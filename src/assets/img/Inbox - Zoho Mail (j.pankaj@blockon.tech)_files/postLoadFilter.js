!function(){"use strict";var a=zmail.Settings.Modules,b=a.create("Apps.Filter");$.subscribe("FILTER_SUGGESTION",function(b,c){var d=zmComponent.loadingBand({container:zmsuite.getCenter()[0].$el[0],notToSetInnerHTML:!0});zmAppLoader.load("zm-settings-app-filters").done(function(){var b=a["import"]("Apps.Filter.Constants"),e=a["import"]("Apps.Filter.Views.Utils"),f=a["import"]("Apps.Filter.Models");f.FilterCollection.getCollectionOf(b.FILTER_TYPES.ALL).then(function(){c&&e.showFilterPane(new f.Filter(c))}).always(function(){zmUtil.hideMenu(),d&&d()})})});var c={"true":"classifySenderInSmartFilter","false":"excludeSenderInSmartFilter",undefined:"excludeSenderInSmartFilter"};b.categoriseMail=function(a){return Backbone.ajax({url:zmail.conPath+"/filter.do",data:{accId:zmail.accId,mode:c[a.include],msgId:a.msgId,filType:a.filType}})},b.loadFilterModels=function(){return zmAppLoader.load("zm-settings-app-filters-models")},b.fetchFilters=function(){var a=$.Deferred();return b.loadFilterModels().then(function(){zmail.Settings.Apps.Filter.Models.FilterCollection.getCollectionOf(0).then(function(b){a.resolve(b)},a.reject)}),a.promise()},b.fetchFilterNamesAndId=function(){var a=$.Deferred();return b.fetchFilters().then(function(b){a.resolve(zmail.Settings.Apps.Filter.Models.getFilterNamesAndId())},a.reject),a.promise()}}();