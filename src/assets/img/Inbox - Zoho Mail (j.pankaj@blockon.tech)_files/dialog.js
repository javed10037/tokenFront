define([],function(a){"use strict";var b,c,d=a("zmail.Core.Namespaces"),e=a("_zm"),f=a("zmText"),g=d.create("zmsDialog"),h=new zmail.Navigator({onEscape:function(){g.remove()}}),i=function(a){a.$el&&a.$el.addClass("sel")},j=function(a){a.$el&&a.$el.removeClass("sel")},k=function(a){var b=h.dom;a=a||[],a.forEach(function(a,c){h.focused<0&&(h.focused=a.selected?c:-1),b.push({isArrowKeyAllowed:!0,$el:a.$el,onFocus:i,onBlur:j,onEnter:a.callback})}),h.setThisAsCurrentNavigator()},l={conBtn:function(a){var b,c,d,e=0;for(a&&(e=a.length),d=$("<div class='SC_PUbtm'/>"),b=0;b<e;b++)c=$("<span/>"),a[b].$el=c,c.html(a[b].txt),c.on("click",a[b].callback),a[b].selected?c.addClass("sel"):a[b].isCancel&&c.attr("data-val","Cancel"),d.append(c);return d},conPtr:function(a){var b=$("<div/>");return"top"===a?b.addClass("SC_arr SC_arrt"):"tleft"===a?b.addClass("SC_arr SC_arrtl"):"tright"===a?b.addClass("SC_arr SC_arrtr"):"bottom"===a?b.addClass("SC_arr SC_arrb"):"bleft"===a?b.addClass("SC_arr SC_arrbl"):"bright"===a&&b.addClass("SC_arr SC_arrbr"),b}},m={dragMove:function(a,d){var e,f,h,i,j=$("#zmsdialog_"+g.elemId);h=a.pageX,i=a.pageY,e=h-b,f=i-c,d(j,e,f,h,i),b=h,c=i},setDrag:function(a,d){a.on("mousedown",function(a){b=a.pageX,c=a.pageY,a.preventDefault(),$(document).mousemove(function(a){m.dragMove(a,d)}),$(document).mouseup(function(){$(document).off("mousemove")})})},movePopup:function(a,b,c){var d=$(document.body).width(),e=$(document.body).height(),f=a.width(),g=a.height(),h=a.offset();h.left+b<=0?a.css("left","0px"):h.left+f+b>=d?a.css("left",d-f+"px"):a.css("left",h.left+b+"px"),h.top+c<=0?a.css("top","0px"):h.top+g+c+13>=e?a.css("top",e-g-13+"px"):a.css("top",h.top+c+"px")},resPopup:function(a,b,c,d,e){var f=$(document.body).width(),g=$(document.body).height(),h=a.width(),i=a.height(),j=a.offset();d+b>=f?a.width(f-j.left):a.width(b+h),e>=g?a.height(g-j.top-13):a.height(c+i)}},n={elemId:null,create:function(b,c){var d,e,h,i,j,n,o,p,q,r,s,t,u,v,w="",x="",y="",z=0,A=void 0===c.defaultNavigator||c.defaultNavigator;if(this.elemId=b,this.closeaction=c.closeaction,this.options=c,t="SC_Pop ",c.customClass&&(t+=" "+c.customClass),c.style)for(var B in c.style)x+=B+":"+c.style[B]+";";if(c.posParent||(t+=" SC_cent"),$("#zmsdialog_"+b).length)return $("#zmsdialog_"+b).attr("style",x),void $("#zmsdialog_"+b).show();if(w+='<div class="'+t+'"><div class="SC_pe"><div id="zmsdialog_'+b+'" class="SC_PU">',w+='<div id="zmsdialogcont_'+b+'" class="SC_PUcen"></div></div></div></div>',$("#"+b).wrap(w),o=$("#zmsdialog_"+b),o.attr("style",x),c.posParent&&o.parents(".SC_Pop").css(c.posParent),c.stopPropagation&&o.on("mousedown",function(b){a("zmUtil").stopEvents(b)}),c.title){y+='<div class="SC_PUtt"><h3>';var C="hdr_actions",D=c[C];if(D)for(var E=0,F=D.length;E<F;E++)y+='<i class="SC_lnk">'+D[E].text+"</i>";else{var G=f.get("dialog","tooltips.close");y+='<div class="SCmb"><div class="SC_frt"><ul><li><b><div class="SC_hd"></div><span data-tooltip="'+G+'" class="SC_ttip ttr"><i class="msi-close"></i></span></b></li></ul></div></div>'}y+=c.title,y+="</h3></div>",$("#zmsdialogcont_"+b).before(y)}if(c.buttons&&c.buttons.length&&(d=l.conBtn(c.buttons),$("#zmsdialogcont_"+b).after(d)),A&&k(c.buttons),c.hideButtons&&$("#zmsdialog_"+b).find(".SC_PUbtm").addClass("SC_vh"),c.bottom&&$("#zmsdialogcont_"+b).after("<div class='SC_PUbtm'>"+c.bottom+"</div>"),c.ptr&&$("#zmsdialogcont_"+b).after(l.conPtr(c.ptr)),c.res){var H=$("<div/>");H.css({position:"absolute",bottom:"0px",right:"0px",width:"10px",height:"10px",background:"grey"}),$("#zmsdialogcont_"+b).after(H),m.setDrag($("#zmsdialog_"+b+" div"),m.resPopup)}o.show(),$("#"+b).show(),setTimeout(function(){c.mask?o.parents(".SC_Pop").addClass("wht"):o.parents(".SC_Pop").addClass("tra"),c.afterDisplay&&setTimeout(function(){c.afterDisplay()},100)},500),n=$(document.body),p=n.height(),q=n.width(),r=o.height(),s=o.width(),c.pos&&("center"===c.pos?(e=p/2-r/2,h=q/2-s/2):"tleft"===c.pos?(e="10%",h="10%"):"tcenter"===c.pos?(e="10%",h=q/2-s/2):"tright"===c.pos?(e="10%",i="10%"):"mleft"===c.pos?(h="10%",e=p/2-r/2):"mright"===c.pos?(i="10%",e=p/2-r/2):"bleft"===c.pos?(h="10%",e=.9*(p-r)):"bcenter"===c.pos?(e=.9*(p-r),h=q/2-s/2):"bright"===c.pos?(e=.9*(p-r),i="10%"):"onevent"===c.pos&&(j=c.onelem.offset(),e=j.top+c.onelem.height()+3,h=j.left,e+r>p&&(e=p-r-20),h+s>q&&(h=q-s-20))),o.css("top",e),h?o.css("left",h):o.css("right",i),u=o.find(".SC_PUtt").height()||0,z&&(z=d.height()||0),p=$(document.body).height(),window.isFinite(c.heightPercent)&&(c.heightPercent=window.parseInt(c.heightPercent),p*=c.heightPercent/100),v=p-(u+z+100),c.notToSetMaxHeight||$("#zmsdialogcont_"+b).css("max-height",v+"px"),c.hideclose?$("#zmsdialog_"+b+" .SC_PUtt i.msi-close").hide():$("#zmsdialog_"+b+" .SC_PUtt i.msi-close").closest("span").click(function(){g.remove()}),c.drag&&m.setDrag($("#zmsdialog_"+b).children(":first"),m.movePopup),c.posParent&&$.publish("/mail/menuCreated",[{element:o.parents(".SC_Pop")[0],menuHandler:this.remove.bind(this)}])},remove:function(a){var b=this,c=$("#"+g.elemId);h.clearTrace(),c.parents(".SC_Pop").removeClass("wht tra"),setTimeout(function(){var c,d=g.elemId;$("#"+d).hide(),c=$("#zmsdialogcont_"+d).contents(),$("#zmsdialog_"+d).parents(".SC_Pop").replaceWith(c),$("#zmsMask").remove(),b.closeaction&&(a||b.closeaction(),b.closeaction=null),g.elemId=null,$.publish("zm/framework/dialogClosed",{id:d})},500)},hide:function(){var a=$("#"+g.elemId);a.parents(".SC_Pop").removeClass("wht tra"),setTimeout(function(){$("#zmsdialog_"+g.elemId).parents(".SC_Pop").hide(),$("#zmsMask").remove()},500)},succErrMsg:function(a,b,c){c=c||{},c.parElem=c.parElem||$("#"+g.elemId)[0],e.succErrMsg(a,b,c)},showButtons:function(){$("#zmsdialog_"+g.elemId).find(".SC_PUbtm").removeClass("SC_vh")},hideButtons:function(){$("#zmsdialog_"+g.elemId).find(".SC_PUbtm").addClass("SC_vh")},isOpen:function(){return null!==g.elemId},listenOnceDialogClose:function(a){if("function"==typeof a){var b=function(){$.unsubscribe("zm/framework/dialogClosed",b),a()};$.subscribe("zm/framework/dialogClosed",b)}}};return $.extend(!0,g,n),g}),define([],function(a){"use strict";var b=a("zmail.Core.Namespaces"),c=a("_zm"),d=a("zmText"),e=b.create("zmsDialog"),f="zm_AlertText",g=function(a,b){return b=b||{},b.buttons=b.buttons||[{txt:d.get("dialog","ok"),selected:!0}],b.mask=b.mask||!0,b.pos=b.pos||"center",b.closeaction=function(){c.remove(a)},b.buttons[0].callback=function(){e.remove(),b.onOk&&b.onOk()},b},h=function(a,b){return b=b||{},b.buttons=b.buttons||[{txt:d.get("dialog","ok"),selected:!0},{txt:d.get("dialog","cancel"),isCancel:!0}],b.mask=b.mask||!0,b.closeaction=function(){c.remove(a)},b.buttons[0].callback=function(){e.remove(),b.onOk&&b.onOk(),b.onHide&&b.onHide()},b.buttons[1].callback=function(){e.remove(),c.remove(a),b.onCancel&&b.onCancel(),b.onHide&&b.onHide()},b},i=function(b){var c=a("zmComponent").htmlizer(["h4",{attrs:{id:f},child:[["text",b]]}]);return document.body.appendChild(c),c};return e.confirm=function(a,b){e.create(f,h(i(a),b))},e.alert=function(a,b){e.create(f,g(i(a),b))},e}),define([],function(a,b){"use strict";var c=a("zmail.Core.Namespaces"),d=a("_"),e=c.create("Dialog"),f={},g={center:"SC_cent"},h={black:"blk",white:"wht",none:"tra"},i={maskWrapper:function(a){var b=a.maskWrapperClass;return b+=" "+g[a.position],b+=" "+h[a.mask],"<div class='"+b+"'></div>"},positionWrapper:function(a){return"<div class='"+a.positionWrapperClass+"'></div>"},contentWrapper:function(a){return"<div class='"+a.contentWrapperClass+"' style='"+(a.wrapperStyle||"")+"' ></div>"},icon:function(a,b,c){var d=a.delimiter?c.iconDelimiterClass:"";return"<li class='"+d+"'><b class='"+c.iconSelectorClass+"'  data-id='"+b+"'><div class='SC_hd' /><span><i class='"+a["class"]+"' /></span></b></li>"},iconGroup:function(a,b,c,e){var f=$("<ul/>"),g=this;return d.isArray(a)||(a=[a]),d(a).each(function(a,d){var h=b+"."+c+"."+d;return f.append($(g.icon(a,h,e)))}),f},iconGroupWrapper:function(){return $("<div class='SCmb'>")},closeIcon:function(a){a=a||{};var b=a.icons||{};if(b.closeIcon){var c=this.iconGroupWrapper();c.addClass("puClose");var d=$("<ul/>");return d.append(this.icon(b.closeIcon,"closeIcon",a)),c.append(d),c}},title:function(a){var b=$("<h3/>");return b.text(a),b},leftHeader:function(a){var b,c=$("<div class='SC_flt'>"),e=a.icons||{},f=this;return a.title&&c.append(this.title(a.title)),e.left&&(b=this.iconGroupWrapper(),d(e.left).each(function(c,d){b.append(f.iconGroup(c,"left",d,a))}),c.append(b)),c},rightHeader:function(a){var b,c=$("<div class='SC_frt'>"),e=a.icons||{},f=this;return e.right&&(b=this.iconGroupWrapper(),d(e.right).each(function(c,d){b.append(f.iconGroup(c,"right",d,a))}),c.append(b)),c},header:function(a,b){a=a||{},b=b||{};var c=$("<div class='"+a.headerClass+"'/>");return b.$leftHeader=this.leftHeader(a),c.append(b.$leftHeader),b.$rightHeader=this.rightHeader(a),c.append(b.$rightHeader),c},content:function(a){return a=a||{},"<div class='"+a.contentClass+"' style='"+(a.contentStyle||"")+"' >"},button:function(a,b,c){var d=a.isSelected?c.buttonSelectionClass:"",e=a.name,f=a.isCancel?"data-val='Cancel'":"",g=a.attrs||"";d+=" "+c.buttonSelectorClass;var h=$("<span class='"+d+"' data-id='"+b+"' "+f+" "+g+" />");return h.text(e),h},buttonContainer:function(a){var b=a.buttons,c=this;if(b&&b.length){var e=$("<div class='"+a.buttonContainerClass+"' ></div>");return d(b).each(function(b,d){e.append(c.button(b,d,a))}),e}return""}};return f.templates=i,d.extend(e,f),e}),define([],function(a,b){"use strict";var c=a("zmail.Core.Namespaces"),d=c.create("Dialog"),e={},f=function(b,c){var d=a("_"),e=b.config,f=e.buttons,g=c.dom;if(f&&f.length){var h=function(a){a.$el&&a.$el.addClass(e.buttonSelectionClass)},i=function(a){a.$el&&a.$el.removeClass(e.buttonSelectionClass)},j=b.$els.$buttonContainer.children();d(f).each(function(a,d){c.focused<0&&(c.focused=a.isSelected?d:-1),g.push({isArrowKeyAllowed:!0,$el:$(j[d]),onFocus:h,onBlur:i,onEnter:function(){a.callback(b)}})})}},g=function(b){var c=a("zmail.Navigator"),d=new c({onEscape:function(){b.remove()}});return f(b,d),d};return e.getDefaultNavigator=g,a("_").extend(d,e),d}),define([],function(a){"use strict";var b=a("zmail.Core.Namespaces"),c=a("_"),d=b.create("Dialog"),e={},f=d.templates,g={getConfig:function(){return{maskWrapperClass:"SC_Pop",positionWrapperClass:"SC_pe",contentWrapperClass:"SC_PU",headerClass:"SC_PUtt",contentClass:"SC_PUcen",buttonContainerClass:"SC_PUbtm",buttonSelectionClass:"sel",buttonSelectorClass:"js-button-selector",iconSelectorClass:"js-icon-selector",iconDelimiterClass:"SC_lbr",position:"center",mask:"white",defaultCloseIcon:!0,ignoreMouseDown:!0,avoidDeepCleanOnRemoval:!1,defaultNavigator:!0}},getCloseIcon:function(){return{"class":"msi-close",callback:function(a){a.remove()}}},extendDefaults:function(a){var b=g.getConfig();return c.extend(b,a),b.defaultCloseIcon&&(b.icons=b.icons||{},b.icons.closeIcon=g.getCloseIcon()),b}},h={build:function(a){var b=a.$els,c=a.config,d=a.templates||f;b.$maskWrapper=$(d.maskWrapper(c)),b.$positionWrapper=$(d.positionWrapper(c)),b.$maskWrapper.append(b.$positionWrapper),b.$contentWrapper=$(d.contentWrapper(c)),b.$positionWrapper.append(b.$contentWrapper),c.defaultCloseIcon&&(b.$closeIcon=$(d.closeIcon(c)),b.$contentWrapper.append(b.$closeIcon)),(c.title||c.icons&&(c.icons.closeIcon||c.icons.left||c.icons.right))&&(b.$header=$(d.header(c,b)),b.$contentWrapper.append(b.$header)),b.$content=$(d.content(c)),b.$contentWrapper.append(b.$content),c.buttons&&c.buttons.length&&(b.$buttonContainer=$(d.buttonContainer(c)),b.$contentWrapper.append(b.$buttonContainer))}},i={buttonsCallbackInvoker:function(a,b,c){var d=a.config.buttons,e=d[b];e&&e.callback&&e.callback(a,c)},iconsCallbackInvoker:function(b,c,d){var e=b.config.icons||{},f=a("_zm").getProperty(e,c);f&&f.callback&&f.callback(b,d)},bindEvents:function(a){var b=a.config;a.$els.$buttonContainer&&a.$els.$buttonContainer.on("click","."+b.buttonSelectorClass,function(c){var d=$(c.target).closest("."+b.buttonSelectorClass).data("id");i.buttonsCallbackInvoker(a,d,c)});var c=function(c){var d=$(c.target).closest("."+b.iconSelectorClass).data("id");i.iconsCallbackInvoker(a,d,c)};a.$els.$closeIcon&&a.$els.$closeIcon.on("click","."+b.iconSelectorClass,c),a.$els.$header&&a.$els.$header.on("click","."+b.iconSelectorClass,c),a.config.ignoreMouseDown&&a.$els.$maskWrapper.on("mousedown",function(a){a.stopPropagation()})}},j={show:function(){this.$els.$maskWrapper.show(),this.config.navigator&&this.config.navigator.setThisAsCurrentNavigator()},hide:function(){this.$els.$maskWrapper.hide(),this.config.hideAction&&this.config.hideAction(this)},remove:function(){this.config.closeAction&&this.config.closeAction(this),this.$els.$maskWrapper.remove(),this.$els.$maskWrapper.remove(),this.config.navigator&&this.config.navigator.clearTrace(),this.config.avoidDeepCleanOnRemoval||(delete this.$els,delete this.config),$.publish("zm/framework/dialogClosed",{})}},k={init:function(a){return h.build(a),i.bindEvents(a),c.extend(a,j),this},dialogWillMount:function(a){return a.config.dialogWillMount&&a.config.dialogWillMount.call(a,a),this},_configureNavigator:function(a){var b=a.config;!b.navigator&&b.defaultNavigator&&(b.navigator=d.getDefaultNavigator(a)),b.navigator&&b.navigator.setThisAsCurrentNavigator()},mountDialog:function(a){var b=a.$dialogParent?$(a.$dialogParent):$("body");return b.append(a.$els.$maskWrapper),a.config.$content&&a.$els.$content.append(a.config.$content),this._configureNavigator(a),this},dialogDidMount:function(a){return a.config.dialogDidMount&&a.config.dialogDidMount.call(a,a),this}},l=function(a){var b={config:g.extendDefaults(a),$els:{}};return k.init(b).dialogWillMount(b).mountDialog(b).dialogDidMount(b),b};return e["new"]=l,c.extend(d,e),d}),define([],function(a){"use strict";var b=a("zmail.Core.Namespaces"),c=a("zmText"),d=b.create("Dialog"),e={},f=function(a,b,e){var f=function(a,c){b&&b(a,c),a.remove()};return e=e||{},e.title=a,e.buttons=[{name:e.okButtonName||c.get("dialog","ok"),callback:f}],d["new"](e)};return e.alert=f,a("_").extend(d,e),d}),define([],function(a){"use strict";var b=a("zmail.Core.Namespaces"),c=a("zmText"),d=b.create("Dialog"),e={},f=function(a,b,e,f){var g=function(a,c){b&&b(a,c),a.remove()},h=function(a,b){e&&e(a,b),a.remove()};return f=f||{},f.title=a,f.buttons=[{name:f.okButtonName||c.get("dialog","ok"),isSelected:!0,callback:g},{name:f.cancelButtonName||c.get("dialog","cancel"),callback:h,isCancel:!0}],d["new"](f)};return e.confirm=f,a("_").extend(d,e),d});