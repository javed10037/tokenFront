"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}define([],function(a){var b,c,d=a("zmText"),e=a("zmail.Core.Namespaces"),f=a("_zm"),g=e.create("zmSmiley"),h=!1,i=d.get("smiley","smileys.header"),j="smileys-2x/",k=function(){return b||(b=d.get("smiley","smileys.tooltips")),c||(c={":smile:":{"class":"smile",category:"smiley"},":)":{"class":"smile",category:"smiley"},":-)":{"class":"smile",category:"smiley"},":happy:":{"class":"happy",category:"smiley"},":joy:":{"class":"joy",category:"smiley"},":D":{"class":"happy",category:"smiley"},":grinning:":{"class":"grinning",category:"smiley"},":cool:":{"class":"cool",category:"smiley"},"B-)":{"class":"cool",category:"smiley"},":love:":{"class":"love",category:"smiley"},":xs":{"class":"love",category:"smiley"},":curious:":{"class":"curious",category:"smiley"},":awe:":{"class":"awe",category:"smiley"},":thinking:":{"class":"thinking",category:"smiley"},":search:":{"class":"search",category:"smiley"},":idea:":{"class":"idea",category:"smiley"},"*-:)":{"class":"idea",category:"smiley"},":wink:":{"class":"wink",category:"smiley"},";-)":{"class":"wink",category:"smiley"},";)":{"class":"wink",category:"smiley"},":razz:":{"class":"razz",category:"smiley"},":P":{"class":"razz",category:"smiley"},":p":{"class":"razz",category:"smiley"},":relaxed:":{"class":"relaxed",category:"smiley"},":angel:":{"class":"peace",category:"smiley"},":peace:":{"class":"peace",category:"smiley"},"(a)":{"class":"peace",category:"smiley"},":blush:":{"class":"blush",category:"smiley"},":yummy:":{"class":"yummy",category:"smiley"},":yuck:":{"class":"yuck",category:"smiley"},":sad:":{"class":"sad",category:"smiley"},":(":{"class":"sad",category:"smiley"},":-(":{"class":"sad",category:"smiley"},":upset:":{"class":"upset",category:"smiley"},":anxious:":{"class":"anxious",category:"smiley"},"D:":{"class":"anxious",category:"smiley"},":worry:":{"class":"worry",category:"smiley"},":stressed-out:":{"class":"stressed-out",category:"smiley"},":-s":{"class":"stressed-out",category:"smiley"},":angry:":{"class":"angry",category:"smiley"},"X-(":{"class":"angry",category:"smiley"},":tensed:":{"class":"tensed",category:"smiley"},":tired:":{"class":"tired",category:"smiley"},":bored:":{"class":"bored",category:"smiley"},":sleepy:":{"class":"sleepy",category:"smiley"},"|-)":{"class":"sleepy",category:"smiley"},":jealous:":{"class":"jealous",category:"smiley"},":evil:":{"class":"evil",category:"smiley"},":facepalm:":{"class":"facepalm",category:"smiley"},":doubt:":{"class":"doubt",category:"smiley"},":shock:":{"class":"shock",category:"smiley"},":o":{"class":"shock",category:"smiley"},":O":{"class":"shock",category:"smiley"},":faint:":{"class":"faint",category:"smiley"},"(6.6)":{"class":"faint",category:"smiley"},":headache:":{"class":"headache",category:"smiley"},":sick:":{"class":"sick",category:"smiley"},"+o(":{"class":"sick",category:"smiley"},":injured:":{"class":"injured",category:"smiley"},":neutral:":{"class":"neutral",category:"smiley"},":smirk:":{"class":"smirk",category:"smiley"},":/":{"class":"smirk",category:"smiley"},":shutup:":{"class":"keep-quiet",category:"smiley"},":keep-quiet:":{"class":"keep-quiet",category:"smiley"},":-#":{"class":"keep-quiet",category:"smiley"},":feeling-warm:":{"class":"feeling-warm",category:"smiley"},":feeling-cold:":{"class":"feeling-cold",category:"smiley"},":rofl:":{"class":"rofl",category:"smiley"},":tongue-out:":{"class":"tongue-out",category:"smiley"},":surprise:":{"class":"surprise",category:"smiley"},":nerd:":{"class":"nerd",category:"smiley"},":rich:":{"class":"rich",category:"smiley"},":shush:":{"class":"shush",category:"smiley"},":crying:":{"class":"crying",category:"smiley"},":thumbsup:":{"class":"thumbsup",category:"smiley"},":thumbsdown:":{"class":"thumbsdown",category:"smiley"},":namaste:":{"class":"namaste",category:"smiley"},"(y)":{"class":"thumbsup",category:"smiley"},"(Y)":{"class":"thumbsup",category:"smiley"},":x-":{"class":"thumbsup",category:"smiley"},"(n)":{"class":"thumbsdown",category:"smiley"},"(N)":{"class":"thumbsdown",category:"smiley"},":super:":{"class":"super",category:"smiley"},":victory:":{"class":"victory",category:"smiley"},":yoyo:":{"class":"yoyo",category:"smiley"},":raising-hand:":{"class":"raising-hand",category:"smiley"},":clap:":{"class":"clap",category:"smiley"},":bye-bye:":{"class":"bye-bye",category:"smiley"},":thug:":{"class":"fist",category:"smiley"},":fist:":{"class":"fist",category:"smiley"},":flexed-biceps:":{"class":"biceps",category:"smiley"},":biceps:":{"class":"biceps",category:"smiley"},":birthday:":{"class":"birthday",category:"celebration"},":champagne:":{"class":"champagne",category:"celebration"},":chicken:":{"class":"chicken",category:"celebration"},":christmas-tree:":{"class":"christmas-tree",category:"celebration"},":eid-mubarak:":{"class":"eid-mubarak",category:"celebration"},":fireworks:":{"class":"fireworks",category:"celebration"},":gift-box:":{"class":"gift-box",category:"celebration"},":kaaba:":{"class":"kaaba",category:"celebration"},":new-year:":{"class":"new-year",category:"celebration"},":party:":{"class":"party",category:"celebration"},":santa-hat:":{"class":"santa-hat",category:"celebration"},":coffee-cup:":{"class":"coffee-cup",category:"office"},":food:":{"class":"food",category:"office"},":peanuts:":{"class":"peanuts",category:"office"},":fire:":{"class":"fire",category:"office"},":fire-extinguisher:":{"class":"fire-extinguisher",category:"office"},":first-aid-box:":{"class":"first-aid-box",category:"office"},":medicine:":{"class":"medicine",category:"office"},":poop:":{"class":"poop",category:"office"},":target:":{"class":"target",category:"office"},":task:":{"class":"task",category:"office"},":calendar:":{"class":"calendar",category:"office"},":report:":{"class":"report",category:"office"},":bug:":{"class":"bug",category:"office"},":milestone:":{"class":"milestone",category:"office"},":security:":{"class":"security",category:"office"},":processor:":{"class":"processor",category:"office"},":laptop:":{"class":"laptop",category:"office"},":server:":{"class":"server",category:"office"},":break-boy:":{"class":"break-boy",category:"sports"},":break-girl:":{"class":"break-girl",category:"sports"},":singing:":{"class":"singing",category:"sports"},":man-dancing:":{"class":"man-dancing",category:"sports"},":woman-dancing:":{"class":"woman-dancing",category:"sports"},":male-cyclist:":{"class":"man-cycling",category:"sports"},":man-cycling":{"class":"man-cycling",category:"sports"},":male-runner:":{"class":"man-running",category:"sports"},":man-running:":{"class":"man-running",category:"sports"},":male-swimmer:":{"class":"man-swimming",category:"sports"},":man-swimming:":{"class":"man-swimming",category:"sports"},":female-cyclist:":{"class":"woman-cycling",category:"sports"},":woman-cycling:":{"class":"woman-cycling",category:"sports"},":female-runner:":{"class":"woman-running",category:"sports"},":woman-running:":{"class":"woman-running",category:"sports"},":female-swimmer:":{"class":"woman-swimming",category:"sports"},":woman-swimming:":{"class":"woman-swimming",category:"sports"},":yoga:":{"class":"yoga",category:"sports"},":badminton:":{"class":"badminton",category:"sports"},":baseball:":{"class":"baseball",category:"sports"},":basketball:":{"class":"basketball",category:"sports"},":chess:":{"class":"chess",category:"sports"},":cricket:":{"class":"cricket",category:"sports"},":flag:":{"class":"flag",category:"sports"},":foosball:":{"class":"foosball",category:"sports"},":football:":{"class":"football",category:"sports"},":golf:":{"class":"golf",category:"sports"},":hockey:":{"class":"hockey",category:"sports"},":snooker:":{"class":"snooker",category:"sports"},":table-tennis:":{"class":"table-tennis",category:"sports"},":tennis:":{"class":"tennis",category:"sports"},":volleyball:":{"class":"volleyball",category:"sports"},":gold-medal:":{"class":"gold-medal",category:"sports"},":silver-medal:":{"class":"silver-medal",category:"sports"},":bronze-medal:":{"class":"bronze-medal",category:"sports"},":archery:":{"class":"archery",category:"sports"},":boxing:":{"class":"boxing",category:"sports"},":badminton-player:":{"class":"badminton-player",category:"sports"},":basketball-player:":{"class":"basketball-player",category:"sports"},":batsman:":{"class":"batsman",category:"sports"},":batter:":{"class":"batter",category:"sports"},":bowler:":{"class":"bowler",category:"sports"},":canoeing:":{"class":"canoeing",category:"sports"},":chess-player:":{"class":"chess-player",category:"sports"},":discus-throw:":{"class":"discus-throw",category:"sports"},":diving:":{"class":"diving",category:"sports"},":equestrian:":{"class":"equestrian",category:"sports"},":fencing:":{"class":"fencing",category:"sports"},":football-player:":{"class":"football-player",category:"sports"},":female-tennis-player:":{"class":"female-tennis-player",category:"sports"},":female-TT-player:":{"class":"female-tabletennis-player",category:"sports"},":female-tabletennis-player:":{"class":"female-tabletennis-player",category:"sports"},":female-volleyball-player:":{"class":"female-volleyball-player",category:"sports"},":golfer:":{"class":"golfer",category:"sports"},":gymnast:":{"class":"gymnast",category:"sports"},":hockey-player:":{"class":"hockey-player",category:"sports"},":hammer-throw:":{"class":"hammer-throw",category:"sports"},":hurdles:":{"class":"hurdles",category:"sports"},":javelin-throw:":{"class":"javelin-throw",category:"sports"},":judo:":{"class":"judo",category:"sports"},":long-jump:":{"class":"long-jump",category:"sports"},":pole-vault:":{"class":"pole-vault",category:"sports"},":running:":{"class":"running",category:"sports"},":rhythmic-gymnastics:":{"class":"rhythmic-gymnastics",category:"sports"},":shooting:":{"class":"shooting",category:"sports"},":shotput-throw:":{"class":"shotput-throw",category:"sports"},":high-jump:":{"class":"high-jump",category:"sports"},":karate:":{"class":"karate",category:"sports"},":male-TT-player:":{"class":"male-tabletennis-player",category:"sports"},":male-tabletennis-player:":{"class":"male-tabletennis-player",category:"sports"},":male-volleyball-player:":{"class":"male-volleyball-player",category:"sports"},":male-tennis-player:":{"class":"male-tennis-player",category:"sports"},":pitcher:":{"class":"pitcher",category:"sports"},":snooker-player:":{"class":"snooker-player",category:"sports"},":weightlifting:":{"class":"weightlifting",category:"sports"},":wrestling:":{"class":"wrestling",category:"sports"},":bicycle:":{"class":"bicycle",category:"travel"},":sports-bike":{"class":"sports-bike",category:"travel"},":cruiser-bike:":{"class":"cruiser-bike",category:"travel"},":motor-scooter:":{"class":"motor-scooter",category:"travel"},":car:":{"class":"car",category:"travel"},":taxi:":{"class":"taxi",category:"travel"},":bus:":{"class":"bus",category:"travel"},":train:":{"class":"train",category:"travel"},":police-car:":{"class":"police-car",category:"travel"},":ambulance:":{"class":"ambulance",category:"travel"},":fire-engine:":{"class":"fire-engine",category:"travel"},":aeroplane:":{"class":"aeroplane",category:"travel"},":passenger-ship:":{"class":"passenger-ship",category:"travel"},":parking:":{"class":"parking",category:"travel"},":cafeteria:":{"class":"cafeteria",category:"travel"},":garden:":{"class":"garden",category:"travel"},":playground:":{"class":"playground",category:"travel"},":home:":{"class":"home",category:"travel"},":office:":{"class":"office",category:"travel"},":library:":{"class":"library",category:"travel"},":auditorium:":{"class":"auditorium",category:"travel"},":store:":{"class":"store",category:"travel"},":mail-room:":{"class":"mail-room",category:"travel"},":pharmacy:":{"class":"pharmacy",category:"travel"},":gym:":{"class":"gym",category:"travel"},":americas:":{"class":"americas",category:"travel"},":europe-africa:":{"class":"europe-africa",category:"travel"},":asia-pacific:":{"class":"asia-pacific",category:"travel"}}),h=!0,c},l=function(b,c){var d=a("zmMention"),e=" "+$(c).data("text")+" ";d.insertAtCursor(b,e),$(b).focus(),$("#zm_dropDown").remove()},m=function(){var a={};h||k(),a=c;var d,e=[],g="",j="",l=f.getDOM(["LI",{attrs:{style:"padding-top:5px"},child:[["DIV",{attrs:{"class":"smileydivmn"},child:[["DIV",{attrs:{"class":"smileydiv zmsc_smiley"},child:[["H5",{child:[["text",i.smiley]]}]]}],["DIV",{attrs:{"class":"smileydiv zmsc_celebration"},child:[["H5",{child:[["text",i.celebration]]}]]}],["DIV",{attrs:{"class":"smileydiv zmsc_office"},child:[["H5",{child:[["text",i.office]]}]]}],["DIV",{attrs:{"class":"smileydiv zmsc_sports"},child:[["H5",{child:[["text",i.sports]]}]]}],["DIV",{attrs:{"class":"smileydiv zmsc_travel"},child:[["H5",{child:[["text",i.travel]]}]]}]]}],["UL",{attrs:{"class":"smileyCateg"},child:[["LI",{attrs:{"class":"sel","data-category":"smiley"},child:[["EM",{attrs:{"class":"zcslymsg-smile"}}]]}],["LI",{attrs:{"data-category":"celebration"},child:[["EM",{attrs:{"class":"zcslymsg-birthday"}}]]}],["LI",{attrs:{"data-category":"office"},child:[["EM",{attrs:{"class":"zcslymsg-coffee-cup"}}]]}],["LI",{attrs:{"data-category":"sports"},child:[["EM",{attrs:{"class":"zcslymsg-football"}}]]}],["LI",{attrs:{"data-category":"travel"},child:[["EM",{attrs:{"class":"zcslymsg-bus"}}]]}]]}]]}]),m={smiley:l.getElementsByClassName("zmsc_smiley")[0],celebration:l.getElementsByClassName("zmsc_celebration")[0],office:l.getElementsByClassName("zmsc_office")[0],sports:l.getElementsByClassName("zmsc_sports")[0],travel:l.getElementsByClassName("zmsc_travel")[0]};for(d in a)g=a[d]["class"],j=a[d].category,e.indexOf(g)===-1&&(e.push(g),m[j].appendChild(f.getDOM(["DIV",{attrs:{"data-text":d,title:b[g],"class":"smlynone"},child:[["DIV",{attrs:{"class":"zcsly-"+g}}]]}])));return l},n=function(a){var b=a.getElementsByClassName("smileyCateg")[0].getBoundingClientRect().height,c=$("#zm_dropDown").children("ul")[0],d=c.getBoundingClientRect().height-b;a.getElementsByClassName("smileydivmn")[0].style.height=d+"px",a.style.paddingBottom=b+5+"px"},o=function(a,b,d){var e,g=m(),h=f("<","LI",f(".","smileyCateg",g)[0]),i=!1,k=f(".","smileydivmn",g)[0];$(h).each(function(){$(this).on("click",function(){if(!$(this).hasClass("sel")){$(this).siblings(".sel").removeClass("sel"),e=$(this).addClass("sel").data("category"),i=!0;var a=f(".","zmsc_"+e,k),b=0,c=$(a).prevAll();if(c.length)for(var d=0,g=c.length;d<g;d++)b+=c[d].offsetHeight;$(k).animate({scrollTop:b},function(){i=!1})}})});var n=f(".","smlynone",g);$(n).each(function(){$(this).on("click",function(e){var f=this;if(a&&"function"==typeof a){var g="";if(f&&$(f).data("text")){var h=$(f).data("text");g=zmail.imgPath+j+c[h]["class"]+".png"}a(g)}else b&&l(d,this,e)})});var o=0;return $(k).scroll(function(a){if(!i){var b,c=$(this),d=$(c).siblings(".smileyCateg").find(".sel"),e=$(this).scrollTop(),f=e>o;if(b=f?$(d).next():$(d).prev(),b.length){var g,h,j,k,l=c[0].getBoundingClientRect(),m=l.height/2;j=f?$(b).data("category"):$(d).data("category"),k=$(c).find(".zmsc_"+j),g=k[0].getBoundingClientRect(),h=f?l.bottom-g.top>=m:l.bottom-g.top<m,l.bottom>g.top&&h&&($(d).removeClass("sel"),$(b).addClass("sel"))}o=e}}),g},p=function(b,c,d){var e=a("zmUtil"),f=o("",!0,b);f.getElementsByClassName("smileydivmn")[0].style.height="300px";var g={par:c,showArrow:!0,liDom:[f],id:"zmsmiley",defaultclass:!1,ulClass:"noclass",direction:"right"};e.showMenu(g),e.stopEvents(d),n(f)},q=function(a){h||k();var d,e,f,g="";for(d in c)""!==g?g+="|"+d:g=d;g=g.replace(/\|-\)/g,"\\|-)"),g=g.replace(/[[\]()*+.?^]/g,function(a){return"\\"+a}),g="("+g+")";for(var i,j=new RegExp("(\\n|\\s|^)("+g+")+(?=[\\s<\\n]|$)","g"),l=[];null!==(i=j.exec(a));){if(e=$.trim(i[0]),e&&(f=c[e])){f=f["class"];var m="zcslymsg-"+f;l.push({from:i.index,to:j.lastIndex,type:"SMILEY",text:m,title:b[f]})}i.index===j.lastIndex&&j.lastIndex++}return l};return g.showList=p,g.replaceText=q,g.getSmiley=o,g.setHeight=n,g.init=k,g});var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();define([],function(a){var b=a("zmail.Core.Namespaces"),c=a("zmail.Components.AutoComplete.System.AbstractTrigger"),d=b.create("zmSmiley"),e=/(?:^[:]{1}([^\d]*))/i,f=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),_createClass(b,[{key:"textChangeAction",value:function(){var a=this,b=a._input,c=b.getCurrentTypingWord();e.lastIndex=0;var d=e.exec(c);if(d){var f=c||"";a.publishTriggerEvent({searchToken:f})}else a.publishNegativeTriggerEvent()}}]),b}(c);return d.SmileyTrigger=f,d}),define([],function(a){var b=a("zmail.Core.Namespaces"),c=a("zmail.Components.AutoComplete.System.AbstractListItemModel"),d=b.create("zmSmiley"),e=c.extend({defaults:{text:"",id:"","class":"",selected:!1}});return d.SmileyListItemModel=e,d}),define([],function(a){var b=a("zmail.Core.Namespaces"),c=a("_zm"),d=a("zmail.Components.AutoComplete.System.AbstractListModel"),e=b.create("zmSmiley"),f=d.extend({selectDownItem:function(a){var b=this,d=b.getListItems();if(d.length){for(var e=a.offsetWidth,f=c(".","zcsimleys",a)[0].offsetWidth,g=Math.floor(e/f),h=0,i=null,j=0,k=d.length;j<k;j++)if(i=d[j],i.attributes.selected){h=j+g;break}h>=d.length&&(h=d.length-1),b.selectItem(d[h].attributes.id)}},selectUpItem:function(a){var b=this,d=b.getListItems();if(d.length){for(var e=a.offsetWidth,f=c(".","zcsimleys",a)[0].offsetWidth,g=Math.floor(e/f),h=0,i=null,j=0,k=d.length;j<k;j++)if(i=d[j],i.attributes.selected){h=j-g;break}h<0&&(h=0),b.selectItem(d[h].attributes.id)}}});return e.SmileyListModel=f,e});var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();define([],function(a){var b=a("zmText"),c=a("zmail.Core.Namespaces"),d=a("zmail.Components.AutoComplete.System.AbstractDataProvider"),e=a("zmSmiley.SmileyListItemModel"),f=c.create("zmSmiley"),g=function(){var a=f.init();return a},h=b.get("smiley","smileys.tooltips"),i=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),_createClass(b,[{key:"searchData",value:function(a){var b,c=a.searchToken||"",d=g(),f=null,i=null;if(a=a||{},f=a.collection,i=a.deferred,!c)return void i.reject();c=c.toLowerCase();var j,k=Object.keys(d),l=[];if(k&&k.length)for(var m in d)if(j=d[m]["class"],b=m.toLowerCase(),0===b.indexOf(c)&&l.indexOf(j)===-1){l.push(j);var n=new e({"class":j,id:m,text:h[j]});f.add(n)}i.resolve()}}]),b}(d);return f.SmileyDataProvider=i,f});var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();define([],function(a,b){var c=a("zmail.Core.Namespaces"),d=a("zmail.Components.AutoComplete.System.AbstractDataAccumulator"),e=c.create("zmSmiley"),f=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),_createClass(b,[{key:"accumulateData",value:function(a){var b=this,c=a.collectionList;c.forEach(function(a){b.dataCollection.add(a.models)}),b.triggerAccumulationComplete()}}]),b}(d);return e.SmileyDataAccumulator=f,e});var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();define([],function(a,b){var c=a("zmail.Core.Namespaces"),d=a("zmail.Components.AutoComplete.System.AbstractListItemComponent"),e=c.create("zmSmiley"),f={ITEM:['<div ref = "wrapper" class="zcsimleys" elemtype="smiley">','<div ref = "code" class="smlglst" purpose="search">','<em ref = "icon"></em>','<span ref = "text"></span>',"</div>","</div>"].join("")},g=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),_createClass(b,[{key:"getTemplate",value:function(){return f.ITEM}},{key:"render",value:function(a,b){var c=this;b=b||{},c._preRender(a),c.state.searchWord=b.searchWord||c.state.searchWord||"";var d=a.attributes,e="srchbn SC_Psli";c.state.selected?$(c.refs.code).addClass(e):$(c.refs.code).removeClass(e);var f=d.id;$(c.refs.code).attr({code:f});var g="zcslymsg-"+d["class"];$(c.refs.icon).addClass(g);var h=d.text;$(c.refs.text).text(h),$(c.refs.code).attr({title:h}),c._postRender()}},{key:"focus",value:function(){var a=this,b=$(a.dom).parents(".smilyatdrpdwnmn")[0].getBoundingClientRect(),c=a.dom.getBoundingClientRect(),d=b.top>c.top,e=d||b.bottom<c.bottom;a.focusTimeoutID=setTimeout(function(){a._mounted&&($(a.refs.wrapper).focus(),e&&a.refs.wrapper.scrollIntoView(d))},0)}}]),b}(d);return e.SmileyListItemComponent=g,e});var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_get=function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(void 0===e){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if("value"in e)return e.value;var g=e.get;if(void 0!==g)return g.call(d)};define([],function(a,b){var c=a("zmail.Core.Namespaces"),d=a("_zm"),e=a("zmail.Components.AutoComplete"),f=c.create("zmSmiley"),g=e.System.AbstractListComponent,h={LIST:['<div ref="wrapper" class="SC_dd shw smilyatdrpdwnmn" style="max-width:780px; overflow: hidden; bottom: auto; height: auto; max-height:auto;">','<div ref="scrollWrapper" class="smilyatdrpdwn ps-container ps-theme-default ps-active-y">','<div ref="listWrapper" id="smileys" searchcatagory="smileys"></div>',"</div>","</div>"].join("")},i=e.Constants,j=i.KEYS,k={SELECT_UP:"selectUp",SELECT_DOWN:"selectDown",SELECT_NEXT:"selectNext",SELECT_PREVIOUS:"selectPrevious",ITEM_SELECTION:"itemSelection",ITEM_SELECTION_CURRENT:"itemSelectionCurrent"},l=function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this)),c=a;return c.popUp=!0,a}return _inherits(b,a),_createClass(b,[{key:"getTemplate",value:function(){return h.LIST}},{key:"getScrollWrapperDOM",value:function(){var a=this;return a.refs.scrollWrapper}},{key:"handleListSpaceOverflow",value:function(a){var b=this;a=a||{};var c=b.getScrollWrapperDOM();$(c).css({height:a.height+"px"})}},{key:"positionComponent",value:function(a){var c=this,e=c.getScrollWrapperDOM();$(e).css({height:"auto"}),$(c.dom).css({height:d(".","smilyatdrpdwn",c.dom)[0].offsetHeight+"px"});var f=_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"positionComponent",this).call(this,a);return f}},{key:"selectUpListItem",value:function(){var a=this;$(a).triggerHandler(k.SELECT_UP)}},{key:"selectDownListItem",value:function(){var a=this;$(a).triggerHandler(k.SELECT_DOWN)}},{key:"_mouseDownHandler",value:function(a){d.stopEvents(a);var b=this;b.mouseDown=!0}},{key:"_keyDownHandler",value:function(a,b){var c=this;b=b||{};var d=a.which||a.keyCode,e=!0,f=!1;switch(d){case j.LEFT:c.selectPreviousListItem();break;case j.RIGHT:c.selectNextListItem();break;case j.UP:c.selectUpListItem();break;case j.DOWN:c.selectDownListItem();break;case j.ENTER:f=c.choseCurrentSelectedItem(),a.ignoreKeyUp=!0,!f&&b.isProxyEvent&&(e=!1);break;default:e=!1}e&&(a.stopPropagation(),a.preventDefault())}},{key:"show",value:function(){var a=this;$(a.dom).addClass("shown").removeClass("hidden"),$(a.dom).css({visibility:"visible"}),a.visible=!0}},{key:"hide",value:function(){var a=this;$(a.dom).addClass("hidden").removeClass("shown"),$(a.dom).css({visibility:"hidden"}),a.visible=!1}}]),b}(g);return l.EVENTS=k,f.SmileyListComponent=l,f});var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();define([],function(a){var b=a("zmail.Core.Namespaces"),c=a("zmail.Components.AutoComplete.System.AbstractListItemComponentFactory"),d=a("zmSmiley.SmileyListItemComponent"),e=a("zmSmiley.SmileyListItemModel"),f=b.create("zmSmiley"),g=function(a){function b(){return _classCallCheck(this,b),_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return _inherits(b,a),_createClass(b,[{key:"createComponent",value:function(a){if(a instanceof e)return new d}}]),b}(c);return f.SmileyListItemComponentFactory=g,f});var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_get=function b(a,c,d){null===a&&(a=Function.prototype);var e=Object.getOwnPropertyDescriptor(a,c);if(void 0===e){var f=Object.getPrototypeOf(a);return null===f?void 0:b(f,c,d)}if("value"in e)return e.value;var g=e.get;if(void 0!==g)return g.call(d)};define([],function(a){var b=a("zmail.Core.Namespaces"),c=a("zmail.Components.AutoComplete.System.BaseHTMLEditableAutoCompleteSystem"),d=a("zmail.Components.AutoComplete.System.AbstractHTMLTextArea"),e=a("zmSmiley.SmileyDataProvider"),f=a("zmSmiley.SmileyListComponent"),g=a("zmSmiley.SmileyListItemComponentFactory"),h=a("zmSmiley.SmileyTrigger"),i=a("zmSmiley.SmileyDataAccumulator"),j=a("zmSmiley.SmileyListModel"),k=b.create("zmSmiley"),l={LIST_SHOWN:"listShown",LIST_HIDDEN:"listHidden"},m={TEXTAREA:"1",EDITOR:"2"},n=function(b){function c(){return _classCallCheck(this,c),_possibleConstructorReturn(this,(c.__proto__||Object.getPrototypeOf(c)).apply(this,arguments))}return _inherits(c,b),_createClass(c,[{key:"initUserInput",value:function(a){var b=this,c=a.inputElement;switch(b.inputType){case"1":b.userInput=new d,b.userInput.init(c);break;case"2":b.userInput=c}}},{key:"createDataProviders",value:function(){return[new e]}},{key:"createTrigger",value:function(){return new h}},{key:"createDataAccumulator",value:function(){return new i}},{key:"createListComponent",value:function(){return new f}},{key:"createListItemComponentFactory",value:function(){return new g}},{key:"createListModel",value:function(){return new j}},{key:"invokeDataProviderSearch",value:function(a){var b=this,c=b.dataProviders;b.dataAccumulator.dataCollection.reset(null),b.listModel.resetData(),b.listModel.set({currentSearchKey:a.searchToken}),b.disable||c.forEach(function(b){b.getData({searchToken:a.searchToken,trigger:a.trigger})})}},{key:"showComponent",value:function(){var b=a("_zm"),c=this,d=c.dataAccumulator.dataCollection,e=d.find(function(a){return a.attributes.selected});e&&e.set({selected:!1});var f=c.listComponent.dom;if(d.length){var g=c.userInput._element.getBoundingClientRect();"2"===c.inputType&&(g=c.userInput.editor.iframe.getBoundingClientRect());var h=b(".","zcsimleys",f),i=h.length>5?5:h.length,j=h[0].offsetWidth,k=1===i?10:30,m=Math.floor(g.width/j);m=m<i?m:i;var n=j*m+k;n=n>g.width?780:n,$(f).css({
width:n+"px"});var o,p=c.userInput.getListAnchorBounds();p.top-=c.userInput._element.scrollTop,p.bottom-=c.userInput._element.scrollTop,c.listComponent.positionComponent({anchorBounds:p});var q=f.getBoundingClientRect();Math.abs(p.right-g.right)<q.width&&(o=q.left+(g.right-q.right)+"px"),$(f).css({left:o}),c.listComponent.listItemComponents[0].model.set("selected",!0),c.listComponent.show(),$(c).triggerHandler(l.LIST_SHOWN)}}},{key:"hideComponent",value:function(){var a=this;a.listComponent.hide(),$(a).triggerHandler(l.LIST_HIDDEN)}},{key:"_componentSelectUpHandler",value:function(){var a=this;a.listModel.selectUpItem(a.listComponent.dom);var b=a.listModel.getSelectedItem();b&&a.listItemFocusSelectAction({listItemModel:b})}},{key:"_componentSelectDownHandler",value:function(){var a=this;a.listModel.selectDownItem(a.listComponent.dom);var b=a.listModel.getSelectedItem();b&&a.listItemFocusSelectAction({listItemModel:b})}},{key:"bindEvents",value:function(){var a=this;a._componentSelectUpHandler=a._componentSelectUpHandler.bind(a),$(a.listComponent).on(f.EVENTS.SELECT_UP,a._componentSelectUpHandler),a._componentSelectDownHandler=a._componentSelectDownHandler.bind(a),$(a.listComponent).on(f.EVENTS.SELECT_DOWN,a._componentSelectDownHandler),_get(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"bindEvents",this).call(this)}},{key:"unbindEvents",value:function(){var a=this;$(a.listComponent).off(f.EVENTS.SELECT_UP,a._componentSelectUpHandler),$(a.listComponent).off(f.EVENTS.SELECT_DOWN,a._componentSelectDownHandler),_get(c.prototype.__proto__||Object.getPrototypeOf(c.prototype),"unbindEvents",this).call(this)}}]),c}(c);return n.EVENTS=l,n.INPUTS=m,k.SmileyAutoCompleteSystem=n,k}),define([],function(a){var b=a("zmail.Core.Namespaces"),c=a("zmail.Components.AutoComplete"),d=b.create("zmSmiley"),e=c.System.AbstractAutoCompleteSystem,f=d.SmileyAutoCompleteSystem,g=function(a){a=a||{};var b=a.input,c=new f;return $(b).is("textarea")?c.inputType=f.INPUTS.TEXTAREA:b.editor&&(c.inputType=f.INPUTS.EDITOR),c.disable=a.disable||!1,c.init({inputElement:b,parentDOM:document.body}),$(c).on(e.EVENTS.ITEM_SELECTED,a.onSelect),$(c).on(f.EVENTS.LIST_SHOWN,a.listShown),$(c).on(f.EVENTS.LIST_HIDDEN,a.listHidden),c};return d.SmileyAutoComplete=g,d});