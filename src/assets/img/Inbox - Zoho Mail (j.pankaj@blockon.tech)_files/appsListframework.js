define([],function(a){"use strict";var b=a("$"),c=a("_"),d=a("zmAdHocSettings"),e=function(a,c){this.appList=e.util.getSortedAppList(a),this.popAccList=c,this.appObj={},this.accListObj={},this.$el=b("<div class='zm_apps'>")};return e.prototype={set:function(a){this.appList=a},setPopAccArr:function(a){this.popAccList=a},constructDOM:function(a){var c,d,f,g;for(g=b("<ul class='zmApps'>"),d=this.appList.length,c=0;c<d;c+=1)f=new e.appIcon(this.appList[c]),this.appObj[this.appList[c].id]=f,g.append(f.getDOM());return a||this.$el.append(g),g},constructAccountsDOM:function(f){var g,h,i,j,k,l,m,n=3,o=zmail.aInfo,p=this.popAccList;if(h=this.popAccList.length){for(j=b('<ul class="zm-accounts-list">'),l=function(c){return function(){var d=a("zmApp"),e=a("zmUtil");String(zmail.accId)!==String(c)?(e.switchAccount(c),b.publish("/mail/accountSwitch",{status:"started",accountID:c})):"m"!==d.currentApp&&d.showApp("m")}},g=0;g<n&&g<h;g+=1){var q=p[g],r={};r.id=q,r.mailId=o[q].mailId,r.count=o[q].c,r.clk=l(q),i=new e.accountsIcon(r),this.accListObj[q]=i,j.append(i.getDOM())}if(g===n&&g!==h){var s={};s.clk=function(e){var f,i=a("zmUtil"),j={},l=[];for(f=g;f<h;f+=1)k=o[p[f]].mailId,m=o[p[f]].c,m&&(m=parseInt(m),isFinite(m)&&m>0&&(k+="<span class='zm_mct'>"+m+"</span>")),l.push({htm:k,data:{id:p[f]}});j.list=l,j.clk=function(a,e,f){if(a&&a.id){i.switchAccount(a.id),b.publish("/mail/accountSwitch",{status:"started",accountID:a.id}),i.hideMenu();var g=zmail.appList.popAccList.indexOf(a.id);if(g>0){var h=zmail.appList.popAccList.splice(g,1);zmail.appList.popAccList.unshift(h[0]),d.setAccountsLhsOrder(c.first(zmail.appList.popAccList,3).join(",")),zmail.appList.reRenderAccArea(),zmail.appList.accListObj[a.id]&&zmail.appList.accListObj[a.id].selectAccount()}}},j.par=e,j.align="cleft",i.showMenu(j)},s.type="more",i=new e.accountsIcon(s),j.append(i.getDOM())}return f||this.$el.append(j),j}},getDOM:function(){return this.$el},removeAndInsertBefore:function(a,b){if(this.appObj[a]&&this.appObj[a].$el){this.appObj[a].$el.remove();var c=this.appObj[a].getDOM();this.appObj[b]&&this.appObj[b].$el?this.appObj[b].$el.before(c):this.$el.append(c)}},removeAndInsertAfter:function(a,b){if(this.appObj[a]&&this.appObj[a].$el){this.appObj[a].$el.remove();var c=this.appObj[a].getDOM();this.appObj[b]&&this.appObj[b].$el?this.appObj[b].$el.after(c):this.$el.append(c)}},reRender:function(){var b=a("zmApp");this.$el.empty(),zmail.leftAppOrder=d.getAppOrder(),this.appList=e.util.getSortedAppList(this.appList),this.constructDOM(),this.constructAccountsDOM(),b.selectApp(b.currentApp)},reRenderAppArea:function(){this.$el.find("ul").eq(0).remove(),zmail.leftAppOrder=d.getAppOrder(),this.appList=e.util.getSortedAppList(this.appList);var a=this.constructDOM(!0);this.$el.prepend(a)},reRenderAccArea:function(){this.$el.find("ul").eq(1).remove();var a=this.constructAccountsDOM(!0);a&&this.$el.append(a)},removeAppSelection:function(){var a=this.$el.find("ul").eq(0);a.find("li").removeClass("sel")},removeAccountSelection:function(){var a=this.$el.find("ul").eq(1);a.find("li").removeClass("sel")}},window.zmAppList=e,e}),define([],function(a){"use strict";var b=a("$"),c=a("zmText"),d=c.get("appsListframework"),e=function(a){this.accInfo=a,this.$el=b("<li>"),this.$el.attr({id:"zm-ac-"+a.id})};return e.prototype={set:function(a){this.accInfo=a},validateCountVal:function(a){var b=window.parseInt(a);return(!isFinite(b)||b<1)&&(b=0),b},getCountValue:function(a){var b="";return a=window.parseInt(a),b=isFinite(a)&&a>0?a>99?"99+":String(a):""},setToolTip:function(){var b=a("zmComponent"),c=this.accInfo.mailId;this.accInfo.count&&"0"!==this.accInfo.count&&(c+=" ("+this.accInfo.count+")"),b.tooltip({elm:this.$el[0],text:c,arrow:"left"})},updateCount:function(a,c){a=this.validateCountVal(a);var d=this.getCountValue(a),e=this.$el.find(".zm_mct");this.accInfo.count=a,a?(e.length?e.text(d):(e=b("<span class='zm_mct'>"+d+"</span>"),this.$el.find(".lAppLbl").before(e)),"inc"!==c&&"bulkInc"!==c||e.addClass("newPopMail")):e&&e.remove(),this.setToolTip()},getIconDom:function(a){var b="msi-otherac";return a.indexOf("@gmail")>0?b="msi-gmail":a.indexOf("@yahoo")>0||a.indexOf("@ymail")>0?b="msi-yahoo":a.indexOf("@outlook")>0&&(b="msi-outlook"),b},getCountDom:function(a){return a=this.getCountValue(a),a?"<span class='zm_mct'>"+a+"</span>":""},constructDOM:function(){var b,c=a("zmComponent"),e=this;if(e.accInfo.type&&"more"===e.accInfo.type)this.$el.html("<i class='msi-moreac'></i><span class='lAppLbl'></span>"),c.tooltip({elm:this.$el[0],text:d.more,arrow:"left"}),this.$el.off("click").click(function(){e.accInfo.clk(e.$el)});else{var f=e.accInfo.mailId;b="<i class='"+e.getIconDom(f)+"'></i>",this.$el.html(b+e.getCountDom(e.accInfo.count)+"<span class='lAppLbl'></span>"),this.$el.find(".lAppLbl").text(this.accInfo.mailId),this.setToolTip(),this.$el.off("click").click(function(){e.selectAccount(),e.accInfo.clk()})}},selectAccount:function(){this.$el.parent().find("li").removeClass("sel"),zmail.appList.removeAppSelection(),this.$el.find(".zm_mct").removeClass("newPopMail"),this.$el.addClass("sel")},getDOM:function(){return this.constructDOM(),this.$el}},window.zmAppList=window.zmAppList||{},window.zmAppList.accountsIcon=e,e}),define([],function(a){"use strict";var b=a("$"),c=function(a){this.appData=a,this.$el=b("<li>")};return c.prototype={set:function(a){this.appData=a},constructDOM:function(){var a=this;this.$el.html("<i class='"+this.appData.icon+"'></i>"),this.$el.append("<span class='lAppLbl'>"+this.appData.tooltip+"</span>"),this.$el.off("click").click(function(){a.selectApp(),a.appData.clk()})},selectApp:function(){this.$el.parent().find("li").removeClass("sel"),zmail.appList.removeAccountSelection(),this.$el.addClass("sel")},getDOM:function(){return this.constructDOM(),this.$el}},window.zmAppList=window.zmAppList||{},window.zmAppList.appIcon=c,c}),define([],function(a){"use strict";var b=a("_"),c={};return c.getSortedAppList=function(a){if(zmail.leftAppOrder instanceof Array||(zmail.leftAppOrder=zmail.leftAppOrder?zmail.leftAppOrder.split(","):[]),a&&a.length)return b.sortBy(a,function(a){var b=zmail.leftAppOrder.indexOf(a.id);return b>-1?b:100})},window.zmAppList=window.zmAppList||{},window.zmAppList.util=c,c});