function ZCL_isEmpty(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}function ZCL_dateTimeComparison(a,b,c,d,e,f,g){var h=ZCL_getObj(a).value.replace(/^\s+/g,"").replace(/\s+$/g,""),i=ZCL_getObj(d).value.replace(/^\s+/g,"").replace(/\s+$/g,""),j=ZCL_splitDateVal(h),k=ZCL_splitDateVal(i);dd1=j[0],mm1=j[1],yyyy1=j[2],dd2=k[0],mm2=k[1],yyyy2=k[2];var l=ZCL_getObj(b).value.replace(/^\s+/g,"").replace(/\s+$/g,"");l=ZCL_TimetoNo(l);var m=ZCL_getObj(e).value.replace(/^\s+/g,"").replace(/\s+$/g,"");m=ZCL_TimetoNo(m);var n=parseInt(l/100,10),o=parseInt(m/100,10),p=l%100,q=m%100,r=new Date(yyyy1,mm1-1,dd1,n,p,0,0),s=new Date(yyyy2,mm2-1,dd2,o,q,0,0);return ZCL_compareDates(r,c,s,f,g)?!0:(ZCL_getObj(a).focus(),!1)}function ZCL_dateValidate(a,b){if(ZCL_patternValidate(a,b,"DATE")==0)return!1;dateval=ZCL_getObj(a).value.replace(/^\s+/g,"").replace(/\s+$/g,"");var c=ZCL_splitDateVal(dateval);dd=c[0],mm=c[1],yyyy=c[2];if(dd<1||dd>31||mm<1||mm>12||yyyy<1||yyyy<1e3)return zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.plentvd,[b])),ZCL_getObj(a).focus(),!1;if(mm==2&&dd>29)return zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.plentvd,[b])),ZCL_getObj(a).focus(),!1;if(mm==2&&dd>28&&yyyy%4!=0)return zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.plentvd,[b])),ZCL_getObj(a).focus(),!1;switch(parseInt(mm)){case 2:case 4:case 6:case 9:case 11:if(dd>30)return zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.plentvd,[b])),ZCL_getObj(a).focus(),!1}return!0}function ZCL_dateComparison(a,b,c,d,e){var f=ZCL_getObj(a).value.replace(/^\s+/g,"").replace(/\s+$/g,""),g=ZCL_getObj(c).value.replace(/^\s+/g,"").replace(/\s+$/g,""),h=ZCL_splitDateVal(f),i=ZCL_splitDateVal(g);dd1=h[0],mm1=h[1],yyyy1=h[2],dd2=i[0],mm2=i[1],yyyy2=i[2];var j=new Date(yyyy1,mm1-1,dd1,0,0,0,0),k=new Date(yyyy2,mm2-1,dd2,0,0,0,0);return ZCL_compareDates(j,b,k,d,e)?!0:(ZCL_getObj(a).focus(),!1)}function ZCL_patternValidate(a,b,c){var d=ZCL_getObj(a);if(c.toUpperCase()=="EMAIL"){d.value=d.value.trim();var e=/^[a-zA-Z0-9]([\w\-\.\+]*)@([\w\-\.]*)(\.[a-zA-Z]{2,8}(\.[a-zA-Z]{2}){0,2})$/i}else if(c.toUpperCase()=="DATE")switch(zcal.DFORMAT[zcal.cdata.opt.DF]){case"yyyy/MM/dd":case"yyyy-MM-dd":var e=/^\d{4}(\-|\/|\.)\d{1,2}\1\d{1,2}$/;break;case"MM/dd/yyyy":case"dd/MM/yyyy":var e=/^\d{1,2}(\-|\/|\.)\d{1,2}\1\d{4}$/}else if(c.toUpperCase()=="TIME")var e=/^\d{1,2}\:\d{1,2}$/;return e.test(d.value)?!0:(zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.plentvd,[b])),d.focus(),!1)}function ZCL_splitDateVal(a){var b,c=new Array(3);a.indexOf("-")>=0?b="-":a.indexOf(".")>=0?b=".":a.indexOf("/")>=0&&(b="/");switch(zcal.DFORMAT[zcal.cdata.opt.DF]){case"yyyy/MM/dd":c[0]=a.substr(a.lastIndexOf(b)+1,a.length),c[1]=a.substring(a.indexOf(b)+1,a.lastIndexOf(b)),c[2]=a.substring(0,a.indexOf(b));break;case"yyyy-MM-dd":c[0]=a.substr(a.lastIndexOf(b)+1,a.length),c[1]=a.substring(a.indexOf(b)+1,a.lastIndexOf(b)),c[2]=a.substring(0,a.indexOf(b));break;case"MM/dd/yyyy":c[0]=a.substring(a.indexOf(b)+1,a.lastIndexOf(b)),c[1]=a.substring(0,a.indexOf(b)),c[2]=a.substr(a.lastIndexOf(b)+1,a.length);break;case"dd/MM/yyyy":c[0]=a.substring(0,a.indexOf(b)),c[1]=a.substring(a.indexOf(b)+1,a.lastIndexOf(b)),c[2]=a.substr(a.lastIndexOf(b)+1,a.length)}return c}function ZCL_compareDates(a,b,c,d,e){var f=!0;switch(e){case"L":a>=c&&(zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.shlethn,[b,b])),f=!1);break;case"LE":a>c&&(zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.shlethoreq,[b,d])),f=!1);break;case"E":a!=c&&(zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.sheqto,[b,d])),f=!1);break;case"G":a<=c&&(zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.shgrthn,[b,d])),f=!1);break;case"GE":a<c&&(zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.shgrthoreq,[b,d])),f=!1)}return f==0?!1:!0}function ZCL_intValidate(a,b){var c=ZCL_getObj(a).value.replace(/^\s+/g,"").replace(/\s+$/g,"");return isNaN(c)||c.indexOf(".")!=-1?(zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.invd,[b])),ZCL_getObj(a).focus(),!1):c<1||c>999?(zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.outrge,[b])),!1):!0}function ZCL_dateTimeValidate(a,b,c,d){var e=ZCL_getObj(a);if(ZCL_patternValidate(a,c,"DATE")==0)return!1;dateval=ZCL_getObj(a).value.replace(/^\s+/g,"").replace(/\s+$/g,"");var f=ZCL_splitDateVal(dateval);dd=f[0],mm=f[1],yyyy=f[2];if(dd<1||dd>31||mm<1||mm>12||yyyy<1||yyyy<1e3)return _zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_datachk,[c])),ZCL_getObj(a).focus(),!1;if(mm==2&&dd>29)return _zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_datachk,[c])),ZCL_getObj(a).focus(),!1;if(mm==2&&dd>28&&!ZCL_isLeapYear(yyyy))return _zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_datachk,[c])),ZCL_getObj(a).focus(),!1;switch(parseInt(mm,10)){case 2:case 4:case 6:case 9:case 11:if(dd>30)return _zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_datachk,[c])),ZCL_getObj(a).focus(),!1}var g=ZCL_getObj("zcl_"+b+"_time"),h=g.value.toLowerCase();return h=h.replace(/\D/ig,""),isNaN(h)?(_zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_datachk,[c])),g.focus(),!1):!0}function ZCL_isLeapYear(a){return a%400==0||a%100!=0&&a%4==0?!0:!1}function ZCL_crmIntValidate(a,b){if(ZCL_getObj(a)!=null&&ZCL_getObj(a).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length!=0){var c=ZCL_getObj(a).value.replace(/^\s+/g,"").replace(/\s+$/g,""),d=/^\d+(,(\d)+)*$/;return isNaN(c)||c.indexOf(".")!=-1||!d.test(c)?(_zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_datachk,[b])),ZCL_getObj(a).focus(),!1):(ZCL_getObj(a).value=ZCL_getObj(a).value.replace(/^\s+/g,"").replace(/\s+$/g,""),!0)}return!0}function ZCL_XHR(a,b,c,d){a="/mail"+a;if(ZCL_LOGIN_STATE){rt=ZCL_RQ.length,ZCL_RQ[rt]=ZCL_GetHTTPTransport(),ZCL_URL[rt]=a,typeof b=="function"?(ZCL_RQ[rt].zcal_callback=b,ZCL_RQ[rt].zcal_reqindex=rt,ZCL_RQ[rt].onreadystatechange=function(){var a=this.zcal_callback,b=this.zcal_reqindex;if(this.readyState==4){var c=this.getResponseHeader("Content-Type").toLowerCase().indexOf("text/xml");c!=-1?a(this.responseXML,ZCL_URL[b]):a(this,ZCL_URL[b]),ZCL_RQ[b]=null}}):ZCL_RQ[rt].onreadystatechange=new Function("{ \t\t\t\tif( ZCL_RQ["+rt+"].readyState == 4 ) { \t\t\t\t\tZCL_XHRInclude(ZCL_RQ["+rt+"],ZCL_URL["+rt+"]);\t\t\t\t\tvar ret = ZCL_RQ["+rt+'].getResponseHeader("Content-Type").toLowerCase().indexOf("text/xml");\t\t\t\t\t'+b+"((ret !=-1 ? ZCL_RQ["+rt+"].responseXML:ZCL_RQ["+rt+"]) ,ZCL_URL["+rt+"]);ZCL_RQ["+rt+"]=null;}}"),m="POST";var e=document.cookie;return e=e.substring(e.indexOf("aprmjrnpkcrkks=")+15,e.length),a.indexOf("?")!=-1?(c=a.substring(a.indexOf("?")+1,a.length),a=a.substring(0,a.indexOf("?"))):c="",c+=(c!=""?"&":"")+"mstpcrdhkur="+(e.indexOf(";")!=-1?e.substring(0,e.indexOf(";")):e),ZCL_RQ[rt].open(m,a,!0),m=="POST"?(d||(d="application/x-www-form-urlencoded;charset=UTF-8"),ZCL_RQ[rt].setRequestHeader("Content-Type",d),ZCL_RQ[rt].send(c)):ZCL_RQ[rt].send(null),!0}return!1}function ZCL_XHRInclude(){return!0}function ZCL_XHRSync(a,b,c){var d=ZCL_GetHTTPTransport();return m=b?"POST":"GET",a+=(a.indexOf("?")+1?"&":"?")+(new Date).getTime(),d.open(m,a,!1),m=="POST"?(c||(c="application/x-www-form-urlencoded;charset=UTF-8"),d.setRequestHeader("Content-Type",c),d.send(b)):d.send(null),d}function ZCL_constructData(){var a="",b=$('<div id="zcl_prntTemp"/>');if(zcal.view==4)a=ZCL_prntTitle()+'<div align="center" style="font-weight:bold; line-height: 40px;font-size:14px;">'+$(".zcl_tpdtmth")[0].innerHTML+'</div><div class="zcl_prntpdf">'+$("#zcl_workarea").parent().html()+"</div>",b.html(a);else if(zcal.view==3)a=ZCL_prntTitle()+'<div align="center" style="font-weight:bold; line-height: 40px;font-size:14px;">'+$(".zcl_tpdtmth")[0].innerHTML+'</div><div class="zcl_prntpdf">'+zcalMonthPrint.printMonth()+"</div>",b.html(a);else{a=ZCL_prntTitle()+'<div align="center" style="font-weight:bold; line-height: 40px;font-size:14px;">'+$(".zcl_tpdtmth")[0].innerHTML+'</div><div class="zcl_prntpdf">'+$("#zcl_workarea").parent().html()+"</div>",b.html(a);var c=b.find("#zcl_workarea"),d=b.find("#zcl_encloser"),e=b.find("#zcl_allgrid"),f=b.find(".zcl_evbg");c.removeAttr("style"),d.removeAttr("style"),e.removeAttr("style"),f.removeAttr("style")}return b[0].innerHTML}var zcal={};zcal.i18n={},zcal.view=0,zcal.mlimit=[],zcal.disabledcal="",zcal.win=window,zcal.isRO=!1,zcal.ZCRM="",zcal.ZMET="",zcal.ZTSK="",zcal.ZNTS="",zcal.ZCAL,zcal.timezones=[],zcal.search={},zcal.calcolor=[["#528800","#8CBF40"],["#B1365F","#E67399"],["#4A716C","#85AAA5"],["#001ca2","#8f9bd6"],["#00a600","#9cdc9c"],["#bd1700","#e8b0a8"],["#7b22aa","#c59eda"],["#787878","#c4c4c4"],["#b30051","#de8fb3"],["#5c8d87","#a6bab7"],["#88880E","#BFBF4D"],["#A32929","#D96666"],["#7A367A","#B373B3"],["#29527A","#668CB3"],["#28754E","#65AD89"],["#BE6D00","#F2A640"],["#865A5A","#BE9494"],["#4E5D6C","#8997A5"],["#8D6F47","#C4A883"],["#AB8B00","#E0C240"]],zcal.eventcolor=["#d581d6","#d6819f","#d68d8d","#e59881","#d6d678","#95d681","#81d6a1","#81d6ce","#81bad6","#92b2d6"],zcal.DFORMAT=["MM/dd/yyyy","dd/MM/yyyy","yyyy/MM/dd","yyyy-MM-dd"],zcal.timeformat=["hh:mm a","HH:mm"],zcal.msec_hour=36e5,zcal.msec_minute=6e4,zcal.hrgrid_lsec_width=81,zcal.ttipformat="MMM dd",zcal.qevent_format="E, NNN dd",zcal.QEDITFMT="MMM dd, yyyy",zcal.CALMODE=0,zcal.isTaskUser=!1,zcal.isCRMUser=!1,zcal.isWindowResized=!1,zcal.reconstructView=!1,zcal.settingsUpdated=!1,zcal.alldayScrollTop=0,zcal.hrgridSrollTop=0,zcal.isSubToCalUpd=!1,zcal.workDays=[],zcal.refreshTimer=null,zcal.refreshMode,zcal.appChild={},zcal.appCount={},zcal.groupChild={},zcal.groupCount={},zcal.localTime=(new Date).getTime();var ZCL_CALNAME="";zcal.time=["12:00 am","12:30 am","1:00 am","1:30 am","2:00 am","2:30 am","3:00 am","3:30 am","4:00 am","4:30 am","5:00 am","5:30 am","6:00 am","6:30 am","7:00 am","7:30 am","8:00 am","8:30 am","9:00 am","9:30 am","10:00 am","10:30 am","11:00 am","11:30 am","12:00 pm","12:30 pm","1:00 pm","1:30 pm","2:00 pm","2:30 pm","3:00 pm","3:30 pm","4:00 pm","4:30 pm","5:00 pm","5:30 pm","6:00 pm","6:30 pm","7:00 pm","7:30 pm","8:00 pm","8:30 pm","9:00 pm","9:30 pm","10:00 pm","10:30 pm","11:00 pm","11:30 pm"],zcal.REM=["300000","600000","900000","1200000","1500000","1800000","2700000","3600000","7200000","14400000","21600000","28800000","43200000","86400000","172800000","259200000","345600000","432000000","518400000","604800000","691200000","777600000","864000000","950400000","1036800000","1123200000","1209600000","1296000000","2592000000","3888000000","5184000000","7776000000"],zcal.ZCL_STREAMGROUPLIST=[];var zcalInit=function(){var a={},b={list:[{groupId:"action",actionArr:[{iconList:["msi-action","msi-barrow"],dropAction:!0,data:"act"}]},{groupId:"view",actionArr:[{iconList:["Day"],text:!0,tooltip:"Day",data:"day"},{iconList:["Week"],text:!0,tooltip:"Week",data:"week"},{iconList:["Work"],text:!0,tooltip:"Work",data:"work"},{iconList:["Month"],text:!0,tooltip:"Month",data:"month"},{iconList:["Agenda"],text:!0,tooltip:"Agenda",data:"agenda"}]},{groupId:"sadd",actionArr:[{iconList:["Smart Add"],text:!0,align:"right",data:"sadd"}]}]},c=function(){var b,c,d,e,f=["DIV",{attrs:{id:"zcl_header","class":"zcl zcl_tpnvcn"},child:[["DIV",{attrs:{"class":"zcl_table"},child:[["UL",{child:[["LI",{child:[["DIV",{attrs:{id:"zcl_sadd"},child:[["B",{child:[["I",{attrs:{"class":"msi-add"}}]]}]]}]]}],["LI",{attrs:{id:"zcl_headerlbl"}}],["LI",{attrs:{"class":"zcl_txr zcl_tpnv",id:"zcl_view"}}],["LI",{attrs:{"class":"zcl_tppnt"},child:[["DIV",{attrs:{id:"zcl_print","class":"SCmb"}}]]}]]}]]}]]}];b=_zm.getDOM(f),c=b.querySelector("#zcl_sadd"),c.addEventListener("click",function(){ZCL_openSAdd(this)}),d=b.children[0].children[0].children[2];for(var g in a.view){var h=a.view[g],i=$("<div "+(g==zcal.view?"class='zcl_sl'":"")+">"+h.text+"</div>");i.attr("data-vid",g),zmComponent.tooltip({elm:i[0],text:h.tooltip,arrow:"top"}),i.off("click").click(function(){var a=$(this);a.parent().find("DIV").removeClass("zcl_sl"),a.addClass("zcl_sl"),zcalView.change(a.attr("data-vid"))}),d.appendChild(i[0])}return e=b.querySelector("#zcl_print"),e.innerHTML='<b><div class="SC_hd"></div><i class="msi-print"/></b>',zmComponent.tooltip({elm:e,text:zcal.i18n.print,arrow:"top"}),e.addEventListener("click",function(){var a=$(this);a.find("b").addClass("SC_ddn"),zmsuite.showMenu({par:a,list:m(),align:"pright",clk:function(a,b){zcalList.bindAction(a,b)}})}),b},d=function(a){a.off("click").click(function(){a.parent().find("DIV").removeClass("zcl_sl"),a.addClass("zcl_sl"),zcalView.change(a.attr("data-vid"))})},e=function(a,b){var c=$("#zcl_headerlbl");c.addClass("SC_lbr");if(zcal.view==4)c.html('<div class="SC_hd"></div><div><div class="zcl_tpdtmth">'+a+"</div></div>");else{c.empty();var d=$('<div class="zcl_tprr">'),e=$("<div>"),f=$('<div class="zcl_tplr">'),g;g=$("<span/>"),b!=4&&g.text(zcal.i18n.today),c.append('<div class="SC_hd"></div>');var h=zcalView.isTodayInViewRange(b);h?c.append($('<div class="zcl_tody zcl_grey"/>').append(g)):(g.off("click").click(function(){zcalView.goToday()}),c.append($('<div class="zcl_tody zcl_tpdyyr"/>').append(g))),f.html('<i class="msi-larrow"></i>'),f.off("click").click(function(a){zcalView.goPrev()}),c.append(f),d.html('<i class="msi-rarrow"></i>'),d.off("click").click(function(a){zcalView.goNext()}),c.append(d),e.append('<div class="zcl_tpdtmth">'+a+"</div>"),c.append(e)}},f=function(a,b){var c={};if(b)for(var d=0;d<b.length;d++){var e=b[d];a[e][8]=="1"?(c[e]={ID:e,CN:a[e][0]==""?"UNTITLED":a[e][0],CC:ZCL_getCalColor(a[e][1])[1],STS:a[e][2]},a[e][2]==0?zcal.disabledcal+=e+",":ZCL_CALNAME+=(ZCL_CALNAME==""?"":",")+a[e][0]):zcal.disabledcal+=e+","}else for(var d in a)a[d][8]=="1"?(c[d]={ID:d,CN:a[d][0]==""?"UNTITLED":a[d][0],CC:ZCL_getCalColor(a[d][1])[1],STS:a[d][2]},a[d][14]=="crm"&&(c[d].HC=1,c[d].E=1),a[d][2]==0?zcal.disabledcal+=d+",":ZCL_CALNAME+=(ZCL_CALNAME==""?"":",")+a[d][0]):zcal.disabledcal+=d+",";return c},g=function(a){return a.sort(function(a,b){var c=a.value.toUpperCase(),d=b.value.toUpperCase();return c<d?-1:c>d?1:0}),a},h=function(){var a={},b="",c=[],d={},e=zcal.cdata.calByGrp;for(var f in zcal.cdata.grpLst)for(var h in zcal.cdata.grpLst[f])d={id:h,value:zcal.cdata.grpLst[f][h].GNAME},c.push(d);var i=g(c);zcal.cdata.gcalbyOdrArr=[];for(var h in i)zcal.cdata.gcalbyOdrArr.push(i[h].id);zcal.groupChild={},zcal.groupCount={};for(var f in zcal.cdata.gcalbyOdrArr){var j=zcal.cdata.gcalbyOdrArr[f],k=zcal.cdata.grpLst.pgrp[j]||zcal.cdata.grpLst.ogrp[j];if(!k)continue;if(!e[j])continue;var l=Object.keys(e[j]).length;if(l==0)continue;var b="";if(k.ISADMIN||l>1){zcal.groupCount[j]={c:"0",p:"-1"},a[j]={ID:j,CN:k.GNAME,CC:zcal.calcolor[0][1],STS:"1",HC:"1",E:"1"};var m={},n=[];seCount=0;for(var f in e[j])d={id:f,value:e[j][f][0]},n.push(d);var o=g(n),p=[];for(var h in o)p.push(o[h].id);for(var f in p){var q=p[f];zcal.groupCount[q]={c:"0",p:j};var r=zcal.cdata.calGLst[q];seCount+=1,r[8]=="1"?(m[q]={CN:r[0],CC:ZCL_getCalColor(r[1])[1],ID:f,STS:r[2],HC:0,SE:seCount},r[2]==0?zcal.disabledcal+=q+",":ZCL_CALNAME+=(ZCL_CALNAME==""?"":",")+r[0]):zcal.disabledcal+=q+","}zcal.groupCount["addCal_"+k.GID]={c:"0",p:j},m["addCal_"+k.GID]={CN:"Add Calendar",addNewType:!0,ID:"addCal_"+k.GID,STS:"1",CC:"0",HC:0,SE:seCount+1},zcal.groupChild[j]={CH:m}}else for(var f in e[j]){zcal.groupCount[f]={c:"0",p:"-1"};var r=zcal.cdata.calGLst[f];r[8]=="1"?(a[f]={ID:f,CN:r[0],CC:ZCL_getCalColor(r[1])[1],STS:r[2]},r[2]==0?zcal.disabledcal+=f+",":ZCL_CALNAME+=(ZCL_CALNAME==""?"":",")+r[0]):zcal.disabledcal+=f+","}}return a},i=function(a){var b=new Date,c=new Date,d=zcal.cdata.opt.WK,e,f,g;return b.setTime(a),c.setTime(a),b.setMonth(b.getMonth()),b.setDate(1),e=b.getDay(),b.setDate(1-b.getDay()),d>e?b.setDate(b.getDate()-(7-d)):b.setDate(b.getDate()+d),g=c.getDaysInMonth(),c.setDate(g),f=c.getDay(),c.setDate(c.getDate()+6-c.getDay()),d>f?c.setDate(c.getDate()-(7-d)):c.setDate(c.getDate()+d),[b,c]},j=function(a){var b=new Date;return b.setTime(a),b.setDate(15),b>=zcal.mlimit[0]&&b<=zcal.mlimit[1]?!0:!1},k=function(){var a=document.createElement("div");a.style.overflow="scroll",a.style.width="100%";var b=document.createElement("div");b.style.overflow="hidden",b.style.width="100%",a.appendChild(b);if(document.documentElement.clientHeight){document.documentElement.appendChild(a);var c=a.offsetWidth-b.offsetWidth;return document.documentElement.removeChild(a),c}document.body.appendChild(a);var c=a.offsetWidth-b.offsetWidth;return document.body.removeChild(a),c},l=function(){var a=[{htm:"Create Calendar",data:{action:"create-cal"}},{htm:"Import",data:{action:"import"}},{htm:"Subscribe",data:{action:"subscribe"}},{htm:"Settings",data:{action:"settings"}}];return a},m=function(){var a=[{htm:zcal.i18n.print,data:{action:"print"}},{htm:zcal.i18n.printpreview,data:{action:"printPreview"}},{htm:zcal.i18n.savepdf,data:{action:"savePdf"}}];return a},n=function(){var a=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");for(var b=0;b<a.length;b++){var c=a[b].split("=");if(c[0]==="url")return c[1]}return},o=function(a){var b=this;a=a||{};if(!a.length)return;var c=a[0];if(c.indexOf("subscribe?")!==-1){var d=n();d&&$.when(zcalSettings.Subscribe.confirmAndSubscribe(d)).done(function(){b.update([])})}},p={prevHeader:{id:"zcalPrevHeader",text:"Preview Text",rIcons:[[{tooltip:"Close",tooltipDir:"right",iconClass:"msi-close",data:{action:"closePrev"}}]]},init:function(){var a=null;typeof zmsuite.createAppRouter=="function"&&(a=zmsuite.createAppRouter());var b={appname:"calendar",appId:"zcal_Container",appIcon:"msi-calendar",customHeader:!0,data:{LNodes:"2",CNodes:"3"},handler:{create:function(){zcalUtil.createEvent()},settings:function(){}},router:a};a!==null&&a.initialize({hashKey:"calendar",handler:o}),zmsuite.setAppInfo(b)},initCalData:function(){zcal.mcal=f(zcal.cdata.calLst,zcal.cdata.calOrdArr),ZCL_updateGroupCalList(),ZCL_updateAppCalList(),zcal.acal=f(zcal.cdata.calALst),zcal.ocal=f(zcal.cdata.calOLst)},bindLeftActions:function(a){var b,c,d,e,f,g;a=a.zmsData,d=a.type,e=a.eventInfo,c=e.srcElement||e.target,f=a.rowInfo.layerId,b=a.rowInfo.type;if(d=="contextmenu")zcalList.calUtility(e,c,f,a.rowObject);else if(d=="click"&&b=="list"&&e.currentTarget.id.indexOf("addCal")==-1)zcalList.chgeCalStatus(e,a.rowObject);else if(e.currentTarget.id.indexOf("addCal")!=-1){var h=e.currentTarget.id.split("_")[1];ZCL_createCal(h)}},bindActionHeaderIcons:function(a,b,c){var d=a.srcElement||a.target;switch(c){case"day":zcal.view=0,zcalView.constGridView();break;case"week":case"work":zcal.view=c=="work"?2:1,zcalView.constGridView();break;case"month":zcal.view=3,zcalView.constGridView();break;case"agenda":zcal.view=4,zcalView.constGridView();break;case"sadd":ZCL_openSAdd(d);break;case"act":var e=$(d).closest("li"),f=l();f&&(e.find("b").addClass("SC_ddn"),zmsuite.showMenu({par:e,list:f,align:"pleft",clk:function(a,b){zcalList.bindAction(a,b)}}));break;case"edit":break;case"save":ZCL_svEve();break;case"delete":}},constructLeft:function(){var a,b=[];a=zcal.calLeft.getNodes();var c={id:"ID",name:"CN",color:"CC",check:"STS",count:"c",hasChild:"HC",expChild:"E",seq:"SE"},d=new ZMLayer,e;e={type:"5",listId:"zcl_mcalL",hasChild:!0,mapObject:c,id:"zcl_mcal",dataObject:{headerObject:{licon:"msi-folder",id:"zcl_mcalH",name:zcal.i18n.mycal,showList:!0,c:"<i class='msi-plus'></i>",onAdd:function(a){ZCL_createCal()}},listObject:zcal.mcal}},d.push(e),b.push(d);if(!$.isEmptyObject(zcal.acal)){var f=new ZMLayer,g;g={type:"5",listId:"zcl_acalL",hasChild:!0,mapObject:c,id:"zcl_acal",dataObject:{headerObject:{licon:"msi-folder",id:"zcl_acalH",name:zcal.i18n.appcal,showList:!0},listObject:zcal.acal}},Object.keys(zcal.appChild).length>0&&(g.type="6",g.hasCountObject=!0,g.dataObject.childObject=zcal.appChild,g.dataObject.countObject=zcal.appCount),f.push(g),b.push(f)}var h=new ZMLayer,i;i={type:"5",listId:"zcl_gcalL",hasChild:!0,mapObject:c,id:"zcl_gcal",dataObject:{headerObject:{licon:"msi-folder",id:"zcl_gcalH",name:zcal.i18n.grpcal,showList:!0},listObject:zcal.gcal}},Object.keys(zcal.groupChild).length>0&&(i.type="6",i.hasCountObject=!0,i.dataObject.childObject=zcal.groupChild,i.dataObject.countObject=zcal.groupCount),h.push(i),b.push(h);if(!$.isEmptyObject(zcal.ocal)){var j=new ZMLayer,k;k={type:"5",listId:"zcl_ocalL",hasChild:!0,mapObject:c,id:"zcl_ocal",dataObject:{headerObject:{licon:"msi-folder",id:"zcl_ocalH",name:zcal.i18n.othcal,showList:!0},listObject:zcal.ocal}},j.push(k),b.push(j)}a[0].push({layerArr:b}),zcal.calLeft.render(),zcal.calLeft.setListener("click",function(a){zcalInit.bindLeftActions(a)}),zcal.calLeft.setListener("contextmenu",function(a){zcalInit.bindLeftActions(a)}),$.isEmptyObject(zcal.acal)||a[0].getLayer("zcl_acal").setChildToggle(function(){window.console.log("ZM_LHS",">>>","Child Toggle Called")}),$.isEmptyObject(zcal.gcal)||a[0].getLayer("zcl_gcal").setChildToggle(function(){window.console.log("ZM_LHS",">>>","Child Toggle Called")})},constructCenter:function(){var a=zmsuite.getCenter(),d=a[0].getNodes();d[0].push(b.list),d[0].setListener("click",function(a,b,c){zcalInit.bindActionHeaderIcons(a,b,c)});var e=c();zmsuite.getCenter()[0].$el.prepend(e),zmsuite.renderCenter(),zmsuite.showApp("zcal_Container");var f=document.getElementsByClassName("zm_togglerpane");f.length>0&&(f[0].onclick=function(){setTimeout(function(){zcalView.constGridView()},300)})},constructView:function(){zcal.calLeft=zmsuite.getLeft(),zcal.calRight=zmsuite.getRight(),zcalInit.constructLeft(),zcalInit.constructCenter(),zcal.calCenter=zmsuite.getCenter(),zcal.calCenter.listElem=zcal.calCenter[0].getNodes()[2].$el[0],zcal.calCenter.headerElem=zcal.calCenter[0].getNodes()[0].$el[0],zcal.calRight=zmsuite.getRight().$el},initCal:function(){zcalInit.initCalData(),zcalInit.init(),zcalInit.constructView(),zcalInit.initCalView()},initCalView:function(){zcalView.constGridView(),zcalEvents.loadMonthData(),ZCL_CheckUserInOtherServices(),zcal.CALMODE==0&&ZCL_getSubGrpLst()},initGlobalVar:function(){zcal.zuid=zcal.cdata.opt.ZUID,zcal.zoid=zcal.cdata.opt.ZOID,a={view:[{text:zcal.i18n.vday,tooltip:zcal.i18n.vday,data:0},{text:zcal.i18n.week,tooltip:zcal.i18n.week,data:1},{text:zcal.i18n.work,tooltip:zcal.i18n.work,data:2},{text:zcal.i18n.month,tooltip:zcal.i18n.month,data:3},{text:zcal.i18n.agenda,tooltip:zcal.i18n.agenda,data:4}]},zcal.view=zcal.cdata.opt.DEF,zcal.cdate=Number(zcal.cdata.opt.DATE),setInterval(function(){var a=(new Date).getTime();zcal.localTime<a&&(zcal.cdate+=a-zcal.localTime,zcal.localTime=a);var b=new Date(zcal.cdate);b.dateBy("yyyyMMdd")!=zcal.chkDate.dateBy("yyyyMMdd")&&(zcal.chkDate=new Date(zcal.cdate),zcalView.constGridView())},1e3),zcal.today=new Date,zcal.today.setTime(zcal.cdate),zcal.chkDate=new Date(zcal.cdate),zcal.mlimit=zcalInit.getMonthLimit(zcal.cdata.opt.DATE),Date.MONTH_NAMES=[[zcal.i18n.january,zcal.i18n.february,zcal.i18n.march,zcal.i18n.april,zcal.i18n.may,zcal.i18n.june,zcal.i18n.july,zcal.i18n.august,zcal.i18n.september,zcal.i18n.october,zcal.i18n.november,zcal.i18n.december],[zcal.i18n.jan,zcal.i18n.feb,zcal.i18n.mar,zcal.i18n.apr,zcal.i18n.may,zcal.i18n.jun,zcal.i18n.jul,zcal.i18n.aug,zcal.i18n.sep,zcal.i18n.oct,zcal.i18n.nov,zcal.i18n.dec]],Date.WEEK_DAYS=[[zcal.i18n.sunday,zcal.i18n.monday,zcal.i18n.tuesday,zcal.i18n.wednesday,zcal.i18n.thursday,zcal.i18n.friday,zcal.i18n.saturday],[zcal.i18n.sun,zcal.i18n.mon,zcal.i18n.tue,zcal.i18n.wed,zcal.i18n.thu,zcal.i18n.fri,zcal.i18n.sat]],zcal.REPEAT_FREQ=[zcal.i18n.daily,zcal.i18n.weekly,zcal.i18n.monthly,zcal.i18n.yearly],zcal.WEEK_TYPE=[zcal.i18n.first,zcal.i18n.second,zcal.i18n.third,zcal.i18n.fourth,zcal.i18n.last],zcal.ALARM_REMTYPE={0:zcal.i18n.before,1:zcal.i18n.after},zcal.ALARM_ACTTYPE={0:zcal.i18n.byemail,1:zcal.i18n.bypopup},zcal.DATEFORMAT=[zcal.i18n.dform1,zcal.i18n.dform2,zcal.i18n.dform3,zcal.i18n.dform4],zcal.TIMEFORMAT=["1:00 "+zcal.i18n.pm,"13:00"],zcal.HOURS=["12:00 "+zcal.i18n.am,"1:00 "+zcal.i18n.am,"2:00 "+zcal.i18n.am,"3:00 "+zcal.i18n.am,"4:00 "+zcal.i18n.am,"5:00 "+zcal.i18n.am,"6:00 "+zcal.i18n.am,"7:00 "+zcal.i18n.am,"8:00 "+zcal.i18n.am,"9:00 "+zcal.i18n.am,"10:00 "+zcal.i18n.am,"11:00 "+zcal.i18n.am,"12:00 "+zcal.i18n.pm,"1:00 "+zcal.i18n.pm,"2:00 "+zcal.i18n.pm,"3:00 "+zcal.i18n.pm,"4:00 "+zcal.i18n.pm,"5:00 "+zcal.i18n.pm,"6:00 "+zcal.i18n.pm,"7:00 "+zcal.i18n.pm,"8:00 "+zcal.i18n.pm,"9:00 "+zcal.i18n.pm,"10:00 "+zcal.i18n.pm,"11:00 "+zcal.i18n.pm],zcal.DEFAULTVIEW=[zcal.i18n.vday,zcal.i18n.week,zcal.i18n.work,zcal.i18n.month,zcal.i18n.agenda],zcal.REMSTR={3e5:"5 "+zcal.i18n.mins,6e5:"10 "+zcal.i18n.mins,9e5:"15 "+zcal.i18n.mins,12e5:"20 "+zcal.i18n.mins,15e5:"25 "+zcal.i18n.mins,18e5:"30 "+zcal.i18n.mins,27e5:"45 "+zcal.i18n.mins,36e5:"1 "+zcal.i18n.hr,72e5:"2 "+zcal.i18n.hrs,144e5:"4 "+zcal.i18n.hrs,216e5:"6 "+zcal.i18n.hrs,288e5:"8 "+zcal.i18n.hrs,432e5:"12 "+zcal.i18n.hrs,864e5:"1 "+zcal.i18n.day,1728e5:"2 "+zcal.i18n.days,2592e5:"3 "+zcal.i18n.days,3456e5:"4 "+zcal.i18n.days,432e6:"5 "+zcal.i18n.days,5184e5:"6 "+zcal.i18n.days,6048e5:"7 "+zcal.i18n.days,6912e5:"8 "+zcal.i18n.days,7776e5:"9 "+zcal.i18n.days,864e6:"10 "+zcal.i18n.days,9504e5:"11 "+zcal.i18n.days,10368e5:"12 "+zcal.i18n.days,11232e5:"13 "+zcal.i18n.days,12096e5:"14 "+zcal.i18n.days,1296e6:"15 "+zcal.i18n.days,2592e6:"30 "+zcal.i18n.days,3888e6:"45 "+zcal.i18n.days,5184e6:"60 "+zcal.i18n.days,7776e6:"90 "+zcal.i18n.days},zcal.AGENDA_INTERVAL={"-1":zcal.i18n.none,0:zcal.i18n.daily,1:zcal.i18n.weekly},zcal.FREEBUSY_DD=[zcal.i18n.alltimes,zcal.i18n.workinghours],zcal.emlNfy=zcal.cdata.orgAdmOpt.MOD_NOTIFY_EMAIL!=undefined?zcal.cdata.orgAdmOpt.MOD_NOTIFY_EMAIL:"-1",zcal.sendInv=zcal.cdata.orgAdmOpt.SEND_INVITATION!=undefined?zcal.cdata.orgAdmOpt.SEND_INVITATION:"-1",zcal.subCal=zcal.cdata.orgAdmOpt.CAL_SUBSCRIBE!=undefined?zcal.cdata.orgAdmOpt.CAL_SUBSCRIBE:"-1",zcal.shrCal=zcal.cdata.orgAdmOpt.CAL_SHARE!=undefined?zcal.cdata.orgAdmOpt.CAL_SHARE:"-1",zcal.impExp=zcal.cdata.orgAdmOpt.IMPORT_EXPORT!=undefined?zcal.cdata.orgAdmOpt.IMPORT_EXPORT:"-1",zcal.holCal=zcal.cdata.orgAdmOpt.CAL_HOLIDAY!=undefined?zcal.cdata.orgAdmOpt.CAL_HOLIDAY:"-1",zcal.pvtUrl=zcal.cdata.orgAdmOpt.PRIVATE_URL!=undefined?zcal.cdata.orgAdmOpt.PRIVATE_URL:"-1",zcal.workDays=ZCL_setWorkDays(),zcalGroup.loadGroup(),zcalCRM.loadCRMUsers()},updateHeaderBand:e,formatCalData:f,ZCL_setGrpCal:h,getMonthLimit:i,checkDate:j,scrollWidth:k};return p}();zcal.dataLoaded=zcal.sentReq=!1,loadZCal=function(a,b){a=a?a:"calapp",zcal.dataLoaded?ZCL_openApp(a,b):zcal.sentReq||(ZCL_uXHR("/ncal/index.do?mode="+a,function(c){zcal.retLoad(c),ZCL_openApp(a,b)}),zcal.sentReq=!0)},ZCL_openApp=function(a,b){zcal.isSubToCalUpd||ZCL_subscribeToCalUpdate();if(a==="event")zcalUtil.createEvent(b);else if(a==="settings")b&&b.resolve({settings:zcalSettings.getCalConfig()});else if(zmsuite.isWorkspaceAvailable("zcal_Container")){var c=zmsuite.getAppObj("zcal_Container");zmTab.setTabForApp(c.obj),zmsuite.showApp("zcal_Container"),zcal.calLeft.setListener("click",function(a){zcalInit.bindLeftActions(a)}),zcal.calLeft.setListener("contextmenu",function(a){zcalInit.bindLeftActions(a)})}else zmApp.selectedApp==="c"&&zcalInit.initCal()},zcal.retLoad=function(a){var b=JSON.parse(a.responseText);b&&(zcal.dataLoaded=!0,zcal.cdata=b.cdata,zcal.i18n=b.i18n,zcal.isAttach=b.ISATTACH,zcal.ZCRM=b.ZCRM,zcal.ZMET=b.ZMET,zcal.ZTSK=b.ZTSK,zcal.ZNTS=b.ZNTS,zcal.ZMIL=b.ZMIL,zcal.ZCAL=b.ZCAL,zcal.ZRECRUIT=b.ZRECRUIT,zcal.ZCAL_MULTICAL_4_GRP=b.ZCAL_MULTICAL_4_GRP,zcal.cssPath=b.CSSPATH,zcal.OUTLOOK32=b.OUTLOOK32,zcal.OUTLOOK64=b.OUTLOOK64,zcal.GCALSYNC=b.GCALSYNC,zcal.ZOHOSTATIC=b.ZOHOSTATIC,zcal.jsPath=b.JSPATH,zcalInit.initGlobalVar(),ZCL_setGrpOdr())},zcal.win.onresize=function(){zcal.isWindowResized=!0,zmApp.currentApp=="c"&&ZCL_resizeCalendar()},$.subscribe("/calendar/load",function(){loadZCal("calapp")}),$.subscribe("/calendar/event",function(a,b){loadZCal("event",b)}),$.subscribe("/calendar/settings",function(a,b){loadZCal("settings",b)}),ZCL_resizeCalendar=function(){zmTab.currentTab=="zcal_Container"&&zcal.view!=4&&zcalView.constGridView()},$.subscribe("/apps/tabSwitched",function(a,b,c){b=="zcal_Container"&&(zcal.isWindowResized&&zcal.view!=4||zcal.reconstructView||zcal.settingsUpdated)&&(zcal.isWindowResized=!1,zcal.reconstructView=!1,zcalView.constGridView(),zcal.settingsUpdated&&zcalInit.constructLeft(),zcal.settingsUpdated=!1)}),$.subscribe("/user/languageChanged",function(){ZCL_handleLanguageChange()}),Date.LZ=function(a){return(a<0||a>9?"":"0")+a},Date.prototype.getDaysInMonth=function(){var a=new Date(this.getFullYear(),this.getMonth(),1);return(new Date(a.getFullYear(),a.getMonth()+1,0)).getDate()},Date.prototype.clone=function(){var a=new Date;return a.setTime(this.getTime()),a},Date.prototype.getWeek=function(){var a=new Date(this.getFullYear(),0,1,0,0,0,0),b,c;b=a.getDay(),a.setDate(a.getDate()-a.getDay());var d=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0,0);return d.setDate(d.getDate()-d.getDay()),b<=4?c=Math.ceil((d-a)/864e5/7)+1:c=Math.ceil((d-a)/864e5/7),d.getMonth()==11&&(d.setDate(d.getDate()+6),c=d.getMonth()==0&&d.getDate()>2?1:c),c},Date.prototype.dateBy=function(a){a+="";var b="",c=0,d="",e="",f=this.getYear()+"",g=this.getMonth()+1,h=this.getDate(),i=this.getDay(),j=this.getHours(),k=this.getMinutes(),l=this.getSeconds(),m,n,o,p,q,r,s,t,u,v,w,j,x,y,z,A,B={};f.length<4&&(f=""+(+f+1900)),B.y=""+f,B.yyyy=f,B.yy=f.substring(2,4),B.M=g,B.MM=Date.LZ(g),B.MMM=Date.MONTH_NAMES[0][g-1],B.NNN=Date.MONTH_NAMES[1][g-1],B.d=h,B.dd=Date.LZ(h),B.E=Date.WEEK_DAYS[1][i],B.EE=Date.WEEK_DAYS[0][i],B.H=j,B.HH=Date.LZ(j),j==0?B.h=12:j>12?B.h=j-12:B.h=j,B.hh=Date.LZ(B.h),B.K=B.h-1,B.k=B.H+1,B.KK=Date.LZ(B.K),B.kk=Date.LZ(B.k),j>11?B.a="pm":B.a="am",B.m=k,B.mm=Date.LZ(k),B.s=l,B.ss=Date.LZ(l);while(c<a.length){d=a.charAt(c),e="";while(a.charAt(c)==d&&c<a.length)e+=a.charAt(c++);B[e]!=null?b+=B[e]:b+=e}return b};var zcalList=function(){var a={bindAction:function(a,b){if(!a)return;var c=a.action,d,e;switch(c){case"edit":zmUtil.hideMenu(),ZCL_editCal(a.id);break;case"share":zmUtil.hideMenu(),typeof zmail._newSettings=="undefined"?zmAppLoader.load("zm-settings-mailsuite-appcore").done(function(){zmail.Settings.MailSuite.App.openApp().done(function(){var b=zmail.Settings.MailSuite.App.Core.Framework;b.requestShowPage("calendar-mgaocalendars").done(function(){var c=zmail.Settings.MailSuite.Apps.CalendarMGAOCalendars.MGAOCalendarsView;b.requestPreviewCard({getView:function(){var b=zcal.cdata.calLst[a.id]||zcal.cdata.calGLst[a.id]||zcal.cdata.calOLst[a.id];return c.openShare(a.id,b)}}).done(function(a){a.card.show()})}).fail(function(){})})}):zmAppLoader.load("settings").then(function(){zmailSettings.init("calendar","zcalSettings."+a.type+"CalList",a)});break;case"embed":zmUtil.hideMenu(),typeof zmail._newSettings=="undefined"?zmAppLoader.load("zm-settings-mailsuite-appcore").done(function(){zmail.Settings.MailSuite.App.openApp().done(function(){var b=zmail.Settings.MailSuite.App.Core.Framework;b.requestShowPage("calendar-mgaocalendars").done(function(){var c=zmail.Settings.MailSuite.Apps.CalendarMGAOCalendars.MGAOCalendarsView;b.requestPreviewCard({getView:function(){var b=zcal.cdata.calLst[a.id]||zcal.cdata.calGLst[a.id]||zcal.cdata.calOLst[a.id];return c.openEmbed(a.id,b)}}).done(function(a){a.card.show()})}).fail(function(){})})}):zmAppLoader.load("settings").then(function(){ZCL_openEmbed(a.id)});break;case"empty":ZCL_empCal(a.id),zmUtil.hideMenu();break;case"delete":case"unsubscribe":var f=c==="unsubscribe"?!0:!1;ZCL_delCal(a.id,f),zmUtil.hideMenu();break;case"closePrev":ZCL_eClose();break;case"create-cal":zcal.createCal();break;case"import":break;case"subscribe":break;case"settings":break;case"eventSave":ZCL_svEve();break;case"crmEventSave":zcalCRM.saveEvent();break;case"taskSave":zcalTask.saveTask();break;case"eventDelete":ZCL_delEve();break;case"eventEdit":ZCL_Dedit();break;case"eventClose":zcalCRM.reset(),ZCL_eClose();break;case"eventSend":ZCL_send(zcal.EOBJ);break;case"startChat":ZCL_chatLet(event,zcal.EOBJ);break;case"setEventAlarm":ZCL_setEventAlarm();break;case"print":zmUtil.hideMenu(),ZCL_print();break;case"printPreview":zmUtil.hideMenu(),ZCL_prntPreview(!1);break;case"savePdf":zmUtil.hideMenu(),ZCL_svPdf();break;case"eventStreamView":zcal.constEventViewCard()}},calUtility:function(a,b,c,d){var e;ZCL_stopEvents(a);for(var f in d)e=f;zcalList.leftUtility(a,b,c,e)},leftUtility:function(a,b,c,d){var e=b.id,f,g=zcal.getCalObj(d);if(g){var h=[];h.push({htm:zcal.i18n.edit,id:"zcalMenu_Edit",cEdit:!1,data:{action:"edit",id:d}}),g[13][0]!=0&&(h.push({sep:!0}),h.push({htm:zcal.i18n.share,id:"zcalMenu_Share",cEdit:!1,data:{action:"share",id:d}})),g[13][0]!=0&&(h.push({sep:!0}),h.push({htm:zcal.i18n.embed,id:"zcalMenu_Embed",cEdit:!1,data:{action:"embed",id:d}})),g[13][3]==1&&(h.push({sep:!0}),h.push({htm:zcal.i18n.empty,id:"zcalMenu_Empty",cEdit:!1,data:{action:"empty",id:d}})),g[13][4]==1&&(h.push({sep:!0}),h.push({htm:zcal.i18n.del,id:"zcalMenu_Del",cEdit:!1,data:{action:"delete",id:d}})),g[13][5]==1&&(h.push({sep:!0}),h.push({htm:zcal.i18n.unsubscribe,id:"zcalMenu_UnSub",cEdit:!1,data:{action:"unsubscribe",id:d}})),f={clk:function(a,b){zcalList.bindAction(b)},conArr:h},zmsuite.showContextMenu(a,f),ZCL_stopEvents(a)}},chgeCalStatus:function(a,b){var c,d,e;ZCL_stopEvents(a);for(var f in b)c=f;c&&ZCL_ChgCalSts(c)}};return a}(),zcalView=function(){var a=function(){return zcal.calCenter=zcal.calCenter||zmsuite.getCenter(),zcal.calCenter.listElem=zcal.calCenter[0].getNodes()[2].$el[0],zcal.calCenter.headerElem=zcal.calCenter[0].getNodes()[0].$el[0],zcal.calCenter},b=function(){var b=$(a().listElem),c;return c=b.height()-33-1,c},c=function(){var b=$(a().listElem);return b.width()-81-zcalInit.scrollWidth()},d=function(){var a=$("#zcl_encloser");return a.children(":first").height()>a.innerHeight()},e=function(){var a=$("#zcl_aContainer");return a.children(":first").height()>a.innerHeight()},f=function(){zcal.today.setTime(zcal.cdate),zcalInit.checkDate(zcal.today.getTime())?zcalView.constGridView():(zcal.mlimit=zcalInit.getMonthLimit(zcal.today.getTime()),zcalEvents.loadMonthData(!0))},g=function(){zcal.view==0?zcal.today.setDate(zcal.today.getDate()+1):zcal.view==1||zcal.view==2?zcal.today.setDate(zcal.today.getDate()+7):zcal.view==3&&(zcal.today.setDate(1),zcal.today.setMonth(zcal.today.getMonth()+1)),zcalInit.checkDate(zcal.today.getTime())?zcalView.constGridView():(zcal.mlimit=zcalInit.getMonthLimit(zcal.today.getTime()),zcalEvents.loadMonthData(!0))},h=function(){zcal.view==0?zcal.today.setDate(zcal.today.getDate()-1):zcal.view==1||zcal.view==2?zcal.today.setDate(zcal.today.getDate()-7):zcal.view==3&&(zcal.today.setDate(1),zcal.today.setMonth(zcal.today.getMonth()-1)),zcalInit.checkDate(zcal.today.getTime())?zcalView.constGridView():(zcal.mlimit=zcalInit.getMonthLimit(zcal.today.getTime()),zcalEvents.loadMonthData(!0))},i=function(a,b,c,d){zcal.view=a;var e=new Date(b,c,d);zcal.today=e.clone();if($("#zcl_view")){var f=$("#zcl_view");f.find("DIV").removeClass("zcl_sl"),f.find("DIV:first").addClass("zcl_sl")}zcalInit.checkDate(zcal.today.getTime())?zcalView.constGridView():(zcal.mlimit=zcalInit.getMonthLimit(zcal.today.getTime()),zcalEvents.loadMonthData(!0))},j=function(a,b,c){a.off("mousedown").on("mousedown",{cnt:b,date:c.getDate(),month:c.getMonth(),year:c.getFullYear()},function(a){var b=a.target||event.srcElement;b.tagName=="SPAN"&&b.parentNode.id=="zcl_lft"+a.data.cnt?zcalView.setView(0,a.data.year,a.data.month,a.data.date):zcalDrag.mstartDiv(a,a.data.cnt)})},k=function(a,b){a.addEventListener("mousedown",function(a){zcalView.setView(0,b.getFullYear(),b.getMonth(),b.getDate())})},l={hourSlot:2,slotDuration:30,gridWidth:0,gridHeight:0,timeoutID:null,change:function(a){zcal.view=a,this.constGridView()},constGridView:function(){if(zmApp.currentApp!="c")return!1;ZCL_clrStck1(),this.gridWidth=c(),this.gridHeight=b(),this.gridWidth<=0?zcal.reconstructView=!0:zcal.view==0?(zcalView.constDayView(),ZCL_$("zcl_encloser").scrollTop=zcal.cdata.opt.HS*51):zcal.view==1||zcal.view==2?(zcalView.constWeekView(),ZCL_$("zcl_encloser").scrollTop=zcal.cdata.opt.HS*51):zcal.view==3?zcalView.constMonthView():zcal.view==4&&zcalView.agendaView()},templates:{day:["DIV",{attrs:{"class":"zcl zcl_dayvw",id:"zcl_workarea"},child:[["UL",{child:[["LI",{child:[["DIV",{attrs:{"class":"zcl_table",id:"zcl_vwheader"}}]]}],["LI",{child:[["DIV",{attrs:{"class":"zcl_rel",id:"zcl_aencloser"},child:[["DIV",{attrs:{"class":"zcl_alldycn zcl_table"},child:[["UL",{attrs:{"class":"zcl_alldyev"},child:[["LI",{attrs:{"class":"zcl_lfsec",id:"zcl_lftsec"}}],["LI",{attrs:{"class":"zcl_scrly"},child:[["DIV",{attrs:{id:"zcl_aContainer","class":"zcl_rel",style:"height:36px"},child:[["DIV",{attrs:{"class":"zcl_adyevecn",id:"zcl_allLay"}}],["DIV",{attrs:{"class":"zcl_table",id:"zcl_allgrid"}}]]}]]}]]}]]}]]}],["DIV",{attrs:{"class":"zcl_scrly zcl_rel",id:"zcl_encloser"},child:[["DIV",{attrs:{"class":"zcl_esub",id:"zcl_eveSub"}}],["DIV",{attrs:{"class":"zcl_wgrdsl",id:"zcl_lay",style:"display:none;height:22px"}}],["UL",{attrs:{"class":"zcl_grid"},child:[["LI",{child:[["DIV",{attrs:{"class":"zcl_table",id:"zcl_hContainer"}}]]}]]}]]}]]}]]}]]}],week:["DIV",{attrs:{"class":"zcl zcl_weekvw",id:"zcl_workarea"},child:[["UL",{child:[["LI",{child:[["DIV",{attrs:{"class":"zcl_table",id:"zcl_vwheader"}}]]}],["LI",{child:[["DIV",{attrs:{"class":"zcl_rel",id:"zcl_aencloser"},child:[["DIV",{attrs:{"class":"zcl_alldycn zcl_table"},child:[["UL",{attrs:{"class":"zcl_alldyev"},child:[["LI",{attrs:{"class":"zcl_lfsec",id:"zcl_lftsec"}}],["LI",{attrs:{"class":"zcl_scrly"},child:[["DIV",{attrs:{id:"zcl_aContainer","class":"zcl_rel",style:"height:36px"},child:[["DIV",{attrs:{"class":"zcl_adyevecn",id:"zcl_allLay"}}],["DIV",{attrs:{"class":"zcl_table",id:"zcl_allgrid"}}]]}]]}]]}]]}]]}],["DIV",{attrs:{"class":"zcl_scrly zcl_rel",id:"zcl_encloser"},child:[["DIV",{attrs:{"class":"zcl_esub",id:"zcl_eveSub"}}],["DIV",{attrs:{"class":"zcl_wgrdsl",id:"zcl_lay",style:"display:none;height:22px"}}],["UL",{attrs:{"class":"zcl_grid"},child:[["LI",{child:[["DIV",{attrs:{"class":"zcl_table",id:"zcl_hContainer"}}]]}]]}]]}]]}]]}]]}],month:["DIV",{attrs:{"class":"zcl zcl_monthvw",id:"zcl_workarea"},child:[["UL",{child:[["LI",{child:[["DIV",{attrs:{"class":"zcl_table",id:"zcl_vwheader"},child:[["UL",{attrs:{"class":"zcl_dylst"}}]]}]]}],["LI",{attrs:{"class":"zcl_grid"},child:[["DIV",{attrs:{id:"zcl_encloser","class":"zcl_table"}}]]}]]}]]}],agenda:[]},constDOM:function(a){return _zm.getDOM(this.templates[a])},getHeaderDOM:function(a,b,c){var d,e,f,g=new Date;g.setTime(zcal.cdate),d=_zm.getDOM(["UL",{attrs:{"class":"zcl_dylst"}}]),e=document.createElement("UL"),e.id="zcl_adaygrid";if(zcal.view!=0){var h=document.createElement("LI");h.className="zcl_lfsec",d.appendChild(h)}for(var i=0;i<=a;i++){var j=zcalMulti.retdate(b.dateBy("yyyyMMdd"),i);f=document.createElement("li"),g.dateBy("yyyyMMdd")==j.dateBy("yyyyMMdd")?(f.className="zcl_sl",zcal.today=j.clone()):i==0&&(zcal.today=j.clone()),f.innerHTML=(j.getDay()==zcal.cdata.opt.WK?"<b>"+j.getWeek()+"</b>":"")+"<span>"+j.dateBy(c)+"</span>",k(f,j),d.appendChild(f),e.appendChild($('<li id="zcl_a'+i+'"></li>')[0])}return[d,e]},getHrDOM:function(a,b,c){var d=$("<li><b></b><u></u></li>");return d.addClass(c),d.off("mousedown").on("mousedown",{dayno:a,hr:b},function(a){zcalDrag.dstartDiv(a,a.data.dayno,a.data.hr)}),d},findTimeLineLeft:function(a){var b=5;for(var c=1;c<a;c++)b+=ZCL_getEleWdt("zcl_a"+c);return b},setCurrentTimeLine:function(){zcalView.timeoutID&&window.clearTimeout(zcalView.timeoutID);if($(".zcl_crday").length>0&&zcal.view>=0&&zcal.view<=2){var a,b=new Date,c=b.getHours(),d=b.getMinutes(),e=b.getSeconds(),f=$(".zcl_crday")[0].getBoundingClientRect().height,g=$(".zcl_crday")[0].getBoundingClientRect().width,h=ZCL_timeInUFormat(b.dateBy("HHmm")),i,j;j=zcalView.findTimeLineLeft($($(".zcl_crday")[0]).index()),ZCL_$("zcl_timeline")||$("#zcl_encloser").append("<div class='zcl_tiln' id='zcl_timeline'/>"),a=$("#zcl_timeline"),a.html('<span/><div style="width:'+g+"px;left:"+j+'px"></div>'),zmComponent.tooltip({elm:a.find("span")[0],text:h,arrow:"top"}),i=c*f+d*(f/60),i=i>0?i-1:0,a.attr("style","top:"+i+"px"),zcalView.timeoutID=setTimeout(zcalView.setCurrentTimeLine,(60-e)*1e3)}else $("#zcl_timeline").remove()},constHrDOM:function(a,b,c){var d="",e=parseInt(zcal.cdata.opt.HS),f=parseInt(zcal.cdata.opt.HE),g=zcal.workDays;zcal.cdata.opt.TF==0?(d+=c==0?12:c>12?c-12:c,d+="&nbsp;"+(c>11?"pm":"am")):d+=(c<9?"0"+c:c)+":00";var h=$('<ul><li class="zcl_lfsec">'+d+"</li></ul>");for(var i=0;i<=a;i++){var j=zcalMulti.retdate(b.dateBy("yyyyMMdd"),i),k="";if(j.dateBy("yyyyMMdd")==(new Date(zcal.cdate)).dateBy("yyyyMMdd")&&c>=e&&c<f)k="zcl_crday";else if(g.indexOf(j.getDay())==-1)k="zcl_wend";else if(c<e||c>=f)k="zcl_nwhr";h.append(zcalView.getHrDOM(i,c,k))}return h[0]},constDayView:function(){var a=zcal.calCenter.listElem,b,c,d,e;a.innerHTML="",zcalInit.updateHeaderBand(zcal.today.dateBy("NNN dd, yyyy"),zcal.view),e=this.constDOM("day"),e.style.height=a.getBoundingClientRect().height+"px",b=e.querySelector("#zcl_vwheader");var f=this.getHeaderDOM(0,zcal.today,"EE");b.appendChild(f[0]),c=e.querySelector("#zcl_allgrid"),c.style.width=this.gridWidth+"px",c.appendChild(f[1]),d=e.querySelector("#zcl_hContainer");for(var g=0;g<24;g++){var h=this.constHrDOM(0,zcal.today,g);d.appendChild(h)}e.addEventListener("contextmenu",function(a){ZCL_stopEvents(a)}),a.appendChild(e),$("#zcl_allLay").on({scroll:function(a){var b=$(this).scrollTop();b!=zcal.alldayScrollTop&&(zcal.alldayScrollTop=b,ZCL_clrStck1())},mousedown:function(a){zcal.qkAllday(a,$(this)[0],"all")}}),$("#zcl_encloser").on({scroll:function(a){var b=$(this).scrollTop();b!=zcal.hrgridScrollTop&&(zcal.hrgridScrollTop=b,ZCL_clrStck1())}}),$(".zcl_crday").length>0&&zcalView.setCurrentTimeLine(),zcalView.dispEvents()},constWeekView:function(){var a=zcal.view==1?zcal.cdata.opt.WK:zcal.view==2?zcal.cdata.opt.WS:0;a=parseInt(a,10);var b=zcal.view==1?6+zcal.cdata.opt.WK:zcal.view==2?zcal.cdata.opt.WE:0;b=parseInt(b,10);var c=new Date;c.setTime(zcal.today.getTime());var d=zcal.view==1&&c.getDay()<a?-7:0,e=b<a?7-(a-b):b-a;c.setDate(c.getDate()-c.getDay()+a+d);var f=c.getTime(),g=c.clone(),h="";g.setDate(g.getDate()+e),c.getFullYear()===g.getFullYear()?c.getMonth()===g.getMonth()?h=c.dateBy("NNN dd")+" - "+g.dateBy("dd, yyyy"):h=c.dateBy("NNN dd")+" - "+g.dateBy("NNN dd, yyyy"):h=c.dateBy("NNN dd, yyyy")+" - "+g.dateBy("NNN dd, yyyy");var i=zcal.calCenter.listElem,j,k,l,m,n,o=zcal.cdata.opt.DF;i.innerHTML="",zcalInit.updateHeaderBand(h,zcal.view),n=new Date,n.setTime(f),m=this.constDOM("week"),m.style.height=i.getBoundingClientRect().height+"px",j=m.querySelector("#zcl_vwheader"),k=m.querySelector("#zcl_allgrid"),o=o=="0"||o=="2"?"M/d (E)":o=="1"?"d/M (E)":"M-d (E)";var p=this.getHeaderDOM(e,n,o);j.appendChild(p[0]),k.style.width=this.gridWidth+"px",k.appendChild(p[1]),l=m.querySelector("#zcl_hContainer");for(var q=0;q<24;q++){var r=this.constHrDOM(e,n,q);l.appendChild(r)}m.addEventListener("contextmenu",function(a){ZCL_stopEvents(a)}),i.appendChild(m),$("#zcl_allLay").on({scroll:function(a){var b=$(this).scrollTop();b!=zcal.alldayScrollTop&&(zcal.alldayScrollTop=b,ZCL_clrStck1())},mousedown:function(a){zcal.qkAllday(a,$(this)[0],"all")}}),$("#zcl_encloser").on({scroll:function(a){var b=$(this).scrollTop();b!=zcal.hrgridScrollTop&&(zcal.hrgridScrollTop=b,ZCL_clrStck1())}}),$(".zcl_crday").length>0&&zcalView.setCurrentTimeLine(),zcalView.dispEvents()},monthHeaderDOM:function(a){var b=document.createElement("LI");return b.innerHTML="<span>"+a.dateBy("E")+"</span>",b.addEventListener("mousedown",function(b){zcalView.setView(0,a.getFullYear(),a.getMonth(),a.getDate())}),b},constMonthView:function(){var a=zcal.cdata.opt.WK,b=0,c=zcal.workDays,d=zcal.mlimit[0].clone(),e,f,g=zcal.calCenter.listElem,h,i,k;g.innerHTML="",e=(zcal.mlimit[1]-zcal.mlimit[0])/864e5+1,f=e/7;var l=zcal.mlimit[0].clone();l.setDate(l.getDate()+15),zcalInit.updateHeaderBand(l.dateBy("NNN yyyy"),zcal.view),k=this.constDOM("month"),k.style.height=g.getBoundingClientRect().height+"px",h=k.querySelector("#zcl_vwheader");var m=new Date;m.setDate(m.getDate()-m.getDay()),m.setDate(m.getDate()+a);for(var n=0;n<7;n++)h.children[0].appendChild(zcalView.monthHeaderDOM(m)),m.setDate(m.getDate()+1);i=k.querySelector("#zcl_encloser"),g.appendChild(k),ZCL_MONTHMODE===1&&(i.style.width=ZCL_getEleWdt(i)-zcalInit.scrollWidth()+"px"),i.parentNode.style.height=this.gridHeight+"px";for(var o=0;o<f;o++){var p=document.createElement("UL");p.id="zcl_row"+o;for(var q=0;q<7;q++){var r="",s,t,u=d.getDay(),v=d.dateBy("NNN yyyy");d.dateBy("yyyyMMdd")==(new Date(zcal.cdate)).dateBy("yyyyMMdd")?(r="zcl_crday",h.children[0].children[q].className="zcl_sl"):c.indexOf(d.getDay())==-1?r="zcl_wend":d.dateBy("yyyyMM")!=l.dateBy("yyyyMM")&&(r="zcl_wend"),s=$('<li id="zcl_mbx'+b+'" class="'+r+'"/>'),t='<div id="zcl_lft'+b+'">'+(d.getDay()==zcal.cdata.opt.WK?"<b>"+d.getWeek()+"</b>":"")+"<span>"+d.getDate()+'</span></div><div id="zcl_lay'+b+'" class="zcl_mgrdsl" style="display:none"></div>',s.html(t),j(s,b,d),p.appendChild(s[0]),b++,d.setDate(d.getDate()+1)}i.appendChild(p)}k.addEventListener("contextmenu",function(a){ZCL_stopEvents(a)}),ZCL_NOB=b,zcal.mcell_width=$("#zcl_mbx0").width();for(var o=0;o<f;o++)i.children[o].style.height=i.children[o].offsetHeight+"px";zcalView.dispEvents()},constMonthPrintView:function(){var a=zcal.cdata.opt.WK,b=0,c=zcal.workDays,d=zcal.mlimit[0].clone(),e,f,g,h,i;e=(zcal.mlimit[1]-zcal.mlimit[0])/864e5+1,f=e/7;var j=zcal.mlimit[0].clone();j.setDate(j.getDate()+15),i=this.constDOM("month"),g=i.querySelector("#zcl_vwheader");var k=new Date;k.setDate(k.getDate()-k.getDay()),k.setDate(k.getDate()+a);for(var l=0;l<7;l++)g.children[0].appendChild(zcalView.monthHeaderDOM(k)),k.setDate(k.getDate()+1);h=i.querySelector("#zcl_encloser"),ZCL_MONTHMODE===1&&(h.style.width=ZCL_getEleWdt(h)-zcalInit.scrollWidth()+"px");for(var m=0;m<f;m++){var n=document.createElement("UL");n.id="zcl_pm_r"+m;for(var o=0;o<7;o++){var p="",q=d.getDay(),r=d.dateBy("NNN yyyy");d.dateBy("yyyyMMdd")==(new Date(zcal.cdate)).dateBy("yyyyMMdd")?(p="zcl_crday",g.children[0].children[o].className="zcl_sl"):c.indexOf(d.getDay())==-1?p="zcl_wend":d.dateBy("yyyyMM")!=j.dateBy("yyyyMM")&&(p="zcl_wend");var s=$('<li id="zcl_pm'+b+'" class="'+p+'"/>'),t='<div id="zcl_lft'+b+'">'+(d.getDay()==zcal.cdata.opt.WK?"<b>"+d.getWeek()+"</b>":"")+"<span>"+d.getDate()+"</span></div>";s.html(t),n.appendChild(s[0]),b++,d.setDate(d.getDate()+1)}h.appendChild(n)}return i},agendaView:function(){var a='<div class="zcl zcl_agendavw" id="zcl_workarea"><ul id="zcl_encloser" class="zcl_frmbg"><li><ul id="zcl_agnlst" class="zcl_agnlst"></ul></li></ul></div>';$(zcal.calCenter.listElem).html(a),zcalInit.updateHeaderBand(zcal.today.dateBy("NNN dd, yyyy"),zcal.view),zcalView.dispEvents()},weekNoText:function(a){var b=a.getWeek(),c=b%10;return c===1&&b!=11?b=ZCL_replaceString(zcal.i18n.weekno1,[b]):c===2&&b!=12?b=ZCL_replaceString(zcal.i18n.weekno2,[b]):c===3&&b!=13?b=ZCL_replaceString(zcal.i18n.weekno3,[b]):b=ZCL_replaceString(zcal.i18n.weekno4,[b]),b},plotEvents:function(){zcal.calCenter==undefined||zcal.calCenter&&zcal.calCenter.listElem.getBoundingClientRect().height<=0?zcal.reconstructView=!0:zcal.view==0?zcalView.dEvents():zcal.view==1||zcal.view==2?zcalView.dEvents():zcal.view==3&&(ZCL_$("zcl_encloser")&&(ZCL_$("zcl_encloser").innerHTML=""),zcalView.constMonthView())},dispEvents:function(){zcal.gridleft=ZCL_findPosXX(ZCL_$("zcl_encloser")),zcal.view==4?zcalAgenda.dispEvents():zcal.view==3?zcalView.mEvents():zcalView.dEvents()},mEvents:function(){ZCL_clrStck1();var a=zcal.mlimit[0].clone(),b=0,c;ZCL_PRINTDATA=[];while(a<zcal.mlimit[1]){var d=zcalMulti.split([a.dateBy("yyyyMMdd"),6]);zcalMonth.render(d,a.dateBy("yyyyMMdd"),7,b),ZCL_PRINTDATA[b]=ZCL_Evl(1,zcalMulti.duplicate(d)),a.setDate(a.getDate()+7),b++}c=$("#zcl_encloser").parent(),ZCL_MONTHMODE===1&&c.css({"overflow-y":"scroll","overflow-x":"hidden"})},dEvents:function(){ZCL_clrStck1(),ZCL_$("zcl_eveSub").innerHTML="";var a=zcal.view==1?zcal.cdata.opt.WK:zcal.view==2?zcal.cdata.opt.WS:0;a=parseInt(a,10);var b=zcal.view==1?6+zcal.cdata.opt.WK:zcal.view==2?zcal.cdata.opt.WE:0;b=parseInt(b,10);var c=new Date;c.setTime(zcal.today.getTime());var d=zcal.view==1&&c.getDay()<a?-7:0,e=b<a?7-(a-b):b-a;zcal.view!=0&&c.setDate(c.getDate()-c.getDay()+a+d);var f=c.getTime(),g=ZCL_getEleWdt("zcl_lftsec");for(var h=0;h<=e;h++){var i=new Date;i.setTime(f),i.setDate(i.getDate()+h);var j=i.dateBy("yyyyMMdd"),k=ZCL_getEleWdt("zcl_a"+h);h!=0&&(g+=k),zcal.cdata.evelst&&zcalEvents.renderDayView(zcal.cdata.evelst[j],j,g,k,h)}var l=zcalMulti.split([c.dateBy("yyyyMMdd"),e]);zcalAday.render(l,c.dateBy("yyyyMMdd"),e)},isTodayInViewRange:function(a){if(a==0)return zcal.today.dateBy("yyyyMMdd")===(new Date(zcal.cdate)).dateBy("yyyyMMdd");if(a==1||a==2){var b=zcal.view==1?zcal.cdata.opt.WK:zcal.view==2?zcal.cdata.opt.WS:0;b=parseInt(b,10);var c=zcal.view==1?6+zcal.cdata.opt.WK:zcal.view==2?zcal.cdata.opt.WE:0;c=parseInt(c,10);var d=new Date;d.setTime(zcal.today.getTime());var e=zcal.view==1&&d.getDay()<b?-7:0,f=c<b?7-(b-c):c-b;d.setDate(d.getDate()-d.getDay()+b+e);var g=new Date;g.setTime(zcal.cdate);for(var h=0;h<=f;h++){var i=zcalMulti.retdate(d.dateBy("yyyyMMdd"),h);if(g.dateBy("yyyyMMdd")==i.dateBy("yyyyMMdd"))return!0}}else if(a==3)return zcal.today.dateBy("yyyyMM")===(new Date(zcal.cdate)).dateBy("yyyyMM");return!1},setView:i,goPrev:h,goNext:g,goToday:f};return l}(),zcalAgenda=function(){var a,b=1,c,d,e={},f=[],g,h=function(){i(),l(c,b)},i=function(){c=zcal.today.clone(),d=k(c)},j=function(){var b=ZCL_daysBetween(c.dateBy("yyyyMMdd"),d[0].dateBy("yyyyMMdd")),e=ZCL_daysBetween(c.dateBy("yyyyMMdd"),d[1].dateBy("yyyyMMdd"));if(b<=10){var f=d[0].clone(),g=a,h=0;f.setDate(f.getDate()-15),g=Math.floor(f.getMonth()/3),d[0]=k(f,g)[0]}else if(e<=10){var f=d[1].clone(),g=a,h=2;f.setDate(f.getDate()+15),g=Math.floor(f.getMonth()/3),d[1]=k(f,g)[1]}},k=function(a){var b=a.clone();return b.setDate(1),dateEd=b.clone(),dateEd.setMonth(b.getMonth()+3),dateEd.setDate(dateEd.getDate()-1),[b,dateEd]},l=function(a,b){g=zmComponent.loadingBand({container:zcal.calCenter.listElem,type:"listing"});var c="/cal/agenda.do?iszmscal=true&dat="+a.dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&qno="+b+"&dateformat="+zcal.DFORMAT[zcal.cdata.opt.DF]+"&calmode="+zcal.CALMODE+(zcal.CALMODE==1?"&gid="+zcal.cdata.opt.GID:"");ZCL_uXHR(c,"zcalAgenda.agendaData")},m=function(a){var b='<div class="zcl zcl_agendavw" id="zcl_workarea"><ul id="zcl_encloser" class="zcl_frmbg"><li><ul id="zcl_agnlst" class="zcl_agnlst"></ul><div id="zcl_agnmsg"></div></li></ul></div>';$(zcal.calCenter.listElem).html(b);var c=ZCL_Evl(1,a.responseText),f=d[0].clone(),g;while(f<d[1])g=f.getFullYear()+"_"+Math.floor(f.getMonth()/3),c[g]&&(e[g]=c[g]),f.setMonth(f.getMonth()+1);n()},n=function(){var a=ZCL_$("zcl_agnlst");$(a).empty();var b=d[0].clone(),c,f;while(b<d[1]){c=b.getFullYear()+"_"+Math.floor(b.getMonth()/3);if(e[c]){f=b.dateBy("yyyyMMdd");if(e[c][0][f]||e[c][1][f]){var g=[];e[c][1][f]&&(g=g.concat(e[c][1][f])),e[c][0][f]&&(g=g.concat(e[c][0][f])),g.length>0&&o(b,g)}}b.setDate(b.getDate()+1)}a.children.length==0?$("#zcl_agnmsg").text(ZCL_replaceString(zcal.i18n.agenda_noevents,[d[1].dateBy("dd/MM/yyyy")])):$("#zcl_agnmsg").text(ZCL_replaceString(zcal.i18n.agenda_dispevents,[d[1].dateBy("dd/MM/yyyy")]))},o=function(a,b){var c=ZCL_$("zcl_agnlst");r(b);var d=zcalCRM.getCRMColorCode();for(var f=0;f<b.length;f++){var g=!1,h=0,i=null,j={},k=b[f];if(!k.EMTY){j.ET=k.ET,j.ST=k.ST;if(k.DUP){h=k.RIDX?k.RIDX:"0",i=k.REPINST?k.REPINST:null;var l=k.ST,m=k.ET;k=e[k.DUP[0]][k.AIDX][k.DUP[1]][k.DUP[2]];if(k.EMTY)continue;k.ADAY==0?(l=="0000"&&k.et=="2400"&&(g=!0),j.ET=m,j.ST=l):g=!0}else k.ADAY=="1"&&(g=!0);var n=k.ORG,o=ZCL_parseDateStr(k.SD),q=parseInt(j.ST.substring(0,2),10),s=parseInt(j.ST.substring(2,4),10);o.setHours(q,s,0,0);var t=ZCL_parseDateStr(k.ED),u=parseInt(j.ET.substring(0,2),10),v=parseInt(j.ET.substring(2,4),10);t.setHours(u,v,0,0);var w=zcal.getCalObj(k.CNAME),x=w[1].split(":"),y=ZCL_getCalColor(x[0]),z=k.CNAME;w[14]=="crm"&&d?d[n]?sts=d[n][2]==0?!1:!0:d.OTHERS&&(sts=d.OTHERS[2]==0?!1:!0):sts=zcal.disabledcal.indexOf(z)==-1?!0:!1;if(sts&&w&&w[2]==1&&w[8]==1){var A=$('<li><div class="zcl_table"><ul><li class="zcl_w70"><ul class="zcl_agdate"><li>'+a.dateBy("E")+"</li><li>"+a.dateBy("dd")+"</li><li>"+a.dateBy("NNN yyyy")+"</li></ul>"+"</li>"+'<li class="zcl_agncclr">'+'<span style="background-color:'+(k.EC!=-1?zcal.eventcolor[k.EC]:y[1])+'"></span>'+"</li>"+'<li class="zcl_grevlst">'+"<ul><li><b>"+ZCL_getHTML(k.SUM)+"</b></li><li><em>"+(g?zcal.i18n.allday:ZCL_timeInUFormat(j.ST)+" - "+ZCL_timeInUFormat(j.ET))+"</em>"+(k.LOC?"<span>"+zcal.i18n.loc+"</span><em>"+ZCL_getHTML(k.LOC)+"</em>":"")+"</li></ul>"+"</li>"+"</ul>"+"</div>"+"</li>");k.EPERM!=0&&p(A,k,a,h,i),c.appendChild(A[0])}}}},p=function(a,b,c,d,e){a.on("click",{obj:b,dat:c,rindex:d,repinst:e},function(a){var b=a.data.obj,c=a.data.dat,d=b.EID+(b.REP?"_"+c.dateBy("yyyyMMdd"):"");ZCL_AgenEveDetail(d,a,b.CNAME,b.EUID,a.data.rindex,a.data.repinst)})},q=function(){var a=["DIV",{attrs:{"class":"zcl_table"},child:[["UL",{child:[["LI",{attrs:{"class":"zcl_w70"}}],["LI",{attrs:{"class":"zcl_grevlst"}}]]}]]}];return _zm.getDOM(a)},r=function(a){if(a.length>1)for(var b=0;b<a.length-1;b++)for(var c=b+1;c<a.length;c++){var d=a[b],e=a[c];if(d&&e){var f=parseInt(d.ST),g=parseInt(d.ET),h=parseInt(e.ST),i=parseInt(e.ET);if(f>h)a[b]=e,a[c]=d;else if(f==h){if(i=="2400"||i<g)a[b]=e,a[c]=d}else a[b]=d,a[c]=e}}},s=function(a,d){if(zcal.view==4){var f=a[d].ADAY;if(a[d].REP)return l(c,b),!1;a[d].SD!=a[d].ED&&(f=1);var g=ZCL_parseDateStr(a[d].SD),h=Math.floor(g.getMonth()/3),i=g.dateBy("yyyy"),j=e[i+"_"+h][f][a[d].SD].length;for(var k=0;k<j;k++)if(!e[i+"_"+h][f][a[d].SD][k].EMTY)if(e[i+"_"+h][f][a[d].SD][k].DUP){var m=e[i+"_"+h][f][a[d].SD][k].DUP;e[m[0]][f][m[1]][m[2]].EID==d&&(e[m[0]][f][m[1]][m[2]]={EMTY:"$$$"})}else e[i+"_"+h][f][a[d].SD][k].EID==d&&(e[i+"_"+h][f][a[d].SD][k]={EMTY:"$$$"});n()}},t=function(a){if(zcal.view==4){var d=ZCL_Evl(1,a);if(d.REP||d.SD!=d.ED)return l(c,b),!1;var f=d.ADAY;d.SD!=d.ED&&(f=1);var g=d.EID,h=ZCL_parseDateStr(d.SD),i=Math.floor(h.getMonth()/3),j=h.dateBy("yyyy");if(e[j+"_"+i]){var k=e[j+"_"+i][f][d.SD].length;for(var m=0;m<k;m++)e[j+"_"+i][f][d.SD][m].EMTY||e[j+"_"+i][f][d.SD][m].EID==g&&(e[j+"_"+i][f][d.SD][m]={EMTY:"$$$"},e[j+"_"+i][d.ADAY][d.SD][e[j+"_"+i][d.ADAY][d.SD].length]=d);n()}}},u=function(a){if(zcal.view==4){var d=ZCL_Evl(1,a);if(d.REP||d.SD!=d.ED)return l(c,b),!1;var f=ZCL_parseDateStr(d.SD),g=Math.floor(f.getMonth()/3),h=f.dateBy("yyyyMMdd"),i=f.getFullYear();if(e[i+"_"+g]){if(d.ADAY==0)if(e[i+"_"+g][0][h]){var j=e[i+"_"+g][0][h].length;e[i+"_"+g][0][h][j]=d}else e[i+"_"+g][0][h]=[],e[i+"_"+g][0][h][0]=d;else if(e[i+"_"+g][1][h]){var j=e[i+"_"+g][1][h].length;e[i+"_"+g][1][h][j]=d}else e[i+"_"+g][1][h]=[],e[i+"_"+g][1][h][0]=d;n()}}},v=function(){c.setDate(1),c.setMonth(c.getMonth()-1),f[0]=new Date(c.getFullYear(),c.getMonth(),1)},w=function(){c.setDate(1),c.setMonth(c.getMonth()+1),f[1]=new Date(c.getFullYear(),c.getMonth()+1,1)},x={dispEvents:h,agendaData:m,goPrev:v,goNext:w,del:s,edit:t,add:u};return x}(),zcalEvents=function(){var a,b,c=function(b){if(zmsuite.isWorkspaceAvailable("zcal_Container")){a=b?zmComponent.loadingBand({container:zcal.calCenter.listElem,type:"listing"}):null;var c="/cal/nxtMon.do?mstart="+zcal.mlimit[0].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&mend="+zcal.mlimit[1].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&dateformat="+zcal.DFORMAT[zcal.cdata.opt.DF]+"&calmode="+zcal.CALMODE;ZCL_uXHR(c,e)}},e=function(b){a&&a();var c=ZCL_Evl(1,b.responseText);zcal.cdata.evelst=c[0],zcal.cdata.eveAll=c[1],zcalView.constGridView()},f=function(a,b){a.onmousedown=function(a){zcalEDrag.dragStart(this,a,b,this.eobj)}},g=function(a,b){a.onclick=function(a){zcal.eveDetail(this.id,a,b,[this.eobj.SD,this.eobj.ST,this.eobj.ED,this.eobj.ET,this.eobj.EUID,this.eobj.CNAME,this.eobj.EPERM,this.eobj.RIDX,this.eobj.DPERM,this.eobj.REPINST])}},h={c:{},findTop:function(a){a=parseInt(a,10),a=a>2330?2330:a,b=b||50;var c=parseInt(a/100,0);return c=c*b+Math.round(a%100*(b/60)),c},findHgt:function(a,c){a=parseInt(a,10),c=parseInt(c,10),b=b||50;var d=parseInt(a/100,10),e=parseInt(c/100,10),f;return d=d*60+a%100,e=e*60+c%100,f=Math.round((e-d)*(b/60)),f=f>b/2?f:b/2,f},findDur:function(a,b){a=parseInt(a,10),b=parseInt(b,10);var c=parseInt(a/100,10),d=parseInt(b/100,10),e=d-c;return b%100>0&&++e,e},incCount:function(a,b){a=parseInt(a,10),b=parseInt(b,10);var c=parseInt(a/100,10),d=parseInt(b/100,10);b%100>0&&++d;for(var e=c;e<d;e++)++zcalEvents.c[e].act},setDur:function(a,b){a=parseInt(a,10);var c=parseInt(a/100,10);zcalEvents.c[c].dur<b&&(zcalEvents.c[c].dur=b)},DGView:function(a,b){var c={},e={};c.eorder=[];var f=zcalCRM.getCRMColorCode();for(var g in a){d=a[g];for(var h in d){var i=zcal.getCalObj(d[h].CNAME),j=!0,k=d[h].ORG;i[14]=="crm"&&f&&(f[k]?j=f[k][2]==0?!1:!0:f.OTHERS&&(j=f.OTHERS[2]==0?!1:!0));if(j&&i&&zcal.disabledcal.indexOf(d[h].CNAME)==-1&&(zcal.cdata.opt.DDE==1||zcal.cdata.opt.DDE==0&&d[h].USTAT!="2")){var l=d[h].ST.substring(0,2)+"00",m=d[h].ST,n=d[h].ET;d[h].SD!=d[h].ED&&(l=b!=d[h].SD?"0000":l,m=b!=d[h].SD?"0000":m,n=b!=d[h].SD?n:"2400");var o=l,p=0;typeof e[o]=="undefined"?(c.eorder.push(o),e[o]=new Array(1)):p=e[o].length,e[o][p]={},e[o][p].id=h,e[o][p].no=g;var q=zcalEvents.findDur(m,n);e[o][p].span=zcalEvents.findHgt(m,n),e[o][p].dur=q,e[o][p].pos=zcalEvents.findTop(m),zcalEvents.setDur(m,q),zcalEvents.incCount(m,n)}}}return c.elist=zcalEvents.sortObj(e),c},sortObj:function(a){for(var b in a){var c=a[b];for(var d=0;d<c.length-1;d++)if(c[d].pos==c[d+1].pos&&c[d].span<c[d+1].span){var e=c[d+1];c.splice(d+1,1),c.splice(d,0,e)}}return a},cArrSlot:function(a,b){for(var c=0;c<b;c++)a[c]=0},renderDayView:function(a,c,d,e,h){zcalEvents.sortEve(a,c);var i=zcalCRM.getCRMColorCode();for(var j=0;j<24;j++)zcalEvents.c[j]={act:0,dur:0,fs:[]};var l=zcalEvents.DGView(a,c);b=$("#zcl_hContainer").find("ul:first")[0].getBoundingClientRect().height;for(var j=0;j<24;j++){var m=zcalEvents.c[j],n=1,o=zcalEvents.c[j].act;for(var p=j+1;p<23;p++){if(!(zcalEvents.c[j].dur>n))break;zcalEvents.c[p].dur-n>zcalEvents.c[j].dur&&(zcalEvents.c[j].dur=zcalEvents.c[p].dur+n),zcalEvents.c[p].act>o&&(o=zcalEvents.c[p].act),++n}for(k=j;k<j+zcalEvents.c[j].dur;k++)zcalEvents.c[k].act=o,j=k}for(var j=0;j<24;j++)zcalEvents.cArrSlot(zcalEvents.c[j].fs,zcalEvents.c[j].act);for(var j=0;j<l.eorder.length;j++){var q=l.eorder[j],m=l.elist[q],r=parseInt(parseInt(q,10)/100,10);for(var p in m){var s=document.createElement("div");s.style.position="absolute";var t=m[p].pos+"px";s.style.top=t;var u=e/zcalEvents.c[r].act;s.style.width=u+u/3+"px";var v=0;for(var w=0;w<zcalEvents.c[r].act;w++)if(zcalEvents.c[r].fs[w]==0){v=w;break}s.style.left=u*v+d+"px";var x=u*v+(u+u/3);x>=e&&(s.style.width=u-3+"px");var y=m[p].span-2-6;for(var z=r;z<=r+m[p].dur-1;z++)zcalEvents.c[z].fs[v]=1;var A=a[m[p].no][m[p].id],B=ZCL_getHTML(A.SUM);B==""&&(B="NO SUBJECT"),s.title=zcalEvents.tooltip(A),s.alt=zcalEvents.tooltip(A),s.setAttribute("gridNo",h);var C=m[p].id+(A.REP?"_"+A.SD:"");s.id=C,s.eobj={RIDX:A.RIDX,EUID:A.EUID,CNAME:A.CNAME,SD:A.SD,ED:A.ED,ST:A.ST,ET:A.ET,ORG:A.ORG,EPERM:A.EPERM,DPERM:A.DPERM,ADAY:A.ADAY,ETZ:A.ETZ,IN_ETZ:A.IN_ETZ,EC:A.EC},A.EPERM==2?f(s,c):g(s,c);var D=zcal.getCalObj(A.CNAME),E=D[1].split(":"),F=ZCL_getCalColor(E[0]),G=E[1]==0?"zcl_event zcl_evwh":"zcl_event zcl_evbl";s.style.borderColor=F[0],s.className=G;var H=A.REF[2]==1?"msi-mail":"",I=A.USTAT;I==1?H="msi-inacc":I==2?H="msi-inden":I==3&&(H="msi-intac");var q=H!=""?"<i class='"+H+"'></i>":"";q+=A.REF["4"]==1?"<i class='msi-alarm'></i>":"",q+=A.HASATTACH?"<i class='msi-attachicon'></i>":"",q+=A.REP?"<i class='msi-repeat'></i>":A.REF[3]==1?"<i class='msi-break'></i>":"",q+=A.IN_ETZ&&A.IN_ETZ==1&&A.ETZ&&A.ETZ!=""?"<i class='msi-timezone'/></i>":"",q+="<em>"+ZCL_timeInUFormat(A.ST)+"</em>";var J="<div style='background-color:"+(A.EC!=-1?zcal.eventcolor[A.EC]:F[1])+"' class='zcl_evbg'></div><div class='zcl_eventbody' style='height:"+y+"px'>";J+="<ul><li class='zcl_sp'></li>";var K="";y<=b/2?(q+="<span>&nbsp;"+B+"</span>",B=""):K+="<ul><li class='zcl_sp'></li><li class='zcl_eventml zcl_evttl'>"+B+"</li></ul>",J+="<li>"+q+"</li></ul>",J+=K,J+="</div>",J+="<div class='zcl_resize'><div class='zcl_scale' id='zcl_scrollme'>&nbsp;</div>",J+="</div>",s.innerHTML=J,zcal.$("zcl_eveSub").style.fontSize="",zcal.$("zcl_eveSub").style.lineHeight="",zcal.$("zcl_eveSub").appendChild(s)}}zcalEvents.c={}},appEvent:function(a,b){var c=ZCL_Evl(1,zcalMulti.toString(a)),d=zcal.cdata.evelst;d||(d={});if(!d[b]||d[b].length<1)d[b]=new Array,d[b][0]=c;else{var e=d[b];e[e.length]=c}},sortEve:function(a,b){var c=a?a.length:0;if(c>1)for(var d=0;d<c-1;d++)for(var e=d+1;e<c;e++){var f=ZCL_Evl(1,zcalMulti.toString(a[d])),g;for(var h in f)g=f[h];var i=ZCL_Evl(1,zcalMulti.toString(a[e])),j;for(var k in i)j=i[k];if(g&&j){var l=parseInt(g.ST,10),m=parseInt(g.DUR,10);g.SD!=b&&(m=parseInt(l/100,10)*zcal.msec_hour+l%100*zcal.msec_minute,l=0);var n=parseInt(j.ST,10),o=parseInt(j.DUR,10);j.SD!=b&&(o=parseInt(n/100,10)*zcal.msec_hour+n%100*zcal.msec_minute,n=0),l>n?(a[d]=i,a[e]=f):l==n&&m<o?(a[d]=i,a[e]=f):(a[d]=f,a[e]=i)}}},remEve:function(a,b,c){var d=b?zcal.cdata.eveAll:zcal.cdata.evelst,e=null;try{var f=null;for(var g in d)for(var h=0;h<d[g].length;h++){var i=d[g][h];for(var j in i)if(j==a){e=i,f=g,c&&d[g].splice(h--,1);break}}d[f]&&d[f].length==0&&delete d[f]}catch(k){}return e},getEve:function(a,b,c){var d=b?zcal.cdata.eveAll:zcal.cdata.evelst,e=null;try{var f=null;if(d[c])for(var g=0;g<d[c].length;g++){var h=d[c][g];if(h[a]){e=h;break}}}catch(i){}return e},tooltip:function(a){var b="",c=ZCL_parseDateStr(a.SD),d=ZCL_parseDateStr(a.ED);return b+=c.dateBy(zcal.ttipformat),a.SD!=a.ED?(b+=a.ADAY==1?"":" "+ZCL_timeInUFormat(a.ST),b+=" - "+d.dateBy(zcal.ttipformat),b+=a.ADAY==1?"":" "+ZCL_timeInUFormat(a.ET)):b+=a.ADAY==1?"":" "+ZCL_timeInUFormat(a.ST)+" - "+ZCL_timeInUFormat(a.ET),b+" "+a.SUM},alltime:function(a){var b=a.USTAT,c="";b==0?c="msi-mail":b==1?c="msi-inacc":b==2?c="msi-inden":b==3&&(c="msi-intac");var d=a.APL_REQ&&a.APL_REQ==1?"<i class='msi-spam'/>":"";return d+=a.ETYPE==1?"<i class='msi-bdy' alt="+zcal.i18n.birthday+" title="+zcal.i18n.birthday+"></i>":"",d+=a.ETYPE==4?"<i class='msi-hdy' alt="+zcal.i18n.holiday+" title="+zcal.i18n.holiday+"></i>":"",d+=a.ETYPE==3?"<i class='msi-task'></i>":"",d+=c!=""?"<i class='"+c+"'></i>":"",d+=a.REF["4"]==1?"<i class='msi-alarm'></i>":"",d+=a.HASATTACH?"<i class='msi-attachicon'></i>":"",d+=a.REP?"<i class='msi-repeat'></i>":a.REF[3]==1?"<i class='msi-break'></i>":"",d+=a.ADAY==1?"":"<em>"+ZCL_timeInUFormat(a.ST)+"</em>",d},loadMonthData:c,retFetchEvents:e};return h}(),zcalMulti=function(){var a={dtArr:new Array,eve:{},retdate:function(a,b){return b==null&&(b=0),new Date(a.substring(0,4),parseInt(a.substring(4,6),10)-1,parseInt(a.substring(6,8),10)+b)},split:function(a){zcalMulti.dtArr=a;var b=zcalMulti.eve;b.all={};for(var c in zcal.cdata.eveAll){var d=zcal.cdata.eveAll[c];for(var e=0;e<d.length;e++)for(var f in d[e]){var g=d[e][f],h=zcal.getCalObj(g.CNAME);h&&zcal.disabledcal.indexOf(g.CNAME)==-1&&(zcal.cdata.opt.DDE==1||zcal.cdata.opt.DDE==0&&g.USTAT!="2")&&(g.SD!=g.ED?zcalMulti.splitMulti(d[e],f):zcalMulti.splitNorm(d[e],f))}}return b},splitMulti:function(a,b){var c=zcalMulti.eve.all,d=zcalMulti.retdate(a[b].SD),e=zcalMulti.retdate(a[b].ED);for(var f=0;f<=zcalMulti.dtArr[1];f++){var g=zcalMulti.retdate(zcalMulti.dtArr[0],f);if(d<=g&&e>=g){g=g.dateBy("yyyyMMdd"),c[g]||(c[g]=new Array),c[g][c[g].length]=a;break}}},splitNorm:function(a,b){var c=zcalMulti.eve.all,d=zcalMulti.retdate(a[b].SD);zcalMulti.retdate(zcalMulti.dtArr[0])<=d&&zcalMulti.retdate(zcalMulti.dtArr[0],zcalMulti.dtArr[1])>=d&&(d=d.dateBy("yyyyMMdd"),c[d]||(c[d]=new Array),c[d][c[d].length]=a)},appEvent:function(a,b){var c=ZCL_Evl(1,zcalMulti.toString(a)),d=zcal.cdata.eveAll;d||(d={});if(!d[b]||d[b].length<1)d[b]=new Array,d[b][0]=c;else{var e=d[b];e[e.length]=c}},sortAll:function(a,b){var c=a?a.length:0;if(c>1)for(var d=0;d<c-1;d++)for(var e=d+1;e<c;e++){var f=ZCL_Evl(1,zcalMulti.toString(a[d])),g;for(var h in f)g=f[h];var i=ZCL_Evl(1,zcalMulti.toString(a[e])),j;for(var k in i)j=i[k];if(g&&j){var l=ZCL_daysBetween(b,g.ED),m=ZCL_daysBetween(b,j.ED);l<=m?(a[d]=i,a[e]=f):(a[d]=f,a[e]=i)}}},toString:function(a){return JSON.stringify(a)},duplicate:function(a){var b="{",c=0;for(var d in a.all){var e=a.all[d];b+=c!=0?",":"",b+='"'+d+'" : [';var f=0;for(var g in e)b+=f!=0?","+zcalMulti.toString(e[g]):zcalMulti.toString(e[g]),f++;b+="]",c++}return b+="}",b}};return a}(),zcalAday=function(){var a={c:new Array,s:1,dtArr:new Array,render:function(a,b,c){zcalAday.s=c+1;var d="";zcalAday.creArray();var e=ZCL_parseDateStr(b);zcalAday.dtArr[0]=e,zcalAday.dtArr[1]=zcalMulti.retdate(b,c);for(var f=0;f<=c;f++){var g=new Date;g.setTime(e),g.setDate(g.getDate()+f);var h=g.dateBy("yyyyMMdd");a.all[h]&&(zcalMulti.sortAll(a.all[h],h),d+=zcalAday.create(a.all[h],f,h))}var i=zcalAday.c.length,j=i*18+14;d+='<div style="height:14px;position:absolute;width:100%;top:'+(j-14)+'px"></div>',zcal.$("zcl_allLay").innerHTML=d,zcal.$("zcl_aContainer").style.height=(j>90?90:j)+"px",zcal.$("zcl_encloser").style.height=$(zcal.calCenter.listElem).height()-33-zcal.$("zcl_allLay").offsetHeight-1-1+"px",zcal.alldayScrollTop=$("#zcl_allLay").scrollTop(),zcal.hrgridScrollTop=$("#zcl_encloser").scrollTop(),zcalAday.c=new Array},create:function(a,b,c){var d="";for(var e in a){var f=zcalAday.freeS(b),g=zcalAday.eveWid(f,b,a[e],c),h=zcalAday.eveLeft(b);d+=zcalAday.divCont(f*18,h,a[e],g)}return d},divCont:function(a,b,c,d){var e="";for(var f in c){var g=zcal.getCalObj(c[f].CNAME);if(typeof g!="undefined"){var h=c[f].REP?f+"_"+c[f].SD:f,i=g[1].split(":"),j=ZCL_getCalColor(i[0]),k=zcal.eventcolor[c[f].EC],l=ZCL_parseDateStr(c[f].SD),m=ZCL_parseDateStr(c[f].ED),n=ZCL_timeInUFormat(c[f].ST),o=ZCL_timeInUFormat(c[f].ET),p=l.dateBy("MMM dd"),q=m.dateBy("MMM dd"),r=ZCL_getHTML(zcalEvents.tooltip(c[f])),s=zcalEvents.alltime(c[f]),t=i[1]==0?"zcl_alldy zcl_evwh":"zcl_alldy zcl_evbl";e+='<div class="'+t+'" style="top:'+a+"px;left:"+b+"px;width:"+d+"px;border-color:"+j[0]+'" alt="'+r+'" title="'+r+'" onmousedown="zcal.eveDetail(\''+h+"', event, '"+c[f].SD+"', ['"+c[f].SD+"', '"+c[f].ST+"', '"+c[f].ED+"', '"+c[f].ET+"', '"+c[f].EUID+"', '"+c[f].CNAME+"', '"+c[f].EPERM+"', '"+c[f].RIDX+"', '"+c[f].DPERM+"', '"+c[f].REPINST+"'])\">",e+='<div class="zcl_evbg" style="background-color:'+(c[f].EC!=-1?k:j[1])+'"></div>',e+='<ul class="zcl_eventbody"><li>'+s+"<span>"+ZCL_getHTML(c[f].SUM)+"</span></li></ul>",e+="</div>"}}return e},creArray:function(){var a=zcalAday.c[zcalAday.c.length]=new Array;for(var b=0;b<zcalAday.s;b++)a[b]=0;return zcalAday.c.length-1},freeS:function(a){for(var b=0;b<zcalAday.c.length;b++)if(zcalAday.c[b][a]==0)return b;return zcalAday.creArray()},fillspace:function(a,b,c){var d=zcalAday.c[a];for(var e=b;e<c+b;e++)d[e]=1},eveWid:function(a,b,c,d){var e="",f="";for(var g in c)ed=c[g].ED;ed=ZCL_parseDateStr(ed),ed>=zcalAday.dtArr[1]?e=ZCL_daysBetween(d,zcalAday.dtArr[1].dateBy("yyyyMMdd"))+1:ed<zcalAday.dtArr[1]&&(e=ZCL_daysBetween(d,ed.dateBy("yyyyMMdd"))+1),zcalAday.fillspace(a,b,e);var h=0;for(var i=0;i<e;i++)h+=ZCL_getEleWdt("zcl_a"+(b+i));return h-5},eveLeft:function(a){var b=0;for(var c=0;c<a;c++)b+=ZCL_getEleWdt("zcl_a"+c);return b+1}};return a}();zcal.REG=/<|>|&lt;|&gt;|&lt|&gt/gi,zcal.$=function(a){return document.getElementById(a)},String.prototype.trim=function(){var a=this;return a=a.replace(/^\s*(.*)/,"$1"),a=a.replace(/(.*?)\s*$/,"$1"),a},String.prototype.zcalescape=function(){var a=this;return a=encodeURIComponent(this),a},String.prototype.zcalunescape=function(){var a=this;return a=unescape(decodeURIComponent(this)),a},String.prototype.zcalreplace=function(){var a=this;return a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/"/g,'\\"')},zcal.validate=function(a){var b=a.lastIndexOf("<"),c=a.lastIndexOf(">");return c>b&&b!="-1"&&c!="-1"?!1:!0},zcal._2digit=function(a){return+a<10?"0"+a:""+a},ZCL_timeInUFormat=function(a){a=parseInt(a,10);var b=Math.floor(a/100),c=zcal._2digit(a%100);if(zcal.cdata.opt.TF==0){var d=b==0?12:b>12?b-12:b;return d+":"+c+" "+(b>11?zcal.i18n.pm:zcal.i18n.am)}return zcal._2digit(b)+":"+c};var ZCL_ClearCacheTimer=null;ZCL_handleLanguageChange=function(){ZCL_ClearCacheTimer==null&&(ZCL_ClearCacheTimer=setTimeout(function(){var a=new Date,b=a.getTime();ZCL_uXHR("/cal/clearusercache.do?nocache="+b,"ZCL_clearUserCache")},3e3))},ZCL_clearUserCache=function(a){ZCL_ClearCacheTimer=null;var b=ZCL_Evl(1,a.responseText),c=zcal.cdata.opt;if(b.TIM!=c.TIM)if(zmApp.currentApp=="c"){var d=document.createElement("div");d.id="zcl_redit_confirm",d.className="zcl_rpt",d.innerHTML="<div>Your timezone has been updated to <span style='color:#000000;font-weight:bold'>"+b.TIM+"</span>. Reload the page for the changes to take effect.</div>",document.body.appendChild(d);var e={title:"Hi  "+b.username+",",style:{left:"500px",top:"100px"},drag:!1,mask:!0,ptr:"tright",buttons:[{txt:"OK",callback:function(){ZCL_Continue(b)}}]};zmsDialog.create("zcl_redit_confirm",e)}else ZCL_Continue(b)},ZCL_Continue=function(a){zmsDialog.remove(!0);var b=zcal.cdata.opt;a&&(b.CTIM=a.CTIM,b.TIM=a.TIM,b.TZLBL=a.TZLBL),zcalEvents.loadMonthData()},ZCL_pxToTime=function(a){var b=$("#zcl_hContainer").find("ul:first")[0].getBoundingClientRect().height,c,d;d=Math.round(a%b/(b/60)),d=Math.round(d/5)*5,c=Math.floor(a/b),c=d==60?c+1:c,d=d==60?0:d;var e=zcal._2digit(c)+""+zcal._2digit(d);return e},ZCL_LinkParser=function(a){var b=a;b=b.replace(/\n/g," <br/>"),b=b.replace(/\\n/g," <br/>"),b=b.replace(/\\N/g," <br/>");var c=/((?=http\:|https\:)[\S]*\/\/[^\s\"]+)/gi,d=/[\w]([\w\-\.\+\'\/]*)@([\w\-\.]*)(\.[a-zA-Z]{2,22}(\.[a-zA-Z]{2}){0,2})/ig,e=/\<br\/?>/gi,f=[],g=[],h=[],i=[],j=[];while((match=c.exec(b))!=null){var k={};match[0].match(/(\<|\>)/ig)||(k.sindex=match.index,k.eindex=match.index+match[0].length,f.push(k))}while((match=d.exec(b))!=null){var k={};k.sindex=match.index,k.eindex=match.index+match[0].length,g.push(k)}while((match=e.exec(b))!=null){var k={};k.sindex=match.index,k.eindex=match.index+match[0].length,h.push(k)}i=f.concat(g).concat(h),i.sort(function(a,b){return a.sindex-b.sindex});for(var l in i){var m;if(l!=0){m=b.substring(i[l-1].eindex,i[l].sindex);var n=document.createTextNode(m);j.push(n),m=b.substring(i[l].sindex,i[l].eindex)}else if(i[l].sindex==0)m=b.substring(0,i[l].eindex);else{m=b.substring(0,i[l].sindex);var n=document.createTextNode(m);j.push(n),m=b.substring(i[l].sindex,i[l].eindex)}if(m.match(/\<br\/?>/))var o=document.createElement("BR");else{var o=document.createElement("A");m.match(d)?o.setAttribute("href","mailto:"+m):o.setAttribute("href",m),m.match(d)?"":o.setAttribute("target","_blank"),o.innerText=m}j.push(o);if(l==i.length-1){var m=b.substring(i[l].eindex,b.length),n=document.createTextNode(m);j.push(n)}}if(i.length==0){var n=document.createTextNode(b!=""?b:"---");j.push(n)}return j},String.prototype.getTimeBy=function(a){a+="";var b="",d=0,e="",f=ZCL_parseTime(this);if(f){while(d<a.length){c=a.charAt(d),e="";while(a.charAt(d)==c&&d<a.length)e+=a.charAt(d++);f[e]!=null?b+=f[e]:b+=e}return b}return this},ZCL_parseTime=function(a){var b,c,d,e,f=a.trim().toLowerCase();if(/^(20|21|22|23|[01]\d|\d)(([:][0-5]\d){1,2})$/.test(f))return ZCL_ParseByRT(f);if(/^(0[1-9]|1[0-2]|[1-9]):[0-5][0-9]\s*([ap]m|[AP]M)$/.test(f))return ZCL_ParseByAm(f);if(/^(20|21|22|23|[01]\d|\d)[0-5][0-9]$/.test(f))return ZCL_ParseByDB(f);f=f.replace(/\D/ig,"");if(isNaN(f))return{HH:"08",hh:"08",mm:"00",a:"am"};var g=f.length;return f=g==1?f+"000":g==2?f+"00":g==3?f+"0":g>4?f.substring(0,4):f,/^(20|21|22|23|[01]\d|\d)[0-5][0-9]$/.test(f)?ZCL_ParseByDB(f):{HH:"08",hh:"08",mm:"00",a:"am"}},ZCL_ParseByRT=function(a){var b=a.split(":");b[0]=parseInt(b[0],10);var c=(b[0]==0?"12|am":b[0]==12?"12|pm":b[0]<12?b[0]+"|am":b[0]-12+"|pm").split("|"),d={};return d.HH=b[0]<10?"0"+b[0]:b[0],d.hh=c[0]<10?"0"+c[0]:c[0],d.mm=b[1],d.a=c[1],d},ZCL_ParseByDB=function(a){var b=a.substring(0,2),c=a.substring(2,4);b=parseInt(b,10);var d=(b==0?"12|am":b==12?"12|pm":b<12?b+"|am":b-12+"|pm").split("|"),e={};return e.HH=b<10?"0"+b:b,e.hh=d[0]<10?"0"+d[0]:d[0],e.mm=c.length<2?"0"+c:c,e.a=d[1],e},ZCL_ParseByAm=function(a){var b=a.split(/:|\s+/);b.length<3&&(b[2]=b[1].substring(2,4),b[1]=b[1].substring(0,2)),b[0]=parseInt(b[0],10);var c={};return c.hh=b[0]<10?"0"+b[0]:b[0],c.mm=b[1],c.a=b[2],c.HH=b[0]==12&&c.a=="am"?"00":c.a=="pm"&&b[0]!=12?b[0]+12:b[0]<10?"0"+b[0]:b[0],c},ZCL_CRTim=function(a){var b=a.value;a.value=a.value.getTimeBy(zcal.timeformat[zcal.cdata.opt.TF])},ZCL_TimetoNo=function(a){var b=ZCL_parseTime(a);return b.HH+""+b.mm},ZCL_replaceString=function(a,b){return a.replace(/\{[0-9]\}/g,function(a){return a=a.replace(/[\{\}]/g,""),b[parseInt(a)]})},ZCL_getPos=function(a){var b={offsetLeft:a.offsetLeft,offsetTop:a.offsetTop,offsetWidth:a.offsetWidth,offsetHeight:a.offsetHeight};if(a.offsetParent){var c=ZCL_getPos(a.offsetParent);b.offsetLeft+=c.offsetLeft,b.offsetTop+=c.offsetTop,b.offsetRight+=c.offsetRight}return b},ZCL_MouseXY=function(a){var a=a||window.event;if(a.pageX||a.pageY)zcalMX=a.pageX,zcalMY=a.pageY;else if(a.clientX||a.clientY)zcalMX=a.clientX+document.body.scrollLeft,zcalMY=a.clientY+document.body.scrollTop},zcal.getCalObj=function(a){return zcal.cdata.calLst[a]||zcal.cdata.calOLst[a]||zcal.cdata.calGLst[a]||zcal.cdata.calALst[a]};var ZCL_ISTIMER=!1,ZCL_SHCAL_EVEUPD;ZCL_chkfeed=function(a){var b=ZCL_$("zcl_frmfeed"),c="zcl_feedsub";ZCL_$(c).value.trim()==""?alert(ZCL_ALERTS.entersubject):(b.zcl_feedcsrf.value=ZCL_CSRFCOO,b.submit(),b.reset(),ZCL_clrStck(),ZCL_slideObj.status(ZCL_ALERTS.thfeedback))},ZCL_openRO=function(){var a=ZCL_$("zcl_ro_msg");ZCL_CAStck(new Array("zcl_ro_msg","zcl_mask","zcl_mask1")),a.style.display="",a.style.left=(document.body.offsetWidth-a.offsetWidth)/2+"px",a.style.top=(document.body.offsetHeight-a.offsetHeight)/2+"px",ZCL_openMask()},ZCL_clsRO=function(){ZCL_$("zcl_ro_msg").style.display="none",ZCL_clrStck()},ZCL_getJSONObjCnt=function(a){var b=0;for(var c in a)a.hasOwnProperty(c)&&b++;return b},ZCL_Evl=function(){if(arguments.length<2)return;if(arguments["0"]==1)return JSON.parse(arguments[1]);if(arguments.length==2)return window[arguments[1]].apply(this);var a=Array.prototype.slice.call(arguments,2);return window[arguments[1]].apply(this,a)},ZCL_getEleWdt=function(a){var b=typeof a=="string"?zcal.$(a):a;return b.getBoundingClientRect().width},ZCL_$=function(a){return document.getElementById(a)},ZCL_setOpacity=function(a,b){a.style.filter="alpha(opacity="+b+"0)",a.style.opacity="0."+b,a.style.mozOpacity="0."+b},ZCL_findPosYY=function(a,b){var c=0;if(a.offsetParent)while(a.offsetParent&&(a.style.position!="absolute"||b))c+=a.offsetTop,a=a.offsetParent;else a.y&&(c+=a.y);return c},ZCL_findPosXX=function(a,b){var c=0;if(a.offsetParent)while(a.offsetParent&&(a.style.position!="absolute"||b))c+=a.offsetLeft,a=a.offsetParent;else a.x&&(c+=a.x);return c},ZCL_daysBetween=function(a,b){var c=ZCL_parseDateStr(a),d=ZCL_parseDateStr(b),e=0,f=6e4,g=f*60*24;d>c&&(e=(d.getTimezoneOffset()-c.getTimezoneOffset())*f);var h=Math.abs(d.getTime()-c.getTime())-e;return Math.ceil(h/g)},ZCL_getHTML=function(a){return a=a.replace(/"/g,"&quot;"),a=a.replace(/'/g,"&#39;"),a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;"),a},ZCL_encodeHTML=function(a){return a=a.replace(/\\/g,""),a=a.replace(/"/g,""),a=a.replace(/'/g,""),a=a.replace(/</g,""),a=a.replace(/>/g,""),a},ZCL_getHTML1=function(a){return a=a.replace(/\\/g,"\\\\"),a=a.replace(/"/g,'\\"'),a=a.replace(/'/g,"\\&#39;"),a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;"),a},ZCL_getDescHTML=function(a){return a=a.replace(/"/g,"&quot;"),a=a.replace(/'/g,"&#39;"),a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;"),a=a.replace(/\n/g,"<br/>"),a=a.replace(/\\n/g,"<br/>"),a=a.replace(/\\N/g,"<br/>"),a},ZCL_stopEvents=function(a){a=a||event,a.stopPropagation?(a.preventDefault(),a.stopPropagation()):(a.cancelBubble=!0,a.returnValue=!1)},ZCL_rdaysInJSRep=function(a){var b=new Array,c=a.length;for(var d=0;c!=0&&d<c;d++){var e=parseInt(a[d],10);e-=1,b[d]=e}return b},ZCL_parseDateStr=function(a){var b=a.substring(0,4),c=parseInt(a.substring(4,6),10)-1,d=a.substring(6,8),e=new Date(b,c,d);return e.setHours(0,0,0,0),e},ZCL_array_search=function(a,b){for(var c in b)if(b[c]==a)return c;return!1};var ZCL_replaceComName=function(a,b){return a.replace("{{companyName}}",zcal.i18n.campanyName)},ZCL_replaceProName=function(a,b){return a.replace("{{productName}}",ZCL_replaceComName(zcal.i18n.productName,zcal.i18n.campanyName))};ZCL_handleCrossProductMessage=function(a,b){if(a=="CL")if(b.operation=="ADD EVENTS")ZCL_showEvent(b.data);else if(b.operation=="DELETE EVENTS"){var c=b.data;ZCL_updateDeletedEvents(c)}else if(b.operation=="MAIL INVITE"||b.operation=="UPDATE INVITED EVENT"){var d=b.data;setTimeout(function(){ZCL_fetchRepeatWithChild(d)},3e3)}else if(b.operation=="UPDATE CALENDAR WITH EVENTS")zcal.refreshMode=b.operation,zcal.refreshTimer||(zcal.refreshTimer=setTimeout(function(){ZCL_shCalAdd()},6e4));else if(b.operation=="UPDATE EVENTS ONLY"){zcal.refreshMode=zcal.refreshMode=="UPDATE CALENDAR WITH EVENTS"?zcal.refreshMode:b.operation;if(b.data=="GSync Events"){zcalSettings.Sync.setGCalSyncStatus(0),ZCL_shCalAdd();var e=$("#zcl_gcallst");e.length>0&&(_zm.succErrMsg("s",zcal.i18n.synccompmsg),zcalSettings.Sync.listGCal())}else if(b.data=="CRM Events"){ZCL_shCalAdd();var f=$("#zcl_appcallst");f.length>0&&f.data("app")=="crm"&&zcalSettings.appList.listCrmCal()}else b.data=="CalDAV Events"?ZCL_shCalAdd():b.data=="ZTask Events"?(ZCL_shCalAdd(),zcalSettings.appList.setTaskSyncStatus("success"),f=$("#zcl_appcallst"),f.length>0&&f.data("app")=="task-sync"&&(_zm.succErrMsg("s",zcal.i18n.synccompmsg),zcalSettings.appList.listTaskCal())):zcal.refreshTimer||(zcal.refreshTimer=setTimeout(function(){ZCL_shCalAdd()},6e4))}else if(b.operation=="IMPORT STATUS")zcalSettings.Import.showImportStatus(b.data);else if(b.operation=="CRM SYNC")if(b.data.sync_status=="success"){zcalSettings.appList.setCrmSyncStatus(b.data.sync_status),zcal.cdata.calOUids+=","+b.data.Uid,zcal.refreshMode="UPDATE CALENDAR WITH EVENTS",ZCL_shCalAdd();var f=$("#zcl_appcallst");f.length>0&&f.data("app")=="crm"&&(_zm.succErrMsg("s",zcal.i18n.synccompmsg),zcalSettings.appList.listCrmCal())}else setTimeout(function(){zcalSettings.appList.setCrmSyncFailedStatus()},3e3);else b.operation=="UPDATE_SHARECAL_EVENT"?setTimeout(function(){ZCL_updateEventsForSharedCal(b.data.eventIdL,b.data.ckey)},3e3):b.operation=="DELETE_SHARECAL_EVENT"&&ZCL_updateDeletedEventsForSharedCal(b.data)};var zcalUtil=function(){var a={createEvent:function(a){var b;a?b=function(){var b=ZCL_nlp(a.SUM,1);b.SUM=b.SUM?b.SUM:"",b.DESC=a.DESC?a.DESC:"",b.msgId=a.msgId?a.msgId:"",b.accId=a.accId?a.accId:"",b.ST=b.ST?b.ST:"",b.ET=b.ET?b.ET:"",b.SD=b.SD?b.SD:"",b.ED=b.ED?b.ED:"",b.failureCallbk=a.failureCallbk?a.failureCallbk:"",b.successCallbk=a.successCallbk?a.successCallbk:"",ZCL_constEventView(b)}:b=function(){ZCL_constEventView()},b()}};return a}();zcal.NN6=document.getElementById&&!document.all,ZCL_getCalArr=function(a,b){var c=[],d="",e=zcal.cdata.calOrdArr;for(var f=0;f<e.length;f++){var g=e[f],h=zcal.cdata.calLst[g];if(zcal.cdata.calLst[g][8]=="1"){var i={};i.id=g,i.name=ZCL_getHTML(h[0]),i.display_text=ZCL_getHTML(h[0]),c.push(i)}}for(var j in zcal.cdata.calGLst){var k=zcal.cdata.calGLst[j];if(k[8]=="1"&&(k[12]==2||k[12]==3)){var i={};i.id=j,i.name=ZCL_getHTML(k[0])+"("+k[14]+")",i.display_text=ZCL_getHTML(k[0])+"("+k[14]+")",c.push(i)}}for(var j in zcal.cdata.calALst){var k=zcal.cdata.calALst[j];if(k[8]=="1"&&(k[12]==2||k[12]==3)){if(k[14]=="ztask"&&b)continue;var i={};i.id=j,i.name=ZCL_getHTML(k[0])+"("+k[14]+")",i.display_text=ZCL_getHTML(k[0])+"("+k[14]+")",c.push(i)}}for(var j in zcal.cdata.calOLst){var k=zcal.cdata.calOLst[j];if(k[8]=="1"&&(k[12]==2||k[12]==3)){var i={};i.id=j,i.name=ZCL_getHTML(k[0])+"(others)",i.display_text=ZCL_getHTML(k[0])+"(others)",c.push(i)}}return c},ZCL_calSelLst=function(a,b){var c="",d=zcal.cdata.calOrdArr;for(var e=0;e<d.length;e++){var f=d[e],g=zcal.cdata.calLst[f];zcal.cdata.calLst[f][8]=="1"&&(c+='<option value="'+f+'" '+(a&&f==a?"selected='true'":"")+">"+ZCL_getHTML(g[0])+"</option>")}for(var h in zcal.cdata.calGLst){var i=zcal.cdata.calGLst[h];i[8]=="1"&&(i[12]==2||i[12]==3)&&(c+='<option value="'+h+'" '+(a&&h==a?"selected='true'":"")+">"+ZCL_getHTML(i[0])+"("+i[14]+")</option>")}for(var h in zcal.cdata.calALst){var i=zcal.cdata.calALst[h];if(i[8]=="1"&&(i[12]==2||i[12]==3)){if(i[14]=="ztask"&&b)continue;c+='<option value="'+h+'" '+(a&&h==a?"selected='true'":"")+">"+ZCL_getHTML(i[0])+"("+i[14]+")</option>"}}for(var h in zcal.cdata.calOLst){var i=zcal.cdata.calOLst[h];i[8]=="1"&&(i[12]==2||i[12]==3)&&(c+='<option value="'+h+'" '+(a&&h==a?"selected='true'":"")+">"+ZCL_getHTML(i[0])+"(others)</option>")}return c},zcal.putDate=function(a){var b=zcal.DFORMAT[zcal.cdata.opt.DF],c=a.substring(6,8),d=a.substring(4,6),e=a.substring(0,4);return b.replace("dd",c).replace("MM",d).replace("yyyy",e)},ZCL_getWeekGridNo=function(a){var b=0,c,d=ZCL_getEleWdt("zcl_lftsec"),e=d,a=a-d,f=ZCL_$("zcl_adaygrid").children;for(var g=0;g<f.length;g++){c=f[g].getBoundingClientRect().width,a-=c;if(a<0){b=g;break}e+=c}return[b,e]},ZCL_dragreturn=function(a,b,c){var d=Math.round(a.offsetTop),e=Math.round(a.offsetTop+a.offsetHeight);d=ZCL_pxToTime(d),e=ZCL_pxToTime(e);var f=a.id,g=c.SD,h=c.ST,i=a.offsetLeft,j=c.ED,k=c.ET,l=zcal.getWeekStart(),m=zcal.today.clone();zcal.view!=0&&m.setDate(m.getDate()-m.getDay()+l);if(i!=0){var n,o,p,q,r,s;n=parseInt(a.getAttribute("gridNo"),10),m.setDate(m.getDate()+n),o=m.dateBy("yyyyMMdd"),p=m.dateBy("yyyyMMdd"),q=e=="2400"?"0000":e;if(g==o&&h==d&&k==q)return zcalView.plotEvents(),!1;r=zcal.findDuration(c);if(b=="bot"){if(g!=j&&o==g&&k!="0000"&&k!="2400")return zcalView.plotEvents(),!1;o=g,d=h}else if(b=="top"){var t=parseInt(d/100,10),u=d%100;m.setHours(t,u,0,0),m.setTime(m.getTime()+r),p=m.dateBy("yyyyMMdd"),e=m.dateBy("HHmm")}s={SD:o,ED:p,ST:d,ET:e,EID:f,CNAME:c.CNAME,EUID:c.EUID,RIDX:c.RIDX,ORG:c.ORG,ADAY:c.ADAY,ETZ:c.ETZ,IN_ETZ:c.IN_ETZ},zcalQAdd.edit(s)}},zcal.getWeekStart=function(){if(zcal.view==0)return 0;if(zcal.view==2)return zcal.cdata.opt.WS;if(zcal.view==1){var a=zcal.today.clone(),b=zcal.cdata.opt.WK;return a.getDay()<b&&(b-=7),b}},zcal.qkAllday=function(a,b){ZCL_clrStck();var c,d,e,f,g,h,i;c=zcal.getWeekStart(),d=zcal.today.clone(),e=ZCL_$("zcl_allLay"),f=e.offsetWidth,g=ZCL_findPosXX(e),h=(a.clientX-g)%f,i=zcalInit.scrollWidth();if(h>=f-i)return!1;h=a.clientX-ZCL_findPosXX(ZCL_$("zcl_aencloser"));var j=ZCL_getWeekGridNo(h);if(zcal.view!=0){d.setDate(d.getDate()-d.getDay()+c);var k=j[0];d.setDate(d.getDate()+k)}var l=d.dateBy("yyyyMMdd");zcal.openAQBook({SD:l,ST:0,ED:l,ET:0,ADAY:1,ORG:zcal.userid},d,a)},ZCL_editEve=function(a,b,c,d){zcal.EOBJ=null;var e=zcal.getCalObj(c),f="/cal/eInfo.do?ckey="+e[9]+"&ekey="+d+"&calmode="+zcal.CALMODE+(zcal.CALMODE==1?"&grpid="+zcal.ZGID:"");f+="&eveId="+(a.indexOf("_")!=-1?a.substring(0,a.indexOf("_"))+"&date="+a.substring(a.indexOf("_")+1,a.length):a),ZCL_TRIDX&&ZCL_TRIDX!="undefined"&&(f+="&ridx="+ZCL_TRIDX),ZCL_REPINST&&ZCL_REPINST!=undefined&&ZCL_REPINST!="undefined"&&ZCL_REPINST!=null&&(f+="&rbrkdate="+ZCL_REPINST),ZCL_XHR(f,function(a){ZCL_processEventData(a,c,e[14])}),ZCL_stopEvents(b)},zcal.GOBJ=null,ZCL_processEventData=function(a,b,c){var d=ZCL_Evl(1,a.responseText);d.NO_DATA?ZCL_slideObj.status(ZCL_ALERTS.eventnotfound):d.mode=="crm"||d.mode=="recruit"?d.status=="success"&&(zcal.EOBJ=d.eobj,zcal.EOBJ.CNAME=b,zcalCRM.updateCRMData(d)):c=="ztask"?(zcal.EOBJ=d,zcalTask.updateTaskData()):(ZCL_TEMP_ADAY=d.ADAY,zcal.GOBJ=d,ZCL_constEventView(d))},ZCL_reqEveDesc=function(a,b,c,d){var e=zcal.getCalObj(c);ZCL_uXHR("/cal/getDesc.do?ckey="+e[9]+"&euid="+d+"&mode=desc","ZCL_retEveDesc"),ZCL_stopEvents(b)},ZCL_retEveDesc=function(a){var b=ZCL_Evl(1,a.responseText);if(ZCL_$("zcl_qview")){var c=ZCL_$("zcl_qview"),d=ZCL_$("zcl_qdesc");if(b.DESC&&b.DESC.trim()!=""){d.style.display="",d.innerHTML="<li><div class='zcl_frmtcp'>"+zcal.i18n.description+"</div><p class='zcl_desc' id='zcl_deschtml'></p>";if(ZCL_$("zcl_deschtml")){var e=ZCL_LinkParser(b.DESC);for(var f in e)e[f].nodeType==3&&e[f].nodeValue.match(/\s/)&&(e[f].nodeValue=e[f].nodeValue.replace(/\s/g,"")),ZCL_$("zcl_deschtml").appendChild(e[f])}var g=document.body.offsetHeight-26,h=g>zcalMY+c.offsetHeight?zcalMY:zcalMY-c.offsetHeight;c.style.top=h+"px",d.style.display=""}else d.style.display="none"}};var ZCL_TRIDX=null,ZCL_REPINST=null;ZCL_AgenEveDetail=function(a,b,c,d,e,f){var g=a.indexOf("_")!=-1?a.substring(0,a.indexOf("_")):a;a.indexOf("_")!=-1&&(ZCL_TRIDX=e,ZCL_REPINST=f!="null"?f:null),zcal.EMODE=0,ZCL_editEve(a,b,c,d)};var ZCL_TEMP_EOBJ,ZCL_TEMP_ADAY,ZCL_MYTIT;ZCL_StdDate=function(a){if([zcl_cdata.opt.DF]!=1){var b=zcal.DFORMAT[zcl_cdata.opt.DF],c=b.indexOf("dd"),d=b.indexOf("MM"),e=b.indexOf("yyyy"),f=a.substring(c,c+2),g=a.substring(d,d+2),h=a.substring(e,e+4);return b=f+"/"+g+"/"+h,b}return a},ZCL_detailObj=function(a){var b="";ZCL_DELRTO=1,zcal.GOBJ=null,ZCL_TEMP_EOBJ=a,ZCL_MYTIT=a.SUM.replace(zcal.REG,""),ZCL_MYTIT==""&&(ZCL_MYTIT="NO SUBJECT"),ZCL_MYTIT.length>255&&(b+="TITLE : "+ZCL_MYTIT+" \n\n",ZCL_MYTIT=ZCL_MYTIT.slice(0,255)),ZCL_MYTIT=ZCL_MYTIT.zcalescape();var c=a.LOC.replace(zcal.REG,"").zcalescape();b+=a.DESC.zcalescape();var d=a.LINK&&a.LINK.replace(zcal.REG,"").zcalescape(),e=zcal.getCalObj(a.CNAME);a.EPERM=a.EPERM!=""?a.EPERM:e[12]>=2?2:e[12]==1?1:0,a.DPERM=a.DPERM!=""?a.DPERM:e[12]>=2?2:0;var f=e[9],g="/cal/ae.do?title="+ZCL_MYTIT+"&ckey="+f+"&desc="+b+"&all="+a.ADAY+"&busy="+a.TRANS+"&loc="+c+"&imp="+a.IMP+"&class="+a.CLASS+"&ctype="+e[5];g+="&ecolor="+(a.EC?a.EC:"-1"),g+="&dateformat="+zcal.DFORMAT[zcal.cdata.opt.DF]+"&sd="+a.SD+"&st="+a.ST+"&ed="+a.ED+"&et="+a.ET+"&etsk="+a.ETSK+"&ents="+a.ENTS+"&emet="+a.EMET+"&ecrm="+a.ECRM,g+=a.ISDMY?"&isdmy="+a.ISDMY:"",a.MSGID&&a.ACCID&&(g+="&msgId="+a.MSGID+"&accId="+a.ACCID),a.Attachment&&a.Attachment!=""&&(g+="&fileId="+a.Attachment),a.RMAttachment&&a.RMAttachment!=""&&(g+="&rmAttachId="+a.RMAttachment),g+=a.LINK?"&eurl="+d:"",g+=a.ETZ!=""?"&etz="+a.ETZ.zcalescape()+"&inetz="+a.IN_ETZ:"",g+=a.ATT?"&att="+a.ATT.zcalescape():"",g+=a.RMVATT?"&rmatt="+a.RMVATT.zcalescape():"",g+="&mty="+zcal.cdata.opt.MT,g+=a.GATT&&a.GATT.length>0?"&gatt="+a.GATT.join(","):"",g+=a.RMVGATT?"&rmgatt="+a.RMVGATT:"",g+=a.USTAT?"&custat="+a.USTAT:"",g+=a.UCMNT?"&cucmt="+a.UCMNT:"",g+=a.SKEY?"&skey="+a.SKEY:"",g+="&mstart="+zcal.mlimit[0].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&mend=",g+=zcal.mlimit[1].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF]),a.NTFY>-1&&(g+="&ntfy="+a.NTFY),a.EID!=""?(a.EID.indexOf("_")!=-1?(g+="&eid="+a.EID.substring(0,a.EID.indexOf("_")),a.TYPE==0?g+="&type="+a.TYPE+"&mode=recurE&ridx="+a.RIDX+"&ekey="+a.EUID:a.TYPE==1?g+="&type="+a.TYPE+"&mode=recurE&ridx="+a.RIDX+"&ekey="+a.EUID:a.TYPE==2&&a.RIDX==0?(ZCL_TEMP_EOBJ.TYPE=1,g+="&mode=edit&ekey="+a.EUID):(a.HASATTACH&&(a.HASATTACH=!1),g+="&type="+a.TYPE+"&mode=recurE&ridx="+a.RIDX+"&ekey="+a.EUID)):g+="&mode=edit&eid="+a.EID+"&ekey="+a.EUID+"&emil="+a.EMIL,g+="&oldCkey="+zcal.$("zcl_oldCkey").value+"&isOthDel="+a.DELRTO,a.HASATTACH&&(g+="&hasAttach="+a.HASATTACH)):(g+="&mode=add",ZCL_TEMP_EOBJ.USTAT=1);var h=a.ALARM;h&&(g+="&isrem=true&remt="+h[0].REMTIME+"&remty="+h[0].REMTYPE+"&actty="+h[0].ACTYPE+"&wrksh="+zcal.cdata.opt.HS);var i=a.REP;i&&(g+="&isrep=true&repf="+i.RFRQ+"&rivl="+i.RIVL+"&rbyon="+i.ROPT+"&rday="+i.RDAY.join(",")+"&towk="+i.RTOWK+"&rdate="+i.RDATE+"&rmon="+i.RMON+"&repc="+i.RCNT+"&until="+(i.RUTL.trim()!=""?ZCL_putDate(i.RUTL):"")),g+="&calmode="+zcal.CALMODE,ZCL_XHR(g,"ZCL_retDET")},ZCL_retDET=function(a){zcal.adStck(new Array("zcl_loading","zcl_mask","zcl_mask1"));var b=ZCL_Evl(1,a.responseText);if(b.status=="success"){ZCL_eClose();var c=zcal.i18n.evtadded;if(zmsuite.isWorkspaceAvailable("zcal_Container")){var d=b.id,e=b.rdats?b.rdats:"",f=b.oid?b.oid:"",g=b.ordats?b.ordats:"",h=b.SKEY,i=b.USTAT,j=i&&i!=""?1:0,k=b.ATTEMAIL,l=b.ETYPE?b.ETYPE:0,m={CNAME:ZCL_TEMP_EOBJ.CNAME,ORG:b.ORG,SD:b.SD?b.SD:ZCL_DFDate(ZCL_TEMP_EOBJ.SD),ED:b.ED?b.ED:ZCL_DFDate(ZCL_TEMP_EOBJ.ED),ST:b.ST?b.ST:ZCL_TEMP_EOBJ.ST,ET:b.ET?b.ET:ZCL_TEMP_EOBJ.ET,SUM:b.SUM,LOC:ZCL_TEMP_EOBJ.LOC,REF:[0,1,j,ZCL_TEMP_EOBJ.TYPE==0?1:0,ZCL_TEMP_EOBJ.ALARM?1:0],RTO:[0,0,ZCL_TEMP_EOBJ.EMET,ZCL_TEMP_EOBJ.ETSK,ZCL_TEMP_EOBJ.ENTS,ZCL_TEMP_EOBJ.ECRM,ZCL_TEMP_EOBJ.EMIL,ZCL_TEMP_EOBJ.LINK==""?0:1],ADAY:ZCL_TEMP_EOBJ.ADAY,EPERM:ZCL_TEMP_EOBJ.EPERM,DPERM:ZCL_TEMP_EOBJ.DPERM,EC:ZCL_TEMP_EOBJ.EC,EUID:b.euid,ISEXP:b.ISEXP?b.ISEXP:0,ETYPE:l,HASATTACH:b.HASATTACH?b.HASATTACH:!1};c=m.ETYPE==3?zcal.i18n.taskadded:zcal.i18n.evtadded,ZCL_TEMP_EOBJ.ETZ&&(m.ETZ=ZCL_TEMP_EOBJ.ETZ,ZCL_TEMP_EOBJ.IN_ETZ?m.IN_ETZ=1:m.IN_ETZ=0),k&&k!=""&&(m.ATTEMAIL=k),h&&h!=""&&(m.USTAT=i,m.SKEY=h);if(ZCL_TEMP_EOBJ.REP){var n={};n.RPDT=ZCL_DFDate(ZCL_TEMP_EOBJ.SD),m.REP=n}b.APL_REQ&&b.APL_REQ==1&&(m.APL_REQ=b.APL_REQ);var o=ZCL_Evl(1,'{"'+d+'":'+JSON.stringify(m)+"}");m.EID=d;var p=JSON.stringify(m);if(ZCL_TEMP_EOBJ.EID!=""){c=m.ETYPE==3?zcal.i18n.taskedited:zcal.i18n.evtedited;var q=ZCL_TEMP_EOBJ.EID.indexOf("_")!=-1?ZCL_TEMP_EOBJ.EID.substring(0,ZCL_TEMP_EOBJ.EID.indexOf("_")):ZCL_TEMP_EOBJ.EID,r=zcalEvents.remEve(q,!1,!0);r||(r=zcalEvents.remEve(q,!0,!0)),o[d].REF[3]=r[q].REF[3]==1?1:o[d].REF[3],g!=""&&ZCL_insertRepEvents(r,g,q)}e!=""?ZCL_insertRepEvents(o,e,d):(ZCL_TEMP_EOBJ&&ZCL_TEMP_EOBJ.TYPE==0&&delete o[d].REP,ZCL_insertEvent(o,d)),zcal.view==4&&(e!=""||g!=""?zcalAgenda.dispEvents():ZCL_TEMP_EOBJ.EID!=""?zcalAgenda.edit(p):zcalAgenda.add(p)),zcalView.plotEvents()}else ZCL_TEMP_EOBJ.ACCID!=""&&ZCL_TEMP_EOBJ.MSGID!=""&&ZCL_TEMP_EOBJ.successCallbk(b.msgId,b.id);ZCL_enableCal(ZCL_TEMP_EOBJ.CNAME),zmUtil.succErrMsg("s",c)}else b.status=="error"?(zmUtil.succErrMsg("e",zcal.i18n[b.error]),ZCL_clrStck()):(zmUtil.succErrMsg("e",b.status),ZCL_clrStck())},ZCL_insertEvent=function(a,b){var c=a[b].SD,d=a[b].ED,e=a[b].ET,f=zcal.findDuration(a[b]);a[b].DUR=f;if(c!=d&&f>=864e5||a[b].ADAY==1)zcalMulti.appEvent(a,c);else{zcalEvents.appEvent(a,c);if(c!=d&&e!="0000"){var g=ZCL_parseDateStr(d),h=g.getTime(),i=parseInt(e.substring(0,2),10),j=parseInt(e.substring(2,4),10);g.setHours(i,j,0,0);var k=g.getTime();zcalEvents.appEvent(a,d)}}},ZCL_insertRepEvents=function(a,b,c){var d=zcal.findDuration(a[c]);for(var e in b){var f=b[e].SD,g=b[e].ED,h=b[e].ST,i=b[e].ET;a[c].SD=f,a[c].ED=g,a[c].ST=h,a[c].ET=i,a[c].RIDX=b[e].RIDX,b[e].REPINST!=undefined&&(a[c].REPINST=b[e].REPINST);if(f!=g&&d>=864e5||a[c].ADAY==1)zcalMulti.appEvent(a,f);else{zcalEvents.appEvent(a,f);if(f!=g&&a[c].ET!="0000"){var j=ZCL_parseDateStr(g),k=j.getTime(),l=parseInt(a[c].ET.substring(0,2),10),m=parseInt(a[c].ET.substring(2,4),10);j.setHours(l,m,0,0);var n=j.getTime();zcalEvents.appEvent(a,g)}}}},zcal.findDuration=function(a){var b=ZCL_parseDateStr(a.SD),c=parseInt(a.ST.substring(0,2),10),d=parseInt(a.ST.substring(2,4),10);b.setHours(c,d,0,0);var e=ZCL_parseDateStr(a.ED);return c=parseInt(a.ET.substring(0,2),10),d=parseInt(a.ET.substring(2,4),10),e.setHours(c,d,0,0),e.getTime()-b.getTime()},zcal.eveDetail=function(a,b,c,d){var b=window.event?window.event:b;zcal.setQuickViewDiv(),document.addEventListener("mousedown",ZCL_mdownClr,!1),document.addEventListener("keydown",zcal.keyCtrl,!1),zcal.CAStck(["zcl_qview"]);var e=a.indexOf("_")!=-1?a.substring(0,a.indexOf("_")):a,f=d[0],g=d[2],h=d[1],i=d[3],j=zcalEvents.getEve(e,!1,f);j||(j=zcalEvents.getEve(e,!0,f));var k=$("#zcl_qview"),l=d[6],m=d[8],n="",o="",p=ZCL_getHTML(j[e].SUM),q={calId:j[e].CNAME,ekey:j[e].EUID,rel:a,ridx:d[7]&&d[7]!="undefined"?d[7]:undefined,rbrkdate:d[9]&&d[9]!="undefined"?d[9]:undefined};p=p==""?"NO SUBJECT":p,n+='<li class="zcl_table">',j[e].ETYPE==1?(n+='<ul class="zcl_bday">',n+=j[e].CPHOTO&&j[e].CPHOTO!=""?'<li><img src="'+j[e].CPHOTO+'" class="zcl_cphoto" id="zcl_cphoto" alt="Contact Photo"/></li>':"",o+=j[e].CEMAIL&&j[e].CEMAIL!=""?'<span class="zcl_greymr">'+j[e].CEMAIL+"</span>":""):n+="<ul>",c=a.indexOf("_")!=-1?a.substring(a.indexOf("_")+1,a.length):c;var r=ZCL_parseDateStr(c),s=f?zcalMulti.retdate(c,ZCL_daysBetween(f,g)):r,t=r.dateBy(zcal.QEDITFMT);j[e].ADAY==1?t+=f!=g?" - "+s.dateBy(zcal.QEDITFMT):"":(t+=" "+ZCL_timeInUFormat(h),t+=f!=g?" - "+s.dateBy(zcal.QEDITFMT)+" ":" - ",t+=ZCL_timeInUFormat(i)+(j[e].IN_ETZ&&j[e].IN_ETZ==1&&j[e].ETZ&&j[e].ETZ!=""?" ("+j[e].ETZ+")":"")),n+='<li><div class="zcl_frmttcp">'+p+o+"</div><p>"+(j[e].LOC&&j[e].LOC!=""?ZCL_replaceString(zcal.i18n.timeAndloc,[t,ZCL_getHTML(j[e].LOC)]):t)+"</p></li>",n+="</ul>";if(j[e].USTAT!=null){var u=j[e].USTAT,v=[zcal.i18n.pending,zcal.i18n.yes,zcal.i18n.no,zcal.i18n.maybe];n+='<ul><li><div class="zcl_frmtcp">Status';if(j[e].ISEXP==1){if(u=="1"||u=="2"||u=="3")n+=" : <u>"+v[u]+"</u></div>"}else{var w="";for(var x=1;x<4;x++)w+="<li "+(u==x?'class="zcl_sl"':"")+" data-ustatus="+x+">"+v[x]+"</li>";n+='</div><ul class="zcl_qvsup" data-marker="statusUpdate" data-skey="'+j[e].SKEY+'">'+w+"</ul>"}n+="</li></ul>"}if(j[e].RTO&&zcal.cdata.calLst[j[e].CNAME]&&j[e].EPERM==2){var y="",z,A,B=ZCL_getOthSrv();z=B[0].split(","),A=B[1].split(","),z.push("lnk:links"),A.push("7");var C=j[e].RTO;q.rto=j[e].RTO.toString();for(var D=0;D<z.length;D++){var E=z[D].split(":")[0],F=z[D].split(":")[1];C[A[D]]==1&&(y+='<li data-service="e'+E+'" data-marker="eventRTO"><i class="msi-'+F+'" title="'+zcal.i18n["eass_"+E]+'" alt="'+zcal.i18n["eass_"+E]+'"></i></li>')}y!=""&&(n+='<ul><li><ul class="zcl_qvassc">'+y+"</ul></li></ul>")}n+='<ul id="zcl_qdesc" style="display:none"></ul></li>',n+='<li><div class="zcl_table"><ul><li><ul class="zcl_qvnv">';var G="";if(l!="0"||m!="0")G+='<li data-marker="eventView">'+zcal.i18n.view+"</li>",G+=l=="2"?'<li><div class="zcl_SDot"></div></li><li data-marker="eventEdit">'+zcal.i18n.edit+"</li>":"",G+=m!="0"?'<li><div class="zcl_SDot"></div></li><li data-marker="eventDelete">'+(m=="2"?zcal.i18n.del:zcal.i18n.removeme)+"</li>":"";G+=G!=""?'<li><div class="zcl_SDot"></div></li>':"",n+=G+'<li onmousedown="ZCL_clrStck()">'+zcal.i18n.cancel+"</li>",n+='</ul></li><li style="width: 50px;text-align: right;">',(l!="0"||m!="0")&&j[e].USTAT!=null&&(n+='<span style="margin-right:16px" data-marker="eventSend" class="SC_ttip" data-tooltip="Send"><i class="msi-send"></i></span>'),n+='<span data-marker="startChat" class="SC_ttip" data-tooltip="StartChat"><i class="msi-cliq"></i></span>',n+="</ul></li></ul></div></li>",k.css({left:"-1000px"}),k.html(n);var H=k.find("[data-marker=eventView]"),I=k.find("[data-marker=eventEdit]"),J=k.find("[data-marker=eventDelete]"),K=k.find("[data-marker=statusUpdate]"),L=k.find("[data-marker=eventRTO]"),M=k.find("[data-marker=eventSend]"),N=k.find("[data-marker=startChat]");H.length&&(H.removeAttr("data-marker"),H.off("mousedown").on("mousedown",{eobj:q},function(a){ZCL_REPINST=a.data.eobj.rbrkdate,ZCL_TRIDX=a.data.eobj.ridx,ZCL_Dview(a.data.eobj.rel,a,a.data.eobj.calId,a.data.eobj.ekey)})),I.length&&(I.removeAttr("data-marker"),I.off("mousedown").on("mousedown",{eobj:q},function(a){ZCL_REPINST=a.data.eobj.rbrkdate,ZCL_TRIDX=a.data.eobj.ridx,ZCL_Dedit(a.data.eobj.rel,a,a.data.eobj.calId,a.data.eobj.ekey)})),J.length&&(J.removeAttr("data-marker"),J.off("mousedown").on("mousedown",{eobj:q},function(a){ZCL_Qdel(a.data.eobj)})),K.length&&(K.removeAttr("data-marker"),K.off("mousedown").on("mousedown",{eobj:q,eventId:e},function(a){var b=$(this),c=zcal.NN6?a.target:event.srcElement,d=b.data("skey"),e=$(c).data("ustatus"),f=a.data.eventId;eKey=a.data.eobj.ekey,calId=a.data.eobj.calId,ZCL_Estatup(e,d,f,eKey,calId)})),L.length&&(L.removeAttr("data-marker"),L.off("mousedown").on("mousedown",function(a){var b=$(this);ZCL_callService(b.data("service"),e,a)})),M.length&&(M.removeAttr("data-marker"),M.off("mousedown").on("mousedown",{eobj:q},function(a){ZCL_eveInfo(a.data.eobj.rel,a,a.data.eobj.calId,a.data.eobj.ekey,"send")})),N.length&&(N.removeAttr("data-marker"),N.off("mousedown").on("mousedown",{eobj:q},function(a){ZCL_eveInfo(a.data.eobj.rel,a,a.data.eobj.calId,a.data.eobj.ekey,"chat")})),k.show(),ZCL_MouseXY(b);var D=document.body.offsetWidth>zcalMX+k[0].offsetWidth+20?zcalMX:zcalMX-k[0].offsetWidth,O=document.body.offsetHeight>zcalMY+k[0].offsetHeight+97?zcalMY:zcalMY-k[0].offsetHeight;k.css({top:O+"px",left:D+"px"}),ZCL_reqEveDesc(a,b,j[e].CNAME,j[e].EUID),ZCL_stopEvents(b)},ZCL_getOthSrv=function(){var a="",b="";return zcal.ZCRM!=""&&zcal.isCRMUser&&(b+=b!=""?",crm:crm":"crm:crm",a+=a!=""?",5":"5"),zcal.ZMET!=""&&(b+=b!=""?",met:meeting":"met:meeting",a+=a!=""?",2":"2"),zcal.ZTSK!=""&&zcal.IsTaskUser&&(b+=b!=""?",tsk:task":"tsk:task",a+=a!=""?",3":"3"),zcal.ZNTS!=""&&zcal.IsTaskUser&&(b+=b!=""?",nts:notes":"nts:notes",a+=a!=""?",4":"4"),zcal.ZMIL!=""&&(b+=b!=""?",mil:mail":"mil:mail",a+=a!=""?",6":"6"),[b,a]},ZCL_array_unique=function(a){var b=new Array;for(var c in a)ZCL_in_array(a[c],b)||b.push(a[c]);return b},ZCL_in_array=function(a,b){for(var c in b)if(b[c]==a)return!0;return!1},ZCL_Estatup=function(a,b,c,d,e){if(!zcal.ISRO){var f=zcal.getCalObj(e),g=f[9];ZCL_XHR("/cal/cuStat.do?eid="+c+"&custat="+a+"&skey="+b+"&ckey="+g+"&ekey="+d+"&calmode="+zcal.CALMODE,function(a){var b=ZCL_Evl(1,a.responseText);ZCL_updateSts(c,b.STS),zcalView.plotEvents()})}},ZCL_updateSts=function(a,b){if(b&&(b=="1"||b=="2"||b=="3")){var c=zcalEvents.remEve(a,!1,!1),d=c?zcal.cdata.evelst:zcal.cdata.eveAll;for(var e in d)for(var f=0;f<d[e].length;f++){var g=d[e][f];for(var h in g)h==a&&(g[h].USTAT=b)}zmUtil.succErrMsg("s",zcal.i18n.statusupdated)}},ZCL_callService=function(a,b,c){ZCL_clrStck(),ZCL_SERVICE=a,a=="ecrm"||a=="emet"||a=="elnk"||a=="emil"?(window.open(location.protocol+"//"+zcal.ZCAL+"/cal/nxtPag.do?sname="+a+"&evid="+b,"_blank"),ZCL_stopEvents(c)):(ZCL_SERVICE=a,ZCL_XHR("/cal/viewOth.do?sname="+a+"&evid="+b,"ZCL_serviceRes"))},ZCL_CheckUserInOtherServices=function(){ZCL_isTaskUser(),ZCL_isCRMUser()},ZCL_isTaskUser=function(){zcal.ZTSK!=""&&ZCL_uXHR("/cal/getPortal.do?mode=task-sync",function(a){var b=ZCL_Evl(1,a.getElementsByTagName("obj")[0].firstChild.nodeValue);b.status==="success"&&(zcal.IsTaskUser=b.isMailSuiteUser||!1)})},ZCL_isCRMUser=function(){zcal.ZCRM!=""&&ZCL_uXHR("/cal/getPortal.do?mode=crm-sync",function(a){if(a!=undefined){var b=ZCL_Evl(1,a.getElementsByTagName("obj")[0].firstChild.nodeValue);b.status==="success"&&(zcal.isCRMUser=!0)}})},ZCL_setWorkDays=function(){var a=zcal.cdata.opt.WS,b=zcal.cdata.opt.WE,c=[];if(a>b){while(a<=6)c.push(a),a++;a=0}for(var d=a;d<=b;d++)c.push(d);return c},ZCL_getTZ=function(a){ZCL_uXHR("/cal/timez.do",function(b){zcal.timezones=ZCL_Evl(1,b.responseText),a.callback&&a.callback()})},ZCL_shCalAdd=function(){zcal.refreshTimer&&window.clearTimeout(zcal.refreshTimer),zcal.refreshMode=="UPDATE CALENDAR WITH EVENTS"?ZCL_XHR("/cal/getOtherCal.do",function(a){var b=ZCL_Evl(1,a.responseText);zcal.cdata.calOLst=b.clst,zcal.cdata.calOUids=b.Uids,zcal.cdata.calGLst=b.gclst,zcal.cdata.calByGrp=b.gclstbygrp,ZCL_setGrpCal(b.gclst),ZCL_updateAppCalList(b.aclst),ZCL_setCalendars(),zcalEvents.loadMonthData(),zcal.view==4&&zcalAgenda.dispEvents()}):zcal.refreshMode=="UPDATE EVENTS ONLY"&&(zcalEvents.loadMonthData(),zcal.view==4&&zcalAgenda.dispEvents()),zcal.refreshTimer=null,zcal.refreshMode=""},ZCL_updateDeletedEvents=function(a){a.length>0&&(ZCL_removeDeletedEvents(a),ZCL_updateEvents())},ZCL_removeDeletedEvents=function(a){if(a.length>0){var b=zcal.cdata.eveAll,c=zcal.cdata.evelst,d="";for(var e in b)for(var f=0;f<b[e].length;f++){var g=b[e][f];for(var h in g){var i=a.indexOf(h);i!=-1&&(b[e].splice(f--,1),d+=d!=""?","+e:e)}}if(d!=""){var j=d.split(","),k;for(var e=0;e<j.length;e++)k=j[e],b[k]&&b[k].length==0&&delete b[k]}d="";for(var e in c)for(var f=0;f<c[e].length;f++){var g=c[e][f];for(var h in g){var i=a.indexOf(h);i!=-1&&(c[e].splice(f--,1),d+=d!=""?","+e:e)}}if(d!=""){var j=d.split(","),k;for(var e=0;e<j.length;e++)k=j[e],c[k]&&c[k].length==0&&delete c[k]}}},ZCL_fetchRepeatWithChild=function(a){ZCL_XHR("/cal/getRepWithChild.do?eid="+a+"&mstart="+zcal.mlimit[0].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&mend="+zcal.mlimit[1].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&dateformat="+zcal.DFORMAT[zcal.cdata.opt.DF],function(a){var b=ZCL_Evl(1,a.responseText);ZCL_updateRepeatEvent(b)})},ZCL_updateRepeatEvent=function(a){if(a.obj.eobj){var b=a.obj.eobj,c=a.obj.eids;ZCL_removeDeletedEvents(c);for(var d in b)for(var e=0;e<b[d].length;e++){var f=b[d][e];for(var g in f)ZCL_insertEvent(f,g)}ZCL_updateEvents()}},ZCL_updateEventsForSharedCal=function(a,b){var c,d=ZCL_getCalIdFromCalKey(b);d!=undefined&&(c=zcal.getCalObj(d),c[8]==1&&ZCL_XHR("/cal/updShareCalEve.do?eid="+a+"&cKey="+b+"&mstart="+zcal.mlimit[0].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&mend="+zcal.mlimit[1].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&dateformat="+zcal.DFORMAT[zcal.cdata.opt.DF],function(a){var b=ZCL_Evl(1,a.responseText);if(b.obj.eobj){var e=b.obj.eobj,f=b.obj.euids,g=b.remtype;ZCL_removeDeletedEventsUsingUids(f,d);for(var h in e)for(var i=0;i<e[h].length;i++){var j=e[h][i];for(var k in j)j[k].CNAME=d,g[j[k].EUID]?j[k].REF[4]=g[j[k].EUID]:j[k].REF[4]=c[6].ACTYPE?1:0,ZCL_insertEvent(j,k)}ZCL_updateEvents()}}))},ZCL_updateDeletedEventsForSharedCal=function(a){var b=a.ekey.split(","),c=a.ckey,d;d=ZCL_getCalIdFromCalKey(c),ZCL_removeDeletedEventsUsingUids(b,d),ZCL_updateEvents()},ZCL_removeDeletedEventsUsingUids=function(a,b){if(a.length>0){var c=zcal.cdata.eveAll,d=zcal.cdata.evelst,e="";for(var f in c)for(var g=0;g<c[f].length;g++){var h=c[f][g];for(var i in h){var j=h[i].EUID,k=h[i].CNAME,l=a.indexOf(j);l!=-1&&k==calid&&(c[f].splice(g--,1),e+=e!=""?","+f:f)}}if(e!=""){var m=e.split(",");for(var f=0;f<m.length;f++){var n=m[f];c[n]&&c[n].length==0&&delete c[n]}}e="";for(var f in d)for(var g=0;g<d[f].length;g++){var h=d[f][g];for(var i in h){var j=h[i].EUID,k=h[i].CNAME,l=a.indexOf(j);l!=-1&&k==b&&(d[f].splice(g--,1),e+=e!=""?","+f:f)}}if(e!=""){var m=e.split(",");for(var f=0;f<m.length;f++){var n=m[f];d[n]&&d[n].length==0&&delete d[n]}}}},ZCL_getCalIdFromCalKey=function(a){var b;for(var c in zcal.cdata.calLst){b=zcal.cdata.calLst[c];if(b[9]==a)return c}for(var c in zcal.cdata.calALst){b=zcal.cdata.calALst[c];if(b[9]==a)return c}for(var c in zcal.cdata.calGLst){b=zcal.cdata.calGLst[k];if(b[9]==a)return c}for(var d in zcal.cdata.calOLst){b=zcal.cdata.calOLst[d];if(b[9]==ckey)return c}},ZCL_updateAppCalList=function(){var a=zcal.cdata.calALst,b;zcal.appChild={},zcal.appCount={};for(var c in a)b=a[c],zcal.appCount[c]={c:"0",p:"-1"},b[14]=="crm"&&(zcal.appChild[c]={CH:zcalCRM.getCRMCalChild(b[1],c)})},ZCL_updateGroupCalList=function(){zcal.ZCAL_MULTICAL_4_GRP&&zcal.CALMODE==0?zcal.gcal=zcalInit.ZCL_setGrpCal():zcal.gcal=zcalInit.formatCalData(zcal.cdata.calGLst,zcal.cdata.gcalOdrArr)},ZCL_getSubGrpLst=function(){ZCL_XHR("/cal/subCal.do?mode=sub-strmgrp","ZCL_retDefSubCAL")},ZCL_retDefSubCAL=function(a){ZCL_clrStck();if(a.status==200){var b=ZCL_Evl(1,a.responseText),c=b.mode,d=b.id?b.id:null,e=b.status,f=b;b.streamGrpLst&&(ZCL_STREAMGROUPLIST=b.streamGrpLst),zcal.cdata.calGLst=e=="success"&&f.gclst!=undefined?f.gclst:zcal.cdata.calGLst,e=="success"&&f.gclst!=undefined&&(zcalEvents.loadMonthData(),ZCL_setCalendars())}else ZCL_slideObj.status(ZCL_ALERTS.errmsg)},zcal.qObj={},zcal.setQuickViewDiv=function(a){zcal.CAStck(["zcl_qview"]);var b=$("#zcl_qview");b.length||(b=$('<ul id="zcl_qview" class="zcl_qview" style="display:none"></div>'),$("body").append(b)),b.removeAttr("class").addClass(a&&a.class||"zcl_qview")},zcal.setQuickCreateDiv=function(a){var b,c=new Date(zcal.cdate),d=zcal.timeformat[zcal.cdata.opt.TF],e=c.getHours(),f=c.getMinutes(),g,h,i;g=e*2+(f>30?2:1),g=g>46?46:g,h=zcal.TTT[g].getTimeBy(d),i=zcal.TTT[g+1].getTimeBy(d),ZCL_$("zcl_qbk")||document.body.appendChild($("<ul id='zcl_qbk' class='zcl_qbook'>")[0]),b=$("#zcl_qbk"),b.empty();var j='<li class="zcl_qbtitl" id="zcl_qbkTop">'+(zcal.view==3?zcal.qObj.SD==zcal.qObj.ED?'<input type="text" placeholder="'+zcal.i18n.eventplaceholder+'" class="SC_tiput zcl_Qbk" id="zcl_qbkttl"/>':'<input type="text" placeholder="'+zcal.i18n.alldayeventplaceholder+'" class="SC_tiput zcl_Qbk" id="zcl_qbkttl"/>':'<input type="text" placeholder="'+zcal.i18n.eventtitle+'" class="SC_tiput zcl_Qbk" id="zcl_qbkttl"/>')+'<input type="text" placeholder="'+zcal.i18n.loc+'" class="SC_tiput zcl_Qloc" id="zcl_qbkloc"/>'+"</li>"+'<li class="zcl_qbcnt" id="zcl_qbkBot">'+'<ul class="zcl_frmrw">'+'<li class="zcl_frmtt">'+zcal.i18n.calendar+"</li>"+"<li>"+'<div class="SC_select">'+'<input rel="'+zcal.cdata.defcal+'" id="zcl_qbkcal" value="'+zcal.cdata.calLst[zcal.cdata.defcal][0]+'" style="width:160px">'+"</div>"+"</li>"+"</ul>"+"<ul>"+'<li class="zcl_cr_btn">'+zcal.i18n.create+"</li>"+'<li class="zcl_mr_lk zcl_curpt">'+zcal.i18n.moredet+" "+"</li>"+"</ul>"+"</li>"+'<input type="hidden" value="'+ZCL_putDate(zcal.qObj.SD)+'" id="zcl_qbksd"/>'+'<input type="hidden" value="'+ZCL_putDate(zcal.qObj.ED)+'" id="zcl_qbked"/>'+'<a class="zcl_qbl" id="zcl_qbkA"></a>';b.html(j);var k=b.find("#zcl_qbkttl"),l=b.find(".zcl_cr_btn"),m=b.find(".zcl_mr_lk");k.off("keydown").on("keydown",function(a){var b=a.which||a.keyCode;b==13&&zcal.quickCreate()}),l.off("click").on("click",function(a){zcal.quickCreate()}),m.off("click").on("click",function(a){ZCL_QDetail()}),b.find("#zcl_qbkcal").off("click").on("click",function(b){var c=ZCL_getCalArr(null,a),d={},e=$(this),f;d.parentDOM=e.parent(),d.displayAs="dropdown",d.parWidth=!0,d.onSelect=function(a,b){zcal.setCalVal(e,a,b),f.hide()},d.dataCallback=function(){return c},f=zmUtil.createFLComp("generic",d),f.elem.css("z-index","999"),f.show()})},zcal.setCalVal=function(a,b,c){a.val(c.display_text),a.attr("rel",b)},ZCL_updateEndTime=function(){},zcal.dquickBook=function(a,b,c,d){var e=!0,f=zcal._2digit((a-a%zcalView.hourSlot)/zcalView.hourSlot),g=zcal._2digit(a%zcalView.hourSlot*zcalView.slotDuration),h=zcal._2digit((b-b%zcalView.hourSlot)/zcalView.hourSlot),i=zcal._2digit(b%zcalView.hourSlot*zcalView.slotDuration),j=f+g,k=h+i,l=zcal.getWeekStart(),m=zcal.today.clone();zcal.view!=0&&m.setDate(m.getDate()-m.getDay()+l),m.setDate(m.getDate()+c);var n=m.dateBy("yyyyMMdd"),o=n;if(k=="2400"){var p=m.clone();p.setDate(p.getDate()+1),o=p.dateBy("yyyyMMdd"),k="0000"}zcal.openQBook({SD:n,ST:j,ED:o,ET:k,ADAY:0,ORG:zcal.userid},m,m,e,d)},zcal.openQBook=function(a,b,c,d,e){zcal.qObj=a,zcal.OBJTEMP=a,zcal.setQuickCreateDiv(d);var f=ZCL_$("zcl_qbk"),g;f.style.display="",g=f.offsetHeight,zcal.CAStck(["zcl_qbk"]),document.addEventListener("mousedown",ZCL_mdownClr,!1),document.addEventListener("keydown",zcal.keyCtrl,!1);if(zcal.view==3){for(var h=0;h<ZCL_NOB;h++)zcal.stck.push("zcl_lay"+h);var i=ZCL_daysBetween(zcal.mlimit[0].dateBy("yyyyMMdd"),c.dateBy("yyyyMMdd")),j=zcal.$("zcl_lay"+i),k=ZCL_findPosXX(j),l=ZCL_findPosYY(j),m=j.offsetHeight,n=j.offsetWidth;k>f.offsetWidth?(f.style.left=k+n/2-310+"px",document.body.offsetHeight-l<g+m/2?(f.style.top=l+m/2-g+"px",zcal.$("zcl_qbkA").className="zcl_qbr"):(f.style.top=l+m/2+"px",zcal.$("zcl_qbkA").className="zcl_qtr")):(f.style.left=k+n/2+"px",document.body.offsetHeight-l<g+m/2?(f.style.top=l+m/2-g+"px",zcal.$("zcl_qbkA").className="zcl_qbl"):(f.style.top=l+m/2+"px",zcal.$("zcl_qbkA").className="zcl_qtl"))}else{var o=$(zcal.calCenter.listElem);zcal.stck.push("zcl_lay");var j=zcal.$("zcl_lay"),l=ZCL_findPosYY(zcal.$("zcl_encloser"))+j.offsetTop-zcal.$("zcl_encloser").scrollTop,k=j.offsetLeft,m=j.offsetHeight,n=j.offsetWidth,p=l+m-g+13;f.style.top=p+"px",k>f.offsetWidth?(zcal.$("zcl_qbkA").className=l<p?"zcl_qtr":"zcl_qbr",f.style.left=zcal.gridleft+k-f.offsetWidth+15+"px"):(zcal.$("zcl_qbkA").className=l<p?"zcl_qtl":"zcl_qbl",f.style.left=zcal.gridleft+k+n/2+"px")}zcal.$("zcl_qbkttl").focus(),ZCL_stopEvents(e)},zcal.openAQBook=function(a,b,c){var d=!1;zcal.qObj=a,zcal.OBJTEMP=a,zcal.setQuickCreateDiv(d);var e=ZCL_$("zcl_qbk"),f;e.style.display="",f=e.offsetHeight,zcal.CAStck(["zcl_qbk"]),document.addEventListener("mousedown",ZCL_mdownClr,!1),document.addEventListener("keydown",zcal.keyCtrl,!1);var g=zcal.NN6?c.clientY:event.clientY,h=zcal.NN6?c.clientX:event.clientX;h>e.offsetWidth?(zcal.$("zcl_qbkA").className="zcl_qtr",e.style.left=h-e.offsetWidth-15+"px"):(zcal.$("zcl_qbkA").className="zcl_qtl",e.style.left=h+15+"px"),e.style.top=g-30+"px",zcal.$("zcl_qbkttl").focus(),ZCL_stopEvents(c)},zcal.mquickBook=function(a,b,c){var d=!1,e=zcal.mlimit[0].clone(),f=e.clone();e.setDate(e.getDate()+(a>b?b:a)),f.setDate(f.getDate()+(a>b?a:b)),zcal.openQBook({SD:e.dateBy("yyyyMMdd"),ST:0,ED:f.dateBy("yyyyMMdd"),ET:0,ADAY:1,ORG:zcal.userid},e,f,d,c)},zcal.quickCreate=function(a){var b=$("#zcl_qbk").find("#zcl_qbkttl"),c=$("#zcl_qbk").find("#zcl_qbkloc"),d=$("#zcl_qbk").find("#zcl_qbkcal");if(b.val().trim()=="")return zmUtil.succErrMsg("e",zcal.i18n.plenttle),ZCL_$("zcl_qbkttl").focus(),!1;if(!zcal.validate(b.val()))return zmUtil.succErrMsg("e",zcal.i18n.spchevetle),ZCL_$("zcl_qbkttl").focus(),!1;var e;if(zcal.view==3){e=ZCL_nlp(b.val().trim(),0);var f=e.ST,g=e.ET;if(zcal.qObj.SD==zcal.qObj.ED)if(!f&&!g)zcal.qObj.ADAY=1;else{if(g.match(/(24)(\d\d)?/)){var h=g.match(/(24)(\d\d)?/);g=h[1]?"00"+(h[2]?h[2]:"00"):g}zcal.qObj.ST=f?ZCL_TimetoNo(f):"0000",zcal.qObj.ET=g?ZCL_TimetoNo(g):"0000";if(zcal.qObj.ST>zcal.qObj.ET&&zcal.qObj.SD==zcal.qObj.ED){var i=parseInt(zcal.qObj.ED%100)+parseInt(1),j=parseInt(zcal.qObj.ED/100);zcal.qObj.ED=j+""+i}zcal.qObj.ADAY=0}}zcal.qObj.SUM=zcal.view==3?e.SUM:b.val().trim(),zcal.qObj.CNAME=d[0].getAttribute("rel"),zcal.qObj.LOC=c.val().trim(),zcalQAdd.add(zcal.qObj),ZCL_clrStck()},zcal.shwLst=function(a){var b=a.parentNode.getElementsByTagName("ul")[0];b.style.display="block"},zcal.selVal=function(a,b){var c=b.parentNode,d=c.parentNode,e=d.getElementsByTagName("input");e[0].value=b.innerHTML,e[1].value=a,c.style.display="none"};var zcalQAdd=function(){var a={adObj:null,add:function(a){this.adObj=a;var b=zcal.getCalObj(a.CNAME);a.SUM=a.SUM.replace(zcal.REG,"");var c="/cal/quick.do?mode=a&sd="+zcal.putDate(a.SD)+"&ed="+zcal.putDate(a.ED)+"&st="+a.ST+"&et="+a.ET+"&all="+a.ADAY+"&sum="+(a.SUM==""?"NO SUBJECT":a.SUM).zcalescape()+"&loc="+(a.LOC!=""?a.LOC.zcalescape():"")+"&dateformat="+zcal.DFORMAT[zcal.cdata.opt.DF]+"&ckey="+b[9]+"&ctype="+b[5]+"&wrksh="+zcal.cdata.opt.HS+"&calmode="+zcal.CALMODE;if(b[14]=="crm"||b[14]=="recruit"&&(zcal.cdata.calOUids.indexOf("zohoRecruit4_")!=-1||zcal.cdata.opt.GTYPE==1&&zcal.cdata.opt.VERSION=="new")){var d=b[14]=="recruit"?zcalCRM.getRecruitCurrentUser():zcalCRM.getCRMCurrentUser();c+="&ownerId="+d.USERID+"&Event Owner="+d.Name}ZCL_XHR(c,"zcalQAdd.retAdd")},retAdd:function(a){var a=ZCL_Evl(1,a.responseText);if(a.status=="success"){var b=a.id,c=zcal.getCalObj(zcalQAdd.adObj.CNAME),d={CNAME:zcalQAdd.adObj.CNAME,ORG:a.ORG?a.ORG:zcalQAdd.adObj.ORG,RTO:[0,0,0,0,0,0,0,0],SD:a.SD?a.SD:zcalQAdd.adObj.SD,ST:a.ST?a.ST:zcalQAdd.adObj.ST,ED:a.ED?a.ED:zcalQAdd.adObj.ED,ET:a.ET?a.ET:zcalQAdd.adObj.ET,REF:[0,1,0,0,c[6].ACTYPE?1:0],SUM:zcalQAdd.adObj.SUM,LOC:zcalQAdd.adObj.LOC,ADAY:zcalQAdd.adObj.ADAY,EPERM:c[12]>=2?2:c[12]==1?1:0,DPERM:c[12]>=2?2:0,EUID:a.euid?a.euid:"",EC:"-1",APL_REQ:a.APL_REQ&&a.APL_REQ==1?a.APL_REQ:"",ETYPE:a.ETYPE?a.ETYPE:0},e=ZCL_Evl(1,'{"'+b+'":'+JSON.stringify(d)+"}");d.EID=b;var f=JSON.stringify(d);ZCL_insertEvent(e,b),zcal.view==4&&zcalAgenda.add(f),ZCL_enableCal(zcalQAdd.adObj.CNAME),zmUtil.succErrMsg("s",d.ETYPE==3?zcal.i18n.taskadded:zcal.i18n.evtadded),zcalView.plotEvents(),zcalQAdd.adObj=null}else a.error&&a.error.trim()!=""&&zmUtil.succErrMsg("e",zcal.i18n[a.error])},edit:function(a){this.adObj=a;var b=zcal.getCalObj(a.CNAME),c="/cal/quick.do?eid="+a.EID+"&sd="+zcal.putDate(a.SD)+"&ed="+zcal.putDate(a.ED)+"&st="+a.ST+"&et="+a.ET+"&dateformat="+zcal.DFORMAT[zcal.cdata.opt.DF]+"&ckey="+b[9]+"&ekey="+a.EUID+"&ctype="+b[5]+"&wrksh="+zcal.cdata.opt.HS+"&all="+a.ADAY+"&calmode="+zcal.CALMODE;c+=a.SUM?"&sum="+a.SUM:"",c+=a.ETZ?"&etz="+a.ETZ.zcalescape()+(a.IN_ETZ&&a.IN_ETZ==1?"&inetz=true":"&inetz=false"):"",c+="&mstart="+zcal.mlimit[0].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&mend="+zcal.mlimit[1].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF]),c+="&mode="+(a.TY!=null?"recurE&ridx="+a.RIDX+"&type="+a.TY:"e"),ZCL_XHR(c,"zcalQAdd.retEdit")},retEdit:function(a){var b=ZCL_Evl(1,a.responseText);if(b.status!="error"){var c=b.id,d=b.euid?b.euid:"",e=b.rdats?b.rdats:"",f=b.oid?b.oid:"",g=b.ordats?b.ordats:"";if(zcalQAdd.adObj.EID!=""){id=zcalQAdd.adObj.EID;var h=zcalEvents.remEve(id,!1,!0);h||(h=zcalEvents.remEve(id,!0,!0));var i=zcal.findDuration(zcalQAdd.adObj);g!=""&&ZCL_insertRepEvents(h,g,f);var j=zcalQAdd.adObj,k={CNAME:h[id].CNAME,ORG:j.ORG,RTO:h[id].RTO,SD:b.SD?b.SD:j.SD,ST:b.ST?b.ST:j.ST,ED:b.ED?b.ED:j.ED,ET:b.ET?b.ET:j.ET,REF:[0,1,h[id].REF[2],h[id].REF[3],h[id].REF[4]],SUM:h[id].SUM.zcalreplace(),LOC:h[id].LOC?h[id].LOC.zcalreplace():"",DUR:i,ADAY:h[id].ADAY?h[id].ADAY:0,EPERM:h[id].EPERM,DPERM:h[id].DPERM,EUID:b.euid?b.euid:h[id].EUID,EC:b.EC?b.EC:-1,ETYPE:b.ETYPE?b.ETYPE:0,HASATTACH:b.HASATTACH?b.HASATTACH:!1};b.ETZ&&(k.ETZ=b.ETZ,b.IN_ETZ?k.IN_ETZ=b.IN_ETZ:k.IN_ETZ=0),h[id].SKEY&&(k.SKEY=h[id].SKEY,k.USTAT=h[id].USTAT),h[id].ATTEMAIL&&(k.ATTEMAIL=h[id].ATTEMAIL);if(h[id].REP){var l={};l.RPDT=j.SD,k.REP=l}b.APL_REQ&&b.APL_REQ==1&&(k.APL_REQ=b.APL_REQ);var m=ZCL_Evl(1,'{"'+c+'":'+JSON.stringify(k)+"}");k.EID=c,e!=""?ZCL_insertRepEvents(m,e,c):(j.TY=="0"&&(m[c].REF[3]=1,delete m[c].REP),ZCL_insertEvent(m,c));if(zcal.view==4){var n=JSON.stringify(k);g!=""||e!=""?zcalAgenda.dispEvents():zcalAgenda.edit(n)}}zmUtil.succErrMsg("s",k.ETYPE==3?zcal.i18n.taskedited:zcal.i18n.evtedited),zcalView.plotEvents(),zcalQAdd.adObj=null}else zmUtil.succErrMsg("e",zcal.i18n[b.error])},del:function(a,b,c){var d=zcal.delRelTo==1?!0:!1,e=zcal.getCalObj(c),f="/cal/delEve.do?mode=d&eid="+a+"&ekey="+b+"&ckey="+e[9]+"&ctype="+e[5]+"&isOthDel="+d+"&calmode="+zcal.CALMODE+"&ntfy="+ZCL_NTFY_ATT;ZCL_NTFY_ATT=-1,ZCL_XHR(f,"zcalQAdd.retDel")},chkAttAndDel:function(a,b,c,d,e){var f=!1;d&&d==1&&(f=!0),e&&(f=ZCL_isAtt()),f?ZCL_shAttPopForQkDel(a,b,c,e):(zcalQAdd.del(a,b,c),e&&ZCL_EClrStck())},retDel:function(a){var b=ZCL_Evl(1,a.responseText);if(b.status=="success"){var c=b.id,d=0,e=zcalEvents.remEve(c,!1,!0);e||(e=zcalEvents.remEve(c,!0,!0)),e&&(d=e[c].ETYPE,zcal.view==4&&zcalAgenda.del(e,c)),zmUtil.succErrMsg("s",d==3?zcal.i18n.taskdeleted:zcal.i18n.evtdeleted),zcalView.plotEvents()}else b.status=="error"?zmUtil.succErrMsg("e",zcal.i18n[b.error]):zmUtil.succErrMsg("e",b.status)},retRepDel:function(a){var b=ZCL_Evl(1,a.responseText);if(b.status=="success"){var c=b.id,d=b.rdats?b.rdats:"",e=zcalEvents.remEve(c,!1,!0);e||(e=zcalEvents.remEve(c,!0,!0));for(var f in e)d!=""&&ZCL_insertRepEvents(e,d,f);zcal.view==4&&zcalAgenda.del(e,c),zcalView.plotEvents()}}};return a}(),ZCL_MONTHMODE=0,ZCL_MROWHGT=[],zcalMonth=function(){var a=[],b=1,c=[],d=16,e={},f=0,g=function(){var c=a[a.length]=[];for(var d=0;d<b;d++)c[d]=0;return a.length-1},h=function(d,h,m,n){b=m,g();var o=ZCL_parseDateStr(h);c[0]=o,c[1]=zcalMulti.retdate(h,m-1);var p=zcalCRM.getCRMColorCode();for(var q=0;q<m;q++){var r=zcal.cdata.evelst,s,t=new Date;t.setTime(o),t.setDate(t.getDate()+q),s=t.dateBy("yyyyMMdd"),d.all[s]&&d.all[s].length>1&&d.all[s].length<=50&&j(d.all[s]);if(r&&r[s]){d.all[s]||(d.all[s]=[]),r[s].length>1&&r[s].length<=50&&k(r[s],s);for(var u in r[s])for(var v in r[s][u]){var w=r[s][u],x,y;x=w[v].CNAME,cObj=zcal.getCalObj(x),y=cObj&&zcal.disabledcal.indexOf(x)==-1?!0:!1;var z=w[v].ORG;cObj&&cObj[14]=="crm"&&p&&(p[z]?y=p[z][2]==0?!1:!0:p.OTHERS&&(y=p.OTHERS[2]==0?!1:!0)),y&&(s==w[v].SD||s!=w[v].SD&&q==0)&&(zcal.cdata.opt.DDE==1||zcal.cdata.opt.DDE==0&&w[v].USTAT!="2")&&d.all[s].push(w)}}d.all[s]&&d.all[s].length>0&&l(d.all[s],q,s,n);var A=7*n+q,B=ZCL_$("zcl_mbx"+A),C=ZCL_$("zcl_encloser"),D=B.offsetHeight-18,E=0,F=0;F=e[A]?e[A].elements.length:0,f=F>=f?F:f,E=Math.floor(D/17),ZCL_MONTHMODE===1||F<E?E=F:F!=0&&(E=D>=E*17+13?E:E-1,E=E<0?0:E);for(var G=0;G<E;G++)e[A].elements[G].className==="zcl_mallev"?(C.appendChild(e[A].elements[G]),B.appendChild($('<div class="zcl_edmy"/>')[0])):B.appendChild(e[A].elements[G]);if(ZCL_MONTHMODE===0&&F>E){var H=document.createElement("DIV"),I=zcalMulti.toString(e[A].events);H.cday=t.dateBy("MMM dd, yyyy"),H.className="zcl_mmore zcl_lk",H.innerHTML="+"+ZCL_replaceString(zcal.i18n.more,[F-E]),H.earr=ZCL_Evl(1,I),i($(H)),B.appendChild(H)}}var J=ZCL_$("zcl_encloser").children[n],K=J.offsetHeight,L;L=ZCL_MONTHMODE===1?f*17+18+17:K,L=L>=K?L:K,J.style.height=L+"px",ZCL_MROWHGT[n]=L,a=[],e={},f=0},i=function(a){a.off("click").on("click",function(a){ZCL_mthmore(this,a)})},j=function(a){var b,c,d;for(var e=0;e<a.length-1;e++)for(var f=e+1;f<a.length;f++){for(var g in a[e])c=ZCL_parseDateStr(a[e][g].ED);for(var h in a[f])d=ZCL_parseDateStr(a[f][h].ED);d>c&&(b=a[f],a[f]=a[e],a[e]=b)}},k=function(a,b){var c,d,e;for(var f=0;f<a.length-1;f++)for(var g=f+1;g<a.length;g++){var h,i,j,k;h=ZCL_Evl(1,zcalMulti.toString(a[f]));for(var l in h)i=h[l];j=ZCL_Evl(1,zcalMulti.toString(a[g]));for(var m in j)k=j[m];if(i&&k){d=ZCL_parseDateStr(i.ED),e=ZCL_parseDateStr(k.ED);var n=parseInt(i.ST,10),o=parseInt(i.DUR,10);i.SD!=b&&(o=parseInt(n/100,10)*zcal.msec_hour+n%100*zcal.msec_minute,n=0);var p=parseInt(k.ST,10),q=parseInt(k.DUR,10);k.SD!=b&&(q=parseInt(p/100,10)*zcal.msec_hour+p%100*zcal.msec_minute,p=0),e>d?(a[f]=j,a[g]=h):n>p?(a[f]=j,a[g]=h):n==p&&o<q?(a[f]=j,a[g]=h):(a[f]=h,a[g]=j)}}},l=function(a,b,c,d){var e,f,g=7*d+b,h=ZCL_$("zcl_mbx"+g);for(var i=0;i<a.length;i++)e=n(b),f=p(e,b,a[i],c),m(e,g,a[i],f,c,d)},m=function(a,b,d,f,g,h){e[b]=e[b]||{};var i=e[b],j=b%7;i.elements=i.elements||[],i.events=i.events||[];for(var k in d){var l=d[k].SUM;l==""&&(l="NO SUBJECT");var m=ZCL_parseDateStr(d[k].SD),n=ZCL_parseDateStr(d[k].ED),o=d[k].REP?k+"_"+d[k].SD:k,p=ZCL_timeInUFormat(d[k].ST),s=ZCL_getHTML(zcalEvents.tooltip(d[k])),t=zcalEvents.alltime(d[k]),u=zcal.getCalObj(d[k].CNAME),v=u[1].split(":"),w=ZCL_getCalColor(v[0]),x=v[1]==0?"zcl_event zcl_evwh":"zcl_event zcl_evbl";if(d[k].ADAY=="1"||n>m){var y=document.createElement("DIV");y.style.width=f+"px",y.className="zcl_mallev",y.style.top=r(h,a)+"px",y.style.left=q(j)+"px",d[k].EPERM==2?(y.eobj={EID:o,SUM:l,SD:d[k].SD,ST:d[k].ST,ED:d[k].ED,ET:d[k].ET,CCOLOR:w[1],ADAY:d[k].ADAY,SDAY:!0,CNAME:d[k].CNAME,EPERM:d[k].EPERM,RIDX:d[k].RIDX,EUID:d[k].EUID,ORG:d[k].ORG,DPERM:d[k].DPERM,ETZ:d[k].ETZ,IN_ETZ:d[k].IN_ETZ,EC:d[k].EC,REPINST:d[k].REPINST,USTAT:d[k].USTAT},y.onmousedown=function(a){zcalMDrag.dragStart(this,a)}):y.onclick=function(a){zcal.eveDetail(o,a,d[k].SD,[d[k].SD,d[k].ST,d[k].ED,d[k].ET,d[k].EUID,d[k].CNAME,d[k].EPERM,d[k].RIDX,d[k].DPERM,d[k].REPINST])};var z='<div class="zcl_mthev" title="'+s+'" alt="'+s+'">'+'<div class="'+x+'" style="background-color:'+(d[k].EC!=-1?zcal.eventcolor[d[k].EC]:w[1])+";border-color:"+w[0]+'">'+'<ul><li class="zcl_sp"></li><li>'+t+"<span>"+ZCL_getHTML(l)+"</span></li></ul>"+"</div>"+"</div>";y.innerHTML=z,i.elements.splice(a,0,y),i.events.splice(a,0,d);var A=d[k].ED,B=0;A=ZCL_parseDateStr(A),A>=c[1]?B=ZCL_daysBetween(g,c[1].dateBy("yyyyMMdd"))+1:A<c[1]&&(B=ZCL_daysBetween(g,A.dateBy("yyyyMMdd"))+1);for(var C=b+1;C<b+B;C++){e[C]=e[C]||{};var D=e[C],E;D.elements=D.elements||[],D.events=D.events||[],E=document.createElement("DIV"),E.className="zcl_edmy",D.elements.splice(a,0,E),D.events.splice(a,0,d)}}else{var F=document.createElement("DIV");F.className="zcl_mevent",d[k].EPERM==2?(F.eobj={EID:o,SUM:l,SD:d[k].SD,ST:d[k].ST,ED:d[k].ED,ET:d[k].ET,CCOLOR:w[0],ADAY:d[k].ADAY,SDAY:!1,CNAME:d[k].CNAME,RIDX:d[k].RIDX,EUID:d[k].EUID,ORG:d[k].ORG,EPERM:d[k].EPERM,DPERM:d[k].DPERM,ETZ:d[k].ETZ,IN_ETZ:d[k].IN_ETZ,REPINST:d[k].REPINST,USTAT:d[k].USTAT},F.onmousedown=function(a){zcalMDrag.dragStart(this,a)}):F.onclick=function(a){zcal.eveDetail(o,a,d[k].SD,[d[k].SD,d[k].ST,d[k].ED,d[k].ET,d[k].EUID,d[k].CNAME,d[k].EPERM,d[k].RIDX,d[k].DPERM,d[k].REPINST])},F.innerHTML='<div title="'+s+'" alt="'+s+'">'+'<em class="zcl_st" style="color:'+w[0]+';">'+p+"</em>"+'<span style="color:'+w[0]+';">'+ZCL_getHTML(l)+"</span>","</div>",i.elements.splice(a,0,F),i.events.splice(a,0,d)}}},n=function(b){for(var c=0;c<a.length;c++)if(a[c][b]==0)return c;return g()},o=function(b,c,d){var e=a[b];for(var f=c;f<d+c;f++)e[f]=1},p=function(a,b,d,e){var f="",g="",h=0;for(var i in d)g=d[i].ED;g=ZCL_parseDateStr(g),g>=c[1]?f=ZCL_daysBetween(e,c[1].dateBy("yyyyMMdd"))+1:g<c[1]&&(f=ZCL_daysBetween(e,g.dateBy("yyyyMMdd"))+1),o(a,b,f);for(var j=0;j<f;j++)h+=ZCL_getEleWdt("zcl_mbx"+(b+j));return h-5},q=function(a){var b=0;for(var c=0;c<a;c++)b+=ZCL_getEleWdt("zcl_mbx"+c);return b+1},r=function(a,b){var c=18;for(var d=0;d<a;d++)c+=ZCL_MROWHGT[d];return c+=b*17,c},s={render:h};return s}();zcal.tempObj={},ZCL_mthmore=function(a,b){zcal.setQuickViewDiv({"class":"zclevlst"}),document.addEventListener("mousedown",ZCL_mdownClr,!1),document.addEventListener("keydown",zcal.keyCtrl,!1);var c=a.earr,d=$("#zcl_qview"),e,f;d.empty(),e=$("<li>"+a.cday+'<i class="msi-close SC_frt"></i></li>'),e.find(".msi-close").off("click").on("click",function(){ZCL_clrStck()}),d.append(e),f=$('<li class="zcl_mrevlst"/>');for(var g=0;g<c.length;g++)for(var h in c[g]){var i=ZCL_getCalColor(zcal.getCalObj(c[g][h].CNAME)[1]),j=ZCL_parseDateStr(c[g][h].SD),k=ZCL_parseDateStr(c[g][h].ED),l=c[g][h].REP?h+"_"+c[g][h].SD:h,m="",n=c[g][h].SUM;n==""&&(n="NO SUBJECT"),c[g][h].ADAY&&c[g][h].ADAY=="1"?m+=zcal.i18n.allday:m+=ZCL_timeInUFormat(c[g][h].ST)+" - "+ZCL_timeInUFormat(c[g][h].ET);var o=$('<ul><li><i style="background-color:#95d681;border-color:'+i[0]+'"></i></li><li>'+ZCL_getHTML(n)+"<span>"+m+"</span></li></ul>");c[g][h].EPERM!=0&&c[g][h].ETYPE!=3?bindClickOnEvent(o,{RIDX:c[g][h].RIDX,ID:l,CNAME:c[g][h].CNAME,EUID:c[g][h].EUID}):o.addClass("zcl_dis"),f.append(o)}d.append(f),d.attr({style:"left:-1000px;display:"}),ZCL_MouseXY(b);var g=document.body.offsetWidth>zcalMX+d[0].offsetWidth+20?zcalMX:zcalMX-d[0].offsetWidth,h=document.body.offsetHeight>zcalMY+d[0].offsetHeight+97?zcalMY:zcalMY-d[0].offsetHeight;d.attr({style:"top:"+h+"px;left:"+g+"px"}),ZCL_stopEvents(b)},bindClickOnEvent=function(a,b){a.off("click").on("click",{RIDX:b.RIDX,ID:b.ID,CNAME:b.CNAME,EUID:b.EUID},function(a){ZCL_clrStck(),ZCL_TRIDX=a.data.RIDX,ZCL_editEve(a.data.ID,a,a.data.CNAME,a.data.EUID)})},zcal.clsMEvlst=function(){var a=zcal.$("zcl_mevlst");a.parentNode.removeChild(a)};var zcalDrag=function(){var a=!1,b,c,d,e,f,g,h,i=0,j=0,k=0,l,m=0,n=0,o,p,q,r=function(b,c,d){q=ZCL_$("zcl_lay"),o=ZCL_$("zcl_encloser"),p=o.getBoundingClientRect(),m=p.left,n=m+p.width-zcalInit.scrollWidth(),ZCL_clrStck();var e=b.target||b.srcElement;g=$("#zcl_hContainer").find("ul:first")[0].getBoundingClientRect().height,h=g/2||25,a=!0,d=d*2+(e.tagName=="B"?0:1),i=k=d,j=d+1,l=c,q.style.top=d*h+"px",q.style.left=u(c)+"px",q.style.width=ZCL_getEleWdt(e)+"px",q.style.height=h+"px",q.style.display="",document.onmousemove=s,document.onmouseup=t},s=function(b){if(a){var c=q.offsetTop,d,e;e=(zcal.NN6?b.clientY:event.clientY)-p.top+o.scrollTop,d=zcal.NN6?b.clientX:event.clientX;if(!(d>m&&d<n))return!1;var f=Math.floor(e/h);f>=0&&f<=47&&(f==k?(q.style.height=h+"px",q.style.top=f*h+"px",i=f,j=f+1):f>k?(q.style.height=(f-k+1)*h+"px",j=f+1,i=k):(q.style.top=f*h+"px",q.style.height=(k-f+1)*h+"px",j=k+1,i=f))}},t=function(b){a=!1,document.onmousemove="",document.onmouseup="",zcal.dquickBook(i,j,l,b),i=j=k=null,ZCL_stopEvents(b)},u=function(a){var b=ZCL_$("zcl_lftsec").getBoundingClientRect().width;for(var c=0;c<a;c++)b+=ZCL_$("zcl_a"+c).getBoundingClientRect().width;return b},v=function(g,h){var i=g.target||g.srcElement,j;ZCL_clrStck(),a=!0,i.id&&(i.id=="zcl_mbx"+h||i.id=="zcl_lft"+h)&&(b=c=d=h,j=zcal.$("zcl_lay"+h),j.style.display="",f=j.offsetHeight,e=j.offsetWidth,document.onmousemove=w,document.onmouseup=x)},w=function(e){if(a){var f=zcal.NN6?e.target:event.srcElement;if(f.id&&(f.id.indexOf("zcl_mbx")!=-1||f.id.indexOf("zcl_lay")!=-1||f.id.indexOf("zcl_lft")!=-1)){var g=f.id.replace(/\D/g,"");c=parseInt(g,10);if(c>b){for(var h=d;h<=b;h++)ZCL_$("zcl_lay"+h).style.display="none",d=h;while(d>c)ZCL_$("zcl_lay"+d--).style.display="none";for(var i=d;i<=c;i++)ZCL_$("zcl_lay"+i).style.display="",d=i}else if(c<b){for(var h=d;h>=b;h--)ZCL_$("zcl_lay"+h).style.display="none",d=h;while(d<c)ZCL_$("zcl_lay"+d++).style.display="none";for(var i=d;i>=c;i--)ZCL_$("zcl_lay"+i).style.display="",d=i}else{while(d<c)ZCL_$("zcl_lay"+d++).style.display="none";while(d>c)ZCL_$("zcl_lay"+d--).style.display="none"}}}},x=function(e){a=!1,document.onmousemove="",document.onmouseup="",zcal.mquickBook(b,c,e),d=b=c=null},y={dstartDiv:r,mstartDiv:v};return y}(),zcalEDrag=function(){var a=!1,b="top",c,d,e,f,g,h,i,j=function(a,j,n,o){ZCL_clrStck(),h=ZCL_$("zcl_eveSub"),i=ZCL_$("zcl_encloser");var p=zcal.NN6?j.target:event.srcElement;f=a.offsetTop,ZCL_MouseXY(j),g=zcalMY,d=a,e=n,c=o,p.tagName=="DIV"&&p.id=="zcl_scrollme"?(b="bot",document.onmousemove=k,document.onmouseup=m):(b="top",document.onmousemove=l,document.onmouseup=m),ZCL_stopEvents(j)},k=function(b){var c=zcal.NN6?b.clientY:event.clientY;if(c!=g){a||ZCL_setOpacity(d,5),a=!0;if(a){var e=d.getElementsByTagName("div")[1],f=e.offsetHeight,i=d.offsetTop;c=(zcal.NN6?b.clientY:event.clientY)-ZCL_findPosYY(h),sHgt=c+h.parentNode.scrollTop-i;if(!(sHgt>12&&c+ZCL_findPosYY(h)<document.body.offsetHeight-50))return!1;e.style.height=sHgt+"px"}}},l=function(b){var c=zcal.NN6?b.clientY:event.clientY,e=zcal.NN6?b.clientX:event.clientX;if(c!=g){a||ZCL_setOpacity(d,5),a=!0;if(a){dHgt=c-g,dLft=e-ZCL_findPosXX(h);if(zcal.view!=0&&h.offsetWidth>dLft+10&&dLft>=zcal.hrgrid_lsec_width){var i=ZCL_getWeekGridNo(dLft);d.style.left=i[1]+"px",d.setAttribute("gridNo",i[0])}f+dHgt+d.offsetHeight<=h.parentNode.scrollHeight&&f+dHgt>0&&(d.style.top=f+dHgt+"px")}}},m=function(g){document.onmousemove="",document.onmouseup="",f=null,a?c.EPERM==1&&c.DPERM==1?ZCL_showConfirm("zcl_attStat"):d.id.indexOf("_")!=-1?n():(ZCL_dragreturn(d,b,{SD:c.SD,ST:c.ST,ED:c.ED,ET:c.ET,CNAME:c.CNAME,EUID:c.EUID,RIDX:c.RIDX,ORG:c.ORG,ADAY:c.ADAY,ETZ:c.ETZ,IN_ETZ:c.IN_ETZ}),d=null):zcal.eveDetail(d.id,g,e,[c.SD,c.ST,c.ED,c.ET,c.EUID,c.CNAME,c.EPERM,c.RIDX,c.DPERM,c.REPINST]),a=!1,b="top",ZCL_stopEvents(g)},n=function(){var a=c.SD,e=c.ST,f=c.ED,g=c.ET,h=zcal.getWeekStart(),i=zcal.today.clone(),j=d.offsetLeft;zcal.view!=0&&i.setDate(i.getDate()-i.getDay()+h);if(j!=0){var k=parseInt(d.getAttribute("gridNo"),10);i.setDate(i.getDate()+k);var l=i.dateBy("yyyyMMdd"),m=d.id;if(b=="bot"&&a!=f&&l==a&&g!="0000"&&g!="2400")return zcalView.constGridView(),!1;l==m.substring(m.indexOf("_")+1,m.length)||l==d.getAttribute("ed")?ZCL_showConfirm("qedit",{dtype:b}):editRep(0)}};editRep=function(a,e){var f=d.id,g=c.SD,h=c.ED,i=c.ST,j=c.ET,k=zcal.getWeekStart(),l=zcal.today.clone(),m,n,o=d.offsetLeft,p=d.offsetTop,q=d.offsetHeight,r=c.RIDX,s,t,u,v,w,x;m=Math.round(p),m=ZCL_pxToTime(m),n=Math.round(p+q),n=ZCL_pxToTime(n),zcal.view!=0&&l.setDate(l.getDate()-l.getDay()+k),b=e&&e.dtype?e.dtype:b,s=parseInt(d.getAttribute("gridNo")),l.setDate(l.getDate()+s),t=l.dateBy("yyyyMMdd"),u=l.dateBy("yyyyMMdd"),v=f.substring(0,f.indexOf("_")),w=zcal.findDuration({SD:g,ST:i,ED:h,ET:j});if(b=="bot")t=g,m=i;else if(b=="top"){var y=parseInt(m/100,10),z=m%100;l.setHours(y,z,0,0),l.setTime(l.getTime()+w),u=l.dateBy("yyyyMMdd"),n=l.dateBy("HHmm")}a==1&&(a=null),a==2&&r==0&&(a=null),x={SD:t,ED:u,ST:m,ET:n,EID:v,TY:a,RIDX:c.RIDX,CNAME:c.CNAME,EUID:c.EUID,ORG:c.ORG,ADAY:c.ADAY,ETZ:c.ETZ,IN_ETZ:c.IN_ETZ,REPINST:c.REPINST},zcalQAdd.edit(x),d=null,c=null,ZCL_closeREditConfirm()};var o={dragStart:j,editRep:editRep};return o}(),zcalMDrag=function(){var a=!1,b=!1,c,d,e,f,g,h,i,j,k,l,m=function(b,m){var p,q,s;k=ZCL_$("zcl_encloser"),l=ZCL_getPos(k),ZCL_clrStck(),a=!0,c=b,g=b.eobj,h=zcal.NN6?m.clientX:event.clientX,i=zcal.NN6?m.clientY:event.clientY,p=Math.floor((h-l.offsetLeft)/zcal.mcell_width),q=r(i),f=d=e=q*7+p,s=ZCL_getCalColor(zcal.getCalObj(g.CNAME)[1]),j=document.createElement("DIV"),g.SDAY||(j.className="zcl_medrg"),j.style.width=zcal.mcell_width-2+"px";if(g.SDAY&&g.SD!=g.ED){var t=(ZCL_parseDateStr(g.ED)-ZCL_parseDateStr(g.SD))/864e5,u='<div class="zcl_mthev" style="z-index:101;"><div class="zcl_event" style="background-color:'+(g.EC!=-1?zcal.eventcolor[g.EC]:s[1])+";border-color:"+s[0]+'"><ul><li class="zcl_sp"></li><li><span>&nbsp;('+(t+1)+"&nbsp;"+zcal.i18n.days+")&nbsp;&nbsp;"+g.SUM+"</span></li></ul></div></div>";j.innerHTML=u}else j.style.zIndex="101",j.innerHTML=b.innerHTML;document.body.appendChild(j),j.style.left=h+"px",j.style.top=i+"px",j.style.position="absolute",j.style.display="none",document.onmousemove=n,document.onmouseup=o,ZCL_stopEvents(m)},n=function(d){var g,k,m,n,o,p,q;k=zcal.NN6?d.clientY:event.clientY,g=zcal.NN6?d.clientX:event.clientX;if(g!=h||k!=i){j.style.display="",b=!0,ZCL_setOpacity(c,5);if(a){var s=l.offsetLeft,t=l.offsetTop,u=l.offsetWidth,v=l.offsetHeight;g>s&&g<s+u&&k>t&&k<t+v&&(p=g>s+u-zcal.mcell_width?s+u-zcal.mcell_width:g,q=k>t+v-j.offsetHeight?t+v-j.offsetHeight:k,n=Math.floor((p-s)/zcal.mcell_width),m=r(q,m),o=e=m*7+n,f!=o&&(ZCL_$("zcl_lay"+f).style.display="none",f=o),ZCL_$("zcl_lay"+o).style.display="",j.style.left=p+"px",j.style.top=q+"px",j.style.position="absolute")}}},o=function(c){a=!1;var f=window.event?window.event:c;document.onmousemove="",document.onmouseup="",j&&j.parentNode.removeChild(j),j=null,b?d!=e?g.EPERM==1&&g.DPERM==1?ZCL_showConfirm("zcl_attStat"):g.EID.indexOf("_")!=-1?q():p():(ZCL_clrStck(),zcalView.plotEvents()):zcal.eveDetail(g.EID,f,g.SD,[g.SD,g.ST,g.ED,g.ET,g.EUID,g.CNAME,g.EPERM,g.RIDX,g.DPERM,g.REPINST]),b=!1,ZCL_stopEvents(f)},p=function(){var a,b,c,d,f,h;a=zcal.mlimit[0].clone(),a.setDate(a.getDate()+e),b=a.clone(),c=(ZCL_parseDateStr(g.ED)-ZCL_parseDateStr(g.SD))/864e5,b.setDate(b.getDate()+c),d=a.dateBy("yyyyMMdd"),f=b.dateBy("yyyyMMdd"),h={SD:d,ED:f,ST:g.ST,ET:g.ET,EID:g.EID,EUID:g.EUID,CNAME:g.CNAME,OR:g.ORG,ADAY:g.ADAY,ETZ:g.ETZ,IN_ETZ:g.IN_ETZ,SUM:g.SUM},zcalQAdd.edit(h)},q=function(){var a,b,c,d,f,h,i,j;a=zcal.mlimit[0].clone(),a.setDate(a.getDate()+e),c=g.EID,d=c.substring(0,c.indexOf("_")),f=c.substring(c.indexOf("_")+1,c.length),b=a.clone(),b.setDate(b.getDate()+(ZCL_parseDateStr(g.ED)-ZCL_parseDateStr(g.SD))/864e5),h=a.dateBy("yyyyMMdd"),i=b.dateBy("yyyyMMdd"),j={SD:h,ED:i,ST:g.ST,ET:g.ET,EID:d,TY:0,RIDX:g.RIDX,CNAME:g.CNAME,EUID:g.EUID,ORG:g.ORG,ADAY:g.ADAY,ETZ:g.ETZ,IN_ETZ:g.IN_ETZ},zcalQAdd.edit(j)},r=function(a,b){var c=k.scrollTop,d=l.offsetTop;a=a+c-d;for(var e=0;e<ZCL_MROWHGT.length;e++){a-=ZCL_MROWHGT[e];if(a<=0){b=e;break}}return b},s={dragStart:m};return s}();ZEVENTS=function(a){return new ZCALPicker(a)},ZEVENTS.count=0,ZEVENTS.obj={},ZEVENTS.template=function(a){switch(a){case"type1":return{_HTML:'<li class="zcal_table zcal_mCaltt"><ul><li class="zcal_arr"><i class="#py#" rel="PY"></i></li><li class="zcal_arr"><i class="#pm#" rel="PM"></i></li><li>#HEAD#</li><li class="zcal_arr"><i class="#nm#" rel="NM"></i></li><li class="zcal_arr"><i class="#ny#" rel="NY"></i></li></ul></li><li class="zcal_mCalcn"><ul><li class="zcal_mCaldy zcal_table"><ul>#wk<li>#item#</li>wk#</ul></li><li class="zcal_table" rel="DT">#dr<div>#dc<#tag#>#item#</#tag#>dc#</div>dr#</li><li class="zcal_tmz"><span>#tz#</span></li></ul></li>',_cont:{tag:"UL",_class:"zcal_mCal"},_class:{sel:"i",hglt:"s",dis:"u",selhgt:"p",nor:"b"}};case"type2":return{_HTML:'<ul class="zcal_mCal #shadow# #hover#"><li class="zcal_table zcal_mCaltt"><ul><li class="zcal_arr"><i class="#py#" rel="PY"></i></li><li class="zcal_arr" ><i class="#pm#" rel="PM"></i></li><li>#HEAD#</li><li class="zcal_arr"><i class="#nm#" rel="NM"></i></li><li class="zcal_arr"><i class="#ny#" rel="NY"></i></li></ul></li><li class="zcal_mCalcn"><ul><li class="zcal_mCaldy zcal_table"><ul>#wk<li>#item#</li>wk#</ul></li><li class="zcal_table" rel="DT">#dr<div>#dc<#tag# rel=#month#Y#year#>#item#</#tag#>dc#</div>dr#</li></ul></li></ul>',_class:{sel:"i",hglt:"s",dis:"u",selhgt:"p",nor:"b",shdwn:"zcal_mCalppu",shup:"zcal_mCalppd"},_cont:{tag:"DIV",_class:"zcal_cn"}};case"type3":return{_HTML:'<li class="zcal_table zcal_mCaltt"><ul><li class="zcal_arr" ><i class="#py#" rel="PY"></i></li><li class="zcal_arr" ><i class="#pm#" rel="PM"></i></li><li>#HEAD#</li><li class="zcal_arr"><i class="#nm#" rel="NM"></i></li><li class="zcal_arr" ><i class="#ny#" rel="NY"></i></li></ul></li><li class="zcal_mCalcn"><ul><li class="zcal_mCaldy zcal_table"><ul>#wk<li>#item#</li>wk#</ul></li><li rel="DT" class="zcal_table">#dr<div>#dc<#tag#>#item#</#tag#>dc#</div>dr#</li></ul></li>',_class:{sel:"em",dis:"u",nor:"b"},_cont:{tag:"UL",_class:"zcal_mCal"},_bsecont:{tag:"DIV",_class:"zcal_mpcal"},_patch:{tag:"DIV",_cont:"<b></b>"}};case"type4":return{_HTML:'<li class="zcl_mCaltt zcl_table"><ul><li><span>#HEADM#</span><span>#HEADY#</span></li><li class="zcl_W20"><i class="#pm#" rel="PM"></i><i class="#nm#" rel="NM"></i></li></ul></li><li class="zcl_mCaldy zcl_table"><ul>#wk<li#hgt#>#item#</li>wk#</ul></li><li class="zcl_table zcl_mCaldt" rel="DT">#dr<div>#dc<#tag#>#item#</#tag#>dc#</div>dr#</li></ul></li>',_cont:{tag:"UL",_class:"zcl_mCal"},_class:{sel:"i",hglt:"s",dis:"u",selhgt:"p",nor:"b"},_cust:{dysel:"zcl_sl",pm:"zcli-larrow",nm:"zcli-rarrow"}};case"type5":return{_HTML:'<div class="zcal_mCal #shadow# #hover# zcl_mCalwti"><div class="zcal_table"><ul><li class="zcal_mCalti"><div class="zcal_table zcal_mCaltt"><ul><li class="zcal_arr"><i class="zci-fst" rel="PY"></i></li><li class="zcal_arr"><i class="zci-pre" rel="PM"></i></li><li>#HEAD#</li><li class="zcal_arr"><i class="zci-nxt" rel="NM"></i></li><li class="zcal_arr"><i class="zci-lst" rel="NY"></i></li></ul></div><div class="zcal_mCalcn"><ul><li class="zcal_mCaldy zcal_table"><ul>#wk<li>#item#</li>wk#</ul></li><li class="zcal_table" rel="DT">#dr<div>#dc<#tag# rel=#month#Y#year#>#item#</#tag#>dc#</div>dr#</li></ul></div></li><li class="zcal_mTil"><i class="zci-tiupar" rel="UT"></i><div ><ul id="zcl_t" style="overflow-y:auto;height:205px">#tr<li#ti# rel="TP">#item#</li>tr#</ul></div><i class="zci-tidnar" rel="TD"></i></li></ul></div><div class="zcal_mCalbtm"><div class="SC_PUbtm"><span rel="OK">Ok</span></div></div></div>',_class:{sel:"i",hglt:"s",dis:"u",selhgt:"p",nor:"b",shdwn:"zcal_mCalppu",shup:"zcal_mCalppd"},_cont:{tag:"DIV",_class:"zcal_cn"}};default:return}},ZEVENTS.selector=function(a){var b={},c=a.trim().split(" ");b.target=(c[0]||c).substring(1);if(c.length==2){c[1]=c[1].trim();var d=c[1].indexOf("[");if(d!=-1){var e=c[1].indexOf("]"),f=c[1].indexOf("."),g=c[1].indexOf("=");b.ele=c[1].substring(0,d),b.atr=c[1].substring(d+1,e),b.atr_val=c[1].substring(g+1)}else b.atr=c[1][0]==="#"?"id":c[1][0]=="."?"class":"",b.atr!=""?(b.atr_val=c[1].substring(c[1].search(/(#|\.)/g)+1),b.ele=""):(b.ele=c[1],b.atr_val="")}else b.ele="",b.atr="",b.atr_val="";return b},ZEVENTS.removeall=function(a){a=a?a:"picker";if(typeof a=="string"&&a=="picker"&&ZEVENTS.obj.picker){var b=ZEVENTS.obj.picker;for(var c in b)ZEVENTS.remove(b[c],a)}},ZEVENTS.remove=function(a,b){if(typeof a=="object"&&a._name){var c=a._cont;a.clearobj(),a.clearvar(),a=null,b=b||"picker",delete ZEVENTS.obj[b][c]}},ZEVENTS.clear=function(a){typeof a=="object"&&a._name&&(a.clearobj(),ZEVENTS.obj.state=null)},ZCALPicker=function(a){return this.tar=a,this},ZCALPicker.prototype.picker=function(a,b){var c=ZEVENTS.obj.picker||(ZEVENTS.obj.picker={}),d;return b.target=this.tar,a=="date"?d=new ZCALdatepickr(b):a=="range"?d=new ZCALrangepickr(b):a=="time"&&(d=new ZCALtimepickr(b)),d?c[d._cont]=d:"",d};var ZCALtimepickr=function(a){return a?(this._name="timepicker",this._type=a.type&&/^[123]$/.test(a.type)?a.type:1,this._tar=typeof a.target=="object"?a.target:document.getElementById(a.target),this._tform=a.tform,a.refer?this._refer=typeof a.refer=="object"?a.refer:document.getElementById(a.refer):this._tar&&(this._refer=this._tar.tagName.toLowerCase()=="input"?this._tar:this._tar.getElementsByTagName("input")[0]),this.os=0,this.n="",this.tmpO="no",this._cont=(new Date).getTime()+"_"+ZEVENTS.count++,this._prevalue="",this._menu=!1,this._sel=-1,this._errfn=[],this._chgefn=[],this):null};ZCALtimepickr.prototype.on=function(a,b){return a=="change"&&"function"==typeof b?this._chgefn.push(b):a=="error"&&"function"==typeof b&&this._errfn.push(b),this},ZCALtimepickr.prototype.bind=function(){var a=this,b=function(){if(a._inEl){ZCALremoveListener(a._inEl,"input",h),ZCALremoveListener(a._inEl,"keydown",i),ZCALremoveListener(a._inEl,"blur",k),ZCALremoveListener(a._inEl,"keypress",j);var b=a._inEl.parentNode.removeChild(a._inEl);e1=null}if(a._ulEl){ZCALremoveListener(a._ulEl,"mousedown",l);var b=a._ulEl.parentNode.removeChild(a._ulEl);e1=null}a._menu=!1,a._sel=-1,a._prevalue="",a._ulEl=a._inEl=null};a.clearobj=function(){ZEVENTS.obj.state=null;var d=document.getElementById(a._cont);d&&(ZCALremoveListener(d,"mousedown",c),ZCALremoveListener(document,"scroll",docevehandle),ZCALremoveListener(document,"mousedown",docevehandle),ZCALremoveListener(document,"mousewheel",docevehandle),ZCALremoveListener(a._tar,"keydown",f),d=d.parentNode.removeChild(d),d=null,a._sel=-1),a._inEl&&(a._refer.placeholder!=""?a._refer.value=a._refer.placeholder:a._refer.value=a._inEl.value,a._refer.placeholder=a._tform,b());return},a.clearvar=function(){a._type==1?(ZCALremoveListener(a._tar,"focus",e),ZCALremoveListener(a._tar,"click",e),ZCALremoveListener(a._tar,"keydown",f)):a._type==3?(ZCALremoveListener(a._refer,"keydown",g),ZCALremoveListener(a._refer,"keyup",g),ZCALremoveListener(a._refer,"mouseup",g)):a._type==2&&ZCALremoveListener(a._refer,"focus",m)};var c=function(b){var c=b.target||event.srcElement;c.tagName.toLowerCase()=="li"&&(a._refer.value=c.innerHTML,d(),a.clearobj()),ZCALprevDef(b)},d=function(){var b=a._errfn,c=a._chgefn,d=a._tform=="hh:mm a"?a.get12hrTime(a._refer.value):a.get24hrTime(a._refer.value);if(!d)for(var e in b)b[e].call(a._refer);else for(var e in c)c[e].call(a._refer)},e=function(b){ZEVENTS.obj.state&&ZEVENTS.clear(ZEVENTS.obj.state),ZEVENTS.obj.state=a;var d=b.target||b.srcElement,e=this.tagName.toLowerCase()=="input"?this:this.getElementsByTagName("input")[0],g=e.value,h=a._tform||e.getAttribute("tform"),i=g.changeTimetoNumber(h);a._sel=i;var j=document.body.appendChild(document.createElement("ul"));j.style.width=(this.clientWidth<110?110:this.clientWidth)+"px",j.style.left=this.positionX()+"px",j.id=a._cont,ZCALaddListener(j,"mousedown",c);var k=(document.documentElement.clientHeight||window.innerHeight)+Math.max(document.body.scrollTop,document.documentElement.scrollTop);j.className="zcal_tilst "+(this.positionY()+250>k?"zcal_tilsbt":"zcal_tilstp");var l="";for(var m=0;m<48;m++)l+='<li rel="'+m+'"'+(m==i?'class="zcal_sl"':"")+">"+(m+"").changeNumbertoTime(h)+"</li>";j.innerHTML=l,j.scrollTop=i*24,j.style.top=this.positionY()+250<k?this.positionY()+this.offsetHeight+"px":this.positionY()-j.offsetHeight+"px",ZCALprevDef(b),ZCALaddListener(document,"scroll",docevehandle=function(){a.clearobj()}),ZCALaddListener(document,"mousedown",docevehandle=function(){a.clearobj()}),ZCALaddListener(a._tar,"keydown",f),ZCALaddListener(a._refer,"blur",docevehandle=function(){a.clearobj()})},f=function(b){var c=b.which||b.keyCode||b.charCode,e=document.getElementById(a._cont).getElementsByTagName("li");c==38&&a._sel!=0?(e[a._sel--].className="",e[a._sel].className="zcal_sl",document.getElementById(a._cont).scrollTop=a._sel*24,d()):c==40&&a._sel!=e.length-1?(e[a._sel++].className="",e[a._sel].className="zcal_sl",document.getElementById(a._cont).scrollTop=a._sel*24,d()):c==13&&(this.value=e[a._sel].innerHTML,a.clearobj())},g=function(b){ZEVENTS.obj.state&&ZEVENTS.clear(ZEVENTS.obj.state),ZEVENTS.obj.state=a;var c=this;b=b||event;var e=b.which||b.keyCode||b.charCode,f=(a._tform||c.getAttribute("tform"))=="HH:mm"?!0:!1;if(b.type.toLowerCase()=="mouseup"){var g=ZCALselstart(c);return a.os=g<=2?ZCALcrtesel(c,0,2):g>=3&&g<=5?ZCALcrtesel(c,3,5):g>=6&&g<=8?ZCALcrtesel(c,6,8):0,!0}if(b.type.toLowerCase()=="keyup"&&e!=9)return;switch(!0){case e==37:a.os=a.os==0&&!f?ZCALcrtesel(c,6,8):a.os==0&&f?ZCALcrtesel(c,3,5):a.os==3?ZCALcrtesel(c,0,2):a.os==6?ZCALcrtesel(c,3,5):0;break;case e==38:a.shiftnos(c,a.os,-1),d();break;case e==39:a.os=a.os==0?ZCALcrtesel(c,3,5):a.os==3&&!f?ZCALcrtesel(c,6,8):a.os==3&&f?ZCALcrtesel(c,0,2):a.os==6?ZCALcrtesel(c,0,2):0;break;case e==40:a.shiftnos(c,a.os,1),d();break;case e>=48&&e<=57:a.typenos(c,e,a.os),d();break;case e==65||e==80:a.typenos(c,e,a.os),d();break;case e==9:if(b.type.toLowerCase()=="keydown"){if(ZCALselend(c)==c.value.length)return;a.tmpO="yes",ZCALselend(c)-ZCALselstart(c)!=2?a.os=ZCALcrtesel(c,0,2):a.os=a.os==0?ZCALcrtesel(c,3,5):a.os==3&&!f?ZCALcrtesel(c,6,8):a.os==3&&f?ZCALcrtesel(c,0,2):a.os==6?ZCALcrtesel(c,0,2):0}else b.type.toLowerCase()=="keyup"&&a.tmpO=="no"?ZCALselend(c)-ZCALselstart(c)!=2?a.os=ZCALcrtesel(c,0,2):a.os=a.os==0?ZCALcrtesel(c,3,5):a.os==3&&!f?ZCALcrtesel(c,6,8):a.os==3&&f?ZCALcrtesel(c,0,2):a.os==6?ZCALcrtesel(c,0,2):0:b.type.toLowerCase()=="keyup"&&a.tmpO=="yes"&&(a.tmpO="no",ZCALprevDef(b));break;default:}ZCALprevDef(b)},h=function(){if(a._prevalue==this.value)return;this.value=this.value.replace("'","").replace("&","").replace("%","").replace(".",""),a._prevalue=this.value;var b=a._tform=="hh:mm a"?a.timeObj12hr(this.value):a.timeObj24hr(this.value);if(b){if(b[0]==""){var c=a._ulEl.getElementsByTagName("li");c[a._sel].className="",c[b[1]].className="zcal_sl"}else{a._ulEl.innerHTML=b[0];var d=a._ulEl.getElementsByTagName("li").length;a._ulEl.style.height=24*(d<=2?d:4)+"px"}a._sel=b[1],a._ulEl.style.display="",a._ulEl.scrollTop=24*b[1],a._prevalue=this.value=a._tform=="hh:mm a"?this.value.toUpperCase().replace(/^0/,""):this.value,a._refer.placeholder=b[2],a._refer.value=""}else a._ulEl.style.display="none",a._refer.placeholder="",a._refer.value=""},i=function(c){var e=c.which||c.keyCode||c.charCode,f=a._ulEl.getElementsByTagName("li");if(e==38)a._sel>0&&(f[a._sel--].className="",f[a._sel].className="zcal_sl",this.value=f[a._sel].innerHTML,a._refer.placeholder=f[a._sel].innerHTML,a._ulEl.scrollTop=24*a._sel);else{if(e==39)return a._refer.placeholder!=""&&(this.value=a._refer.placeholder.substring(0,this.value.length+1)),h.call(this,c);e==40?f.length-1>a._sel&&(f[a._sel++].className="",f[a._sel].className="zcal_sl",this.value=f[a._sel].innerHTML,a._refer.placeholder=f[a._sel].innerHTML,a._ulEl.scrollTop=24*a._sel):e==13&&(a._refer.placeholder!=""?a._refer.value=a._refer.placeholder:a._refer.value=this.value,a._refer.placeholder=a._tform,d(),b())}},j=function(b){var c=b.which||b.keyCode||b.charCode;if(!/^(8|4[0689]|5[0-8]|3[7-9])$/.test(c)&&a._tform=="HH:mm")return b.preventDefault(),b.stopPropagation(),!1;var d=this.selectionStart,e=this.selectionEnd;if(d==e&&e==this.value.length&&!/^(37|8|46)$/.test(c)){var f=String.fromCharCode(c),g=a._tform=="hh:mm a"?a.get12hrTime(this.value+f):a.get24hrTime(this.value+f);g||(b.preventDefault(),b.stopPropagation())}},k=function(){a._refer.placeholder!=""?a._refer.value=a._refer.placeholder:a._refer.value=this.value,a._refer.placeholder=a._tform,d(),b()},l=function(c){var e=c.target||c.srcElement;e.tagName.toLowerCase()=="li"&&(a._refer.value=e.innerHTML,a._refer.placeHolder="",b(),d())},m=function(b){ZEVENTS.obj.state&&ZEVENTS.clear(ZEVENTS.obj.state),ZEVENTS.obj.state=a;var c=this.parentNode;a._inEl=c.getElementsByTagName("input")[1],a._ulEl=c.getElementsByTagName("ul")[0],a._inEl||(a._inEl=c.appendChild(document.createElement("input")),a._inEl.type="text",a._inEl.className="zcal_tiabs",ZCALaddListener(a._inEl,"input",h),ZCALaddListener(a._inEl,"keydown",i),ZCALaddListener(a._inEl,"blur",k),ZCALaddListener(a._inEl,"keypress",j)),a._ulEl||(a._ulEl=c.appendChild(document.createElement("ul")),ZCALaddListener(a._ulEl,"mousedown",l));var d=a._tform=="hh:mm a"?a.timeObj12hr(this.value):a.timeObj24hr(this.value);if(d){a._ulEl.innerHTML=d[0],a._ulEl.style.display="";var e=a._ulEl.getElementsByTagName("li").length;a._ulEl.style.height=24*(e<=2?e:4)+"px",a._ulEl.scrollTop=24*d[1],a._inEl.value=a._tform=="hh:mm a"?this.value.toUpperCase().replace(/^0/,""):this.value,this.placeholder=d[2],this.value="",a._sel=d[1],a._prevalue=this.value}else a._inEl.value=this.value,this.value="",this.placeholder="",a._ulEl.style.display="none";a._inEl.focus()};return a._type==1?(ZCALaddListener(a._tar,"focus",e),ZCALaddListener(a._tar,"click",e)):a._type==2?ZCALaddListener(a._refer,"focus",m):a._type==3&&(ZCALaddListener(a._refer,"keydown",g),ZCALaddListener(a._refer,"keyup",g),ZCALaddListener(a._refer,"mouseup",g)),this},ZCALtimepickr.prototype.typenos=function(a,b,c){if(c==6&&/(A|P)/ig.test(String.fromCharCode(b))){var d=String.fromCharCode(b);return _ch=d=="A"?" "+ZCALtform[0]:" "+ZCALtform[1],a.value=a.value.substring(0,5)+_ch,ZCALcrtesel(a,c,c+2),!0}var e=String.fromCharCode(b),f=(this._tform||a.getAttribute("tform"))=="HH:mm"?!0:!1;this.n==""?(this.n=e,e="0"+e):(e=this.n+""+e,this.n=""),c==0&&(!f&&parseInt(e,10)<=12||f&&parseInt(e,10)<=23)?a.value=e+a.value.substring(2):c==3&&parseInt(e,10)<=59&&(a.value=a.value.substring(0,3)+e+a.value.substring(5));var g=this;setTimeout(function(){g.n=""},1e4),ZCALcrtesel(a,c,c+2)},ZCALtimepickr.prototype.shiftnos=function(a,b,c){var d=a.value.substring(b,b+2);if(b==0){var e=(this._tform||a.getAttribute("tform"))=="HH:mm"?!0:!1,f=parseInt(d,10);e&&f==0&&c==-1?f=23:!e&&f==1&&c==-1?f=12:e&&f==23&&c==1?f=0:!e&&f==12&&c==1?f=1:f+=c,a.value=(f<=9?"0":"")+f+a.value.substring(2,8)}else if(b==3){var f=parseInt(d,10);f==0&&c==-1?f=59:f==59&&c==1?f=1:f+=c,a.value=a.value.substring(0,3)+(f<=9?"0":"")+f+a.value.substring(5,8)}else b==6&&(d==ZCALtform[0]?a.value=a.value.substring(0,5)+" "+ZCALtform[1]:a.value=a.value.substring(0,5)+" "+ZCALtform[0]);return ZCALcrtesel(a,b,b+2),"true"},ZCALtimepickr.prototype.timeObj12hr=function(a){var b=this.get12hrTime(a),c="";if(b&&b.arr){for(var d=0;d<b.arr.length;d++)c+="<li"+(d==b.sel?" class='zcal_sl'":"")+">"+b.arr[d]+"</li>";return this._menu=!1,[c,b.sel,b.arr[b.sel]]}if(b&&b.sel>-1){var e="";if(!this._menu)for(var d=0;d<24;d++){var f=d==0?"12:00 AM":d==12?"12:00 PM":d>12?d-12+":00 PM":d+":00 AM";d==b.sel&&(e=f),c+="<li"+(d==b.sel?" class='zcal_sl'":"")+">"+f+"</li>",c+="<li>"+f.replace("00","30")+"</li>"}else e=b.sel==0?"12:00 AM":b.sel+":00 AM";return this._menu=!0,[c,b.sel*2,e]}return!1},ZCALtimepickr.prototype.get12hrTime=function(a){var b=["^([0-9])$","^(0?[1-9]|1[012])$","^(0?[1-9]|1[012])(:)$","^(0?[1-9]|1[012])(:)([0-5])$","^(0?[1-9]|1[012])(:)([0-5][0-9])$","^(0?[1-9]|1[012])(:)([0-5][0-9])(\\s)$","^(0?[1-9]|1[012])(:)([0-5][0-9])(\\s)([APap])$","^(0?[1-9]|1[012])(:)([0-5][0-9])(\\s)([APap][mM])$"],c=a.length,d;c>1&&a[1]==":"&&c++;if(!(c>0&&c<=8&&(d=a.match(new RegExp(b[c-1])))))return c==0?!1:!1;d=Array.prototype.slice.call(d,1);if(c<4){var e=parseInt(d[0],10);return{sel:e>11?0:e==0?12:e}}if(c==4)return a=a[0]==0?a.slice(1):a,{arr:[a+"0 AM",a+"5 PM",a+"0 AM",a+"5 PM"],sel:0};if(c>4){var e=a.substring(0,5).trim();e=e[0]==0?e.slice(1):e;var f=d[4]?/a/i.test(d[4][0])?0:1:0;return{arr:[e+" AM",e+" PM"],sel:f}}},ZCALtimepickr.prototype.timeObj24hr=function(a){var b=this.get24hrTime(a),c=tmp="";if(b&&b.arr){for(var d=0;d<b.arr.length;d++)c+="<li "+(d==b.sel?"class='zcal_sl'":"")+">"+b.arr[d]+"</li>";return this._menu=!1,[c,b.sel,b.arr[b.sel]]}if(b&&b.sel>-1){if(!this._menu)for(var d=0;d<24;d++)tmp=d<10?"0"+d:d,c+="<li "+(d==b.sel?"class='zcal_sl'":"")+" >"+tmp+":00</li>",c+="<li>"+tmp+":30</li>";return this._menu=!0,[c,b.sel*2,(b.sel<10?"0"+b.sel:b.sel)+":00"]}},ZCALtimepickr.prototype.get24hrTime=function(a){var b=["^([0-2])$","^([0-1][0-9]|2[0-3])$","^([0-1][0-9]|2[0-3])(:)$","^([0-1][0-9]|2[0-3])(:)([0-5])$","^([0-1][0-9]|2[0-3])(:)([0-5][0-9])$"],c=a.length,d;if(!(c>0&&c<6&&(d=a.match(new RegExp(b[c-1])))))return c==0?!1:!1;d=Array.prototype.slice.call(d,1);if(c==2){var e=parseInt(d[0],10);return{sel:e}}if(c<4){var e=parseInt(d[0],10);return{sel:d[0].length==1&&e<=2?e*10:e}}if(c==4)return{arr:[a+"0",a+"5"],sel:0};if(c==5)return{arr:[a],sel:0}};var ZCALrangepickr=function(a){if(!a)return;this._name="rangepicker",a.range=a.range||["",""],a.range[0]=a.range[0].trim()!=""?new Date(a.range[0].parseDate(a.dform)):new Date(1947,8,15),a.range[1]=a.range[1].trim()!=""?new Date(a.range[1].parseDate(a.dform)):new Date(2147,8,15),a.range[1]=a.range[0].diffTo("month",a.range[1])>=0?a.range[1]:new Date(2147,8,15);var b=new Date,c=a.range[0].diffTo("month",new Date),d=b.diffTo("month",a.range[1]),e=c>=0&&d>0?new Date((new Date).setDate(1)):c<=0?a.range[0]:d<=0?new Date(a.range[1].getFullYear(),a.range[1].getMonth()-1,1):"",f=new Date(e.getFullYear(),e.getMonth()+1);return this._r1=new ZCALdatepickr({dform:a.dform||"MM/DD/YYYY",curdate:e,wkst:a.wkst||0,template:"type3",_cont:(new Date).getTime()+"_"+ZEVENTS.count++,range:a.range}),this._r2=new ZCALdatepickr({dform:a.dform||"MM/DD/YYYY",curdate:f,wkst:a.wkst||0,template:"type3",_cont:(new Date).getTime()+"_"+ZEVENTS.count++,range:a.range}),this._clkdates=[],this._selfn=[],this._tar=typeof a.target=="object"?a.target:document.getElementById(a.target),this._bsecont=ZEVENTS.template("type3")._bsecont,this._patch=ZEVENTS.template("type3")._patch,this._cont=(new Date).getTime()+"_"+ZEVENTS.count++,this};ZCALrangepickr.prototype.on=function(a,b){return a=="select"&&"function"==typeof b&&this._selfn.push(b),this},ZCALrangepickr.prototype.bind=function(){var a=this,b=document.createElement(a._bsecont.tag);b.id=a._cont,b.className=a._bsecont._class,a._tar.appendChild(b);var c=a._r1._curDate.diffTo("month",a._r2._curDate);a.clearobj=function(){ZCALremoveListener(document.getElementById(a._r1._cont),"mousedown",e),ZCALremoveListener(document.getElementById(a._r2._cont),"mousedown",e),ZCALremoveListener(b,"selectstart",ZCALprevDef),ZCALremoveListener(b,"dragstart",ZCALprevDef);var c=b.parentNode.removeChild(b);c=null},a.clearvar=function(){a=b=c=null};var d=function(a){while(a.firstChild)a.removeChild(a.firstChild);return a},e=function(b){var c=b.target||event.srcElement,e=c.getAttribute("rel"),h=c.parentNode.getAttribute("rel"),i=this.rel=="r1"?a._r1:a._r2,j=new Date(i._curDate),k=!1;if(c.tagName.toLowerCase()=="u"||c.className.indexOf("zcal_dis")!=-1)return ZCALprevDef(b),!1;if(e=="PM"||h=="PM")j=ZCALchangeMonth(j,-1),i._curDate=j;else if(e=="NM"||h=="NM")j=ZCALchangeMonth(j,1),i._curDate=j;else if(e=="PY"||h=="PY")j.setYear(j.getFullYear()-1),i._curDate=j;else if(e=="NY"||h=="NY")j.setYear(j.getFullYear()+1),i._curDate=j;else if(c.parentNode.parentNode.getAttribute("rel")=="DT"){if(c.className&&c.className==ZEVENTS.template(i._template)._class.dis)return;j.setDate(parseInt(c.innerHTML,10));var l=a._clkdates.length;if(l==0||l>=2)a._clkdates=new Array(j);else if(l==1&&a._clkdates[0].getTime()!=j.getTime()){var m=j<a._clkdates[0]?0:1;a._clkdates.splice(m,0,j),k=!0}}var l=a._clkdates.length;a._r1._select=a._r2._select=[];if(l==2){var n=a._clkdates[0].diffTo("month",a._r1._curDate),o=a._r1._curDate.diffTo("month",a._clkdates[1]),p=a._clkdates[0].diffTo("month",a._r2._curDate),q=a._r2._curDate.diffTo("month",a._clkdates[1]);n>=0&&o>=0&&(a._r1._select={start:n>0?1:a._clkdates[0].getDate(),end:o>0?(new Date(a._r1._curDate.getFullYear(),a._r1._curDate.getMonth()+1,0)).getDate():a._clkdates[1].getDate()}),p>=0&&q>=0&&(a._r2._select={start:p>0?1:a._clkdates[0].getDate(),end:q>0?(new Date(a._r2._curDate.getFullYear(),a._r2._curDate.getMonth()+1,0)).getDate():a._clkdates[1].getDate()})}else l==1&&a._clkdates[0].diffTo("month",j)==0&&(i._select=[j.getDate()]);var r=a._r1._curDate.diffTo("month",a._r2._curDate);a.resetDRange(this.rel=="r1"?"r1":"r2"),d(f.call(a._r1)).innerHTML=a._r1.calendar(),d(g.call(a)).innerHTML=r>1?a._patch._cont:"",d(f.call(a._r2)).innerHTML=a._r2.calendar();if(k)for(var s in a._selfn)a._selfn[s].call({getDateRange:{from:a._clkdates[0],to:a._clkdates[1]}})};c<=0&&(a._r2._curDate=new Date((new Date(a._r1._curDate.getTime())).setMonth(a._r1._curDate.getMonth()+1)));var f=function(b){var c=document.getElementById(this._cont);if(!c){var d=ZEVENTS.template(this._template)._cont;c=document.createElement(d.tag),c.className=d._class,c.rel=b,c.id=this._cont,document.getElementById(a._cont).appendChild(c),ZCALaddListener(c,"mousedown",e)}return c},g=function(){var a=document.getElementById(this._cont+"_patch");if(!a){var a=document.createElement(this._patch.tag);a.id=this._cont+"_patch",document.getElementById(this._cont).appendChild(a)}return a};return a.resetDRange(),f.call(a._r1,"r1").innerHTML=a._r1.calendar(),g.call(a).innerHTML=c>1?a._patch._cont:"",f.call(a._r2,"r2").innerHTML=a._r2.calendar(),ZCALaddListener(b,"selectstart",ZCALprevDef),ZCALaddListener(b,"dragstart",ZCALprevDef),this},ZCALrangepickr.prototype.resetDRange=function(a){this._r1._edate=new Date(this._r2._curDate.getFullYear(),this._r2._curDate.getMonth(),0),this._r2._sdate=new Date(this._r1._curDate.getFullYear(),this._r1._curDate.getMonth()+1,1)};var ZCALdatepickr=function(a){return a=a?a:{},this.fullDtclk=a.fullDtclk!=undefined?a.fullDtclk:0,this._name="datepicker",this._dform=a.dform||"mm/dd/yyyy",this._wkst=a.wkst&&/^[0-7]$/g.test(a.wkst)?a.wkst:0,this._tar=typeof a.target=="object"?a.target:document.getElementById(a.target),this._type=a.mode||"inline",this._titype=a.time||"",this._select=a.select||[],this._monchge=[],this._yrchge=[],this._dtclk=[],this._template=a.template||(this._type=="inline"?"type1":this._type=="popup"&&this._titype=="right"?"type5":"type2"),this._curDate=a.curdate||(a.today?a.today.parseDate(this._dform):new Date),this._cont=a._cont||(new Date).getTime()+"_"+ZEVENTS.count++,this._change=a.update||"yes",this._minhgt=a.minhgt||251,this._tz=a.timezone||"",a.fn&&(this.fn=a.fn),a.range&&Object.prototype.toString.call(a.range[0])=="[object String]"?(this._sdate=a.range[0].parseDate(this._dform)||new Date(1947,8,15),this._edate=a.range[1].parseDate(this._dform)||new Date(2147,8,15)):a.range&&Object.prototype.toString.call(a.range[0])=="[object Date]"?(this._sdate=a.range[0],this._edate=a.range[1]):(this._sdate=null,this._edate=null),a.refer?this._refer=typeof a.refer=="object"?a.refer:document.getElementById(a.refer):this._tar&&(this._refer=this._tar.tagName.toLowerCase()=="input"?this._tar:this._tar.getElementsByTagName("input")[0]),this};ZCALdatepickr.prototype.on=function(a,b){return a=="monthchge"&&"function"==typeof b?this._monchge.push(b):a=="yearchge"&&"function"==typeof b?this._yrchge.push(b):a=="dateclick"&&"function"==typeof b&&this._dtclk.push(b),this},ZCALdatepickr.prototype.updateselect=function(a){return this._r1||(this._select=a||this._select,document.getElementById(this._cont).innerHTML=this.calendar()),this},ZCALdatepickr.prototype.bind=function(){var a=this,b=ZEVENTS.template(a._template)._cont,c="",d=document.createElement(b.tag);d.id=a._cont,d.className=b._class,a.clearobj=function(){ZEVENTS.obj.state=null;if(document.getElementById(a._cont)){ZCALremoveListener(d,"mousedown",g),ZCALremoveListener(d,"selectstart",ZCALprevDef),ZCALremoveListener(d,"dragstart",ZCALprevDef);var b=d.parentNode.removeChild(d);a._type=="popup"&&(ZCALremoveListener(document,"mousedown",docevehandle),ZCALremoveListener(document,"scroll",docevehandle)),b=null}},a.hide=function(b){var c=!0;d.contains(b.target)&&(c=!1),c&&a.clearobj()},a.clearvar=function(){a=d=b=null};var e=function(b){ZEVENTS.obj.state&&ZEVENTS.clear(ZEVENTS.obj.state),ZEVENTS.obj.state=a;var e=a._refer,f=(document.documentElement.clientHeight||window.innerHeight)+Math.max(document.body.scrollTop,document.documentElement.scrollTop),h=(document.documentElement.clientWidth||window.innerWidth)+Math.max(document.body.scrollLeft,document.documentElement.scrollLeft);document.body.appendChild(d),ZCALaddListener(d,"mousedown",g),ZCALaddListener(d,"selectstart",ZCALprevDef),ZCALaddListener(d,"dragstart",ZCALprevDef),ZCALaddListener(document,"mousedown",docevehandle=function(){a.clearobj()}),ZCALaddListener(document,"scroll",docevehandle=function(b){a.hide(b)}),ZCALaddListener(document,"mousewheel",docevehandle=function(b){a.hide(b)}),c=this.positionY()+this.offsetHeight+a._minhgt>f?"no":"yes",d.style.left=this.positionX()+(this.positionX()+260>h?-260+this.offsetWidth:0)+"px",a._curDate=e.value.parseDate(a._dform)||new Date,d.innerHTML=a.calendar(c),d.style.top=(c=="yes"?this.positionY()+this.offsetHeight:this.positionY()-d.offsetHeight)+"px",a._refer.focus(),ZCALprevDef(b)},f=function(a,b,c){return c==0?{getDates:function(){return[b,a]}}:{getDate:function(){return a}}},g=function(b){b=b||event;var e=b.target||b.srcElement,g=e.getAttribute("rel"),h=e.parentNode.getAttribute("rel"),i=[],j=0,k=new Date(a._curDate);if(e.tagName.toLowerCase()=="u"||e.className.indexOf("zcal_dis")!=-1){if(a.fullDtclk!=1||e.tagName.toLowerCase()!="u")return ZCALprevDef(b),!1;i=a._dtclk,j=1;var l=parseInt(e.getAttribute("rel").split("Y")[0]),m=parseInt(e.getAttribute("rel").split("Y")[1]);k.setDate(parseInt(e.innerHTML,10)),k.setMonth(l),k.setYear(m)}if(g=="PY"||h=="PY")i=a._yrchge,k.setYear(k.getFullYear()-1);else if(g=="NY"||h=="NY")i=a._yrchge,k.setYear(k.getFullYear()+1);else if(g=="PM"||h=="PM")i=a._monchge,k=ZCALchangeMonth(k,-1);else if(g=="NM"||h=="NM")k=ZCALchangeMonth(k,1),i=a._monchge;else if(e.parentNode.parentNode.getAttribute("rel")=="DT")i=a._dtclk,j=1,k.setDate(parseInt(e.innerHTML,10));else if(g=="UT")j=1,e.parentNode.querySelector("ul[id=zcl_t]").scrollTop-=10;else if(g=="TD")j=1,e.parentNode.querySelector("ul[id=zcl_t]").scrollTop+=10;else if(g=="OK"){if(a._refer.value.split(" ").length<2){var n=e.parentNode.parentNode.parentNode.querySelector(".zcal_sl").innerHTML;a._refer.value=a._refer.value+" "+n,this.fn&&this.fn(a._refer.value)}else a.clearobj();a.clearobj()}if(j==0){a._curDate=k;while(d.firstChild)d.removeChild(d.firstChild);d.innerHTML=a.calendar(c)}j==1&&a&&a._type=="popup"&&(a._titype=="right"?a._change=="yes"&&(a._refer.value=k.getDateBy(a._dform)):(a._change=="yes"&&(a._refer.value=k.getDateBy(a._dform)),a.clearobj()));for(var o in i)i[o].call(f(k,a._curDate,j));ZCALprevDef(b)};return a._type=="inline"?(a._tar.appendChild(d),ZCALaddListener(d,"mousedown",g),ZCALaddListener(d,"selectstart",ZCALprevDef),ZCALaddListener(d,"dragstart",ZCALprevDef),d.innerHTML=a.calendar()):a._type=="popup"&&(ZCALaddListener(a._refer,"focus",e),ZCALaddListener(a._refer,"blur",docevehandle=function(){a.clearobj()}),ZCALaddListener(a._refer,"keypress",ZCALprevDef),ZCALaddListener(a._tar,"mousedown",e)),this},ZCALdatepickr.prototype.changeDate=function(a){var b=document.getElementById(this._cont);this._curDate=a?a.parseDate(this._dform):this._curDate;while(b.firstChild)b.removeChild(b.firstChild);return b.innerHTML=this.calendar(""),!0},ZCALdatepickr.prototype.calendar=function(a){var b=ZEVENTS.template(this._template),c=b._HTML,d=b._class,e=b._cust,f=c.indexOf("#wk"),g=c.indexOf("wk#"),h=c.indexOf("#dr"),i=c.indexOf("dr#"),j=c.indexOf("#tr"),k=c.indexOf("tr#"),l=c.substring(0,f).replace("#HEAD#",this._curDate.getDateBy("MMMM YYYY")).replace("#HEADM#",this._curDate.getDateBy("MMMM")).replace("#HEADY#",this._curDate.getDateBy("YYYY"));if(this._sdate&&this._edate){var m=this._sdate.getFullYear(),n=this._sdate.getMonth(),o=this._edate.getFullYear(),p=this._edate.getMonth(),q=this._curDate.getFullYear(),r=this._curDate.getMonth(),s=this._curDate.getDate();l=l.replace("#py#","zci-fst"+(new Date(q-1,r,1)>=new Date(m,n,1)?"":" zcal_dis")).replace("#ny#","zci-lst"+(new Date(q+1,r,1)<=new Date(o,p,1)?"":" zcal_dis")).replace("#pm#","zci-pre"+(new Date(q,r,1)>new Date(m,n,1)?"":" zcal_dis")).replace("#nm#","zci-nxt"+(new Date(q,r,1)<new Date(o,p,1)?"":" zcal_dis"))}else l=l.replace("#py#","zci-fst").replace("#ny#","zci-lst").replace("#pm#","zci-pre").replace("#nm#","zci-nxt");return l=this.fullDtclk==1?l.replace("#hover#","zcal_mCalce"):l.replace("#hover#",""),a&&a!=""&&(l=l.replace("#shadow#",a=="yes"?d.shdwn:d.shup)),l+=this.weekrow(c.substring(f+3,g)),l+=c.substring(g+3,h),l+=this.daterow(c.substring(h+3,i)),this._type=="popup"&&this._titype=="right"?(l+=c.substring(i+3,j).replace("#tz#",this._tz),l+=this.timerow(c.substring(j+3,k)),l+=c.substring(k+3,c.length)):l+=c.substring(i+3,c.length).replace("#tz#",this._tz),l},ZCALdatepickr.prototype.timerow=function(a){var b=["12:00 am","12:30 am","1:00 am","1:30 am","2:00 am","2:30 am","3:00 am","3:30 am","4:00 am","4:30 am","5:00 am","5:30 am","6:00 am","6:30 am","7:00 am","7:30 am","8:00 am","8:30 am","9:00 am","9:30 am","10:00 am","10:30 am","11:00 am","11:30 am","12:00 pm","12:30 pm","1:00 pm","1:30 pm","2:00 pm","2:30 pm","3:00 pm","3:30 pm","4:00 pm","4:30 pm","5:00 pm","5:30 pm","6:00 pm","6:30 pm","7:00 pm","7:30 pm","8:00 pm","8:30 pm","9:00 pm","9:30 pm","10:00 pm","10:30 pm","11:00 pm","11:30 pm"],c=new Date,d="";c.setTime(zcal.today.getTime());var e=c.getDate(),f=c.getMonth(),g=c.getFullYear(),h,i,j,k,l;f=f+1<10?"0"+(f+1):f+1,e=e<10?"0"+e:e,h=g+""+f+""+e,c.setTime(zcal.cdate),i=c.getHours(),j=c.getMinutes(),k=i*2+(j>30?2:1),k=k>46?46:k;var m=ZEVENTS.template(this._template),n="";for(var o=0;o<48;o++)n+=a.replace("#item#",(o+"").changeNumbertoTime("hh:mm a")).replace("#ti#",o==k?' class="zcal_sl"':"");return n},ZCALdatepickr.prototype.weekrow=function(a){var b=(new Date(this._curDate)).getDay(),c=this._wkst,d=ZEVENTS.template(this._template),e=0,f="";while(e<7)f+=a.replace("#item#",Date.WEEKS_DAYS[2][c]).replace("#hgt#",c==b&&d._cust?" class="+d._cust.dysel:""),c=c<6?c+1:0,e++;return f},ZCALdatepickr.prototype.daterow=function(a){var b=a.indexOf("#dc"),c=a.indexOf("dc#"),d=a.substring(b+3,c),e=new Date(this._curDate),f=e.getDate(),g=e.getMonth(),h="",i="",j="",k=",",l=this._type,m=Object.prototype.toString.call(this._select)=="[object Object]"?!0:!1;if(!m)for(var n=0;n<this._select.length;n++)k+=this._select[n]+",";e.setDate(1);var o=e.getDay(),p=new Date(e.getFullYear(),e.getMonth(),1),q=new Date(e.getFullYear(),e.getMonth()+1,0),r=Math.ceil((p.getDay()+q.getDate())/7),s=o-this._wkst+(r==4||r==5?7:0)+(o-this._wkst<0?7:0);e.setDate(e.getDate()-s);var t=ZEVENTS.template(this._template)._class;for(var u=0;u<7;u++){j+=a.substring(0,b);for(var v=0;v<7;v++){var w="";h=e.getDate(),i=e.getMonth();var x=t.nor;if(i==g&&!this._sdate&&!this._edate||i==g&&this._sdate&&this._edate&&this._sdate<=e&&this._edate>=e){if(k!=""&&k.indexOf(","+h+",")>-1||m&&this._select.start<=h&&this._select.end>=h)x=t.sel;f==h&&t.hglt&&(x=x==t.sel?t.selhgt:t.hglt)}else x=t.dis;j+=d.replace(/#tag#/g,x).replace("#item#",h).replace("#month#",e.getMonth()).replace("#year#",e.getFullYear()),e.setDate(h+1)}j+=a.substring(c+3,a.length)}return j},Element.prototype.positionX=function(a){var b=0,c=this;if(typeof c.getBoundingClientRect=="function"){var d=c.getBoundingClientRect();b=d.left+(window.pageXOffset||document.documentElement.scrollLeft)-(document.documentElement.clientLeft||0)}else if(c.offsetParent)while(c.offsetParent)b+=c.offsetLeft,c=c.offsetParent;else c.x&&(urleft+=c.x);return b},Element.prototype.positionY=function(){var a=0,b=this;if(typeof b.getBoundingClientRect=="function"){var c=b.getBoundingClientRect();a=c.top+(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0)}else if(b.offsetParent)while(b.offsetParent)a+=b.offsetTop,b=b.offsetParent;else b.y&&(a+=b.y);return a},String.prototype.trim=function(){var a=this;return a=a.replace(/^\s*(.*)/,"$1"),a=a.replace(/(.*?)\s*$/,"$1"),a},String.prototype.changeNumbertoTime=function(a){var b,c,d=parseInt(this,10);return a=="hh:mm a"?(c=d>24?d-24:d,c=c==0||c==1?12:parseInt(c/2,10),b=d>23?" "+ZCALtform[1]:" "+ZCALtform[0]):(c=parseInt(d/2,10),b=""),(c<10?"0":"")+c+":"+(d%2==1?"30":"00")+b},String.prototype.changeTimetoNumber=function(a){if(this.indexOf(":")<0)return 0;var b=this.split(":");b[0]=parseInt(b[0],10);if(a=="hh:mm a"){var c=b[1].split(" ");c[1]==ZCALtform[1]&&b[0]!=12?b[0]+=12:c[1]==ZCALtform[0]&&b[0]==12&&(b[0]=0),b[1]=c[0]}return b[1]=parseInt(b[1],10),b[0]*2+(b[1]==30?1:0)},String.prototype.parseDate=function(a){var b=function(a,b){for(var c in b)if(a.toLowerCase().trim()==b[c].toLowerCase())return parseInt(c,10)+1;return!1};if(!a||a.trim()=="")return!1;if(this&&this.trim()=="")return!1;var c=this,d=c.match(/(\d+)|([a-zA-Z]+)/g),e=0,f={},g=a.toLowerCase().match(/([a-z]+)/g);if(g.length!=3||d.length!=3)return!1;for(var e in g)g[e]=="d"||g[e]=="m"?g[e]+=g[e]:g[e]=="mmm"?(d[e]=b(d[e],Date.MONTH_NAMES[1]),g[e]="mm"):g[e]=="mmmm"?(d[e]=b(d[e],Date.MONTH_NAMES[0]),g[e]="mm"):g[e]=="yy"&&(d[e]=d[e]>=70?1900+parseInt(d[e],10):2e3+parseInt(d[e],10),g[e]="yyyy"),f[g[e]]=d[e];return new Date(f.yyyy,f.mm-1,f.dd)},Date.MONTH_NAMES=new Array(["January","February","March","April","May","June","July","August","September","October","November","December"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),Date.WEEKS_DAYS=new Array(["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["S","M","T","W","T","F","S"]),ZCALtform=["am","pm"],Date.prototype.getDaysOfMonth=function(){return(new Date(this.getFullYear(),this.getMonth()+1,0)).getDate()},Date.prototype.getDateBy=function(a){var b=function(a){return(a<0||a>9?"":"0")+a};if(a.trim()=="")return;a+="";var c="",d=0,e="",f="",g=this.getYear()+"",h=this.getMonth()+1,i=this.getDate(),j=this.getDay();g.length<4&&(g=""+(+g+1900));var k={};k.YYYY=g,k.YY=g.substring(2,4),k.M=h,k.MM=b(h),k.MMMM=Date.MONTH_NAMES[0][h-1],k.MMM=Date.MONTH_NAMES[1][h-1],k.D=i,k.DD=b(i),k.E=Date.WEEKS_DAYS[1][j],k.EE=Date.WEEKS_DAYS[0][j];while(d<a.length){e=a.charAt(d),f="";while(a.charAt(d)==e&&d<a.length)f+=a.charAt(d++);k[f.toUpperCase()]!=null?c+=k[f.toUpperCase()]:c+=f}return c},Date.prototype.getTimeBy=function(a){function b(a,b){var c=a+"";b=b||2;while(c.length<b)c="0"+c;return c}var c=this.getHours();a=a.replace(/(^|[^\\])HH+/g,"$1"+b(c)),a=a.replace(/(^|[^\\])H/g,"$1"+c);var d=c>12?c-12:c==0?12:c;a=a.replace(/(^|[^\\])hh+/g,"$1"+b(d)),a=a.replace(/(^|[^\\])h/g,"$1"+d);var e=this.getMinutes();a=a.replace(/(^|[^\\])mm+/g,"$1"+b(e)),a=a.replace(/(^|[^\\])m/g,"$1"+e);var f=this.getSeconds();a=a.replace(/(^|[^\\])ss+/g,"$1"+b(f)),a=a.replace(/(^|[^\\])s/g,"$1"+f);var g=c<12?"AM":"PM";a=a.replace(/(^|[^\\])TT+/g,"$1"+g),a=a.replace(/(^|[^\\])T/g,"$1"+g.charAt(0));var h=g.toLowerCase();a=a.replace(/(^|[^\\])tt+/g,"$1"+h),a=a.replace(/(^|[^\\])t/g,"$1"+h.charAt(0));var i=-this.getTimezoneOffset(),j=i?i>0?"+":"-":"Z";i=Math.abs(i);var k=Math.floor(i/60),l=i%60;return j+=b(k)+":"+b(l),a=a.replace(/(^|[^\\])K/g,"$1"+j),a},Date.prototype.diffTo=function(a,b){var c=this;b=b||new Date;if(a=="days")return parseInt((b.getTime()-c.getTime())/864e5,10);if(a=="month")return b.getMonth()-c.getMonth()+12*(b.getFullYear()-c.getFullYear());if(a=="year")return b.getFullYear()-c.getFullYear()};var ZCALaddListener=document.addEventListener?function(a,b,c,d){b=="mousewheel"&&navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&(b="DOMMouseScroll"),a.addEventListener(b,c,Boolean(d))}:function(a,b,c){a.attachEvent("on"+b,c)},ZCALremoveListener=document.removeEventListener?function(a,b,c,d){b=="mousewheel"&&navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&(b="DOMMouseScroll"),a.removeEventListener(b,c,Boolean(d))}:function(a,b,c){a.removeEventListener("on"+b,c)},ZCALprevDef=function(a){a=a||event,a.stopPropagation?(a.preventDefault(),a.stopPropagation()):(a.cancelBubble=!0,a.returnValue=!1)};ZCALcrtesel=function(a,b,c){if(a.createTextRange){a.focus();var d=a.createTextRange();d.collapse(!0),d.moveStart("character",b),d.moveEnd("character",c-b),d.select()}else a.setSelectionRange?(a.focus(),a.setSelectionRange(b,c)):typeof a.selectionStart!="undefined"&&(a.focus(),a.selectionStart=b,a.selectionEnd=c);return b},ZCALselstart=function(a){if(document.selection){var b=document.selection.createRange().duplicate();return b.moveEnd("character",a.value.length),b.text==""?a.value.length:a.value.lastIndexOf(b.text)}return a.selectionStart},ZCALselend=function(a){if(document.selection){var b=document.selection.createRange().duplicate();return b.moveStart("character",-a.value.length),b.text.length}return a.selectionEnd},ZCALchangeMonth=function(a,b){var c=new Date(a.getFullYear(),a.getMonth()+b,1),d=a.getDate(),e=(new Date(c.getFullYear(),c.getMonth()+1,0)).getDate();return c.setDate(d<=e?d:e),c},zcal.stck=[],zcal.keyCtrl=function(a){var b=zcal.NN6?a.target:a.srcElement,c=a.which||a.keyCode;if(c==27){zcal.preclr(a);return}if(b.tagName=="INPUT"||b.tagName=="TEXTAREA")return;document.removeEventListener("keydown",zcal.keyCtrl)},zcal.movView=function(a,b){ZCL_clrStck(b),ZCL_TY=a,ZCL_gridView()},zcal.preclr=function(a){zmApp.currentApp=="c"&&(zcal.stck.toString().indexOf("zcl_repstat")!=-1||zcal.stck.toString().indexOf("zcl_attStat")!=-1?zcalView.constGridView():ZCL_clrStck(),a!=null&&ZCL_stopEvents(a))},ZCL_clrStck1=function(a){if(zcal.stck.toString().indexOf("newEve")==-1){for(var b=0;b<zcal.stck.length;b++)zcal.$(zcal.stck[b])&&(zcal.$(zcal.stck[b]).style.display="none");zcal.stck=new Array,a!=null&&ZCL_stopEvents(a)}},ZCL_EClrStck=function(){zcal.EOBJ=null,zcal.EMODE=0,zmsuite.isWorkspaceAvailable("zcal_eContainer")&&zmsuite.closeWorkspace("zcal_eContainer"),ZCL_clrStck()},ZCL_clrStck=function(a){for(var b=0;b<zcal.stck.length;b++)ZCL_$(zcal.stck[b])&&(ZCL_$(zcal.stck[b]).style.display="none");zcal.stck=[];if(zcal.$("zcl_action")){var c=zcal.$("zcl_action").getElementsByTagName("b")[0];c.className=""}a!=null&&ZCL_stopEvents(a)},zcal.adStck=function(a){zcal.stck=zcal.stck.concat(a)},zcal.CAStck=function(a){ZCL_clrStck(),zcal.adStck(a)},ZCL_mdownClr=function(a){if(zmApp.currentApp=="c"){var b=a.target||a.srcElement,c,d,e,f;c=ZCL_$("zcl_qbk"),d=ZCL_$("zcl_qview"),e=ZCL_$("zcl_smAdd"),f=$(".zcal_cn");if(c&&c.contains(b)||d&&d.contains(b)||e&&e.contains(b)||f.length>0)return!1;ZCL_clrStck(),document.removeEventListener("mousedown",ZCL_mdownClr)}};var zcalTemplate=function(){var a={};return a.popupCreateEvent=function(a){var b='<div class="SC_PUcen">';return b+='<div><div class="zcl_adev">',b+='<div class="zcl_adevtt"><textarea id="zcl_ppce_tit" placeholder="'+zcal.i18n.popup_eventtitle+'">'+a.sum+"</textarea></div>",b+='<ul class="zcl_frmrw zcl_adetim"><li id="zcl_ce_timdv"><input type="text" readonly="" id="zcl_ce_sd" class="zcl_w137 SC_tiput" value="'+a.sd+'"></li><li id="zcl_ce_stpar"><input type="text" id="zcl_ce_st" class="zcl_w136 SC_tiput" value="'+a.st+'"></li><li class="zcl_tmto">to</li><li id="zcl_ce_edpar"><input type="text" readonly="" id="zcl_ce_ed" class="zcl_w137 SC_tiput" value="'+a.ed+'"></li><li id="zcl_ce_etpar"><input type="text" id="zcl_ce_et" class="zcl_w136 SC_tiput" value="'+a.et+'"></li></ul>',b+='<ul class="zcl_frmrw zcl_adall"><li class="zcl_curpt"><i id="zcl_ce_aday" class="msi-uncheck"></i>'+zcal.i18n.allday+"</li></ul>",b+='<ul class="zcl_frmrw zcl_rem">'+a.reminder+"</ul>",b+='<ul class="zcl_frmrw"><li><u>'+zcal.i18n.loc+'</u><input type="text" value="" id="zcl_ce_loc" class="zcl_adelk SC_tiput"></li><li><u>'+zcal.i18n.calendar+'</u><div class="SC_select zcl_adecl"><input rel="'+zcal.cdata.defcal+'" value="'+zcal.cdata.calLst[zcal.cdata.defcal][0]+'" readonly type="text" id="zcl_ce_cal"></div></li></ul>',b+='<textarea id="zcl_ce_desc" class="SC_tiput" placeholder="'+zcal.i18n.description+'">'+a.desc+"</textarea>",b+="</div></div>",b+="</div>",b},a.popupCreateCal=function(a){var b="<ul>";return b+='<li class="zcl_CMS"><ul class="zcl_addcal"><li><input type="hidden" id="zcl_calid" value="'+(a.id?a.id:"")+'"/><input type="hidden" id="zcl_calgid" value="'+(a.gId?a.gId:"")+'"><input type="text" class="SC_tiput" placeholder="'+zcal.i18n.calname+'" value="'+(a.name?ZCL_getHTML(a.name):"")+'" id="zcl_calname"></li>',b+="<li>",b+=a.desc&&a.desc!=""?'<textarea placeholder="Description" id="zcl_caldesc" class="SC_tiput">'+a.desc+"</textarea>":'<span id="zcl_opencaldesc">'+zcal.i18n.addnote+' +</span><textarea style="display:none" placeholder="Description" id="zcl_caldesc" class="SC_tiput"></textarea>',b+="</li>",b+='<li class="zcl_calcol" id="zcl_calcol">'+zcal.calColorSel(a.color)+"</li>",b+='<li id="zcl_txtcol"><div class="zcl_addcaltx"><b>Text color</b><u  data-marker ="textColor"><i class="'+(a.txtcolor==0?"msi-option":"msi-unoption")+'"></i><u class="">White</u></u><u data-marker ="textColor"><i class="'+(a.txtcolor==1?"msi-option":"msi-unoption")+'"></i><u class="">Black</u></u></div></li>',b+="</ul>",b},a.popupChatlet=function(a){var b=new Date,c=b.getHours()==0?12:b.getHours(),d=c>12?"pm":"am",c=c>12?c-12:c,e=c+":"+b.getMinutes()+" "+d,f='<div class="SC_PUcen zmChatlet" style=""><div style="width:400px">';f+='<div class="SC_floatLabel flBox flFLabel zm_title">',f+='<input value="'+a.SUM+",Chat&nbsp@"+e+'" id="zcl_chTit" style="font-size:14px;font-weight:weight;" maxlength="50">',f+="<label>Title</label>",f+="</div>",f+='<div class="inviteeList"></div>';if(a.ATT){f+='<div id="attDiv" class="addInv SC_floatLabel flFLabel clearfix addUsers autoFilldata">';for(var g in a.ATT.USR)for(var h in a.ATT.USR[g])f+='<div id="att" class="SC_cs myInv dFill" data-zid='+a.ATT.USR[g][h].ZUID+' title="'+a.ATT.USR[g][h].AID+'">',f+='<div class="SC_avtr">',f+='<img src="'+a.ATT.USR[g][h].PHOTO+'">',f+="</div>",f+="<span>"+a.ATT.USR[g][h].AID+"</span>",f+='<i class="msi-close closePopup prevB"></i>',f+="</div>";f+='<input id="atInp" type="text" class="zm_sgst">',f+="<label>Participants</label>",f+='<i class="msi-plus SC_thm borderPlus" id="attAdd"></i>'}else f+='<div id="attDiv" class="addInv SC_floatLabel flFLabel clearfix addUsers autoFilldata edit_parti">',f+='<input  id="atInp" type="text" class="zm_sgst"><label>Participants</label><i class="msi-plus SC_thm borderPlus SC_dyn" id="attAdd"></i></div>';return f+="</div>",f+="</div></div>",f},a.popupSmartAdd=function(){var a='<li class="zcl_qttl"></li><li class="zcl_table"><ul><li><input type="text" id="zcl_smaddtxt" placeholder="e.g. Client Breakfast at 10 am"></li><li><b onclick="ZCL_openSAddHelp()"><i class="msi-faq"></i></b></li></ul></li>';return a+='<li style="display:none" id="zcl_saddhelp">',a+='<p>To schedule an event for having breakfast with a client at 9 am, simply type "Client Breakfast at 9 am".</p>',a+="<h1>Dates,</h1><span>Team treat on Friday</span><span>Suganthi birthday Aug 15</span><span>Mehna BirthDay 8/15</span>",a+="<h1>Dates and Times,</h1><span>Leads meet 07/01/2008 10am-12pm</span><span>Meeting 08/01/2008 11:30 am</span>",a+="<h1>Multiple Days,</h1><span>Vacation Aug 3 - Aug 15</span><span>Conference in London 8/10 - 8/25</span>",a+="</li>",a},a.OutlookPopup=function(){var a='<div class="SC_PUcen zcl_ovr" style="max-height: 551px;">';return a+='<ul class="SC_cal_groups">',a+='<li><div id="zcl_olbtn" class="zm_comp"><a title="'+ZCL_replaceComName(zcal.i18n.outlooktitle64)+'" href="'+zcal.OUTLOOK64+'" class="SC_lnk"><span>Download</span><span><i class="msi-download"></i></span></a></div><span>'+ZCL_replaceComName(zcal.i18n.outlooktitle64)+"<s>Beta</s></span><em>("+ZCL_replaceComName(zcal.i18n.outlooksubtitle64)+")</em></li>",a+='<li><div class="zm_comp" id="zcl_olbtn"><a class="SC_lnk" href="'+zcal.OUTLOOK32+'" title="'+ZCL_replaceComName(zcal.i18n.outlooktitle32)+'"><span>Download</span><span><i class="msi-download"></i></span></a></div><span>'+ZCL_replaceComName(zcal.i18n.outlooktitle32)+"<s>Beta</s></span><em>("+ZCL_replaceComName(zcal.i18n.outlooksubtitle32)+")</em></li>",a+="</ul>",a+="<p>"+zcal.i18n.mshelp+"</p>",a+="</div>",a},a.calDetials=function(a,b){var c=ZCL_getHTML(b[0]),d=b[9],e=zcal.cdata.opt.TIM,f=location.protocol,g='<iframe src="'+f+"//"+zcal.ZCAL+(b[14]==""||b[14]=="gcal"?"":"/"+b[14])+"/embed/"+d+"?title="+c+"&type=1&l=en&tz="+e+'&sh=[1,1]&v=0" width="600" height="500" frameborder="0" scroll="auto"></iframe>',h='<div class="conditionDiv">';return h+='<div class="zmL">',h+='<div class="SC_srch shw">',h+='<table class="condition">',h+='<tr><td class="gbld">'+zcal.i18n.calname+"</td></tr>",h+='<tr><td><table><tr><td width="29%"><span>'+c+"</span></td></tr></table></td></tr>",h+="</table>",h+="</div>",h+="</div>",h+='<div class="zmL">',h+='<div class="SC_srch shw">',h+='<table class="condition">',h+='<tr><td class="gbld">'+zcal.i18n.calendarid+"</td></tr>",h+='<tr><td><table><tr><td width="29%"><span>'+d+"</span></td></tr></table></td></tr>",h+="</table>",h+="</div>",h+="</div>",h+='<div class="zmL">',h+='<div class="SC_srch shw">',h+='<table class="condition">',h+='<tr><td class="gbld">'+zcal.i18n.embedurl+"</td></tr>",h+='<tr><td><table><tr><td width="29%"><textarea type="text" class="zcl_Stxt">'+g+'</textarea><span class="zcl_lk" data-marker="embedMore">'+zcal.i18n.moretemplates+"</span></td></tr></table></td></tr>",h+="</table>",h+="</div>",h+="</div>",h+='<div class="zmL">',h+='<h2 class="recom_conditionHeading">'+zcal.i18n.reminder+"</h2>",h+='<ul class="zcl_rem">',h+='<li data-marker="calReminder"></li>',h+="</ul>",h+="</div>",h+='<span class="mLnone" data-marker="markAsBusy"><i class="msi-check"></i><span class="pl5">'+zcal.i18n.markasbusy_cal+"</span></span>",h+='<span class="mLnone" data-marker="dlgInvNtfy"><i class="msi-check"></i><span class="pl5">'+zcal.i18n.dlg_Inv_Notify+"</span></span>",h+="</div>",h+='<div class="SC_PUbtm"><span class="sel" data-marker="detailSave">'+zcal.i18n.save+'</span><span data-val="Cancel">'+zcal.i18n.cancel+"</span></div>",h},a.calShare=function(){var a='<div class="conditionDiv">';return a+='<div data-marker="loadingAnimation"></div>',a+='<div data-marker="publicShare"></div>',a+='<div data-marker="privateAddress"></div>',a+='<div data-marker="indShare"></div>',a+='<div class="zcl_Sshlst" data-marker="sharedList"></div>',a+="</div>",a+='<div class="SC_PUbtm"><span data-val="Cancel">'+zcal.i18n.close+"</span></div>",a},a.calEmbed=function(){var a="";return a+='<div class="SC_set SC_filt_bottom">',a+='<div class="zcl_Semdtmp" data-marker="embedTpl"/>',a+='<div class="conditionDiv">',a+='<table class="zcl_Semdsp"><tr>',a+='<td data-marker="embedTplImg"></td>',a+="<td>",a+='<div data-marker="embedTitleSec"></div>',a+="</td>",a+="<td>",a+='<div data-marker="embedTZSec"></div>',a+="</td>",a+="</tr></table>",a+="</div>",a+='<div class="zmL"><div class="SC_srch shw">',a+='<table class="condition">',a+='<tr><td class="gbld">'+zcal.i18n.embed_instruction+"</td></tr>",a+="<tr><td><table>",a+='<tr><td data-marker="embedCode"></td></tr>',a+="</table></td></tr>",a+="</table>",a+="</div></div>",a+="</div>",a},a.invitationview=function(a){var b="";b='<table cellspacing="0px" cellpadding="0px"  width="100%" style="_width:97%;border:1px solid #e7e7e7;display:table;table-layout:fixed">',b+="<tr>",b+='<td colspan="2">',b+='<table cellspacing="0px" cellpadding="0px" width="100%" style="font:normal 11px Verdana,arial,Helvetica,sans-serif;color:#333333;border:1px solid #ffffff;display:table;table-layout:fixed">',b+='<tr bgcolor="#fafafa">',b+="<td>",b+='<table cellspacing="0px" cellpadding="0px" style="font:normal 11px Verdana,arial,Helvetica,sans-serif;color:#333333;float:left">',b+="<tr>",b+='<td background="$IMG_INV$" width="46px" height="52"></td>',b+='<td style="padding-left:10px;color:#000000;height:52px"><a href="mailto:'+zcal.cdata.opt.MID+'">'+zcal.cdata.opt.MID+"</a> <br/><b>Invites you</b></td>",b+="</tr>",b+="</table>",b+="</td>",b+="</tr>",b+="<tr>",b+='<td width="100%">',b+='<table cellspacing="0px" cellpadding="0px" width="100%" style="background-color:#ffffff;padding:1px">',b+="<tr>",b+="<td>",b+='<table cellspacing="0px" cellpadding="5px" width="100%" style="font:normal 11px Verdana,arial,Helvetica,sans-serif;line-height:18px;color:#333333;border-collapse:collapse;word-wrap:break-word;table-layout:fixed">',b+="<tr>",b+='<td width="100px" style="font-weight:bold;border-bottom:1px solid #f4f4f4;vertical-align:top">'+zcal.i18n.title+"</td>",b+='<td style="border-bottom:1px solid #f4f4f4;vertical-align:top">'+a.title+"</td>",b+="</tr>",b+="<tr>",b+='<td style="font-weight:bold;border-bottom:1px solid #f4f4f4;vertical-align:top">Date</td>',b+='<td style="border-bottom:1px solid #f4f4f4;vertical-align:top">On '+a.date+"</td>",b+="</tr>",b+="<tr>",b+='<td style="font-weight:bold;border-bottom:1px solid #f4f4f4;vertical-align:top">Attendees</td>',b+='<td style="border-bottom:1px solid #f4f4f4;vertical-align:top"><span style="pointer:cursor;color:#878787;">';for(var c in a.att)b+='<a href="mailto:'+a.att[c]+'">'+a.att[c]+"</a>"+",";return b+="</span></td>",b+="</tr>",b+="</table>",b+="</td>",b+="</tr>",b+="</table>",b+="</td>",b+="</tr>",b+="</table>",b+="</td>",b+="</tr>",b+="</table>",b},a}();zcal.TTT=["12:00 am","12:30 am","1:00 am","1:30 am","2:00 am","2:30 am","3:00 am","3:30 am","4:00 am","4:30 am","5:00 am","5:30 am","6:00 am","6:30 am","7:00 am","7:30 am","8:00 am","8:30 am","9:00 am","9:30 am","10:00 am","10:30 am","11:00 am","11:30 am","12:00 pm","12:30 pm","1:00 pm","1:30 pm","2:00 pm","2:30 pm","3:00 pm","3:30 pm","4:00 pm","4:30 pm","5:00 pm","5:30 pm","6:00 pm","6:30 pm","7:00 pm","7:30 pm","8:00 pm","8:30 pm","9:00 pm","9:30 pm","10:00 pm","10:30 pm","11:00 pm","11:30 pm"],zcal.TT=["12 am","1 am","2 am","3 am","4 am","5 am","6 am","7 am","8 am","9 am","10 am","11 am","12 pm","1 pm","2 pm","3 pm","4 pm","5 pm","6 pm","7 pm","8 pm","9 pm","10 pm","11 pm"];var ZCL_REMSTR=[],ZCL_REM=["300000","600000","900000","1200000","1500000","1800000","2700000","3600000","7200000","14400000","21600000","28800000","43200000","86400000","172800000","259200000","345600000","432000000","518400000","604800000","691200000","777600000","864000000","950400000","1036800000","1123200000","1209600000","1296000000","2592000000","3888000000","5184000000","7776000000"];zcal.OBJTEMP;var ZCL_SERVICE="";zcal.MSPERMINUTE=6e4,zcal.MSPERHOUR=36e5,zcal.TF=["hh:mm a","HH:mm"],zcal.EOBJ=null,zcal.EMODE=0,zcal.CAL_IND=0;var ZCL_NTFY_ATT=-1,ZCL_OLD_COBJ,ZCL_AttachSize,ZCL_AttachCount,ZCL_AttachElement=[];ZCL_hdnFld=function(a,b){return'<input type="hidden" id="'+a+'" value="'+b+'"/>'},ZCL_SetEventHiddenFlds=function(a){var b,c,d,e,f,g,h,i;return b=zcal.EOBJ.EUID?zcal.EOBJ.EUID:"",c=zcal.EOBJ.EID?zcal.EOBJ.EID:"",d=zcal.EOBJ.RIDX?zcal.EOBJ.RIDX:"",e=zcal.EOBJ.REPINST?zcal.EOBJ.REPINST:"",f=zcal.EOBJ.CNAME?zcal.EOBJ.CNAME:"",g=zcal.EOBJ.EPERM?zcal.EOBJ.EPERM:"",h=zcal.EOBJ.DPERM?zcal.EOBJ.DPERM:"",i=zcal.EOBJ.RTO?zcal.EOBJ.RTO:"",txt=ZCL_hdnFld("zcl_ce_mode",zcal.EMODE)+ZCL_hdnFld("zcl_eid",c)+ZCL_hdnFld("zcl_rmvatt","")+ZCL_hdnFld("zcl_ekey",b)+ZCL_hdnFld("zcl_ridx",d)+ZCL_hdnFld("zcl_repinst",e)+ZCL_hdnFld("zcl_crel",f)+ZCL_hdnFld("zcl_eperm",g)+ZCL_hdnFld("zcl_dperm",h)+ZCL_hdnFld("zcl_oldCkey",a[9])+ZCL_hdnFld("zcl_rtoval",i)+ZCL_hdnFld("zcl_rmvgatt","")+ZCL_hdnFld("zcl_ce_isrep","false"),txt},ZCL_SetEventTtl=function(a){var b='<ul class="zcl_frmrw">',c;return zcal.EMODE==0?(c=zcal.EOBJ.SUM?ZCL_getHTML(zcal.EOBJ.SUM):"",b+='<li class="zcl_evttvw">'+c+"</li>"):(c=zcal.EOBJ.SUM?ZCL_getHTML(zcal.EOBJ.SUM):"",b+='<li class="zcl_W70pc">',b+='<input type="text" placeholder="Untitled event" class="zcl_crevntt SC_tiput" value="'+c+'" id="zcl_ce_tit">',b+="</li>",b+='<li class="zcl_curpt" onclick="ZCL_ChgChk(this)"><i class="'+(zcal.EOBJ.CLASS&&zcal.EOBJ.CLASS==1?"msi-check":"msi-uncheck")+'" id="zcl_ce_pvt"></i>'+zcal.i18n.eprivate+"</li>"),b+="</ul>",b},ZCL_SetEventCal=function(){var a="";if(zcal.EMODE==0)a+='<ul class="zcl_frmrw"><li><u>'+zcal.i18n.calendar+"</u><span>"+ZCL_GetCalName(zcal.EOBJ.CNAME)+"</span></li></ul>";else{var b=zcal.cdata.calLst[zcal.EOBJ.CNAME]||zcal.cdata.calGLst[zcal.EOBJ.CNAME]||zcal.cdata.calALst[zcal.EOBJ.CNAME]||zcal.cdata.calOLst[zcal.EOBJ.CNAME];a+="<li><u>"+zcal.i18n.calendar+'</u><div class="SC_select" ><input rel="'+zcal.EOBJ.CNAME+'" value="'+b[0]+'" id="zcl_ce_cal" type="text" style="width:212px" readonly></div></li>'}return a},ZCL_SetEventSchTime=function(){var a=zcal.timeformat[zcal.cdata.opt.TF],b=zcal.EOBJ.ADAY&&zcal.EOBJ.ADAY==1?!0:!1,c=zcal.EOBJ.SD,d=zcal.EOBJ.ED,e=b?"8:00 am":zcal.EOBJ.ST,f=b?"8:30 am":zcal.EOBJ.ET,g=e.getTimeBy(a),h=f.getTimeBy(a),i=ZCL_splitDateVal(ZCL_putDate(c)),j=ZCL_splitDateVal(ZCL_putDate(d)),k=ZCL_parseTime(g),l=ZCL_parseTime(h);ZCL_ESDATE=new Date(i[2],i[1]-1,i[0],k.HH,k.mm,0,0),ZCL_EEDATE=new Date(j[2],j[1]-1,j[0],l.HH,l.mm,0,0),zcal.EOBJ.rObj=new zcalRepeat,zcal.EOBJ.rObj.init(ZCL_ESDATE);if(zcal.EMODE==0){var m='<ul class="zcl_frmrw"><li>',n=ZCL_parseDateStr(c),o=ZCL_parseDateStr(d);return m+=n.dateBy("MMM dd, yyyy"),b?m+=c!=d?" - "+o.dateBy("MMM dd, yyyy"):"":(m+=c!=d?", "+g+" - "+o.dateBy("MMM dd, yyyy")+", "+h:", "+g+" - "+h,m+=zcal.EOBJ.ETZ?'&nbsp;<span class="zcl_greymr">'+zcal.EOBJ.ETZ+"</span>":""),m+="</li></ul>",m}var p=b?'style="display:none"':"",q=zcal.EOBJ.ETZ?zcal.EOBJ.ETZ:zcal.cdata.opt.TIM,r=zcal.EOBJ.IN_ETZ&&zcal.EOBJ.IN_ETZ==1?!0:!1,m='<ul class="zcl_frmrw zcl_when"><li class="zcl_select" id="zcl_ce_timdv"><input class="zcl_w100 SC_tiput" type="text" value="'+ZCL_putDate(c)+'" id="zcl_ce_sd" readonly />'+"</li>"+"&nbsp;&nbsp;"+'<li class="zcl_select" '+p+' id="zcl_ce_stpar">'+'<input class="zcl_w70 SC_tiput" type="text" id="zcl_ce_st" value="'+g+'"/>'+"</li>"+'<li class="zcl_tmto">to</li>'+'<li class="zcl_select" id="zcl_ce_edpar">'+'<input class="zcl_w100 SC_tiput" type="text" value="'+ZCL_putDate(d)+'" id="zcl_ce_ed" readonly />'+"</li>"+"&nbsp;&nbsp;"+'<li class="zcl_select" '+p+' id="zcl_ce_etpar">'+'<input class="zcl_w70 SC_tiput" type="text" id="zcl_ce_et" value="'+h+'"/>'+"</li>"+'<li><span class="zcl_lk zcl_cetmz" id="zcl_ce_tza">'+q+"</span></li>"+"</ul>";return!b&&zcal.EOBJ.ETZ&&(m+='<ul class="zcl_frmrw zcl_when"><li class="zcl_curpt"><i class="'+(r?"msi-check":"msi-uncheck")+'" id="zcl_ce_inetz"></i>'+ZCL_replaceString(zcal.i18n.display_in_etz,[q])+"</li>"+"</ul>"),m},ZCL_SetAllDayRepeatSec=function(){var a="";zcal.EOBJ.REP&&(zcal.EOBJ.rObj.update(zcal.EOBJ.REP),a=zcal.EOBJ.rObj.getStr());var b='<ul class="zcl_frmrw"><li class="zcl_curpt"><i class="'+(zcal.EOBJ.ADAY&&zcal.EOBJ.ADAY==1?"msi-check":"msi-uncheck")+'" id="zcl_ce_aday"></i>'+zcal.i18n.allday+"</li>";return b+=zcal.EOBJ.RBRK&&zcal.EOBJ.RBRK==1?"":'<li id="zcl_rep" class="zcl_curpt" onclick="ZCL_chgeRepOpt(this, event)"><i class="'+(zcal.EOBJ.REP?"msi-check":"msi-uncheck")+'"></i>'+zcal.i18n.repeat+(a!=""?'<span class="zcl_lk" id="zcl_rep_span" onclick="ZCL_chgeRepOpt(this, event)">'+a+"</span>":"")+"</li>",b+="</ul>",b},ZCL_SetEventLoc=function(){var a="",b=zcal.EOBJ.LOC?ZCL_getHTML(zcal.EOBJ.LOC):"";return zcal.EMODE==0?b!=""&&(a+='<ul class="zcl_frmrw"><li><u>'+zcal.i18n.loc+"</u><span>"+b+"</span></li></ul>"):a+="<li><u>"+zcal.i18n.loc+'</u><input type="text" class="zcl_crlk SC_tiput" id="zcl_ce_loc" value="'+b+'"></li>',a},ZCL_SetEventColor=function(){var a="";return zcal.EMODE==0?zcal.EOBJ.EC>-1&&(a+='<ul class="zcl_frmrw"><li><u class="zcl_frmtt">'+zcal.i18n.eventcolor+"</u>",a+='<ul class="zcl_cecolr"><li style="background-color:'+zcal.eventcolor[zcal.EOBJ.EC]+'"></li></ul>',a+="</li></ul>"):a+='<ul class="zcl_frmrw">'+ZCL_EventColorSel()+"</ul>",a},ZCL_EventColorSel=function(){var a='<li class="zcl_frmtt">'+zcal.i18n.eventcolor+'</li><li><ul class="zcl_cecolr" id=zcl_ce_color rel="'+(zcal.EOBJ.EC?zcal.EOBJ.EC:-1)+'">';for(var b=0;b<zcal.eventcolor.length;b++){var c=zcal.EOBJ.EC==b?'class="zcl_sl"':"";a+='<li id="zcl_ecolor'+b+'" rel='+b+' onclick="ZCL_EventColor(this)" style="background-color:'+zcal.eventcolor[b]+'" '+c+'><i class="msi-tick"></i></li>'}return a+="</ul></li>",a},ZCL_EventColor=function(a){var b=zcal.$("zcl_ce_color").getElementsByTagName("li");for(var c=0;c<b.length;c++){var d=b[c];a.id!="zcl_ecolor"+c&&(d.className="")}a.className==""?(a.className="zcl_sl",zcal.$("zcl_ce_color").setAttribute("rel",a.getAttribute("rel"))):(a.className="",zcal.$("zcl_ce_color").setAttribute("rel","-1"))},ZCL_SetEventAlrm=function(a){var b="";if(zcal.EMODE==0||zcal.EMODE==1&&a[14]!=""){if(zcal.EOBJ.REMTY&&zcal.EOBJ.REMTY==1)b+=ZCL_putAlarmForView(zcal.EOBJ.ALARM);else if(zcal.EOBJ.REMTY&&zcal.EOBJ.REMTY==2)b+=ZCL_putCalAlarmForView(a[6]);else if(a[14]!=""){var c=ZCL_putCalAlarmForView(a[6]);b+=c!=""?c:""}return zcal.CALMODE==0&&zcal.EMODE==0&&zcal.EOBJ.EPERM==1&&(b+=a[14]==""&&a[5]!=2?"<div "+(b!=""?'style="padding-top:5px"':"")+'><a id="zcl_setrem" class="SC_lnk">'+zcal.i18n.setreminder+"</a></div>":""),b!=""?'<ul class="zcl_frmrw zcl_rem"><li id="zcl_ce_rem"><u>'+zcal.i18n.reminder+"</u>"+b+"</li></ul>":""}return zcal.EOBJ.REMTY==1&&zcal.EOBJ.ALARM?b+=ZCL_putAlarm(zcal.EOBJ.ALARM):zcal.EOBJ.REMTY==2?b+=ZCL_putCalAlarm(a[6]):b+=ZCL_RemAddLnk(),'<ul class="zcl_frmrw zcl_rem"><li id="zcl_ce_rem">'+b+"</li></ul>"},ZCL_setGrpCalAlarm=function(a,b){var c="";if(zcal.EMODE==0||zcal.EMODE==1&&a[14]!=""){if(zcal.EOBJ.REMTY&&zcal.EOBJ.REMTY==1)c+=ZCL_putAlarmForView(zcal.EOBJ.ALARM);else if(zcal.EOBJ.REMTY&&zcal.EOBJ.REMTY==2)c+=ZCL_putCalAlarmForView(a[6]);else if(a[14]!=""){var d=ZCL_putCalAlarmForView(a[6]);c+=d!=""?d:""}zcal.CALMODE==0&&zcal.EMODE==0&&zcal.EOBJ.EPERM==1&&(c+=a[14]==""&&a[5]!=2?"<div "+(c!=""?'style="padding-top:5px"':"")+'><a id="zcl_setrem" class="SC_lnk">'+zcal.i18n.setreminder+"</a></div>":"")}else zcal.EOBJ.REMTY==1&&zcal.EOBJ.ALARM?c+=ZCL_putAlarm(zcal.EOBJ.ALARM):zcal.EOBJ.REMTY==2?c+=ZCL_putCalAlarm(a[6]):c+=ZCL_RemAddLnk();if(!b)return c;if(c=="")ZCL_$("zcl_ce_rem")&&ZCL_$("zcl_ce_rem").parentNode.parentNode.removeChild(ZCL_$("zcl_ce_rem").parentNode);else if(ZCL_$("zcl_ce_rem"))ZCL_$("zcl_ce_rem").innerHTML=c;else{var e=document.createElement("div");e.className="zcl_frm",e.innerHTML='<ul class="zcl_frmrw zcl_rem"><li id="zcl_ce_rem"><u>'+zcal.i18n.reminder+'</u><div class="zcl_frmaln" id="zcl_ce_rem">'+c+"</div></div>",ZCL_$("zcl_ce_ele").insertBefore(e,ZCL_$("zcl_ce_ele").childNodes[6])}},ZCL_SetEventAttach=function(a,b){ZCL_AttachSize=0,ZCL_AttachCount=0;var c='<ul class="zcl_frmrw zcl_rem" style="display:'+(b[14]==""||b[14]!="gcal"?"":"none")+'"><li id="zcl_ce_attach"><div class="'+(zcal.EMODE==0?"zmPAtt":"zmCAt")+'">';if(zcal.EOBJ.HAS_ATTACH&&zcal.EOBJ.ATTACH)for(var d=0;d<zcal.EOBJ.ATTACH.length;d++)c+=ZCL_Getattachhtml(zcal.EOBJ.ATTACH[d],a);return c+="</div>",zcal.EMODE!=0&&a==0&&(c+='<input type="file" style="display:none" multiple id="AttachInput" onchange="ZCL_addAttach(event)"><ul id="zcl_addAttach"><li><span onclick=zcal.$("AttachInput").click()><i class="msi-add"></i>'+zcal.i18n.addattachment+"</span></li></ul>"),c+="</li></ul>",c},ZCL_addAttach=function(a){var b=a.path?a.path[0].files:a.target.files;for(var c=0;c<b.length;c++){var d,e,f=new FormData;d=b[c].name;var g=/\b(ade|adp|bat|chm|cmd|com|cpl|exe|hta|ins|isp|jar|jse|lib|lnk|mde|msc|msp|mst|pif|scr|sct|shb|sys|vb|vbe|vbs|vxd|wsc|wsf|wsh)\b/ig,h=d.lastIndexOf("."),i="";h>0&&(i=d.substr(h+1,d.length)),i.match(g)?zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.attachpolicy,[d])):(f.append("zcl_attachFile",b[c]),fileSize=b[c].size,ZCL_AttachSize+=b[c].size,ZCL_AttachCount++,ZCL_SendFiletoProcess(f,d,fileSize))}ZCL_$("AttachInput").value=""},ZCL_SendFiletoProcess=function(a,b,c){if(ZCL_AttachSize<=10485760){var d="loadfile"+ZCL_AttachCount,e=ZCL_Getattachhtml({name:b,size:c,id:d},0);ZCL_$("zcl_ce_attach").childNodes[0].appendChild(e);var f=document.cookie,g;f=f.substring(f.indexOf("aprmjrnpkcrkks=")+15,f.length),g=f.indexOf(";")!=-1?f.substring(0,f.indexOf(";")):f,a.append("mstpcrdhkur",g);var h=new XMLHttpRequest;h.upload.addEventListener("progress",function(a){ZCL_$(d)&&(ZCL_$(d).querySelector("div[id=progressbar]").style.width=a.loaded/a.total*100+"%")},!1),h.onreadystatechange=function(){if(this.readyState==4&&this.status==200){var a=JSON.parse(this.responseText);if(a.status=="success"){if(ZCL_$(d)){var b=ZCL_$(d).querySelector("div[id=progressbar]");b.parentNode.removeChild(b),ZCL_$(d).querySelector("div[id=attachMenu]").style.display="",ZCL_$(d).querySelector("div[id=attachSize]").style.display="",ZCL_$(d).setAttribute("rel",a.fileId),ZCL_$(d).setAttribute("size",a.size),ZCL_$(d).setAttribute("type",a.contentType),ZCL_$(d).setAttribute("akey",a.attachKey),ZCL_$(d).setAttribute("name",ZCL_encodeHTML(a.fileName)),ZCL_$(d).setAttribute("preview",a.preview),ZCL_$(d).id="fileAttachment"}}else ZCL_$(d)&&(ZCL_$(d).parentNode.removeChild(ZCL_$(d)),zmUtil.succErrMsg("e",zcal.i18n.uploaderror))}else(this.status==400||this.status==500)&&ZCL_$(d)&&(ZCL_$(d).parentNode.removeChild(ZCL_$(d)),zmUtil.succErrMsg("e",zcal.i18n.uploaderror))},h.open("POST","/mail/cal/addAttachment.do",!0),h.send(a)}else zmUtil.succErrMsg("e",zcal.i18n.maxlimit),ZCL_AttachSize-=c,ZCL_AttachCount--},ZCL_PreviwAttach=function(a){ZCL_AttachElement=[];var b=document.querySelectorAll("[id=fileAttachment]");window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""));for(var c=0;c<b.length;c++){var d={fn:b[c].getAttribute("name"),ft:b[c].getAttribute("type").match(/(image\/)/)?101:103,src:b[c].getAttribute("preview")=="true"?"/mail/cal/attachment/preview/"+b[c].getAttribute("akey")+"?frameorigin="+window.location.origin:"",fileId:b[c].getAttribute("rel"),akey:b[c].getAttribute("akey")};ZCL_AttachElement.push(d)}var e;a.className&&a.className=="zmImg"?e=a.parentNode.parentNode.parentNode:e=zcal.EMODE==0?a.parentNode.parentNode.parentNode.parentNode.parentNode:a.parentNode.parentNode.parentNode.parentNode;var f=ZCL_getCurelIndex(e.getAttribute("rel"),1),g=e.getAttribute("preview");if(g=="true")if(f>=0){var h={startIndex:f,attObjList:ZCL_AttachElement,hideAllOptions:!0,ignoreThumb:!0};h.addIcons={download:{"class":"msi-download",title:zmText.get("attachmentUtility").prevMenu.downLoad,events:[{name:"click",listener:function(a,b){var c="/mail/cal/attachment/download/"+b.akey;window.open(c)}}]}},zmUtil.initAttSlideShow(h)}else zmUtil.succErrMsg("e",zcal.i18n.uploadprogress);else ZCL_getDownloadLink(a)},ZCL_GetFileSize=function(a){var b="";navigator.appVersion.indexOf("Win")!=-1&&(b="Windows"),navigator.appVersion.indexOf("Mac")!=-1&&(b="MacOS"),navigator.appVersion.indexOf("X11")!=-1&&(b="UNIX"),navigator.appVersion.indexOf("Linux")!=-1&&(b="Linux");var c=b=="MacOS"?parseInt(1e3):parseInt(1024),d=["Bytes","KB","MB","GB","TB"];if(a>0)var e=parseInt(Math.floor(Math.log(a)/Math.log(c))),f=(a/Math.pow(c,e)).toFixed(1)+" "+d[e];return f},ZCL_rmvAttach=function(a){var b=a.parentNode.parentNode.parentNode.parentNode;ZCL_AttachSize-=b.getAttribute("size"),b.parentNode.removeChild(b),ZCL_AttachCount--},ZCL_Getattachhtml=function(a,b){var c="",d;if(b==0){var e=zmUtil.fileTyp(a.name)[1],f=ZCL_encodeHTML(a.name);return a.fileId?(ZCL_AttachSize+=parseInt(a.size),ZCL_AttachCount++,c+='<div class="'+(zcal.EMODE==0?"zmL zmAch":"zmL SC_Pbar")+'" id="fileAttachment" data="'+a.attachId+'" rel='+a.fileId+' size="'+a.size+'" type="'+a.contentType+'" akey="'+a.attachKey+'" name="'+f+'" preview="'+a.preview+'">'):(d=document.createElement("DIV"),d.className=zcal.EMODE==0?"zmL zmAch":"zmL SC_Pbar",d.id=a.id),c+='<div class="zmLst">',c+='<div class="zmDtl">',c+='<div class="zmImg" onclick="ZCL_PreviwAttach(this)">',c+='<i class="'+(e!=""?e:"msi-attothers")+'"></i>',c+="</div>",c+='<div class="zmFrm">',c+='<span title="'+a.name+'" data-msg="view">'+f+"</span>",c+="</div>",c+='<div class="zmSub" id="attachMenu" style="display:'+(a.fileId?"":"none")+'">',zcal.EMODE==0?(c+="<font>",c+='<i class="msi-download" title="'+zcal.i18n.download+'" onclick="ZCL_getDownloadLink(this)" data-msg="download"></i>',c+="</font>",a.preview&&(c+="<font>",c+='<i class="msi-zoomin" title="'+zcal.i18n.view+'" onclick="ZCL_PreviwAttach(this)" data-msg="view"></i>',c+="</font>")):(c+='<span  onclick="ZCL_PreviwAttach(this)">'+zcal.i18n.preview+"</span>",c+='<span  onclick="ZCL_getDownloadLink(this)">'+zcal.i18n.download+"</span>"),c+="</div>",c+='<div class="zmSze" id="attachSize" style="display:'+(a.fileId?"":"none")+'">',c+='<span class="sum">'+ZCL_GetFileSize(a.size)+"</span>",c+="</div>",zcal.EMODE!=0&&(c+='<div class="SC_icn">',c+='<i class="msi-close" onclick="ZCL_rmvAttach(this)"></i>',c+="</div>",c+='<div class="zm_lbl">',a.fileId||(c+='<div id="progressbar">',c+="</div>"),c+="</div>"),c+="</div>",c+="</div>",a.fileId&&(c+="</div>"),a.fileId?c:(d.innerHTML=c,d)}return c="<p>"+a.name+"</p>",c},ZCL_getCurelIndex=function(a,b){for(var c=0;c<ZCL_AttachElement.length;c++){if(!a)return-1;if(ZCL_AttachElement[c].fileId==a){if(b==0){ZCL_AttachElement.splice(c,1);break}return c}}},ZCL_getFileAttach=function(a){var b="",c=[],d=$("#zcl_ce_cal")[0].getAttribute("rel"),e=zcal.getCalObj(d);if(e[14]==""||e[14]!="gcal"){if(zcal.$("fileAttachment")){var c=document.querySelectorAll("[id=fileAttachment]");if(a=="get")for(var f=0;f<c.length;f++)c[f].getAttribute("data")||(b+=b==""?c[f].getAttribute("rel"):","+c[f].getAttribute("rel"))}ZCL_AttachCount=0,ZCL_AttachSize=0}return a=="get"?b:c.length>0?!0:!1},ZCL_getFileRemoved=function(){var a="";if(zcal.EOBJ.ATTACH){var b=[],c=document.querySelectorAll("[id=fileAttachment]");for(var d=0;d<c.length;d++)c[d].getAttribute("data")&&b.push(c[d].getAttribute("rel"));for(var d=0;d<zcal.EOBJ.ATTACH.length;d++)a+=b.indexOf(zcal.EOBJ.ATTACH[d].fileId)<0?a==""?zcal.EOBJ.ATTACH[d].attachId:","+zcal.EOBJ.ATTACH[d].attachId:""}return a},ZCL_getDownloadLink=function(a){var b;a.className&&a.className=="zmImg"?b=a.parentNode.parentNode.parentNode:b=zcal.EMODE==0?a.parentNode.parentNode.parentNode.parentNode.parentNode:a.parentNode.parentNode.parentNode.parentNode;var c=b.getAttribute("akey"),d=b.getAttribute("name"),e="/mail/cal/attachment/download/"+c;window.open(e)},ZCL_SetEventLnk=function(){var a="",b=zcal.EOBJ.URL?ZCL_getHTML(zcal.EOBJ.URL):"";return zcal.EMODE==0?b!=""&&(a+='<ul class="zcl_frmrw"><li><u>'+zcal.i18n.link+'</u><span class="zcl_lk" id="zcl_ve_lnk">'+b+"</span></li></ul>"):a+='<ul class="zcl_frmrw"><li class="zcl_W70pc"><u>'+zcal.i18n.link+'</u><input type="text" class="zcl_crlk SC_tiput" id="zcl_ce_lnk" value="'+b+'"></li></ul>',a},ZCL_SetEventDesc=function(){var a="",b=zcal.EOBJ.DESC?zcal.EOBJ.DESC:"";return zcal.EMODE==0?a+='<ul class="zcl_frmrw"><li><u>'+zcal.i18n.description+'</u><div class="zcl_vwdes" id="zcl_cedesc"></div></li></ul>':a+='<ul class="zcl_frmrw"><li class="zcl_W70pc"><u>'+zcal.i18n.description+'</u><textarea style="height:44px;" class="zcl_Cedes SC_tiput" id="zcl_ce_desc"></textarea></li></ul>',a},ZCL_dispDesc=function(a){a.className="zcl_curpt zcl_hide",zcal.$("zcl_ce_desc").parentNode.className=""},ZCL_SetAlrm=function(){var a="";if(zcal.EOBJ.REMTY==1&&zcal.EOBJ.ALARM)a+=ZCL_putAlarm(zcal.EOBJ.ALARM);else if(zcal.EOBJ.REMTY==2){var b=zcal.getCalObj(zcal.EOBJ.CNAME);a+=ZCL_putCalAlarm(b[6])}else a+=ZCL_putAlarm([{ACTYPE:"0",REMTYPE:"0",REMTIME:"300000"}]);ZCL_$("zcl_ce_rem").innerHTML=a,ZCL_$("zcl_ce_rem")&&$("#zcl_ce_rem .msi-close").off("click").on("click",function(){var a=this.parentNode.parentNode.parentNode,b;a.removeChild(this.parentNode.parentNode),b=a.querySelector("#zcl_addrem"),b||ZCL_AppendRemAddLnk(a)});var c=zmsuite.getCenter()[1].getNodes()[0],d=c.headerArr.text,e={id:"zcalPrevHeader",rIcons:[{groupId:"Save",actionArr:[{iconClass:"msi-save",tooltip:zcal.i18n.save,data:{action:"setEventAlarm"}}]},{groupId:"Delete",actionArr:[{iconClass:"msi-trash",data:{action:"eventDelete"},tooltip:"eventDelete"}]},{groupId:"Close",actionArr:[{iconClass:"msi-close",tooltip:zcal.i18n.save,data:{action:"eventClose"}}]}]};c.push(e),e.text=d,c.render()},ZCL_SetEventAttStsUpd=function(){var a="";if(!zcal.EOBJ.ISEXP&&zcal.EOBJ.USTAT){var b=zcal.EOBJ.ATTEMAIL,c=zcal.EOBJ.USTAT,d="",e="zcl_evtxa zcl_greymr";zcal.EOBJ.UCMNT&&(d=zcal.EOBJ.UCMNT,e="zcl_evtxa"),a+='<ul class="zcl_frmrw zcl_vwsts"><li><u>'+ZCL_UStatusText(c,b)+"</u>"+ZCL_hdnFld("zcl_skey",zcal.EOBJ.SKEY),a+='<ul class="zcl_qvsup" id="zcl_ce_asts">'+ZCL_AttStsDv(c)+"</ul>",a+='<textarea style="height: 30px;" class="SC_tiput" id="zcl_cu_cmt">'+d+"</textarea>",a+='<div class="SC_PUbtm"><span onclick="ZCL_sndStat()">'+zcal.i18n.update+"</span></div>",a+="</li></ul>"}return a},ZCL_SetEventAss=function(){var a="",b=zcal.EOBJ.RTO,c=ZCL_getOthSrv(),d=c[0].split(","),e=c[1].split(","),f="";for(var g=0;g<d.length;g++){var h=d[g].split(":")[0],i=d[g].split(":")[1];if(zcal.EMODE==0){var j=zcal.EOBJ.EID.indexOf("_")!=-1?zcal.EOBJ.EID.split("_")[0]:zcal.EOBJ.EID;b[e[g]]==1&&(f+="<li onmousedown=\"ZCL_callService('e"+h+"','"+j+'\', event)"><i class="msi-'+i+'" title="'+zcal.i18n["eass_"+h]+'"></i></li>')}else f+=h!="mil"?'<li onclick="ZCL_ChgChk(this)"><i id="zcl_ce_'+h+'" class="'+(b[e[g]]==1?"msi-check":"msi-uncheck")+'"></i><i class="msi-'+i+'" title="'+zcal.i18n["eass_"+h]+'"></i></li>':'<input type="hidden" id="zcl_ce_'+h+'" value="'+b[e[g]]+'"/>'}return a+=f!=""?"<li><u>"+zcal.i18n.associate+"</u><ul>"+f+"</ul></li>":"",a},ZCL_SetEventAtt=function(){var a="";if(zcal.EMODE==1&&(zcal.EOBJ.EID&&zcal.EOBJ.ATT||zcal.sendInv!="0")||zcal.EMODE==0&&zcal.EOBJ.ATT)a+=ZCL_SetIndAttLst("all");return a},ZCL_attStsLnk=function(a,b){return b==a?'<li class="zcl_sl">'+zcal.i18n[a]+"</li>":"<li onclick=\"ZCL_swtchAtt('"+a+"', this)\">"+zcal.i18n[a]+"</li>"},ZCL_swtchAtt=function(a,b){ZCL_$("zcl_ce_aslst").innerHTML=ZCL_attStsLnk("all",a)+ZCL_attStsLnk("yes",a)+ZCL_attStsLnk("no",a)+ZCL_attStsLnk("maybe",a)+ZCL_attStsLnk("pending",a),ZCL_$("zcl_ce_attlst").innerHTML=ZCL_ListAtt(a);var c=$("#zcl_ce"),d=c.find("[data-marker=groupAtt]");d.length>0&&(d.removeAttr("data-marker"),d.off("click").on("click",function(){var a=$(this),b=a.data("gid"),c=a.data("sts");ZCL_listGroupUserAtt(b,c)}))},ZCL_SetSvCnlBtn=function(){return'<ul class="zcl_frmrw"><li><div class="SC_PUbtm"><span onclick="ZCL_svEve()">'+zcal.i18n.save+'</span><span data-val="Cancel" onclick="ZCL_eClose()">'+zcal.i18n.cancel+"</span></div></li></ul>"},ZCL_ConstEventPage=function(){var a=zcal.EOBJ.CNAME,b,c="",d,e="";b=zcal.getCalObj(a),b[14]=="crm"||b[14]=="recruit"&&zcal.cdata.calOUids.indexOf("zohoRecruit4_")!=-1?(crmCalId=a,zcalCRM.showCRMForm()):b[14]=="ztask"?zcalTask.showTaskForm():(c+='<div class="zcl zcl_CMS zcl_H100" id="zcl_ce">',c+=ZCL_SetEventHiddenFlds(b),c+='<div class="zcl_table zcl_H100">',d=ZCL_SetEventAtt(),e=b[14]==""?ZCL_SetEventAss():"",zcal.EMODE==0?c+='<ul><li><ul class="zcl_crevnt" id="zcl_ce_ele"><li><ul class="zcl_vwev"><li>'+ZCL_SetEventTtl(b[14])+ZCL_SetEventSchTime()+ZCL_SetEventAlrm(b)+(zcal.isAttach&&(zcal.EMODE==0&&zcal.EOBJ.ATTACH||zcal.EMODE!=0)?ZCL_SetEventAttach(0,b):"")+(b[14]!=""?"":ZCL_SetEventColor())+ZCL_SetEventLoc()+ZCL_SetEventCal()+ZCL_SetEventLnk()+ZCL_SetEventDesc()+"</li>"+"</ul>"+"</li>"+"</ul>"+"</li>"+'<li class="zcl_Cer zcl_vwCer" id="zcl_ce_ext">'+ZCL_SetMetaInfo(d,b[14])+ZCL_SetEventAttStsUpd()+(e!=""?'<ul class="zcl_frmrw" id="zcl_ce_ass">'+e+"</ul>":"")+d+"</li>"+"</ul>":(c+='<ul><li><ul class="zcl_crevnt" id="zcl_ce_ele"><li>'+ZCL_SetEventTtl(b[14])+ZCL_SetEventSchTime()+ZCL_SetAllDayRepeatSec()+"</li>"+"<li>"+ZCL_SetEventAlrm(b)+(zcal.isAttach&&(zcal.EMODE==0&&zcal.EOBJ.ATTACH||zcal.EMODE!=0)?ZCL_SetEventAttach(0,b):"")+(b[14]!=""?"":ZCL_SetEventColor())+'<ul class="zcl_frmrw" id="zcl_ce_loccal">'+ZCL_SetEventLoc()+ZCL_SetEventCal()+"</ul>"+ZCL_SetEventLnk()+ZCL_SetEventDesc()+ZCL_SetSvCnlBtn()+"</li>"+"</ul>"+"</li>"+'<li class="zcl_Cer" id="zcl_ce_ext">',zcal.EOBJ.EID&&(c+=ZCL_SetMetaInfo(d,b[14]),c+=ZCL_SetEventAttStsUpd()),c+=(e!=""?'<ul class="zcl_frmrw" id="zcl_ce_ass">'+e+"</ul>":"")+d+"</li>"+"</ul>"),c+="</div></div>",ZCL_$("zcl_ce")?(ZCL_updEventPrevHeader(),$("#zcl_ce").parent().html(c)):ZCL_setEventWorkSpace(c),zcal.bindCreateEventAction()),zcal.EMODE==1&&ZCL_$("zcl_ce_cal")!=null&&(zcal.CAL_IND=ZCL_$("zcl_ce_cal").selectedIndex,ZCL_OLD_COBJ=zcal.getCalObj(zcal.EOBJ.CNAME))},ZCL_openTZPopup=function(){var a,b,c=$("#zcl_ce_tza");ZCL_$("zcl_tz_pp")||$("body").append("<div id='zcl_tz_pp' class='zcl_ovr'/>"),a=$("#zcl_tz_pp"),a.html('<div>\t\t\t<div data-marker="loadingAnimation"></div>\t\t\t<div class="SC_select" id="zcl_tzlst"><input type="text" readonly  value="'+unescape(zcal.cdata.opt.CTIM)+'" class="SC_tiput zcl_nrbr" rel="'+zcal.cdata.opt.TIM+'" /></div>\t\t   </div>'),b=a.find("[data-marker=loadingAnimation]").removeAttr("data-marker");var d={title:zcal.i18n.event_timezone,mask:!0,drag:!1,ptr:"tright",pos:"center",style:{"min-width":"600px","max-width":"750px"},customClass:"SC_SetPop",closeaction:function(){zmsDialog.remove(),$("#zcl_tz_pp").remove()},buttons:[{txt:zcal.i18n.done,callback:function(){var a=$("#zcl_tz_pp").find("input");if(a.length){var b=a[0].getAttribute("rel"),d=c.html();b!=d&&ZCL_setEvenTimezone(b)}zmsDialog.remove(!0),$("#zcl_tz_pp").remove()}},{isCancel:!0,txt:zcal.i18n.cancel,callback:function(){zmsDialog.remove(!0),$("#zcl_tz_pp").remove()}}]};zmsDialog.create("zcl_tz_pp",d),zcal.timezones.length>0?ZCL_showTimezoneSelection():(b.show(),ZCL_getTZ({mode:"event",callback:function(){b.hide(),ZCL_showTimezoneSelection()}}))},ZCL_showTimezoneSelection=function(){$("#zcl_tz_pp").find("#zcl_tzlst").on("click",function(){var a=zcal.timezones,b=[];for(var c in a)for(var d in a[c]){var e={};e.id=d,e.name=a[c][d]+" ("+d+")",e.display_text=a[c][d]+" ("+d+")",b.push(e)}var f={},g=$(this),h;f.parentDOM=g.parent(),f.displayAs="dropdown",f.parWidth=!0,f.onSelect=function(a,b){setGroupValueTZ(g,a,b),h.hide()},f.dataCallback=function(){return b},h=zmUtil.createFLComp("generic",f),h.show()})};var setGroupValueTZ=function(a,b,c){a.find("input").val(c.display_text),a.find("input").attr("rel",b)};ZCL_setEvenTimezone=function(a){var b,c=$("#zcl_ce_tza"),d=zcal.cdata.opt.TIM;c.html(a),ZCL_$("zcl_ce_inetz")&&$("#zcl_ce_inetz").parents("ul.zcl_frmrw").remove(),a!=d&&(b=$('<ul class="zcl_frmrw zcl_when"><li class="zcl_curpt"><i class="msi-uncheck" id="zcl_ce_inetz"></i>'+ZCL_replaceString(zcal.i18n.display_in_etz,[a])+"</li></ul>"),b.find("li").off("click").on("click",function(){ZCL_ChgChk(this)}),$("#zcl_ce_aday").parents("ul.zcl_frmrw").before(b))},ZCL_ListAtt=function(a){var b="";if(zcal.EOBJ.ATT&&zcal.EOBJ.ATT.GRP){var c=zcal.EOBJ.ATT.GRP;b=ZCL_getGroupAttHtml(c,a)}if(zcal.EOBJ.ATT&&zcal.EOBJ.ATT.USR){var d="",e=a=="yes"?zcal.EOBJ.ATT.USR[0]:a=="no"?zcal.EOBJ.ATT.USR[1]:a=="maybe"?zcal.EOBJ.ATT.USR[2]:a=="pending"?zcal.EOBJ.ATT.USR[3]:zcal.EOBJ.ATT.USR[0].concat(zcal.EOBJ.ATT.USR[1],zcal.EOBJ.ATT.USR[2],zcal.EOBJ.ATT.USR[3]);for(var f=0;f<e.length;f++){var g=e[f];d+="<ul>"+(g.PHOTO?'<li><img src="'+g.PHOTO+'"/></li>':'<li><img src="'+zmail.defaultPhoto+'"></li>')+"<li><b>"+ZCL_getHTML(g.AID)+"</b>"+ZCL_AttCmntDiv(g.CMNT)+'</li><li class="zcl_txr">'+ZCL_AttCmntIcn(g.CMNT)+ZCL_AttStsIcn(g.STS)+ZCL_AttRmvIcn(g.AID,g.UID)+"</li></ul>"}b+=d!=""?'<div class="zcl_viwatlst zcl_table">'+d+"</div>":""}return b=b!=""?b:'<div class="zcl_viwatlst zcl_table"><ul><li><div class="zcl_grey">No attendee</div></li></ul></div>',b},ZCL_AttCmntIcn=function(a){return a!=""?'<i class="msi-comment" title='+zcal.i18n.comment+' onclick="ZCL_DispAttCmt(this)"></i>':""},ZCL_AttStsIcn=function(a){return"<i "+(a==1?"class='msi-like' title='"+zcal.i18n.statusyes+"'":a==2?"class='msi-unlike' title='"+zcal.i18n.statusno+"'":a==3?"class='msi-maybe' title='"+zcal.i18n.statusmaybe+"'":"class='msi-pending' title='"+zcal.i18n.statuspending+"'")+"></i>"},ZCL_AttRmvIcn=function(a,b){var c="";return zcal.EMODE==1&&(c+=b!=zcal.EOBJ.ORG?'<i class="msi-close" title='+zcal.i18n.remove+" onclick=\"ZCL_rmvAtt(this,'"+a+"')\"></i>":""),c},ZCL_AttCmntDiv=function(a){return a!=""?'<span id="cmtSpan" style="display:none">'+a+"</span>":""},ZCL_DispAttCmt=function(a){var b=a.parentNode.parentNode,c=b.querySelector("#cmtSpan");c.style.display=c.style.display=="none"?"":"none"},ZCL_StsDv=function(a,b,c){return"<li "+(a==b?"class='zcl_sl'":"")+' onclick="ZCL_ChgSts(this)">'+c+"</li>"},ZCL_AttStsDv=function(a){return ZCL_StsDv(a,1,zcal.i18n.yes)+""+ZCL_StsDv(a,2,zcal.i18n.no)+""+ZCL_StsDv(a,3,zcal.i18n.maybe)},ZCL_ChgSts=function(a){var b=a.parentNode.childNodes;for(var c=0;c<b.length;c++)b[c].className="";a.className="zcl_sl"},ZCL_txtAreaFcs=function(a){if(a.id=="zcl_cu_cmt"){var b=a.value.trim();a.value=b==zcal.i18n.comments?"":b,a.className="zcl_evtxa"}},ZCL_txtAreaBlur=function(a){if(a.id=="zcl_cu_cmt"){var b=a.value.trim();a.value=b==""?zcal.i18n.comments:b,a.className=b==""?"zcl_evtxa zcl_greymr":"zcl_evtxa"}},ZCL_listGroupUserAtt=function(a,b){var c=zcalGroup.getGroup(a),d=c.getMembers();ZCL_isEmpty(d)?zcalGroup.fetchMembers(a,function(){d=zcalGroup.getGroup(a).getMembers(),ZCL_listGroupMemWithStatus(a,d,b)}):ZCL_listGroupMemWithStatus(a,d,b)},ZCL_listGroupMemWithStatus=function(a,b,c){var d=ZCL_$("zcl_gattThd_"+a);if(d.style.display=="none"){c=="all"&&(c="");var e="",f=[],g=[],h=zcal.EOBJ.ORGM;zcal.EOBJ.ATT.GRP_USR&&(f=ZCL_getGroupUserAttArr("")),zcal.EOBJ.ATT.USR&&(g=ZCL_getUserAttArr(""));var i=!1,j=[];c&&(zcal.EOBJ.ATT.GRP_USR&&(c=="pending"&&(f=ZCL_getGroupUserAttArr("")),f=ZCL_getGroupUserAttArr(c)),zcal.EOBJ.ATT.USR&&(c=="pending"?g=ZCL_getUserAttArr(""):g=ZCL_getUserAttArr(c)),i=!0);var k=0,l=!1;for(var m in b){var n=b[m].eid,o=!1;if(n!=h){for(var p in f){var q=f[p].AID,r=f[p].STS,s=f[p].CMNT;if(n==q){c!="pending"&&(e+="<ul><li><span><b></b></span></li><li><b>"+n+"</b>"+ZCL_AttCmntDiv(s)+"</li>"+"<li>"+ZCL_AttCmntIcn(s)+ZCL_AttStsIcn(r)+"</li>"+"</ul>",k++),o=!0;break}}if(!o)for(var p in g){var t=g[p].AID,r=g[p].STS,s=g[p].CMNT;if(n==t){c!="pending"&&(e+="<ul><li><span><b></b></span></li><li><b>"+n+"</b>"+ZCL_AttCmntDiv(s)+"</li>"+"<li>"+ZCL_AttCmntIcn(s)+ZCL_AttStsIcn(r)+"</li>"+"</ul>",k++),o=!0;break}}!i&&!o?e+="<ul><li><span><b></b></span></li><li><b>"+n+"</b></li><li>"+ZCL_AttStsIcn(0)+"</li></ul>":c=="pending"&&!o&&(e+="<ul><li><span><b></b></span></li><li><b>"+n+"</b></li><li>"+ZCL_AttStsIcn(0)+"</li></ul>",k++)}else n==h&&(l=!0)}e!=""&&(d.innerHTML=e,d.style.display="",$("#zcl_gatt_"+a).addClass("zcl_vwatgrp"))}else d.style.display="none",$("#zcl_gatt_"+a).removeClass("zcl_vwatgrp")},ZCL_getGroupAttHtml=function(a,b){var c="",d=zcal.EOBJ.ATT.GRP_PHOTO||{};if(b=="all"&&zmail.zoid==-1)for(var e=0;e<a.length;e++)for(var f in a[e]){var g=a[e][f];g=g.length>15?ZCL_getHTML(g.substr(0,12))+"...":ZCL_getHTML(g),attTxt+='<div class="zcl_viwatlst zcl_table" id="zcl_gatt_'+f+'">'+"<ul>"+"<li>"+(d[f]?'<img src="'+d[f]+'">':"")+"</li>"+"<li><b>"+g+"</b></li>"+(zcal.EMODE==1&&!zcal.EOBJ.ATT.IS_STREAM?'<li><i class="msi-close" title='+zcal.i18n.remove+" onclick=\"ZCL_rmvGAtt(this, '"+f+"')\"></i></li>":"")+"</ul>"+"</div>"}else for(var e=0;e<a.length;e++)for(var f in a[e]){var g=a[e][f],h=b!="all"?ZCL_isGroupMemWithStsPres(f,b):!0;g=g.length>15?ZCL_getHTML(g.substr(0,12))+"...":ZCL_getHTML(g),h&&(c+='<div class="zcl_viwatlst zcl_table zcl_curpt" id="zcl_gatt_'+f+'">'+'<ul data-marker="groupAtt" data-gid="'+f+'" data-sts="'+b+'">'+"<li>"+(d[f]?'<img src="'+d[f]+'">':"")+"</li>"+"<li><b>"+g+"</b></li>"+(zcal.EMODE==1&&!zcal.EOBJ.ATT.IS_STREAM?'<li><i class="msi-close" title='+zcal.i18n.remove+" onclick=\"ZCL_rmvGAtt(this, '"+f+"')\"></i></li>":"")+"</ul>"+"</div>"+'<div class="zcl_viwatlst zcl_vwatgrpls zcl_table" id="zcl_gattThd_'+f+'" style="display:none"></div>')}return c},ZCL_isGroupMemWithStsPres=function(a,b){if(b!="pending"&&!zcal.EOBJ.ATT.GRP_USR)return!1;var c={},d={},e={},f=!1;if(zcal.EOBJ.ATT.GRP_USR){var g=zcal.EOBJ.ATT.GRP_USR[5];c=g[0],d=g[1],e=g[2]}if(b=="yes")c[a]&&(f=!0);else if(b=="no")d[a]&&(f=!0);else if(b=="maybe")e[a]&&(f=!0);else if(b=="pending"){var h=0,i=zcal.EOBJ.ATT.GRP_MEM_CNT,j=0;i[a]&&(h=i[a]),c[a]&&(j=parseInt(j+ZCL_getJSONObjCnt(c))),d[a]&&(j=parseInt(j+ZCL_getJSONObjCnt(d))),e[a]&&(j=parseInt(j+ZCL_getJSONObjCnt(tentxObj))),h>j&&(f=!0)}return f},ZCL_getGroupUserAttArr=function(a){switch(a){case"yes":return zcal.EOBJ.ATT.GRP_USR[0];case"no":return zcal.EOBJ.ATT.GRP_USR[1];case"maybe":return zcal.EOBJ.ATT.GRP_USR[2];case"pending":return zcal.EOBJ.ATT.GRP_USR[0].concat(zcal.EOBJ.ATT.GRP_USR[1],zcal.EOBJ.ATT.GRP_USR[2]);case"all":default:return zcal.EOBJ.ATT.GRP_USR[0].concat(zcal.EOBJ.ATT.GRP_USR[1],zcal.EOBJ.ATT.GRP_USR[2],zcal.EOBJ.ATT.GRP_USR[3])}},ZCL_getUserAttArr=function(a){switch(a){case"yes":return zcal.EOBJ.ATT.USR[0];case"no":return zcal.EOBJ.ATT.USR[1];case"maybe":return zcal.EOBJ.ATT.USR[2];case"pending":return zcal.EOBJ.ATT.USR[3];case"all":default:return zcal.EOBJ.ATT.USR[0].concat(zcal.EOBJ.ATT.USR[1],zcal.EOBJ.ATT.USR[2],zcal.EOBJ.ATT.USR[3])}},ZCL_addRem=function(a){var b=a.parentNode;b.removeChild(a);var c=b.childNodes.length;c<4&&(ZCL_appendRem(b),c<3&&ZCL_AppendRemAddLnk(b))},ZCL_appendRem=function(a){a.appendChild((new zcalAlarm).getDOM("dom"))},ZCL_ChgeRemType=function(a){var b=a.nextSibling.value;a.innerHTML=b=="1"?zcal.i18n.before:zcal.i18n.after,a.nextSibling.value=b=="1"?"0":"1"},ZCL_ChgeActType=function(a){var b=a.nextSibling.value;a.innerHTML=b=="1"?zcal.i18n.byemail:zcal.i18n.bypopup,a.nextSibling.value=b=="1"?"0":"1"},ZCL_rmvRem=function(a){var b=a.parentNode.parentNode;b.removeChild(a.parentNode),zcal.$("zcl_addrem")||ZCL_AppendRemAddLnk(b)},ZCL_QDetail=function(){var a=$("#zcl_qbk").find("#zcl_qbkttl"),b=$("#zcl_qbk").find("#zcl_qbkloc"),c=$("#zcl_qbk").find("#zcl_qbkcal");zcal.OBJTEMP.SUM=a.val(),zcal.OBJTEMP.CNAME=c[0].getAttribute("rel");if(zcal.view==3)if(!zcal.OBJTEMP.SUM)zcal.OBJTEMP.SD==zcal.OBJTEMP.ED&&(zcal.OBJTEMP.ADAY=0,zcal.OBJTEMP.ST="8:00",zcal.OBJTEMP.ET="8:30");else{var d;d=ZCL_nlp(a.val().trim(),0);if(zcal.OBJTEMP.SD==zcal.OBJTEMP.ED){var e=d.ST,f=d.ET;if(!e&&!f)zcal.OBJTEMP.ST="8:00",zcal.OBJTEMP.ET="8:30";else{zcal.OBJTEMP.ST=e?ZCL_TimetoNo(e):"8:00",zcal.OBJTEMP.ET=f?ZCL_TimetoNo(f):"8:30";if(zcal.OBJTEMP.ST>zcal.OBJTEMP.ET&&zcal.OBJTEMP.SD==zcal.OBJTEMP.ED){var g=parseInt(zcal.OBJTEMP.ED%100)+parseInt(1),h=parseInt(zcal.OBJTEMP.ED/100);zcal.OBJTEMP.ED=h+""+g}zcal.OBJTEMP.ADAY=0}}zcal.OBJTEMP.SUM=d.SUM}zcal.OBJTEMP.LOC=b.val(),zcal.OBJTEMP.Eurl="",zcal.OBJTEMP.DESC="",zcal.OBJTEMP.RTO=[0,0,0,0,0,0,0,0],zcal.OBJTEMP.REMTY=2,zcal.EMODE=1,ZCL_constEventView(zcal.OBJTEMP),zcal.OBJTEMP=null},ZCL_Qdel=function(a){var b=a.rel,c=a.ekey,d=a.calId,e=a.rto,f=a.ridx,g=a.rbrkdate;ZCL_clrStck();if(b.indexOf("_")==-1)if(e&&e.indexOf("1")!=-1&&e.indexOf("1")!=0)if(zcal.cdata.calLst[d])ZCL_getPromtval("eve",b,c,d);else{var h=zcalEvents.remEve(b,!1,!1);h||(h=zcalEvents.remEve(b,!1,!1)),h?h[b].USTAT?h[b].ORG==zcal.cdata.opt.ZUID?zcalQAdd.chkAttAndDel(b,c,d,h[b].USTAT):zcalQAdd.chkAttAndDel(b,c,d):zcalQAdd.chkAttAndDel(b,c,d):zcalQAdd.chkAttAndDel(b,c,d)}else{var h=zcalEvents.remEve(b,!1,!1);h||(h=zcalEvents.remEve(b,!1,!1)),h?h[b].USTAT?h[b].ORG==zcal.cdata.opt.ZUID?zcalQAdd.chkAttAndDel(b,c,d,h[b].USTAT):zcalQAdd.chkAttAndDel(b,c,d):zcalQAdd.chkAttAndDel(b,c,d):zcalQAdd.chkAttAndDel(b,c,d)}else ZCL_showConfirm("delete",{rel:b,ekey:c,crel:d,rto:e,ridx:f,rbrkdate:g})},ZCL_delRep=function(a,b){ZCL_EClrStck(),ZCL_closeREditConfirm();var c=b.rel,d=b.crel,e=b.ekey,f=b.ridx,g=b.rto,h=b.rbrkdate,i=c.substring(0,c.indexOf("_")),j=zcalEvents.remEve(i,!1,!1);j||(j=zcalEvents.remEve(i,!0,!1));var k=j[i].REP.RPDT;if(a==1||a==2&&f==0)g&&g.indexOf("1")!=-1&&g.indexOf("1")!=0?zcal.cdata.calLst[d]?ZCL_getPromtval("eve",i,e,d):zcalQAdd.del(c.substring(0,c.indexOf("_")),e,d,g):zcalQAdd.del(c.substring(0,c.indexOf("_")),e,d,g);else{var l=zcal.getCalObj(d),m="/cal/delEve.do?mode=recurD&eid="+i+"&type="+a+"&dateformat="+zcal.DFORMAT[zcal.cdata.opt.DF]+"&ckey="+l[9]+"&ekey="+e+"&ctype="+l[5]+"&calmode="+zcal.CALMODE;m+="&mstart="+zcal.mlimit[0].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&mend="+zcal.mlimit[1].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF]),m+=f&&f!="undefined"?"&ridx="+f:"",m+=h&&h!="undefined"?"&rbrkdate="+h:"",ZCL_XHR(m,"zcalQAdd.retRepDel")}},ZCL_Dedit=function(a,b,c,d){zcal.EMODE=1,zcal.EOBJ==null||a&&a!=zcal.EOBJ.EID?ZCL_editEve(a,b,c,d):ZCL_constEventView(zcal.EOBJ)},ZCL_eveInfo=function(a,b,c,d,e){zcal.EMODE=1;if(zcal.EOBJ==null||a&&a!=zcal.EOBJ.EID){zcal.EOBJ=null;var f=zcal.getCalObj(c),g="/cal/eInfo.do?ckey="+f[9]+"&ekey="+d+"&calmode="+zcal.CALMODE+(zcal.CALMODE==1?"&grpid="+zcal.ZGID:"");g+="&eveId="+(a.indexOf("_")!=-1?a.substring(0,a.indexOf("_"))+"&date="+a.substring(a.indexOf("_")+1,a.length):a),ZCL_TRIDX&&ZCL_TRIDX!="undefined"&&(g+="&ridx="+ZCL_TRIDX),ZCL_REPINST&&ZCL_REPINST!=undefined&&ZCL_REPINST!="undefined"&&ZCL_REPINST!=null&&(g+="&rbrkdate="+ZCL_REPINST),ZCL_XHR(g,function(a){var c=ZCL_Evl(1,a.responseText);e=="send"?ZCL_send(c):ZCL_chatLet(b,c)})}else e=="send"?ZCL_send(zcal.EOBJ):ZCL_chatLet(b,zcal.EOBJ)},ZCL_send=function(a){ZCL_clrStck();var b="",c=[];if(a.ATT){for(var d in a.ATT.USR)for(var e in a.ATT.USR[d])b+=b!=""?", "+a.ATT.USR[d][e].AID:a.ATT.USR[d][e].AID+"",c.push(a.ATT.USR[d][e].AID);var f=ZCL_parseDateStr(a.SD),g=String(f).slice(0,3),h=f.dateBy("MMM dd, yyyy"),i=zcal.timeformat[zcal.cdata.opt.TF],j=a.ADAY&&a.ADAY==1?!0:!1,k=a.SD,l=a.ED,m=j?"8:00 am":a.ST,n=j?"8:30 am":a.ET,o=m.getTimeBy(i),p=n.getTimeBy(i),q=o.split(" ")[0],r=o.split(" ")[1]=="am"?"AM":"PM",s=p.split(" ")[0],t=p.split(" ")[1]=="am"?"AM":"PM",u=g+" "+h+" "+(j?"":q+" "+r+" - "+s+" "+t)+" ("+zcal.cdata.opt.TIM+")",v={title:a.SUM,date:u,att:c},w=zcalTemplate.invitationview(v)}zmUtil.compose({TO:b,CONTENT:w,SUBJECT:zcal.i18n.eventinvitation+" - "+a.SUM})},ZCL_Dview=function(a,b,c,d){zcal.EMODE=0,ZCL_editEve(a,b,c,d)},ZCL_GetCalName=function(a){return ZCL_getHTML(zcal.getCalObj(a)[0])},ZCL_tgleNxtEle=function(a){var b=a.parentNode;b.nextSibling.style.display=="none"?(b.nextSibling.style.display="",a.children[0].className="msi-barrow"):(b.nextSibling.style.display="none",a.children[0].className="msi-rarrow")},ZCL_tgleAttEle=function(a){var b=a.parentNode.parentNode;b.nextSibling.style.display=="none"?(b.nextSibling.style.display="",b.className="zcl_ratgpsl"):(b.nextSibling.style.display="none",b.className="zcl_ratgp")},ZCL_setTblHgt=function(){zcal.$("zcl_ce_tbl").style.height=zcal.$("zcl_ce_cont").offsetHeight-2+"px"},ZCL_tgleGrpAtt=function(a){var b=a.childNodes[0];b.className=="zcl_sl"?b.className="":b.className="zcl_sl"},ZCL_UStatusText=function(a,b){return b?"Status of "+b:"Status"},ZCL_putAttendee=function(){if(zcal.EOBJ.ATT&&zcal.EOBJ.ATT.USR&&ZCL_$("zcl_ce_aslst")){var a=ZCL_$("zcl_ce_aslst").childNodes,b="all";a[1].className=="sl"?b="yes":a[2].className=="sl"?b="no":a[3].className=="sl"?b="maybe":a[4].className=="sl"&&(b="pending"),ZCL_$("zcl_ce_attlst").innerHTML=ZCL_ListAtt("all");var c=$("#zcl_ce"),d=c.find("[data-marker=groupAtt]");d.length>0&&(d.removeAttr("data-marker"),d.off("click").on("click",function(){var a=$(this),b=a.data("gid"),c=a.data("sts");ZCL_listGroupUserAtt(b,c)}))}},ZCL_rmvAtt=function(a,b){var c=ZCL_$("zcl_rmvatt"),d=c.value,e=d!=""?d.split(","):[];ZCL_in_array(b,e)||e.push(b),c.value=e.join(","),a.parentNode.parentNode.parentNode.removeChild(a.parentNode.parentNode)},ZCL_rmvGAtt=function(a,b){var c=ZCL_$("zcl_rmvgatt"),d=c.value,e=d!=""?d.split(","):[];ZCL_in_array(b,e)||e.push(b),c.value=e.join(","),$("#zcl_gatt_"+b).remove(),$("#zcl_gattThd_"+b).remove()},ZCL_putCalAlarmForView=function(a){var b="";if(a.ACTYPE){var c=a.ACTYPE.split(","),d=a.REMTIME.split(","),e=a.REMTYPE.split(","),f=c.length;for(var g=0;g<f&&f<=4;g++){var h=ZCL_array_search(d[g],ZCL_REM);c[g]==1&&e[g]==1?b+="<span>"+zcal.REMSTR[d[g]]+' after <span class="zcl_grey">by popup</span></span>':c[g]==1&&e[g]==0?b+="<span>"+zcal.REMSTR[d[g]]+' before <span class="zcl_grey">by popup</span></span>':c[g]==0&&e[g]==1?b+="<span>"+zcal.REMSTR[d[g]]+' after <span class="zcl_grey">by email</span></span>':c[g]==0&&e[g]==0&&(b+="<span>"+zcal.REMSTR[d[g]]+' before <span class="zcl_grey">by email</span></span>')}}return b},ZCL_putCalAlarm=function(a){var b="";if(a.ACTYPE){var c=a.ACTYPE.split(","),d=a.REMTIME.split(","),e=a.REMTYPE.split(","),f=c.length;for(var g=0;g<f&&f<=4;g++){var h=new zcalAlarm;h.set({ACTYPE:c[g],REMTYPE:e[g],REMTIME:d[g]}),b+=h.getDOM("string")}b+=f==4?"":ZCL_RemAddLnk()}else b+=ZCL_RemAddLnk();return b},ZCL_AppendRemAddLnk=function(a){var b=$('<ul id="zcl_addrem"><li><span><i class="msi-add"></i>'+zcal.i18n.addreminder+"</span></li></ul>");b.find("span").off("click").on("click",function(){ZCL_addRem(this.parentNode.parentNode)}),a.appendChild(b[0])},ZCL_RemAddLnk=function(){return'<ul id="zcl_addrem"><li><span onclick="ZCL_addRem(this.parentNode.parentNode)"><i class="msi-add"></i>'+zcal.i18n.addreminder+"</span></li></ul>"},ZCL_RemDelDiv=function(){return'<li onclick="ZCL_rmvRem(this)"><i class="msi-close" title='+zcal.i18n.remove+"></i></li>"},ZCL_putAlarmForView=function(a){var b="",c="",d="",e="",f="";if(a){var g=a.length;for(var h=0;h<g&&g<=4;h++){var i=a[h],j=parseInt(i.ACTYPE),k=parseInt(i.REMTYPE),l=ZCL_array_search(i.REMTIME,ZCL_REM),m="";l?m=zcal.REMSTR[i.REMTIME]:m=ZCL_getCustomAlarmInfo(i.REMTIME),j==1&&k==1?b+="<div>"+m+' after <span class="zcl_grey">by popup</span></div>':j==1&&k==0?b+="<div>"+m+' before <span class="zcl_grey">by popup</span></div>':j==0&&k==1?b+="<div>"+m+' after <span class="zcl_grey">by email</span></div>':j==0&&k==0&&(b+="<div>"+m+' before <span class="zcl_grey">by email</span></div>')}}return b},ZCL_putAlarm=function(a){var b="",c=a.length;for(var d=0;d<c&&c<=4;d++){var e=new zcalAlarm;e.set(a[d]),b+=e.getDOM("string")}return b+=c==4?"":ZCL_RemAddLnk(),b},ZCL_putDate=function(a){var b=zcal.DFORMAT[zcal.cdata.opt.DF],c=a.substring(6,8),d=a.substring(4,6),e=a.substring(0,4);return b.replace("dd",c).replace("MM",d).replace("yyyy",e)},ZCL_DFDate=function(a){var b=zcal.cdata.opt.DF==3?zcal.DFORMAT[zcal.cdata.opt.DF].split("-"):zcal.DFORMAT[zcal.cdata.opt.DF].split("/"),c=zcal.cdata.opt.DF==3?a.split("-"):a.split("/"),d={};for(var e=0;e<c.length;e++)d[b[e]]=c[e];return d.yyyy+""+d.MM+""+d.dd},ZCL_putValues=function(a,b,c){var d=0;for(var e in c)a.options[d]=new Option(c[e],e),b&&e==b&&(a.options[d].selected=!0),d++};var ZCL_DELRTO=1;ZCL_svEve=function(){zcal.$("zcl_eid").value!=""?zcal.GOBJ.RTO[2]==1&&zcal.$("zcl_ce_met")&&zcal.$("zcl_ce_met").className=="msi-uncheck"?ZCL_getPromtval("zcl_ce_met"):zcal.GOBJ.RTO[5]==1&&zcal.$("zcl_ce_crm")&&zcal.$("zcl_ce_crm").className=="msi-uncheck"?ZCL_getPromtval("zcl_ce_crm"):zcal.GOBJ.RTO[3]==1&&zcal.$("zcl_ce_tsk")&&zcal.$("zcl_ce_tsk").className=="msi-uncheck"?ZCL_getPromtval("zcl_ce_tsk"):zcal.GOBJ.RTO[4]==1&&zcal.$("zcl_ce_nts")&&zcal.$("zcl_ce_nts").className=="msi-uncheck"?ZCL_getPromtval("zcl_ce_nts"):ZCL_getEntry():ZCL_getEntry()},ZCL_getEntry=function(){var a=new Date,b=new Date,c=ZCL_splitDateVal(zcal.$("zcl_ce_sd").value),d=ZCL_parseTime(zcal.$("zcl_ce_st").value);b.setYear(c[2]),b.setMonth(c[1]-1),b.setDate(c[0]),b.setHours(d.HH,d.mm,0,0);if(ZCL_$("zcl_ce_tit").value.trim()=="")return zmUtil.succErrMsg("e",zcal.i18n.plenttle),ZCL_$("zcl_ce_tit").focus(),!1;if(!zcal.validate(ZCL_$("zcl_ce_tit").value))return zmUtil.succErrMsg("e",zcal.i18n.spchevetle),ZCL_$("zcl_ce_tit").focus(),!1;if(!zcal.validate(ZCL_$("zcl_ce_loc").value))return zmUtil.succErrMsg("e",zcal.i18n.spcheveloc),ZCL_$("zcl_ce_loc").focus(),!1;if(zcal.isAttach){var e=document.querySelectorAll("[id=fileAttachment]");if(ZCL_AttachCount&&ZCL_AttachCount!=e.length)return zmUtil.succErrMsg("e",zcal.i18n.uploadprogress),!1}ZCL_UrlCheck(ZCL_$("zcl_ce_lnk").value);if(!ZCL_dateValidate("zcl_ce_sd",zcal.i18n.evest)||!ZCL_dateValidate("zcl_ce_ed",zcal.i18n.eveed))return!1;if(!ZCL_dateTimeComparison("zcl_ce_ed","zcl_ce_et",zcal.i18n.eveed,"zcl_ce_sd","zcl_ce_st",zcal.i18n.evest,"G"))return!1;if(zcal.$("zcl_eid").value!=""){var f=zcal.$("zcl_eid").value,g=f.indexOf("_")!=-1?f.substring(0,f.indexOf("_")):f;if(zcal.GOBJ&&zcal.GOBJ.REP&&zcal.GOBJ.CNAME==zcal.$("zcl_ce_cal").getAttribute("rel")){var h=zcal.$("zcl_ce_tza").innerHTML!=zcal.cdata.opt.TIM?zcal.$("zcl_ce_tza").innerHTML:"",i=zcal.GOBJ.ETZ?zcal.GOBJ.ETZ:"";if(h==i){var j=zcal.GOBJ.REP,k=ZCL_getRep("arr");!k||k[0]!=j.RFRQ||k[1]!=j.RIVL||k[2]!=j.ROPT||k[3].join("")!=j.RDAY.join("")||k[4]!=j.RTOWK||k[5]!=j.RDATE||k[6]!=j.RMON||k[7]!=j.RCNT||k[8].trim()!=j.RUTL?ZCL_subEvent(1):ZCL_showConfirm("edit")}else ZCL_subEvent(1)}else ZCL_subEvent(1)}else ZCL_subEvent()},ZCL_retEntry=function(a){var b=!1,c=zcal.cdata.opt.TIM,d=$("#zcl_ce_tza").html(),e=$("#zcl_ce_aday").hasClass("msi-check"),f=$("#zcl_ce_sd").val(),g=$("#zcl_ce_ed").val(),h=e?"00:00":$("#zcl_ce_st").val(),i=e?"00:00":$("#zcl_ce_et").val(),j=$("#zcl_ce_tit").val(),k=$("#zcl_ce_desc").val(),l=$("#zcl_ce_inetz").hasClass("msi-check"),m=$("#zcl_ce_cal")[0].getAttribute("rel");zcal.GOBJ!=null&&zcal.GOBJ.SUM==j&&zcal.GOBJ.SD==ZCL_DFDate(f)&&zcal.GOBJ.ED==ZCL_DFDate(g)&&zcal.GOBJ.ST==ZCL_TimetoNo(h)&&zcal.GOBJ.ET==ZCL_TimetoNo(i)&&zcal.GOBJ.DESC==k&&(b=!0);var n=zcal.getCalObj(m),o={EID:ZCL_$("zcl_eid").value,EUID:ZCL_$("zcl_ekey").value,RIDX:ZCL_$("zcl_ridx").value,EPERM:ZCL_$("zcl_eperm").value,DPERM:ZCL_$("zcl_dperm").value,SD:ZCL_$("zcl_ce_sd").value,ST:ZCL_TimetoNo(h),ED:ZCL_$("zcl_ce_ed").value,ET:ZCL_TimetoNo(i),ATT:ZCL_getAttendee(),RMVATT:ZCL_$("zcl_rmvatt").value,GATT:ZCL_getGrpAttendee(),RMVGATT:ZCL_$("zcl_rmvgatt").value,CLASS:ZCL_$("zcl_ce_pvt")&&ZCL_$("zcl_ce_pvt").className=="msi-check"?1:0,ADAY:ZCL_$("zcl_ce_aday").className=="msi-check"?1:0,IMP:0,Attachment:ZCL_getFileAttach("get"),HASATTACH:ZCL_getFileAttach("sts"),RMAttachment:ZCL_getFileRemoved(),USTAT:ZCL_usrStat(),UCMNT:ZCL_$("zcl_cu_cmt")?ZCL_$("zcl_cu_cmt").value:"",SKEY:ZCL_$("zcl_skey")?ZCL_$("zcl_skey").value:"",CNAME:m,LOC:ZCL_$("zcl_ce_loc").value,TRANS:1,DESC:ZCL_$("zcl_ce_desc").value,LINK:ZCL_$("zcl_ce_lnk").value,ETSK:ZCL_$("zcl_ce_tsk")&&ZCL_$("zcl_ce_tsk").className=="msi-check"?1:0,ECRM:ZCL_$("zcl_ce_crm")&&ZCL_$("zcl_ce_crm").className=="msi-check"?1:0,ENTS:ZCL_$("zcl_ce_nts")&&ZCL_$("zcl_ce_nts").className=="msi-check"?1:0,EMET:ZCL_$("zcl_ce_met")&&ZCL_$("zcl_ce_met").className=="msi-check"?1:0,SUM:ZCL_$("zcl_ce_tit").value,ALARM:n[14]==""?ZCL_getAlarm("zcl_ce_rem"):"",REP:ZCL_getRep(),TYPE:a,ISDMY:b,ETZ:d!=c?d:"",IN_ETZ:l,DELRTO:ZCL_DELRTO==1?!0:!1,EC:ZCL_$("zcl_ce_color")?ZCL_$("zcl_ce_color").getAttribute("rel"):-1,ADD_MODE:"DET",NTFY:ZCL_NTFY_ATT},p=o.ATT;if(p!="")if(n[14]==="group"){var q="/cal/validateAtt.do?grpid="+n[9]+"&att="+p.zcalescape();ZCL_XHR(q,function(a){ZCL_retValAtt(a,o,"group")})}else if(zcal.sendInv=="1"){var q="/cal/validateAtt.do?att="+p.zcalescape();ZCL_XHR(q,function(a){ZCL_retValAtt(a,o,"user")})}else ZCL_detailObj(o);else ZCL_detailObj(o)},ZCL_subEvent=function(a){ZCL_isAtt()?a?ZCL_shNtfyAttPop(a):ZCL_shNtfyAttPop():a?ZCL_retEntry(a):ZCL_retEntry()},ZCL_isAtt=function(){var a=!1;zcal.EOBJ.ATT&&(zcal.EOBJ.ATT.USR||zcal.EOBJ.ATT.GRP)&&(a=!0);if(!a&&ZCL_$("attlist")){var b=ZCL_$("attlist").childNodes;b.length>0&&(a=!0)}return a},ZCL_shNtfyAttPop=function(a){var b;ZCL_$("zcl_att_confirm")||$("body").append("<div id='zcl_att_confirm' class='zcl_rpt'/>"),b=$("#zcl_att_confirm"),b.html($("<div>"+zcal.i18n.invnotifymsg+" ?</div>")[0]);var c={title:zcal.i18n.eventinvitation,style:{left:"500px",top:"100px"},drag:!1,mask:!0,ptr:"tright",buttons:[{txt:zcal.i18n.send,callback:function(){ZCL_confNotAtt(a,"1")}},{txt:zcal.i18n.sendme,callback:function(){ZCL_confNotAtt(a,"2")}},{txt:zcal.i18n.dontsend,callback:function(){ZCL_confNotAtt(a,"0")}},{txt:zcal.i18n.cancel,callback:function(){zmsDialog.remove(!0)}}]};setTimeout(function(){zmsDialog.create("zcl_att_confirm",c)},600)},ZCL_shAttPopForQkDel=function(a,b,c,d){var e;ZCL_$("zcl_att_confirm")||$("body").append("<div id='zcl_att_confirm' class='zcl_rpt'/>"),e=$("#zcl_att_confirm"),e.html($("<div>"+zcal.i18n.invnotifymsg+" ?</div>")[0]);var f={title:zcal.i18n.eventinvitation,buttons:[{txt:zcal.i18n.send,callback:function(){ZCL_confAttQkDel(a,b,c,d,"1")}},{txt:zcal.i18n.sendme,callback:function(){ZCL_confAttQkDel(a,b,c,d,"2")}},{txt:zcal.i18n.dontsend,callback:function(){ZCL_confAttQkDel(a,b,c,d,"0")}},{txt:zcal.i18n.cancel,callback:function(){zmsDialog.remove(!0)}}]};zmsDialog.create("zcl_att_confirm",f)},ZCL_confNotAtt=function(a,b){ZCL_NTFY_ATT=b,ZCL_clrStck(),zmsDialog.remove(!0),a?ZCL_retEntry(a):ZCL_retEntry()},ZCL_confAttQkDel=function(a,b,c,d,e){ZCL_NTFY_ATT=e,zcalQAdd.del(a,b,c),zmsDialog.remove(!0),d&&d==1&&(ZCL_EClrStck(),zmsDialog.remove(!0))},ZCL_retValAtt=function(a,b,c){var d=ZCL_Evl(1,a.responseText);if(d.ISVALID=="true")ZCL_detailObj(b);else{var e=c==="group"?"Group policy does not support to add non-group members as attendees.":"Organization policy does not support to add non-organization members as attendees.";zmsDialog.confirm(e,{onOk:function(){ZCL_detailObj(b)}})}},ZCL_getAddress=function(a){var b=[];for(var c in a[0].childNodes){if(!a[0].childNodes[c].id)continue;var d={};a[0].childNodes[c].getAttribute("gid")?(d.egid=a[0].childNodes[c].id,d.gid=a[0].childNodes[c].getAttribute("gid")):(d.eid=a[0].childNodes[c].id,d.zid=a[0].childNodes[c].getAttribute("data-zid")),b.push(d)}return b},ZCL_getAttendee=function(a){var b="",a=a||$("#attlist");if(a.length>0){var c=ZCL_getAddress(a);if(c)for(var d=0;d<c.length;d++)if(!c[d].gid){var e=c[d].eid;b+=b.trim()!=""?","+e:e}var f=b.split(",");f=ZCL_array_unique(f),b=f.join(",")}return b},ZCL_getGrpAttendee=function(){var a=new Array;if(zcal.$("attlist")){var b=ZCL_getAddress($("#attlist"));if(b)for(var c=0;c<b.length;c++)b[c].egid&&a.push(b[c].egid)}return a},ZCL_getAlarm=function(a){var b=a=="zcl_cal_rem"?[{}]:"";if(ZCL_$(a)){var c=ZCL_$(a).childNodes,d=c.length;d>1&&d<=5&&(b=ZCL_getAlarmObj(c))}return b},ZCL_getAlarmObj=function(a){var b=a.length,c=[],d=[],e=[];b=b>5?5:b;for(var f=0;f<b;f++)if(a[f].tagName=="UL"&&a[f].id!="zcl_addrem"){var g=a[f].childNodes;d.push(g[0].children[0].children[0].value),e.push(g[1].children[0].children[0].value),c.push(g[2].children[0].children[0].value)}var h=[{ACTYPE:c.join(","),REMTIME:d.join(","),REMTYPE:e.join(",")}];return h},ZCL_getRep=function(a){var b=ZCL_$("zcl_rep"),c=zcal.EOBJ.rObj;if(b){if(b.getElementsByTagName("I")[0].className!="msi-check")return c.reset(),null;var d=c.getReqObj();return a!=null&&a=="arr"&&(d=[d.RFRQ,d.RIVL,d.ROPT,d.RDAY,d.RTOWK,d.RDATE,d.RMON,d.RCNT,d.RUTL]),d}return null},ZCL_ChgChk=function(a){if(a.id!="zcl_rep_span"){var b=a.childNodes[0];b.className=b.className=="msi-check"?"msi-uncheck":"msi-check"}},ZCL_checkAll=function(){$("#zcl_ce_aday").hasClass("msi-uncheck")?($("#zcl_ce_st").parent().show(),$("#zcl_ce_et").parent().show(),$("#zcl_ce_tza").parent().show(),$("#zcl_ce_inetz").parents("ul.zcl_frmrw").show()):($("#zcl_ce_st").parent().hide(),$("#zcl_ce_et").parent().hide(),$("#zcl_ce_tza").parent().hide(),$("#zcl_ce_inetz").parents("ul.zcl_frmrw").hide())},ZCL_delEve=function(){var a=ZCL_$("zcl_eid").value,b=ZCL_$("zcl_ekey").value,c=ZCL_$("zcl_crel").value,d=ZCL_$("zcl_rtoval").value;if(!zcal.isRO){if(a&&a!="")if(a.indexOf("_")==-1)d.indexOf("1")!=-1&&d.indexOf("1")!=0?zcal.cdata.calLst[c]?ZCL_getPromtval("eve",a,b,c):zcalQAdd.chkAttAndDel(a,b,c,-1,!0):zcalQAdd.chkAttAndDel(a,b,c,-1,!0);else{var e={rel:a,crel:c,ekey:b,ridx:ZCL_$("zcl_ridx").value,rbrkdate:ZCL_$("zcl_repinst").value,rto:d};ZCL_showConfirm("delete",e)}}else ZCL_openRO()},ZCL_usrStat=function(){var a=0;if(ZCL_$("zcl_ce_asts")){var b=ZCL_$("zcl_ce_asts").childNodes;a=b[0].className=="zcl_sl"?1:b[1].className=="zcl_sl"?2:b[2].className=="zcl_sl"?3:a}return a},ZCL_sndStat=function(){var a=ZCL_usrStat();if(a!=0)if(!zcal.isRO){var b=ZCL_$("zcl_cu_cmt").value,c=ZCL_$("zcl_eid").value,d=ZCL_$("zcl_skey").value,e=ZCL_$("zcl_crel").value,f=zcal.getCalObj(e),g=f[9],h=ZCL_$("zcl_ekey").value;c=c.indexOf("_")==-1?c:c.substring(0,c.indexOf("_")),ZCL_XHR("/cal/cuStat.do?custat="+a+"&cucmt="+b+"&eid="+c+"&skey="+d+"&ckey="+g+"&ekey="+h+"&calmode="+zcal.CALMODE,"ZCL_retStat")}else ZCL_openRO()},ZCL_retStat=function(a,b){var c=b=="UPDATE ATTENDEE STATUS"?ZCL_Evl(1,a):ZCL_Evl(1,a.responseText);if(c.ERR)return ZCL_slideObj.status(zcal.i18n[c.ERR]),!1;c.ATTENDEE&&(zcal.EOBJ.ATT.USR=c.ATTENDEE,ZCL_putAttendee()),c.EID&&(c.STS=="1"||c.STS=="2"||c.STS=="3")&&ZCL_updateSts(c.EID,c.STS)},ZCL_showEvent=function(a){for(var b in a)for(var c in a[b]){a[b][c].EC=a[b][c].EC?a[b][c].EC:"-1";if(a[b][c].MODE=="edit"){var d=zcalEvents.remEve(c,!1,!0);d||(d=zcalEvents.remEve(c,!0,!0)),ZCL_insertEvent(a[b],c)}else{var e=parseInt(a[b][c].SD),f=parseInt(a[b][c].ED),g=parseInt(a[b][c].ADAY),h=parseInt(a[b][c].ST),i=a[b][c];i.REP?ZCL_XHR("/cal/repRange.do?eid="+c+"&mstart="+zcal.mlimit[0].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&mend="+zcal.mlimit[1].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&dateformat="+zcal.DFORMAT[zcal.cdata.opt.DF],function(a){var b=ZCL_Evl(1,a.responseText);ZCL_updateRepeatWithRange(b,i)}):ZCL_insertEvent(a[b],c)}}ZCL_enableCal(a[b][c].CNAME),ZCL_updateCalAndEvents()},ZCL_updateRepeatWithRange=function(a,b){var c=a.id,d=a.rdats?a.rdats:"";if(b){var e="{'"+c+"':{'CNAME': '"+b.CNAME+"', 'SD' : '"+b.SD+"', 'ED' : '"+b.ED+"', 'ST': '"+b.ST+"', 'ET':'"+b.ET+"', 'SUM' :'"+b.SUM+"', 'ADAY':'"+b.ADAY+"', 'EUID':'"+b.EUID+"', 'DUR':'"+b.DUR+"', 'EPERM':'"+b.EPERM+"', 'DPERM':'"+b.DPERM+"'";e+=", 'REF' : ["+b.REF[0]+", "+b.REF[1]+", "+b.REF[2]+", "+b.REF[3]+", "+b.REF[4]+"]",e+=b.REP?", 'REP' : {'RPDT' : '"+b.RPDT+"'}}":"}",e+="}";var f=ZCL_Evl(1,e);d!=""&&d.length>0&&ZCL_insertRepEvents(f,d,c)}},ZCL_eClose=function(){ZCL_EClrStck()},ZCL_serviceRes=function(a){var b=ZCL_Evl(1,a.responseText),c=b.status;if(c=="success"){var d=b.service;if(d=="ents"){var e=ZCL_$("zcl_eassociate_qv")?ZCL_$("zcl_eassociate_qv"):document.createElement("div");e.id="zcl_eassociate_qv",e.className="zcl_asso";var f=b.nobj,g=f.title;e.innerHTML="";var h=document.createElement("p");h.append(zcal.i18n.title+" : "+g);var i=document.createElement("p"),j=ZCL_LinkParser(f.desc?f.desc:"");for(var k in j)j[k].nodeType==3&&j[k].nodeValue.match(/\s/)&&(j[k].nodeValue=j[k].nodeValue.replace(/\s/g,"")),i.appendChild(j[k]);e.append(h),e.append(i),document.body.appendChild(e);var l={title:ZCL_replaceComName(zcal.i18n.znotes),style:{left:"500px",top:"100px"},drag:!1,mask:!0,ptr:"tright"};zmsDialog.create("zcl_eassociate_qv",l)}else if(d=="etsk")try{var m=[zcal.i18n.ztask_priority_high,zcal.i18n.ztask_priority_medium,zcal.i18n.ztask_priority_low],n=b.tobj,o=m[n.PRIORITY],e=ZCL_$("zcl_eassociate_qv")?ZCL_$("zcl_eassociate_qv"):document.createElement("div");e.id="zcl_eassociate_qv",e.className="zcl_asso";var p='<ul class="zcl_frmrw"><li class="zcl_frmtt">'+zcal.i18n.task_label_title+"</li><li>"+n.TITLE+"</li></ul>";p+='<ul class="zcl_frmrw"><li class="zcl_frmtt">'+zcal.i18n.task_label_duedate+"</li><li>"+n.DUEDATE+"</li></ul>",p+='<ul class="zcl_frmrw"><li class="zcl_frmtt">'+zcal.i18n.task_label_priority+"</li><li>"+o+"</li></ul>",p+='<ul class="zcl_frmrw"><li class="zcl_frmtt">'+zcal.i18n.task_label_description+"</li><li></li></ul>",p+="<p>"+n.DESC+"</p>",e.innerHTML=p,document.body.appendChild(e);var l={title:ZCL_replaceComName(zcal.i18n.ztask),style:{left:"500px",top:"100px"},drag:!1,mask:!0,ptr:"tright"};zmsDialog.create("zcl_eassociate_qv",l)}catch(q){return zmUtil.succErrMsg("e",zcal.i18n.errorpopup_desc),!1}else ZCL_SERVICE=="emet"?window.open(a.responseText):ZCL_SERVICE=="elnk"?a.responseText!=""&&window.open(a.responseText):ZCL_SERVICE=="ecrm"?window.open(a.responseText):ZCL_SERVICE=="emil"&&window.open(a.responseText)}},ZCL_getPromtval=function(a,b,c,d){var e=document.createElement("div");e.id="zcl_rmvass_confirm",e.className="zcl_rpt",e.innerHTML=a=="eve"?zcal.i18n.delOthSer:zcal.i18n.disOther,ZCL_$("zcl_rmvass_confirm")||document.body.appendChild(e);var f={title:"Confirm ?",style:{left:"500px",top:"100px"},drag:!1,mask:!0,ptr:"tright",closeaction:function(){ZCL_closeAssConfirm()},buttons:[{txt:zcal.i18n.yes,callback:function(){ZCL_DELRTO=1,ZCL_closeAssConfirm(),a=="eve"?zcalQAdd.del(b,c,d):ZCL_getEntry()}},{txt:zcal.i18n.no,callback:function(){ZCL_DELRTO=0,a=="eve"?zcalQAdd.del(b,c,d):ZCL_getEntry(),ZCL_closeAssConfirm()}},{txt:zcal.i18n.cancel,callback:function(){zmsDialog.remove(!0)}}]};zmsDialog.create("zcl_rmvass_confirm",f)},ZCL_closeAssConfirm=function(){zmsDialog.remove(!0),$("#zcl_rmvass_confirm").remove()},ZCL_UrlCheck=function(){var a=zcal.$("zcl_ce_lnk").value.trim();if(a!=""){var b=/^http(s?)\:\/\/[0-9a-zA-Z]([-.\w]*[0-9a-zA-Z])*(:(0-9)*)*(\/?)([a-zA-Z0-9\-\.\?\,\:\'\/\\\+=&amp;%\$#_]*)?$/i;b.test(a)?ZCL_$("zcl_ce_lnk").value=a:(a=a.match(/\b^(http|https)\:\/\/\b/)?a:location.protocol+"//"+a,zcal.$("zcl_ce_lnk").value=a)}},ZCL_setEventAlarm=function(){var a=ZCL_$("zcl_crel").value,b=zcal.cdata.calLst[a]||zcal.cdata.calOLst[a];if(b){var c=b[9],d=ZCL_$("zcl_ekey").value,e=ZCL_getAlarm("zcl_ce_rem"),f="/cal/setEveRem.do?ekey="+d+"&ckey="+c;e?f+="&isrem=true&remt="+e[0].REMTIME+"&remty="+e[0].REMTYPE+"&actty="+e[0].ACTYPE:f+="&isrem=false",ZCL_XHR(f,function(a){ZCL_retRemStat(a)})}},ZCL_retRemStat=function(a){var b=ZCL_Evl(1,a.responseText);_zm.succErrMsg(b.STS=="reminderupdated"||b.STS=="reminderremoved"?"s":"e",zcal.i18n[b.STS])},ZCL_getAddEventObj=function(a){var b=new Date,c="";a&&(c=a),b.setTime(zcal.today.getTime());var d=b.getDate(),e=b.getMonth(),f=b.getFullYear(),g,h,i,j,k;e=e+1<10?"0"+(e+1):e+1,d=d<10?"0"+d:d,g=f+""+e+""+d,b.setTime(zcal.cdate),h=b.getHours(),i=b.getMinutes(),j=h*2+(i>30?2:1),j=j>46?46:j,zcal.EMODE=1;for(var f in zcal.cdata.calOrdArr)if(zcal.cdata.calLst[zcal.cdata.calOrdArr[f]][8]=="1"){k=zcal.cdata.calOrdArr[f];break}return k?{SD:g,ST:zcal.TTT[j],ED:g,ET:zcal.TTT[j+1],SUM:c,LOC:"",DESC:"",ADAY:0,ORG:zcal.uid,RTO:[0,0,0,0,0,0,0,0],CNAME:k,REMTY:2}:(alert("You don't have permission to add event on any of these calendars."),!1)},ZCL_updEventPrevHeader=function(a){var b=zmsuite.getCenter()[1].getNodes()[0],c="eventSave",d=b.headerArr.text,e;"task"===a?c="taskSave":"crm"===a&&(c="crmEventSave"),zcal.EMODE==0?(e={id:"zcalPrevHeader",rIcons:[{groupId:"Delete",actionArr:[{iconClass:"msi-trash",tooltip:"Delete",data:{action:"eventDelete"}}]},{groupId:"Close",actionArr:[{iconClass:"msi-close",tooltip:zcal.i18n.save,data:{action:"eventClose"}}]}]},zcal.EOBJ.EPERM==2&&e.rIcons.unshift({groupId:"Edit",actionArr:[{iconClass:"msi-edit",tooltip:"Edit",data:{action:"eventEdit"}}]}),zcal.EOBJ.ATT!=null&&e.rIcons.unshift({groupId:"Send",actionArr:[{iconClass:"msi-send",tooltip:"Send as mail",data:{action:"eventSend"}}]}),e.rIcons.unshift({groupId:"Chatlet",actionArr:[{iconClass:"msi-cliq",tooltip:"Start chat",data:{action:"startChat"}}]})):(e={id:"zcalPrevHeader",rIcons:[{groupId:"Save",actionArr:[{iconClass:"msi-save",tooltip:zcal.i18n.save,data:{action:c}}]}]},zcal.EOBJ.ATT!=null&&e.rIcons.push({groupId:"Send",actionArr:[{iconClass:"msi-send",tooltip:"Send as mail",data:{action:"eventSend"}}]}),e.rIcons.push({groupId:"Chatlet",actionArr:[{iconClass:"msi-cliq",tooltip:"Start chat",data:{action:"startChat"}}]}),zcal.EOBJ.EID&&e.rIcons.push({groupId:"Delete",actionArr:[{iconClass:"msi-trash",data:{action:"eventDelete"},tooltip:"eventDelete"}]}),e.rIcons.push({groupId:"Close",actionArr:[{iconClass:"msi-close",tooltip:zcal.i18n.save,data:{action:"eventClose"}}]})),b.push(e),e.text=d,b.render()},ZCL_setEventWorkSpace=function(a,b){var c="zcal_eContainer",d,e="eventSave",f=zcal.EMODE==0?zcal.i18n.viewevent:zcal.EOBJ.EID?zcal.i18n.editevt:zcal.i18n.createevt;"task"===b?(e="taskSave",f=zcal.EMODE==0?zcal.i18n.viewtask:zcal.EOBJ.EID?zcal.i18n.edittask:zcal.i18n.createtask):"crm"===b&&(e="crmEventSave");var g={appname:f,appId:c,data:{CNodes:"2"},appIcon:zcal.EMODE==0?"msi-Vevnt":"msi-caledit"};zmsuite.setWorkSpace(g);var h=["DIV",{attrs:{"class":"SC_phd"},child:[["text",f]]}];zcal.EMODE==0?(d={id:"zcalPrevHeader",rIcons:[{groupId:"Delete",actionArr:[{iconClass:"msi-trash",tooltip:"Delete",data:{action:"eventDelete"}}]},{groupId:"Close",actionArr:[{iconClass:"msi-close",tooltip:zcal.i18n.save,data:{action:"eventClose"}}]}]},zcal.EOBJ.EPERM==2&&d.rIcons.unshift({groupId:"Edit",actionArr:[{iconClass:"msi-edit",tooltip:"Edit",data:{action:"eventEdit"}}]}),zcal.EOBJ.ATT!=null&&d.rIcons.unshift({groupId:"Send",actionArr:[{iconClass:"msi-send",tooltip:"Send as mail",data:{action:"eventSend"}}]}),d.rIcons.unshift({groupId:"Chatlet",actionArr:[{iconClass:"msi-cliq",tooltip:"Start chat",data:{action:"startChat"}}]})):(d={id:"zcalPrevHeader",rIcons:[{groupId:"Save",actionArr:[{iconClass:"msi-save",tooltip:zcal.i18n.save,data:{action:e}}]}]},zcal.EOBJ.ATT!=null&&d.rIcons.push({groupId:"Send",actionArr:[{iconClass:"msi-send",tooltip:"Send as mail",data:{action:"eventSend"}}]}),d.rIcons.push({groupId:"Chatlet",actionArr:[{iconClass:"msi-cliq",tooltip:"Start chat",data:{action:"startChat"}}]}),zcal.EOBJ.EID&&d.rIcons.push({groupId:"Delete",actionArr:[{iconClass:"msi-trash",data:{action:"eventDelete"},tooltip:"eventDelete"}]}),d.rIcons.push({groupId:"Close",actionArr:[{iconClass:"msi-close",tooltip:zcal.i18n.save,data:{action:"eventClose"}}]})),d.text=h;var i=zmsuite.getCenter(),j=i[1].getNodes();zmsuite.renderCenter(),j[0].push(d),j[0].setListener("click",function(a,b){zcalList.bindAction(a,b)}),j[1].push($(a)),i[1].show();var k=b=="task"?ZCL_$("zcl_tskdes"):ZCL_$("zcl_cedesc");if(k){var l=ZCL_LinkParser(zcal.EOBJ.DESC?zcal.EOBJ.DESC:"");for(var m in l)l[m].nodeType==3&&l[m].nodeValue.match(/\s/)&&(l[m].nodeValue=l[m].nodeValue.replace(/\s/g,"")),k.appendChild(l[m])}ZCL_$("zcl_ce_desc")&&(ZCL_$("zcl_ce_desc").value=zcal.EOBJ.DESC?zcal.EOBJ.DESC:""),zmsuite.showWorkSpace(c),i[0].$el.addClass("SC_sw"),i[1].$el.addClass("SC_w100")},ZCL_constEventView=function(a){ZCL_clrStck(),zcal.EOBJ=a?a:ZCL_getAddEventObj(),zmApp.currentApp!="c"?zmTab.currentTab.indexOf("zm_srch")!=-1?(zmsuite.isWorkspaceAvailable("zcal_eContainer")&&zmsuite.closeWorkspace("zcal_eContainer"),zcal.EMODE=0,ZCL_ConstEventPage()):ZCL_openPopupCreateEvent(zcal.EOBJ):(zmsuite.isWorkspaceAvailable("zcal_eContainer")&&zmsuite.closeWorkspace("zcal_eContainer"),zcal.EMODE=zcal.EOBJ.EID==null||zcal.EMODE==1&&zcal.EOBJ.EPERM&&zcal.EOBJ.EPERM==2?1:0,ZCL_ConstEventPage())},zcal.constEventViewCard=function(){var a=zcal.EOBJ.GROUP_ID,b=zcal.EOBJ.ENTITY_ID;ZCL_clrStck(),ZCL_eClose();var c=zmsuite.isWorkspaceAvailable("zcal_Container");if(c){var d={gid:a,pid:b,type:4,actionType:"viewGroupEntity"};zmStream.singlePost.init(d,function(a){var b=zmsuite.getCenter("zcal_Container")[1],c=["DIV",{attrs:{"class":"SC_phd"},child:[["text","Stream view"]]}],d={text:[c],rIcons:[[{tooltip:"Close",iconClass:"msi-close",data:"close"}]]},e=b.getNodes()[0];e.push(d);var f=function(){zcal.closePrvwCard(b)};e.setListener("click",f);var g=b.getNodes()[1];g.push(a),b.show()})}},zcal.closePrvwCard=function(a){a.close()};var isFreeBusyClicked=!1;zcal.bindCreateEventAction=function(){var a=ZCL_$("zcl_ce_sd"),b=ZCL_$("zcl_ce_ed");a&&ZEVENTS(a.parentNode).picker("date",{dform:zcal.DFORMAT[zcal.cdata.opt.DF],refer:"zcl_ce_sd",wkst:zcal.cdata.opt.WK,mode:"popup",fullDtclk:1,higDate:["14/11/2017","16/11/2017"],update:"yes",minhgt:251}).on("dateclick",function(){ZCL_calcEed(a)}).bind(),b&&ZEVENTS(b.parentNode).picker("date",{dform:zcal.DFORMAT[zcal.cdata.opt.DF],refer:"zcl_ce_ed",wkst:zcal.cdata.opt.WK,mode:"popup",fullDtclk:1,update:"yes",minhgt:251}).on("dateclick",function(){ZCL_setEed(b)}).bind();var c=ZCL_$("zcl_ce_st"),d=ZCL_$("zcl_ce_et");c&&ZEVENTS(c).picker("time",{tform:zcal.timeformat[zcal.cdata.opt.TF],refer:"zcl_ce_st"}).on("change",function(){ZCL_calcEed(c,!0)}).bind(),d&&ZEVENTS(d).picker("time",{tform:zcal.timeformat[zcal.cdata.opt.TF],refer:"zcl_ce_et"}).on("change",function(){ZCL_setEed(d,!0)}).bind(),ZCL_$("zcl_ce_cal")&&$("#zcl_ce_cal").on("change",function(){ZCL_DoGrpChg()}),ZCL_$("zcl_ce_cal")&&$("#zcl_ce_cal").off("click").on("click",function(a){var b=ZCL_getCalArr(),c={},d=$(this),e;c.parentDOM=d.parent(),c.displayAs="dropdown",c.parWidth=!0,c.onSelect=function(a,b){setGroupValue(d,a,b),e.hide()},c.dataCallback=function(){return b},$("#zm_flpopup").remove(),e=zmUtil.createFLComp("generic",c),e.show()}),$("#zcl_addevent").on("click",function(a){a.target.id!="zcl_ce_cal"&&$("#zm_flpopup").remove()}),document.onmouseup=function(a){if(a.target.id!="zcl_iatt_lst"&&ZCL_$("zcl_ce_att_tbox")&&$("#zcl_ce_att_tbox")[0].value!=""){var b=$("#zcl_ce_att_tbox")[0].value;if(ZCL_isEmail(b)){var c={};c.id=b,ZCL_attCont(c),$("#zcl_ce_att_tbox").val("")}}},ZCL_$("zcl_ce_att")&&($("#zcl_ce_att_tbox").on("keydown",function(a){if(a.keyCode==13&&this.id=="zcl_ce_att_tbox"){var b=this.value.split(",");for(var c=0;c<b.length;c++){var d=b[c].trim(),e=d.indexOf("<"),f=d.indexOf(">");e>-1&&f>-1&&(d=d.substring(e+1,f)),d=d.replace(/,/g,"")}if(ZCL_isEmail(d)){var g={};g.id=d,ZCL_attCont(g),$("#zcl_ce_att_tbox").val("")}}}),zmAppLoader.load("zmContactsAutoComplete").done(function(){zmContactsAutoComplete.autoComplete({input:$("#zcl_ce_att_tbox")[0],excludeMe:!0,contactType:["org","crm","personal"],exclude:function(){var a=[];if($("#zcl_ce_attlst")[0]){var b=$("#zcl_ce_attlst")[0].childNodes[0].childNodes;for(var c=0;c<b.length;c++)a.push(b[c].getElementsByTagName("B")[0].innerHTML)}else if($("#attlist")[0].childNodes){var b=$("#attlist")[0].childNodes;for(var c in b)a.push(b[c].id)}return a},onSelect:function(a,b){var b=b.item.attributes;ZCL_attCont(b),$("#zcl_ce_att_tbox").val("")}})})),ZCL_$("zcl_ce_aday")&&$("#zcl_ce_aday").parent().off("click").on("click",function(){ZCL_ChgChk(this),ZCL_checkAll()}),ZCL_$("zcl_ce_tza")&&$("#zcl_ce_tza").parent().off("click").on("click",function(){ZCL_openTZPopup()}),ZCL_$("zcl_ce_inetz")&&$("#zcl_ce_inetz").parent().off("click").on("click",function(){ZCL_ChgChk(this)}),ZCL_$("zcl_fblnk")&&$("#zcl_fblnk").off("click").on("click",function(a){isFreeBusyClicked||zcalFreebusy.loadFB()}),ZCL_$("zcl_gatt_add")&&$("#zcl_gatt_add").off("click").on("click",function(a){zcalGroup.listGroupForAttSel()}),ZCL_$("zcl_ce_rem")&&$("#zcl_ce_rem .msi-close").off("click").on("click",function(){var a=this.parentNode.parentNode.parentNode,b;a.removeChild(this.parentNode.parentNode),b=a.querySelector("#zcl_addrem"),b||ZCL_AppendRemAddLnk(a)}),ZCL_$("zcl_ve_lnk")&&$("#zcl_ve_lnk").on("click",function(a){var b=ZCL_$("zcl_eid").value;window.open(location.protocol+"//"+zcal.ZCAL+"/cal/nxtPag.do?sname=elnk&evid="+b,"_blank"),ZCL_stopEvents(a)}),ZCL_$("zcl_setrem")&&$("#zcl_setrem").on("click",function(a){ZCL_SetAlrm()});var e=$("#zcl_ce");$groupAtt=e.find("[data-marker=groupAtt]"),$groupAtt.length>0&&($groupAtt.removeAttr("data-marker"),$groupAtt.off("click").on("click",function(){var a=$(this),b=a.data("gid"),c=a.data("sts");ZCL_listGroupUserAtt(b,c)}))},ZCL_attCont=function(a){var b=$("#attlist"),c=document.createElement("ul");a.zid&&c.setAttribute("data-zid",a.zid),c.setAttribute("id",a.id),c.setAttribute("class","zcl_sl"),$("#zcl_ce_attlst")[0]?(c.innerHTML="<li>"+(a.profileImage?"<img src="+a.profileImage+">":"")+"</li><li><b>"+a.id+'</b></li><li class="zcl_txr"><i class="msi-pending" title="Status &quot;Pending&quot;"></i><i class="msi-close" onclick="ZCL_rmvAtt(this,\''+a.id+'\')" title="Remove" ></i></li>',$("#zcl_ce_attlst").prepend(b.append($(c)))):(c.innerHTML="<li>"+(a.profileImage?"<img src="+a.profileImage+">":"")+"</li><li><b>"+a.id+'</b></li><li class="zcl_txr" style="width:20px"><i class="msi-close" onclick="ZCL_rmvAtt(this,\''+a.id+'\')" title="Remove" ></i></li>',b.append($(c)))};var setGroupValue=function(a,b,c){a.val(c.display_text),a.attr("rel",b),ZCL_DoGrpChg()};ZCL_selBox=function(a,b,c){var d='<div class="SC_select"><select class="select" id="'+a+'">';for(var e=0;e<c.length;e++)d+="<option "+(e==b?"selected":"")+' value="'+e+'">'+c[e]+"</option>";return d+="</select></div>",d},ZCL_selBox1=function(a,b,c){var d='<div class="SC_select"><select class="select" id="'+a+'">';for(var e in c)d+="<option "+(e==b?"selected":"")+' value="'+e+'">'+c[e]+"</option>";return d+="</select></div>",d},ZCL_SetMetaInfo=function(a,b){var c=zcal.EOBJ.CRETIME.split(","),d=zcal.EOBJ.LSTMODTIME.split(","),e='<ul class="zcl_vwmeta"><li><span onclick="ZCL_tgleNxtEle(this)"><i class="'+(a!=""?"msi-rarrow":"msi-barrow")+'"></i>'+(zcal.EOBJ.ETYPE==3?zcal.i18n.taskinfo:zcal.i18n.eventinfo)+"</span></li>";return e+="<li "+(a!=""?'style="display:none"':"")+'><div class="zcl_table">',zcal.EOBJ.ORGM&&zcal.EOBJ.ORGM!=""&&(e+="<ul><li>"+(zcal.EOBJ.ORG_PH?'<img src="'+zcal.EOBJ.ORG_PH+'"/>':"")+"</li>"+"<li><b>"+zcal.i18n.organizer+'</b><span class="zcl_lk">'+zcal.EOBJ.ORGM+"</span></li>"+"</ul>"),zcal.EOBJ.CREBY?e+="<ul><li>"+(zcal.EOBJ.CREBY_PH?'<img src="'+zcal.EOBJ.CREBY_PH+'">':"")+"</li>"+"<li>"+"<b>"+zcal.i18n.createdby+'</b><span class="zcl_lk">'+zcal.EOBJ.CREBY+"</span>"+"<u>"+ZCL_parseDateStr(c[1]).dateBy("NNN dd, yyyy")+" @ "+ZCL_parseTime(c[2]).HH+":"+ZCL_parseTime(c[2]).mm+"</u>"+"</li>"+"</ul>":e+="<ul><li>"+(zcal.EOBJ.CREBY_PH?'<img src="'+zcal.EOBJ.CREBY_PH+'">':"")+"</li>"+"<li>"+"<b>"+zcal.i18n.createdon+"</b>"+"<u>"+ZCL_parseDateStr(c[1]).dateBy("NNN dd, yyyy")+" @ "+ZCL_parseTime(c[2]).HH+":"+ZCL_parseTime(c[2]).mm+"</u>"+"</li>"+"</ul>",zcal.EOBJ.MODBY?e+="<ul><li>"+(zcal.EOBJ.MODBY_PH?'<img src="'+zcal.EOBJ.MODBY_PH+'"/>':"")+"</li>"+"<li>"+"<b>"+zcal.i18n.modifiedby+'</b><span class="zcl_lk">'+zcal.EOBJ.MODBY+"</span>"+"<u>"+ZCL_parseDateStr(d[1]).dateBy("NNN dd, yyyy")+" @ "+ZCL_parseTime(d[2]).HH+":"+ZCL_parseTime(d[2]).mm+"</u>"+"</li>"+"</ul>":e+="<ul><li>"+(zcal.EOBJ.MODBY_PH?'<img src="'+zcal.EOBJ.MODBY_PH+'"/>':"")+"</li>"+"<li>"+"<b>"+zcal.i18n.modifiedon+"</b>"+"<u>"+ZCL_parseDateStr(d[1]).dateBy("NNN dd, yyyy")+" @ "+ZCL_parseTime(d[2]).HH+":"+ZCL_parseTime(d[2]).mm+"</u>"+"</li>"+"</ul>",e+="</div></li></ul>",e},ZCL_SetIndAttLst=function(a){var b="",c="";zcal.EOBJ.ATT&&(zcal.EOBJ.ATT.USR||zcal.EOBJ.ATT.GRP)&&(b+='<ul class="zcl_viwatt" id="zcl_ce_aslst">'+ZCL_attStsLnk("all",a)+ZCL_attStsLnk("yes",a)+ZCL_attStsLnk("no",a)+ZCL_attStsLnk("maybe",a)+ZCL_attStsLnk("pending",a)+"</ul>",b+='<div id="zcl_ce_attlst">'+ZCL_ListAtt(a)+"</div>");if(zcal.EMODE==1){c+='<ul class="zcl_frmrw" id="zcl_ce_attdv"><li class="zcl_att"><u>'+zcal.i18n.attendees+"</u>",c+='<ul class="zcl_frmrw zcl_pddbz"><li id="zcl_iatt_lst" class="zcl_atte"><div id="zcl_ce_att"><input type="text" class="zm_sgst" placeholder="'+zcal.i18n.typeaemailid+'" id="zcl_ce_att_tbox"></div>';var d,e,f=ZCL_hasGrp();ZCL_$("zcl_ce_cal")?d=ZCL_$("zcl_ce_cal").getAttribute("rel"):d=zcal.EOBJ.CNAME,e=zcal.getCalObj(d),f&&e[14]==""&&(c+='<i class="msi-addgroup" id="zcl_gatt_add"></i>'),c+='</li></ul><div class="zcl_txr"><span id="zcl_fblnk" class="zcl_lk">'+zcal.i18n.freebusy+"</span></div>"}return c+='<div><div class="zcl_viwatlst zcl_table" id="attlist"></div></div>',b!=""&&(c+='<ul class="zcl_frmrw zcl_vwatte"><li><div>'+b+"</div></li></ul>"),c},ZCL_hasGrp=function(){var a=!1,b,c;return b=zcal.cdata.grpLst&&zcal.cdata.grpLst.pgrp?Object.keys(zcal.cdata.grpLst.pgrp).length:0,b>0?!0:(c=zcal.cdata.grpLst&&zcal.cdata.grpLst.ogrp?Object.keys(zcal.cdata.grpLst.ogrp):0,c>0&&(a=!0),a)},ZCL_DoGrpChg=function(){var a,b;a=ZCL_$("zcl_ce_cal").getAttribute("rel"),b=zcal.getCalObj(a);if(b[14]!=""){b[14]!="crm"&&ZCL_$("zcl_ce_cal")!=null&&(zcal.CAL_IND=ZCL_$("zcl_ce_cal").selectedIndex);if(b[14]=="crm"||b[14]=="recruit"&&(zcal.cdata.calOUids.indexOf("zohoRecruit4_")!=-1||zcal.cdata.opt.GTYPE==1&&zcal.cdata.opt.VERSION=="new")){if(b[14]=="crm"&&zcal.EOBJ.EID!=null&&ZCL_OLD_COBJ!=null){var c=ZCL_OLD_COBJ[5];if(c!=0){zmUtil.succErrMsg("e",zcal.i18n.crmothercal),ZCL_$("zcl_ce_cal").selectedIndex=zcal.CAL_IND;return}if(zcal.EOBJ.REP!=null){zmUtil.succErrMsg("e",zcal.i18n.crmrepadd),ZCL_$("zcl_ce_cal").selectedIndex=zcal.CAL_IND;return}}zcal.EOBJ.CNAME=a,crmCalId=a,zcalCRM.showCRMForm()}else b[14]=="ztask"?(zcal.EOBJ.CNAME=a,zcalTask.showTaskForm()):(b[14]=="gcal"?ZCL_$("zcl_ce_attach")&&(ZCL_$("zcl_ce_attach").parentNode.style.display="none"):ZCL_$("zcl_ce_attach")&&(ZCL_$("zcl_ce_attach").parentNode.style.display=""),ZCL_$("zcl_ce_ass")&&ZCL_$("zcl_ce_ass").parentNode.removeChild(ZCL_$("zcl_ce_ass")),ZCL_$("zcl_ce_pvt")&&ZCL_$("zcl_ce_pvt").parentNode.parentNode.removeChild(ZCL_$("zcl_ce_pvt").parentNode),ZCL_$("zcl_ce_attdv")&&(ZCL_$("zcl_ce_attdv").innerHTML=ZCL_SetEventAtt()),ZCL_$("zcl_ce_color")&&ZCL_$("zcl_ce_color").parentNode.parentNode.parentNode.removeChild(ZCL_$("zcl_ce_color").parentNode.parentNode),ZCL_setGrpCalAlarm(b,!0))}else{ZCL_$("zcl_ce_cal")!=null&&(zcal.CAL_IND=ZCL_$("zcl_ce_cal").selectedIndex);if(!ZCL_$("zcl_ce_ass")){var d=ZCL_SetEventAss();if(d!=""){var e=document.createElement("ul");e.className="zcl_frmrw",e.id="zcl_ce_ass",e.innerHTML=d;if(ZCL_$("zcl_ce_ext")){var f=ZCL_$("zcl_ce_ext").childNodes;ZCL_$("zcl_ce_ext").insertBefore(e,ZCL_$("zcl_ce_attdv"))}}}if(!ZCL_$("zcl_ce_pvt")){var g=document.createElement("li");g.className="zcl_curpt",g.onclick=function(){ZCL_ChgChk(this)},g.innerHTML='<i class="'+(zcal.EOBJ.CLASS&&zcal.EOBJ.CLASS==1?"msi-check":"msi-uncheck")+'" id="zcl_ce_pvt"></i>'+zcal.i18n.eprivate,ZCL_$("zcl_ce_tit")&&ZCL_$("zcl_ce_tit").parentNode.parentNode.appendChild(g)}if(!ZCL_$("zcl_ce_rem")){var h=document.createElement("ul");h.className="zcl_frmrw zcl_rem";var i=ZCL_setGrpCalAlarm(b,!1);h.innerHTML='<li id="zcl_ce_rem"><div class="zcl_frmaln" id="zcl_ce_rem">'+i+"</div></div>",ZCL_$("zcl_ce_ele")?ZCL_$("zcl_ce_ele").insertBefore(h,ZCL_$("zcl_ce_ele").childNodes[1]):ZCL_$("zcl_ce_desc").parentNode.childNodes[3].append(h)}if(!ZCL_$("zcl_ce_color")){var j=document.createElement("ul");j.className="zcl_frmrw",j.innerHTML=ZCL_EventColorSel(),ZCL_$("zcl_ce_ele")&&ZCL_$("zcl_ce_ele").insertBefore(j,ZCL_$("zcl_ce_ele").childNodes[2])}ZCL_$("zcl_ce_attach")&&(ZCL_$("zcl_ce_attach").parentNode.style.display=""),ZCL_$("zcl_ce_attdv")&&(ZCL_$("zcl_ce_attdv").innerHTML=ZCL_SetEventAtt())}zcal.bindCreateEventAction()},ZCL_openPopupCreateEvent=function(a){var b,c,d,e,f,g,h,i=ZCL_getAddEventObj(),j=zcal.timeformat[zcal.cdata.opt.TF];f=a.ADAY&&a.ADAY==1?!0:!1,b=a.SD?a.SD:i.SD,c=a.ED?a.ED:i.ED,d=a.ST?a.ST:i.ST,e=a.ET?a.ET:i.ET;var k=a.CNAME?a.CNAME:i.CNAME,l;l=zcal.getCalObj(k),g=a.SUM?ZCL_getHTML(a.SUM):"",h=a.DESC?a.DESC:"";var m=d.getTimeBy(j),n=e.getTimeBy(j),o=ZCL_splitDateVal(ZCL_putDate(b)),p=ZCL_splitDateVal(ZCL_putDate(c)),q=ZCL_parseTime(m),r=ZCL_parseTime(n);ZCL_ESDATE=new Date(o[2],o[1]-1,o[0],q.HH,q.mm,0,0),ZCL_EEDATE=new Date(p[2],p[1]-1,p[0],r.HH,r.mm,0,0);var s=ZCL_SetEventAlrm(l),t=$(".zm_compose"),u,v,w,x;x=$(zcalTemplate.popupCreateEvent({sum:g,desc:h,sd:ZCL_putDate(b),st:m,ed:ZCL_putDate(c),et:n,reminder:s})),u=t.offset(),v=u.top+"px",w=u.left+t.width()+"px";var y={title:zcal.i18n.createevt,mask:!0,posParent:{top:v,left:w},buttons:[{txt:zcal.i18n.save,callback:function(){ZCL_savePopupEvent(a)}},{isCancel:!0,txt:zcal.i18n.cancel,callback:function(){zmMention.clearMention($("#zcl_ppce_tit")),zmUtil.hideMenu()}}],closeaction:function(){zmMention.clearMention($("#zcl_ppce_tit")),zmUtil.hideMenu()}};ZCL_$("zcl_addevent")||$("body").append('<div id="zcl_addevent"></div>'),$("#zcl_addevent").html(x),zmsDialog.create("zcl_addevent",y);if(ZCL_$("zcl_ppce_tit")){var z={contentArray:"org",compare:["fn","ln","nn","eid"],LType:"3",OType:"3",drag:!1};zmAutoFill.setAutofill(z,$("#zcl_ppce_tit"))}$("#zmsdialog_zcl_addevent").mousedown(function(a){zmUtil.stopEvents(a,!0),$(".zcal_cn").remove(),$(".zcal_tilst").remove()}),zcal.bindCreateEventAction()},ZCL_savePopupEvent=function(a){var b,c,d,e;b=ZCL_$("zcl_ppce_tit").parentNode.firstChild.innerHTML.split("<b")[0],b==""&&(b=ZCL_$("zcl_ppce_tit").value),c=ZCL_$("zcl_ce_loc").value,d=zmMention.getMentions($("#zcl_ppce_tit")),e=ZCL_streamEve.getMentionEmails(d);if(b=="")return zmUtil.succErrMsg("e",zcal.i18n.plenttle),ZCL_$("zcl_ppce_tit").focus(),!1;if(!zcal.validate(b))return zmUtil.succErrMsg("e",zcal.i18n.spchevetle),ZCL_$("zcl_ppce_tit").focus(),!1;if(!ZCL_dateValidate("zcl_ce_sd",zcal.i18n.evest)||!ZCL_dateValidate("zcl_ce_ed",zcal.i18n.eveed))return!1;if(!ZCL_dateTimeComparison("zcl_ce_ed","zcl_ce_et",zcal.i18n.eveed,"zcl_ce_sd","zcl_ce_st",zcal.i18n.evest,"G"))return!1;if(!zcal.validate(c))return zmUtil.succErrMsg("e",zcal.i18n.spcheveloc),ZCL_$("zcl_ce_loc").focus(),!1;if(!zcal.validate(ZCL_$("zcl_ce_desc").value))return zmUtil.succErrMsg("e",zcal.i18n.spchevenot),ZCL_$("zcl_ce_desc").focus(),!1;var f=zcal.$("zcl_ce_st").style.display==""?zcal.$("zcl_ce_st").value:"00:00",g=zcal.$("zcl_ce_et").style.display==""?zcal.$("zcl_ce_et").value:"00:00",h=zcal.$("zcl_ce_cal").getAttribute("rel"),i=zcal.getCalObj(h),j,k={EID:"",EUID:"",EPERM:i[12]>=2?2:i[12]==1?1:0,DPERM:i[12]>=2?2:0,SD:ZCL_$("zcl_ce_sd").value,ST:ZCL_TimetoNo(f),ED:ZCL_$("zcl_ce_ed").value,ET:ZCL_TimetoNo(g),ADAY:ZCL_$("zcl_ce_aday").className=="msi-check"?1:0,LOC:c,DESC:ZCL_$("zcl_ce_desc").value,ALARM:i[14]==""?ZCL_getAlarm("zcl_ce_rem"):"",ETZ:"",IN_ETZ:!1,CLASS:0,IMP:0,CNAME:h,TRANS:1,ETSK:0,ECRM:0,ENTS:0,EMET:0,LINK:"",SUM:b,EC:-1,ATT:e,ADD_MODE:"PP",MSGID:a.msgId,ACCID:a.accId,failureCallbk:a.failureCallbk,successCallbk:a.successCallbk};ZCL_detailObj(k),zmMention.clearMention($("#zcl_ppce_tit")),zmUtil.hideMenu()};var zcalTask=function(){var a,b=function(){a=zcal.EOBJ.CNAME,zcal.EOBJ.EID==null&&d(),e()},c=function(){a=zcal.EOBJ.CNAME,e()},d=function(){zcal.EOBJ.SUM=ZCL_$("zcl_ce_tit")?ZCL_$("zcl_ce_tit").value:zcal.EOBJ.SUM,zcal.EOBJ.Description=ZCL_$("zcl_ce_desc")?ZCL_$("zcl_ce_desc").value:"",zcal.EOBJ.SD=ZCL_$("zcl_ce_sd")?ZCL_DFDate(ZCL_$("zcl_ce_sd").value):zcal.EOBJ.SD,zcal.EOBJ.ST=ZCL_$("zcl_ce_st")?ZCL_TimetoNo(ZCL_$("zcl_ce_st").style.display==""?ZCL_$("zcl_ce_st").value:"00:00"):zcal.EOBJ.ST,zcal.EOBJ.ED=ZCL_$("zcl_ce_ed")?ZCL_DFDate(ZCL_$("zcl_ce_ed").value):zcal.EOBJ.ED,zcal.EOBJ.ET=ZCL_$("zcl_ce_et")?ZCL_TimetoNo(ZCL_$("zcl_ce_et").style.display==""?ZCL_$("zcl_ce_et").value:"00:00"):zcal.EOBJ.ET},e=function(){ZCL_clrStck();var a='<div class="zcl zcl_CMS zcl_H100" id="zcl_ce">';a+=q(),a+='<div class="zcl_table zcl_H100">',zcal.EMODE==0?a+='<ul><li><ul class="zcl_crevnt" id="zcl_ce_ele"><li><ul class="zcl_vwev"><li>'+h()+i()+j()+k()+l()+n()+o()+p()+"</li>"+"</ul>"+"</li>"+"</ul>"+"</li>"+'<li class="zcl_Cer zcl_vwCer" id="zcl_ce_ext">'+s()+"</li>"+"</ul>":a+='<ul><li><ul class="zcl_crevnt" id="zcl_ce_ele"><li>'+h()+i()+j()+k()+l()+n()+o()+p()+r()+"</li>"+"</ul>"+"</li>"+'<li class="zcl_Cer zcl_vwCer" id="zcl_ce_ext" style="'+(zcal.EOBJ.EID?"":"visibility:hidden")+'">'+(zcal.EOBJ.EID?s():"")+"</li>"+"</ul>",a+="</div></div>",ZCL_$("zcl_ce")?(ZCL_updEventPrevHeader("task"),$("#zcl_ce").parent().html(a)):ZCL_setEventWorkSpace(a,"task"),f()},f=function(){var b=$("#zcl_ce"),c=zcal.DFORMAT[zcal.cdata.opt.DF],d=zcal.timeformat[zcal.cdata.opt.TF],e=b.find("[data-marker=dateField]"),f=b.find("[data-marker=timeField]"),h=b.find("[data-marker=chkboxField]"),i=b.find("[data-marker=remField]"),j=b.find("[data-marker=taskSave]"),k=b.find("[data-marker=taskFormClose]");if(e.length>0){var l=new Date(zcal.cdate),m;m=l.dateBy(c),e.removeAttr("data-marker");for(var n=0;n<e.length;n++){var o=e[n];ZEVENTS(o).picker("date",{dform:c,range:[m,""],refer:o.id,wkst:0,mode:"popup",update:"yes",minhgt:251}).bind()}}if(f.length>0){f.removeAttr("data-marker");for(var n=0;n<f.length;n++){var p=f[n];ZEVENTS(p).picker("time",{tform:d,refer:p.id}).bind()}}i.length>0&&(i.removeAttr("data-marker"),i.off("click").on("click",function(){g(this)})),h.length>0&&(h.removeAttr("data-marker"),h.parent().off("click").on("click",function(){ZCL_ChgChk(this)})),j.length>0&&(j.removeAttr("data-marker"),j.off("click").on("click",function(){u()})),k.length>0&&(k.removeAttr("data-marker"),k.off("click").on("click",function(){a=undefined,ZCL_eClose()}))},g=function(a){var b=$(a),c;c=m("dom"),b.parent().replaceWith(c),f()},h=function(){var a='<ul class="zcl_frmrw">',b=zcal.EOBJ.SUM?ZCL_getHTML(zcal.EOBJ.SUM):"";return zcal.EMODE==0?a+='<li class="zcl_evttvw">'+b+"</li>":a+='<li class="zcl_W70pc"><input type="text" placeholder="Task Title" class="zcl_crevntt SC_tiput" id="zcl_ce_tit" value="'+b+'">'+"</li>",a+="</ul>",a},i=function(){var a="",b=zcal.EOBJ.SD;if(zcal.EMODE==0){var c=ZCL_parseDateStr(b);a+='<ul class="zcl_frmrw"><li>'+c.dateBy("MMM dd, yyyy")+"</li>"+"</ul>"}else a+='<ul class="zcl_frmrw"><li class="zcl_select"><u>'+zcal.i18n.duedate+"</u>"+'<input type="text" class="zcl_w100 SC_tiput" data-marker="dateField" value="'+ZCL_putDate(b)+'" id="zcl_ce_dd" readonly>'+"</li>"+"</ul>";return a},j=function(){var a="",b=zcal.EOBJ.PRIORITY?zcal.EOBJ.PRIORITY:1,c=[zcal.i18n.ztask_priority_high,zcal.i18n.ztask_priority_medium,zcal.i18n.ztask_priority_low];return a+='<ul class="zcl_frmrw"><li><u>'+zcal.i18n.priority+"</u>",zcal.EMODE==0?a+="<span>"+c[b]+"</span>":a+=ZCL_selBox("zcl_task_pri",b,c),a+="</li></ul>",a},k=function(){var a="",b=zcal.EOBJ.STATUS?zcal.EOBJ.STATUS:0,c=[zcal.i18n.inprogress,zcal.i18n.completed];return a+='<ul class="zcl_frmrw"><li><u>'+zcal.i18n.status+"</u>",zcal.EMODE==0?a+="<span>"+c[b]+"</span>":a+=ZCL_selBox("zcl_task_sts",b,c),a+="</li></ul>",a},l=function(){var a="";return zcal.EMODE==0||zcal.EOBJ.REMDATE?a+=m("string"):a+='<ul class="zcl_frmrw zcl_rem"><li data-marker="remField"><ul id="zcl_addrem"><li><span><i class="msi-add"></i>'+zcal.i18n.addreminder+"</span></li></ul>"+"</li>"+"</ul>",a},m=function(a){var b=zcal.DFORMAT[zcal.cdata.opt.DF],c=zcal.timeformat[zcal.cdata.opt.TF],d=zcal.EOBJ.REMDATE||"",e=zcal.EOBJ.REMTIME||"",f=e.getTimeBy(c),g=$('<ul class="zcl_frmrw"/>'),h="";if(zcal.EMODE==0){var i=d!=""?ZCL_parseDateStr(d).dateBy("MMM dd, yyyy")+", "+f:"";h+="<li><u>"+zcal.i18n.reminder+"</u>"+"<span>"+i+"</span>"+"</li>"}else d=d!=""?d:zcal.EOBJ.SD,h+="<li><u>"+zcal.i18n.reminder+"</u>"+'<ul class="zcl_frmrw zcl_when">'+'<li class="zcl_select">'+'<input type="text" class="zcl_w100 SC_tiput" data-marker="dateField" value="'+ZCL_putDate(d)+'" id="zcl_ce_rd" readonly>'+"</li>"+'<li class="zcl_select">'+'<input type="text" class="zcl_w70 SC_tiput" data-marker="timeField" value="'+f+'" id="zcl_ce_rt">'+"</li>"+"</ul>"+"<ul>"+'<li class="zcl_curpt">'+'<i class="'+(zcal.EOBJ.EMLR&&zcal.EOBJ.EMLR==1?"msi-check":"msi-uncheck")+'" data-marker="chkboxField" id="zcl_remMail"></i>'+zcal.i18n.mail+"</li>"+'<li class="zcl_curpt">'+'<i class="'+(zcal.EOBJ.PPR&&zcal.EOBJ.PPR==1?"msi-check":"msi-uncheck")+'" data-marker="chkboxField" id="zcl_remPop"></i>'+zcal.i18n.notification+"</li>"+"</ul>"+"</li>";g.html(h);if(a==="dom")return g;if(a==="string")return g[0].outerHTML},n=function(){return'<ul class="zcl_frmrw"><li><u class="zcl_grey">'+zcal.i18n.calendar+"</u><span>"+ZCL_GetCalName(a)+"</span></li></ul>"},o=function(){return'<ul class="zcl_frmrw"><li><u class="zcl_grey">'+zcal.i18n.task+"</u><span>"+zcal.i18n.mytask+"</span></li></ul>"},p=function(){var a='<ul class="zcl_frmrw">',b=zcal.EOBJ.DESC||"";return zcal.EMODE==0?a+="<li><u>"+zcal.i18n.description+"</u>"+'<div class="zcl_vwdes" id="zcl_tskdes"></div>'+"</li>":a+='<li class="zcl_W70pc"><u>'+zcal.i18n.description+"</u>"+'<textarea style="height:44px;" class="zcl_Cedes SC_tiput" id="zcl_ce_desc">'+b+"</textarea>"+"</li>",a+="</ul>",a},q=function(){var b=ZCL_hdnFld("zcl_eid",zcal.EOBJ.EID?zcal.EOBJ.EID:"")+ZCL_hdnFld("zcl_ekey",zcal.EOBJ.EUID?zcal.EOBJ.EUID:"")+ZCL_hdnFld("zcl_crel",a)+ZCL_hdnFld("zcl_rmvatt","");return b},r=function(){var a='<ul class="zcl_frmrw"><li><div class="SC_PUbtm"><span data-marker="taskSave">'+zcal.i18n.save+"</span>"+'<span data-marker="taskFormClose" data-val="Cancel">'+zcal.i18n.cancel+"</span>"+"</div>"+"</li>"+"</ul>";return a},s=function(){return ZCL_SetMetaInfo("")},t=function(){var a=new Date,b=new Date,c=ZCL_splitDateVal(ZCL_$("zcl_ce_dd").value);return b.setYear(c[2]),b.setMonth(c[1]-1),b.setDate(c[0]),ZCL_$("zcl_ce_tit").value.trim()==""?(zmUtil.succErrMsg("e",zcal.i18n.plenttle),ZCL_$("zcl_ce_tit").focus(),!1):zcal.validate(ZCL_$("zcl_ce_tit").value)?zcal.validate(ZCL_$("zcl_ce_desc").value)?ZCL_dateValidate("zcl_ce_dd",zcal.i18n.evest)?!0:!1:(zmUtil.succErrMsg("e",zcal.i18n.spchevenot),ZCL_$("zcl_ce_desc").focus(),!1):(zmUtil.succErrMsg("e",zcal.i18n.spchevetle),ZCL_$("zcl_ce_tit").focus(),!1)},u=function(){if(t()){var a=ZCL_$("zcl_ce_rt")?ZCL_$("zcl_ce_rt").value:"00:00",b={EID:ZCL_$("zcl_eid").value,EUID:ZCL_$("zcl_ekey").value,DD:ZCL_$("zcl_ce_dd").value,CNAME:ZCL_$("zcl_crel").value,SUM:ZCL_$("zcl_ce_tit").value,PRIORITY:ZCL_$("zcl_task_pri").value,STATUS:ZCL_$("zcl_task_sts").value,REMDATE:ZCL_$("zcl_ce_rd")?ZCL_$("zcl_ce_rd").value:"",REMTIME:ZCL_TimetoNo(a),MAIL:ZCL_$("zcl_remMail")&&ZCL_$("zcl_remMail").className=="msi-check"?1:0,POPUP:ZCL_$("zcl_remPop")&&ZCL_$("zcl_remPop").className=="msi-check"?1:0,ADAY:1,EPERM:2,DPERM:2,EC:-1},c="/cal/addTask.do?title="+b.SUM.zcalescape()+"&dateFormat="+zcal.DFORMAT[zcal.cdata.opt.DF];c+="&dueDate="+b.DD,c+="&priority="+b.PRIORITY.zcalescape(),c+="&status="+b.STATUS.zcalescape(),c+=ZCL_$("zcl_ce_desc")?"&desc="+ZCL_$("zcl_ce_desc").value.zcalescape():"",b.EID&&(c+="&eid="+b.EID+"&ekey="+b.EUID),b.REMDATE!=""&&(c+="&remDate="+b.REMDATE+"&remTime="+b.REMTIME+"&remMail="+b.MAIL+"&remPopup="+b.POPUP);var d=zcal.getCalObj(ZCL_$("zcl_crel").value);c+="&ckey="+d[9],ZCL_TEMP_EOBJ=b,ZCL_XHR(c,function(a){ZCL_retDET(a)})}},v={showTaskForm:b,updateTaskData:c,saveTask:u};return v}();ZCL_getCustomAlarmInfo=function(a){var b="";if(a<36e5)b=parseInt(a/6e4),b==1?b+=" min":b+=" mins";else if(a<864e5){b=parseInt(a/36e5),b==1?b+=" hr":b+=" hrs";var c=a%36e5;c=parseInt(c/6e4),c!=0&&(c==1?b+=" "+c+" min":b+=" "+c+" mins")}else{b=parseInt(a/864e5);var d=a%864e5,c=d%36e5;b==1?b+=" day":b+=" days",d=parseInt(d/36e5),d!=0&&(d==1?b+=" "+d+" hr":b+=" "+d+" hrs"),c=parseInt(c/6e4),c!=0&&(d==0&&(b+=" 0 hrs"),c==1?b+=" "+c+" min":b+=" "+c+" mins")}return b},ZCL_chatDropdown=function(a,b){if(zmTab.currentTab=="zcal_eContainer"){var c=[{txt:"Start New Chat",data:"newChat"}];for(var d in a)c.push({txt:a[d].title,data:a[d].chatId});var e=[],f,g;for(var h in c)g=c[h].data==="newChat",f=g?"SC_thm":"",e.push(_zm.getDOM(["LI",{attrs:{"data-item":c[h].data,"class":f},child:[["text",c[h].txt]]}])),g&&e.push(_zm.getDOM(["LI",{attrs:{"class":"SC_lne"}}]));var i;i=new zmDropDownMenu;var j={par:b.target,showArrow:!1,liDom:e,spanClass:"SC_Sopt",clk:chatAction=function(a){if(a.item=="newChat")ZCL_openChatletPopup(),zmUtil.hideMenu();else{var b=zcal.EOBJ.EID,c="/cal/chatlet.do?mode=add&chId="+a.item;b!=""&&(b.indexOf("_")!=-1?c+="&eveId="+b.substring(0,b.indexOf("_")):c+="&eveId="+b),ZCL_XHR(c,function(a){var b=JSON.parse(a.responseText);b.status=="success"&&zmUtil.hideMenu()})}},align:"pright"};i.setDropObj(j),i.paint()}else{ZCL_clrStck();var k={buttons:[{txt:"Start New Chat",callback:function(){ZCL_openChatletPopup()}},{isCancel:!0,txt:zcal.i18n.cancel,callback:function(){ZCL_closeChatlet()}}],closeaction:function(){ZCL_closeChatlet()}};ZCL_$("zcl_chatlet")||$("body").append('<ul id="zcl_alchatlet" class="zcl_chatlgr"></ul>');var l="";for(var h in a)l+="<li rel="+a[h].chatId+">"+a[h].title+"</li>";$("#zcl_alchatlet").html(l),$("#zcl_alchatlet").find("LI").on("click",function(a){var b=zcal.EOBJ.EID,c=a.target.getAttribute("rel"),d="/cal/chatlet.do?mode=add&chId="+c;b!=""&&(b.indexOf("_")!=-1?d+="&eveId="+b.substring(0,b.indexOf("_")):d+="&eveId="+b),ZCL_XHR(d,function(a){var b=JSON.parse(a.responseText);b.status=="success"&&zmsDialog.remove(!0)})}),zmsDialog.create("zcl_alchatlet",k)}},ZCL_chatLet=function(a,b){zcal.EOBJ=b;var c=zcal.EOBJ.EID;c!=""&&(c.indexOf("_")!=-1?ZCL_XHR("/cal/chatlet.do?mode=getChats&eveId="+c.substring(0,c.indexOf("_")),function(b){var c=ZCL_Evl(1,b.responseText);c.ChatObj.length>0?ZCL_chatDropdown(c.ChatObj,a):ZCL_openChatletPopup()}):ZCL_XHR("/cal/chatlet.do?mode=getChats&eveId="+c,function(b){var c=ZCL_Evl(1,b.responseText);c.ChatObj.length>0?ZCL_chatDropdown(c.ChatObj,a):ZCL_openChatletPopup()}))},ZCL_chatInfo=function(a,b){var c=ZCL_Evl(1,a.responseText);c.ChatObj.length>0?ZCL_chatDropdown(c.ChatObj,b):ZCL_openChatletPopup()},ZCL_openChatletPopup=function(){var a=zcal.EOBJ,b=$(zcalTemplate.popupChatlet(a)),c={title:"Start new chat",mask:!0,buttons:[{txt:"Start Chat",callback:function(){ZCL_creatChatlet()}},{isCancel:!0,txt:zcal.i18n.cancel,callback:function(){ZCL_closeChatlet()}}],closeaction:function(){ZCL_closeChatlet()}};ZCL_$("zcl_chatlet")||$("body").append('<div id="zcl_chatlet"></div>'),$("#zcl_chatlet").html(b),$("#zmsdialog_zcl_alchatlet").remove(),zmsDialog.create("zcl_chatlet",c),$("#zmsdialog_zcl_chatlet").on("click",function(a){if($(a.target).parent()[0].id=="attDiv"){if(a.target.id=="attAdd"||$(a.target).parent()[0].id=="att")b.find("#attDiv")[0].className="addInv SC_floatLabel flFLabel clearfix edit_parti",b.find("input").focus()}else $(a.target).parent()[0].id!="att"&&(b.find("#attDiv")[0].className="addInv SC_floatLabel flFLabel clearfix addUsers autoFilldata",b.find("#attAdd")[0].className="msi-plus SC_thm borderPlus")}),b.find(".msi-close").on("click",function(){$(this).parent("#att").remove()}),ZCL_autoCom(b)},ZCL_creatChatlet=function(){var a=zcal.timeformat[zcal.cdata.opt.TF],b=zcal.EOBJ.ADAY&&zcal.EOBJ.ADAY==1?!0:!1,c=zcal.EOBJ.SD,d=zcal.EOBJ.ED,e=b?"8:00 am":zcal.EOBJ.ST,f=b?"8:30 am":zcal.EOBJ.ET,g=e.getTimeBy(a),h=f.getTimeBy(a),i=ZCL_splitDateVal(ZCL_putDate(c)),j=ZCL_splitDateVal(ZCL_putDate(d)),k=ZCL_parseTime(g),l=ZCL_parseTime(h);ZCL_ESDATE=new Date(i[2],i[1]-1,i[0],k.HH,k.mm,0,0),ZCL_EEDATE=new Date(j[2],j[1]-1,j[0],l.HH,l.mm,0,0),zcal.EOBJ.rObj=new zcalRepeat,zcal.EOBJ.rObj.init(ZCL_ESDATE);var m=zcal.EOBJ.LOC,n="",o=ZCL_parseDateStr(c),p=ZCL_parseDateStr(d);n+=o.dateBy("NNN dd, yyyy"),b?n+=c!=d?" - "+p.dateBy("NNN dd, yyyy"):"":n+=c!=d?", "+g+" - "+p.dateBy("NNN dd, yyyy")+", "+h:", "+g+" - "+h;var q=$("#zcl_chTit")[0].value,r="";for(var s in $("#attDiv")[0].childNodes)$("#attDiv")[0].childNodes.length>3?$("#attDiv")[0].childNodes[s].id=="att"&&(r+=r==""?$("#attDiv")[0].childNodes[s].getAttribute("data-zid"):","+$("#attDiv")[0].childNodes[s].getAttribute("data-zid")):zmUtil.succErrMsg("e","Please Enter attendee");var t=zcal.EOBJ.EID,u="/cal/chatlet.do?mode=create&title="+q+"&att="+r+"&edate="+n+"&loc="+m;t!=""&&(t.indexOf("_")!=-1?u+="&eveId="+t.substring(0,t.indexOf("_")):u+="&eveId="+t),ZCL_XHR(u,function(a){var b=ZCL_Evl(1,a.responseText);b.status=="success"&&ZCL_closeChatlet()})},ZCL_autoCom=function(a){var b=$(a).find("#atInp");zmAppLoader.load("zmContactsAutoComplete").done(function(){zmContactsAutoComplete.autoComplete({input:b[0],contactType:"org",exclude:function(){var a=[];if($("#attDiv")[0]){var b=$("#attDiv")[0].childNodes;for(var c=0;c<b.length;c++){if(!b[c].getElementsByTagName("SPAN")[0])continue;a.push(b[c].getElementsByTagName("SPAN")[0].innerHTML)}}return a},excludeMe:!0,onSelect:function(c,d){var d=d.item.attributes,e=$(a).find("#attDiv"),f=document.createElement("div");f.className="SC_cs myInv dFill",f.setAttribute("data-zid",d.zid),f.setAttribute("id","att"),f.setAttribute("title",d.email),f.innerHTML='<div class="SC_avtr"><img src='+d.profileImage+"></div><span>"+d.email+'</span><i class="msi-close closePopup"></i></div>',e.prepend($(f)),$(b).val(""),$(f).find(".closePopup").on("click",function(){$(this).parent("#att").remove()})}})})},ZCL_closeChatlet=function(){zmsDialog.remove(!0);var a=$("#zcl_chatlet");a.length>0&&a.remove(),zmUtil.hideMenu()};var zcalRepeat=function(){var a=function(){this.frequency=-1,this.interval=1,this.option=0,this.date,this.month,this.day,this.week,this.until,this.count=0};return a.prototype={init:function(a){this.date=a&&a.getDate(),this.month=a&&a.getMonth(),this.day=a&&[a.getDay()],this.week=a&&Math.floor(this.date/7)},update:function(a){this.frequency=a&&a.RFRQ?a.RFRQ:this.frequency,this.interval=a&&a.RIVL?a.RIVL:this.interval,this.option=a&&a.ROPT?a.ROPT:this.option,this.date=a&&a.RDATE?a.RDATE:this.date,this.month=a&&a.RMON?a.RMON:this.month,this.week=a&&a.RTOWK?a.RTOWK:this.week,this.day=a&&a.RDAY?ZCL_rdaysInJSRep(a.RDAY):this.day,this.count=a&&a.RCNT>0?a.RCNT:this.count,this.until=a&&this.count==0&&a.RUTL!=0?a.RUTL:this.until},setFrequency:function(a){this.frequency=parseInt(a)},setInterval:function(a){this.interval=parseInt(a)},setOption:function(a){this.option=a},setDate:function(a){this.date=parseInt(a)},setMonth:function(a){this.month=parseInt(a)},setWeek:function(a){this.week=parseInt(a)},setDay:function(a){this.day=a},setCount:function(a){this.count=a},setUntil:function(a){this.until=a},getStr:function(){var a="",b=this.day.length;if(this.frequency==0)this.option==1?a+="Every weekday":a+=this.interval==1?"Daily":"Every "+this.interval+" days";else if(this.frequency==1){a+=this.interval==1?"Weekly":"Every "+this.interval+" weeks",a+=" on ";for(var c=0;c<this.day.length;c++){var d=parseInt(this.day[c]);a+=c!=0&&c!=b-1?", ":c!=0&&c==b-1?" & ":"",a+=Date.WEEK_DAYS[1][d]}}else this.frequency==2?(a+=this.interval==1?"Monthly":"Every "+this.interval+" months",this.option==1?a+=" on the "+zcal.WEEK_TYPE[this.week]+" "+Date.WEEK_DAYS[0][this.day[b-1]]:a+=" on day "+this.date):this.frequency==3&&(a+=this.interval==1?"Yearly":"Every "+this.interval+" years",this.option==1?a+=" on "+Date.MONTH_NAMES[0][this.month]+" "+zcal.WEEK_TYPE[this.week]+" "+Date.WEEK_DAYS[0][this.day[b-1]]:a+=" on "+Date.MONTH_NAMES[0][this.month]+" "+this.date);return this.count&&this.count!=0?a+=", "+this.count+" times":this.until&&this.ZCL_REPUTL!=0&&(a+=", until "+ZCL_putDate(this.until)),a!=""?" ("+a+")":""},getReqObj:function(){if(this.frequency!=-1){var a={RFRQ:this.frequency,RIVL:this.interval,ROPT:this.option,RCNT:this.count&&this.count!=0?this.count:"",RUTL:this.until&&this.until!=0?this.until:"",RST:ZCL_DFDate(ZCL_$("zcl_ce_sd").value)},b=rtowk=rdate="",c=[];if(this.frequency!=2&&this.frequency!=3||this.option!=1)if(this.frequency!=2&&this.frequency!=3||this.option!=0){if(this.frequency==1)for(var d=0;d<this.day.length;d++)c[d]=parseInt(this.day[d])+1}else b=this.month,rdate=this.date;else b=this.month,rtowk=this.week,c[0]=parseInt(this.day[0])+1;return a.RTOWK=rtowk,a.RMON=b,a.RDATE=rdate,a.RDAY=c,a}return null},reset:function(){this.frequency=-1,this.interval=1,this.option=0,this.date=null,this.month=null,this.day=null,this.week=null,this.until=null,this.count=0}},a}();ZCL_chgeRepOpt=function(a,b){ZCL_stopEvents(b),a.id=="zcl_rep_span"?ZCL_openRepeatPP():(ZCL_ChgChk(a),a.childNodes[0].className=="msi-check"?ZCL_openRepeatPP():zcal.$("zcl_rep_span")&&(zcal.$("zcl_rep_span").innerHTML=""))},ZCL_openRepeatPP=function(){var a;ZCL_$("zcl_ce_rsec")||$("body").append("<div id='zcl_ce_rsec' class='zcl_rpt'/>"),a=$("#zcl_ce_rsec");var b=_zm.getDOM(["UL",{child:[["LI",{attrs:{id:"zcl_rep_optpar"},child:[["text",zcal.i18n.repeats]]}],["LI",{child:[["UL",{attrs:{"class":"zcl_CMS"},child:[["LI",{attrs:{"class":"zcl_repsec",id:"zcl_repsec"}}]]}]]}]]}]);a.html(b),ZCL_constRepeatOpt();var c={title:zcal.i18n.repeat,style:{left:"500px",top:"100px"},drag:!1,mask:!0,ptr:"tright",closeaction:function(){ZCL_closeRepeat()},buttons:[{txt:zcal.i18n.done,callback:function(){ZCL_getRepeatData()}},{isCancel:!0,txt:zcal.i18n.cancel,callback:function(){ZCL_closeRepeat()}}]};zmsDialog.create("zcl_ce_rsec",c),ZCL_$("zcl_ce_rutl")&&ZEVENTS(ZCL_$("zcl_ce_rutl").parentNode).picker("date",{dform:zcal.DFORMAT[zcal.cdata.opt.DF],refer:"zcl_ce_rutl",wkst:0,mode:"popup",update:"yes",minhgt:251}).bind()},ZCL_constRepeatOpt=function(){var a=document.createElement("select");a.id="zcl_ce_rfreq",a.className="select",ZCL_putValues(a,zcal.EOBJ.rObj.frequency,zcal.REPEAT_FREQ),a.addEventListener("change",function(){var a=this.selectedIndex;ZCL_setRepeatCriteria(this.selectedIndex)});var b=document.createElement("div");b.className="SC_select",b.appendChild(a),$("#zcl_rep_optpar").append(b);var c=$("<ul><li id='zcl_rep_cri'></li><li></li><li></li><li id='zcl_rep_ends'></li></ul>");$(c.children()[1]).append($("<ul class='zcl_sp'><li></li></ul>")),$(c.children()[2]).append($("<ul class='zcl_adrept'><li>"+zcal.i18n.ends+"</li></ul>")),$("#zcl_repsec").append(c),zcal.EOBJ.rObj&&zcal.EOBJ.rObj.frequency!=-1&&ZCL_$("zcl_rep_span")&&(ZCL_$("zcl_rep_span").innerHTML=zcal.EOBJ.rObj.getStr()),ZCL_setRepeatCriteria(zcal.EOBJ.rObj.frequency!=-1?zcal.EOBJ.rObj.frequency:0),ZCL_setRepeatEnds()},ZCL_setRepeatEnds=function(){var a=zcal.EOBJ.rObj,b=ZCL_$("zcl_rep_ends"),c=a.count>0?a.count:0,d=a.until?ZCL_putDate(a.until):0,e=document.createElement("UL");e.className="zcl_adrept",e.addEventListener("click",function(){ZCL_ChgRdo(this),ZCL_addTbox(this)}),e.appendChild($('<li class="zcl_curpt"><i class="'+(c==0&&d==0?"msi-option":"msi-unoption")+'"></i>'+zcal.i18n.noenddate+"</li>")[0]),b.appendChild(e);var f=document.createElement("UL");f.className="zcl_adrept",f.addEventListener("click",function(){ZCL_ChgRdo(this),ZCL_addTbox(this,d!=0?d:null)}),f.appendChild($('<li class="zcl_curpt"><i class="'+(c==0&&d!=0?"msi-option":"msi-unoption")+'"></i>'+zcal.i18n.until+"</li>")[0]),f.appendChild($('<li class="zcl_select" '+(c==0&&d!=0?"":'style="display:none"')+'><input type="text" class="SC_tiput" id="zcl_ce_rutl" value="'+d+'"></li>')[0]),b.appendChild(f);var g=document.createElement("UL");g.className="zcl_adrept",g.addEventListener("click",function(){ZCL_ChgRdo(this),ZCL_addTbox(this)}),g.appendChild($('<li class="zcl_curpt"><i class="'+(c!=0?"msi-option":"msi-unoption")+'"></i>'+ZCL_replaceString(zcal.i18n.fortimes,['<input type="text" id="zcl_ce_rcnt" maxlength="3" value="'+(c!=0?c:"")+'" class="zcl_rpdy SC_tiput">'])+"</li>")[0]),b.appendChild(g)},ZCL_setRepeatCriteria=function(a){var b=zcal.EOBJ.rObj;a==0?ZCL_dailyRepeatOption(b):a==1?ZCL_weeklyRepeatOption(b):a==2?ZCL_monthlyRepOption(b):a==3&&ZCL_yearlyRepeatOption(b)},ZCL_getRepeatData=function(){var a=zcal.EOBJ.rObj,b=ZCL_$("zcl_ce_rfreq").value,c=ZCL_$("zcl_rep_cri");a.setFrequency(b);if(b==0){var d=c.children[0].children[0],e=c.children[1].children[0];if(d.children[0].className=="msi-option"){a.setOption(0);var f=d.children[1].value;if(isNaN(f)||f==""||f<=0)return zmUtil.succErrMsg("e",zcal.i18n.invalidrecurpattern),d.children[1].focus(),!1;a.setInterval(f)}else e.children[0].className=="msi-option"&&(a.setOption(1),a.setInterval(1))}else if(b==1){var d=c.children[0].children[0],f=d.children[0].value;if(isNaN(f)||f==""||f<=0)return zmUtil.succErrMsg("e",zcal.i18n.invalidrecurpattern),d.children[0].focus(),!1;a.setInterval(f);var g=c.children[1].children;a.day=[];for(var h=0;h<g.length;h++)g[h].children[0].className=="msi-check"&&a.day.push(h)}else if(b==2){var d=c.children[0].children[0],e=c.children[1].children[0];if(d.children[0].className=="msi-option"){a.setOption(0);var i=d.children[1].value;if(isNaN(i)||i==""||i<1||i>ZCL_ESDATE.getDaysInMonth())return zmUtil.succErrMsg("e",zcal.i18n.invalidrecurpattern),d.children[1].focus(),!1;a.setDate(i);var f=d.children[2].value;if(isNaN(f)||f==""||f<=0)return zmUtil.succErrMsg("e",zcal.i18n.invalidrecurpattern),d.children[2].focus(),!1;a.setInterval(f)}else if(e.children[0].className=="msi-option"){a.setOption(1),a.setWeek(e.children[1].children[0].value),a.setDay([e.children[2].children[0].value]);var f=e.children[3].value;if(isNaN(f)||f==""||f<=0)return zmUtil.succErrMsg("e",zcal.i18n.invalidrecurpattern),e.children[3].focus(),!1;a.setInterval(f)}}else if(b==3){var d=c.children[0].children[0],e=c.children[1].children[0];a.setInterval(1);if(d.children[0].className=="msi-option"){a.setOption(0);var j=d.children[1].children[0].value,k=d.children[2].value,l=ZCL_ESDATE.clone();l.setDate(1),l.setMonth(j);if(isNaN(k)||k==""||k<1||k>l.getDaysInMonth())return zmUtil.succErrMsg("e",zcal.i18n.invalidrecurpattern),d.children[2].focus(),!1;a.setMonth(j),a.setDate(k)}else e.children[0].className=="msi-option"&&(a.setOption(1),a.setWeek(e.children[1].children[0].value),a.setDay([e.children[2].children[0].value]),a.setMonth(e.children[3].children[0].value))}var m=ZCL_$("zcl_rep_ends");if(m.children[1].children[0].children[0].className=="msi-option"){if(!ZCL_dateValidate("zcl_ce_rutl",zcal.i18n.repun))return!1;if(!ZCL_dateComparison("zcl_ce_rutl",zcal.i18n.repun,"zcl_ce_ed",zcal.i18n.eveed,"GE"))return!1;a.setUntil(ZCL_DFDate(ZCL_$("zcl_ce_rutl").value)),a.setCount(0)}else if(m.children[2].children[0].children[0].className=="msi-option"){var n=ZCL_$("zcl_ce_rcnt").value.trim();if(n=="")return zmUtil.succErrMsg("e",zcal.i18n.repeatcount),ZCL_$("zcl_ce_rcnt").focus(),!1;if(!ZCL_intValidate("zcl_ce_rcnt",zcal.i18n.repcount))return!1;a.setCount(parseInt(n)),a.setUntil(0)}else a.setUntil(0),a.setCount(0);var o=ZCL_$("zcl_rep_span")||document.createElement("span");o.id="zcl_rep_span",o.className="zcl_lk",o.onclick=function(a){ZCL_chgeRepOpt(this,a)},o.innerHTML=a.getStr(),ZCL_$("zcl_rep").appendChild(o),ZCL_closeRepeat()},ZCL_closeRepeat=function(){var a=zcal.EOBJ.rObj;zmsDialog.remove(!0);var b=ZCL_$("zcl_ce_rsec");b&&b.parentNode.removeChild(b),a.frequency==-1&&(ZCL_$("zcl_rep").children[0].className="msi-uncheck")},ZCL_ChgRdo=function(a,b){var c=a.parentNode.childNodes;for(var d=0;d<c.length;d++)c[d].childNodes[0].childNodes[0].tagName=="I"&&(c[d].childNodes[0].childNodes[0].className="msi-unoption");a.childNodes[0].childNodes[0].className="msi-option",b&&b!=""&&ZCL_Evl(0,b)},ZCL_addTbox=function(a,b){var c=a.parentNode,d=c.children[1];d.children[0].children[0].className=="msi-unoption"?d.children[1].style.display="none":(d.children[1].style.display="",d.children[1].children[0].value=b?b:zcal.$("zcl_ce_ed").value)},ZCL_dailyRepeatOption=function(a){var b=$("#zcl_rep_cri"),c=$("<ul class='zcl_adrept'/>"),d=$("<ul class='zcl_adrept'/>");b.empty(),c.on("click",function(){ZCL_ChgRdo(this)}),c.append('<li class="zcl_curpt"><i class="'+(a.option==0?"msi-option":"msi-unoption")+'"></i>'+ZCL_replaceString(zcal.i18n.ce_daily0,['<input type="text" id="zcl_rivl0" value="'+a.interval+'" class="zcl_rpdy SC_tiput">'])+"</li>"),b.append(c),d.on("click",function(){ZCL_ChgRdo(this)}),d.append($('<li class="zcl_curpt"><i class="'+(a.option==1?"msi-option":"msi-unoption")+'"></i>'+zcal.i18n.ce_daily1+"</li>")),b.append(d)},ZCL_weeklyRepeatOption=function(a){var b=$("#zcl_rep_cri"),c=$("<ul class='zcl_adrept'/>"),d=$("<ul class='zcl_adrept zcl_adreptwk'/>");b.empty(),c.append($('<li class="zcl_curpt">'+ZCL_replaceString(zcal.i18n.ce_weekly0,['<input type="text" id="zcl_rivl0" value="'+a.interval+'" class="zcl_rpdy SC_tiput">'])+"</li>")),b.append(c);for(var e in Date.WEEK_DAYS[1]){var f=$('<li class="zcl_curpt"/>');f.html('<i class="'+(a.day.indexOf(parseInt(e))!=-1?"msi-check":"msi-uncheck")+'"></i>'+Date.WEEK_DAYS[1][e]),f.on("click",function(){ZCL_ChgChk(this)}),d.append(f)}b.append(d)},ZCL_monthlyRepOption=function(a){var b=$("#zcl_rep_cri"),c=$("<ul class='zcl_adrept'/>");_ele2=$("<ul class='zcl_adrept'/>"),l=a.day.length,b.empty(),c.on("click",function(){ZCL_ChgRdo(this)}),c.append($('<li class="zcl_curpt"><i class="'+(a.option==0?"msi-option":"msi-unoption")+'"></i>'+ZCL_replaceString(zcal.i18n.ce_monthly0,['<input type="text" id="zcl_rmd" value="'+a.date+'" class="zcl_rpdy SC_tiput">','<input type="text" id="zcl_rivl0" value="'+a.interval+'" class="zcl_rpdy SC_tiput">'])+"</li>")),b.append(c),_ele2.on("click",function(){ZCL_ChgRdo(this)}),_ele2.append($('<li class="zcl_curpt"><i class="'+(a.option==1?"msi-option":"msi-unoption")+'"></i>'+ZCL_replaceString(zcal.i18n.ce_monthly1,[ZCL_selBox("zcl_reps0",a.week,zcal.WEEK_TYPE,"wktype","zcl_stime"),ZCL_selBox("zcl_reps1",a.day[l-1],Date.WEEK_DAYS[0],"weekdays","zcl_sday"),'<input type="text" id="zcl_rivl0" value="'+a.interval+'" class="zcl_rpdy SC_tiput">'])+"</li>")),b.append(_ele2)},ZCL_yearlyRepeatOption=function(a){var b=$("#zcl_rep_cri"),c=$("<ul class='zcl_adrept'/>");_ele2=$("<ul class='zcl_adrept'/>"),l=a.day.length,b.empty(),c.on("click",function(){ZCL_ChgRdo(this)}),c.append($('<li class="zcl_curpt"><i class="'+(a.option==0?"msi-option":"msi-unoption")+'"></i>'+ZCL_replaceString(zcal.i18n.ce_yearly0,[ZCL_selBox("zcl_mons0",a.month,Date.MONTH_NAMES[0],"months","zcl_sdate"),'<input type="text" id="zcl_rivl0" value="'+a.date+'" class="zcl_rpdy SC_tiput">'])+"</li>")),b.append(c),_ele2.on("click",function(){ZCL_ChgRdo(this)}),_ele2.append($('<li class="zcl_curpt"><i class="'+(a.option==1?"msi-option":"msi-unoption")+'"></i>'+ZCL_replaceString(zcal.i18n.ce_yearly1,[ZCL_selBox("zcl_reps0",a.week,zcal.WEEK_TYPE,"wktype","zcl_stime"),ZCL_selBox("zcl_reps1",a.day[l-1],Date.WEEK_DAYS[0],"weekdays","zcl_sday"),ZCL_selBox("zcl_mons0",a.month,Date.MONTH_NAMES[0],"months","zcl_sdate")])+"</li>")),b.append(_ele2)},ZCL_showConfirm=function(a,b){var c=document.createElement("div");c.id="zcl_redit_confirm",c.className="zcl_rpt",c.innerHTML=a=="delete"?zcal.i18n.rdelete_msg:zcal.i18n.redit_msg,document.body.appendChild(c);var d={title:a=="delete"?zcal.i18n.confirm_delete:zcal.i18n.confirm_edit,style:{left:"500px",top:"100px"},drag:!1,mask:!0,ptr:"tright",closeaction:function(){ZCL_closeREditConfirm()},buttons:[{txt:zcal.i18n.only,callback:function(){a=="delete"?ZCL_delRep(0,b):a=="qedit"?zcalEDrag.editRep(0,b):(ZCL_retEntry(0),ZCL_closeREditConfirm())}},{txt:zcal.i18n.redit0,callback:function(){a=="delete"?ZCL_delRep(1,b):a=="qedit"?zcalEDrag.editRep(1,b):(ZCL_retEntry(1),ZCL_closeREditConfirm())}},{txt:zcal.i18n.redit1,callback:function(){a=="delete"?ZCL_delRep(2,b):a=="qedit"?zcalEDrag.editRep(2,b):(ZCL_retEntry(2),ZCL_closeREditConfirm())}},{txt:zcal.i18n.cancel,callback:function(){ZCL_closeREditConfirm()}}]};zmsDialog.create("zcl_redit_confirm",d)},ZCL_closeREditConfirm=function(){zmsDialog.remove(!0);var a=ZCL_$("zcl_redit_confirm");a&&a.parentNode.removeChild(a),ZCL_clrStck(),zcalView.plotEvents()};var zcalAlarm=function(){function c(){this.actionType="0",this.reminderType="0",this.reminderTime=a[0]}"use strict";var a=["300000","600000","900000","1200000","1500000","1800000","2700000","3600000","7200000","14400000","21600000","28800000","43200000","86400000","172800000","259200000","345600000","432000000","518400000","604800000","691200000","777600000","864000000","950400000","1036800000","1123200000","1209600000","1296000000","2592000000","3888000000","5184000000","7776000000"],b=function(a,b,c){var d="";for(var e in c)d+='<option value="'+e+'" '+(e==b?"selected='true'":"")+">"+c[e]+"</option>";a.innerHTML=d};return c.prototype.set=function(a){this.actionType=a&&a.ACTYPE,this.reminderType=a&&a.REMTYPE,this.reminderTime=a&&a.REMTIME},c.prototype.getDOM=function(a){var c=this,d=$('<ul><li><div class="SC_select"><select class="select"></select></div></li><li><div class="SC_select"><select class="select"></select></div></li><li><div class="SC_select"><select class="select"></select></div></li><li><i class="msi-close" title='+zcal.i18n.remove+"></i></li></ul>")[0],e,f,g,h;g=d.children[0].children[0].children[0],b(g,c.reminderTime,zcal.REMSTR),f=d.children[1].children[0].children[0],b(f,c.reminderType,zcal.ALARM_REMTYPE),e=d.children[2].children[0].children[0],b(e,c.actionType,zcal.ALARM_ACTTYPE),h=d.children[3],h.addEventListener("click",function(){var a=this.parentNode.parentNode,b;a.removeChild(this.parentNode),b=a.querySelector("#zcl_addrem"),b||ZCL_AppendRemAddLnk(a)});if(a==="dom")return d;if(a==="string")return d.outerHTML},c}();ZCL_getObj=function(a,b){var c,d,e;b||(b=document),a!=undefined&&(c=a.indexOf("?"))>0&&parent.frames.length&&(b=parent.frames[a.substring(c+1)].document,a=a.substring(0,c)),!(e=b[a])&&b.all&&(e=b.all[a]);for(d=0;!e&&d<b.forms.length;d++)e=b.forms[d][a];for(d=0;!e&&b.layers&&d<b.layers.length;d++)e=ZCL_getObj(a,b.layers[d].document);return!e&&b.getElementById&&(e=b.getElementById(a)),e};var ZCL_ESDATE=new Date,ZCL_EEDATE=new Date;ZCL_calcEed=function(a,b){var c=ZCL_$("zcl_ce_sd").value.trim();if(c!=""){b&&ZCL_CRTim(a);var d=ZCL_parseTime(ZCL_$("zcl_ce_st").value),e=ZCL_splitDateVal(c),f=new Date(e[2],e[1]-1,e[0],d.HH,d.mm,0,0),g=f.getTime()-ZCL_ESDATE.getTime();ZCL_EEDATE.setTime(ZCL_EEDATE.getTime()+g),ZCL_$("zcl_ce_ed").value=ZCL_EEDATE.dateBy(zcal.DFORMAT[zcal.cdata.opt.DF]),ZCL_$("zcl_ce_et").value=ZCL_EEDATE.dateBy(zcal.timeformat[zcal.cdata.opt.TF]),ZCL_ESDATE=f.clone(),zcal.EOBJ.rObj&&!zcal.EOBJ.EID&&(zcal.EOBJ.rObj.init(ZCL_ESDATE),ZCL_$("zcl_rep_span").innerHTML=zcal.EOBJ.rObj.getStr())}},ZCL_setEed=function(a,b){var c=ZCL_$("zcl_ce_ed").value.trim();if(c!=""){b&&ZCL_CRTim(a);var d=ZCL_splitDateVal(c),e=ZCL_parseTime(ZCL_$("zcl_ce_et").value);ZCL_EEDATE=new Date(d[2],d[1]-1,d[0],e.HH,e.mm,0,0),ZCL_ESDATE>=ZCL_EEDATE&&(ZCL_ESDATE.getTime()-ZCL_EEDATE.getTime()>=zcal.MSPERHOUR?ZCL_EEDATE.setDate(ZCL_ESDATE.getDate()):ZCL_EEDATE.setDate(ZCL_ESDATE.getDate()+1),zcal.$("zcl_ce_ed").value=ZCL_EEDATE.dateBy(zcal.DFORMAT[zcal.cdata.opt.DF]))}},ZCL_isEmail=function(a){a=a.trim();var b=/^[\w]([\w\-\.\+\'\/]*)@([\w\-\.]*)(\.[a-zA-Z]{2,22}(\.[a-zA-Z]{2}){0,2})$/i;return b.test(a)},ZCL_crmFormValidate=function(){if(ZCL_$("zcl_ce_tit").value.trim()=="")return _zm.succErrMsg("e",zcal.i18n.plenttle),ZCL_$("zcl_ce_tit").focus(),!1;if(!ZCL_dateValidate("zcl_ce_sd",zcal.i18n.evest)||!ZCL_dateValidate("zcl_ce_ed",zcal.i18n.eveed))return!1;if(!ZCL_dateTimeComparison("zcl_ce_ed","zcl_ce_et",zcal.i18n.eveed,"zcl_ce_sd","zcl_ce_st",zcal.i18n.evest,"G"))return!1;var a=ZCL_$("zcl_crmfldname").value.split(";"),b=ZCL_$("zcl_crmfldtype").value.split(";"),c=ZCL_$("zcl_crmfldlabel").value.split(";");for(var d=0;d<a.length;d++){var e=b[d].split("~"),f="zcl_"+a[d];if(e[1]=="M"&&ZCL_$(f)!=null&&!ZCL_emptyCheck(f,c[d]))return!1;switch(e[0]){case"O":break;case"V":break;case"C":break;case"E":if(ZCL_getObj(f)!=null&&ZCL_getObj(f).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length!=0&&!ZCL_emailValidate(f,c[d]))return!1;break;case"DT":if(ZCL_getObj(f)!=null&&ZCL_getObj(f).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length!=0){var g=typeof e[3]=="undefined"?"OTH":e[3];if(!ZCL_dateTimeValidate(f,e[2],c[d],g))return!1}break;case"D":if(ZCL_getObj(f)!=null&&ZCL_getObj(f).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length!=0){var g=typeof e[2]=="undefined"?"OTH":e[2];if(!ZCL_crmDateValidate(f,c[d],g))return!1}break;case"I":if(ZCL_getObj(f)!=null&&ZCL_getObj(f).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length!=0&&!ZCL_crmIntValidate(f,c[d]))return!1;break;case"DE":if(ZCL_getObj(f)!=null&&ZCL_getObj(f).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length!=0){var h=typeof e[2]=="undefined"?"any":e[2];if(!ZCL_decimalValidate(f,c[d],h))return!1}break;case"N":if(ZCL_getObj(f)!=null&&ZCL_getObj(f).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length!=0){var h=typeof e[2]=="undefined"?"any":e[2];if(!ZCL_numValidate(f,c[d],h))return!1}break;case"P":if(ZCL_getObj(f)!=null&&ZCL_getObj(f).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length!=0&&!ZCL_phoneValidate(f,c[d]))return!1;break;case"W":if(ZCL_getObj(f)!=null&&ZCL_getObj(f).value.replace(/^\s+/g,"").replace(/\s+$/g,"").length!=0&&!ZCL_isValidWebURL(f,c[d]))return!1}}return!0},ZCL_emptyCheck=function(a,b,c){var d=ZCL_getObj(a);if(d!=null&&d.value.replace(/^\s+/g,"").replace(/\s+$/g,"").length==0&&!d.disabled){_zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_emptychk,[b]));try{d.focus()}catch(e){}return!1}return!0},ZCL_isValidWebURL=function(a,b){var c=ZCL_getObj(a),d="http",e="https",f=c.value,g=new RegExp("^("+d+":\\/\\/www.|"+e+":\\/\\/www.|ftp:\\/\\/www.|www.|"+d+":\\/\\/|"+e+":\\/\\/|ftp:\\/\\/|){1}[a-zA-Z0-9--]+(\\.[a-zA-Z0-9-\\_\\#\\:\\;\\?]+)+(/[\\w-\\;\\-\\*\\._\\?\\,\\:\\'/\\\\\\+&amp;%\\$#\\=~@-]*)*$");return g.test(f)?!0:(_zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_datachk,[b])),c.focus(),!1)},ZCL_phoneValidate=function(a,b){var c=ZCL_getObj(a),d=/^[0-9a-zA-Z!#%\*\^\(\)=\{\}\[\]\?`~_\-\.\$@\?\,\:\'\/\!\P{InBasicLatin}\s\+\|\\]+$/;return d.test(c.value.trim())?!0:(_zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_datachk,[b])),c.focus(),!1)},ZCL_crmDateValidate=function(a,b,c){var d=ZCL_getObj(a);if(ZCL_patternValidate(a,b,"DATE")==0)return!1;dateval=ZCL_getObj(a).value.replace(/^\s+/g,"").replace(/\s+$/g,"");var e=ZCL_splitDateVal(dateval);dd=e[0],mm=e[1],yyyy=e[2];if(dd<1||dd>31||mm<1||mm>12||yyyy<1||yyyy<1e3)return _zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_datachk,[b])),ZCL_getObj(a).focus(),!1;if(mm==2&&dd>29)return _zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_datachk,[b])),ZCL_getObj(a).focus(),!1;if(mm==2&&dd>28&&!isLeapYear(yyyy))return _zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_datachk,[b])),ZCL_getObj(a).focus(),!1;switch(parseInt(mm,10)){case 2:case 4:case 6:case 9:case 11:if(dd>30)return _zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_datachk,[b])),ZCL_getObj(a).focus(),!1}return!0},ZCL_emailValidate=function(a,b){return ZCL_patternValidate(a,b,"EMAIL")==0?!1:!0},ZCL_numValidate=function(a,b,c){var d=ZCL_getObj(a),e=ZCL_getObj(a).value.replace(/^\s+/g,"").replace(/\s+$/g,"");if(d!=null&&d.value.replace(/^\s+/g,"").replace(/\s+$/g,"").length!=0){var f=/^-?\d+((\d)+)*(\.\d{1,2})?$/;if(c!="any"&&parseInt(c)!=0){var c=c.split(","),g="^-?\\d+((\\d)+)*(\\.\\d{1,"+c[0]+"})?$";f=new RegExp(g)}return f.test(e)?(d.value=e,!0):(_zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_datachk,[b])),d.focus(),!1)}return!0},ZCL_decimalValidate=function(a,b,c){var d=ZCL_getObj(a);if(d!=null&&d.value.replace(/^\s+/g,"").replace(/\s+$/g,"").length!=0){var e=d.value.replace(/^\s+/g,"").replace(/\s+$/g,""),f=/^-?\d+(\.\d\d*)*$/;if(c!="any"&&parseInt(c)!=0){var g="^-?\\d+((\\d)+)*(\\.\\d{1,"+c+"})?$";f=new RegExp(g)}return f.test(e)?!0:(_zm.succErrMsg("e",ZCL_replaceString(zcal.i18n.validation_datachk,[b])),d.focus(),!1)}return!0},ZCL_clearId=function(a){var b=ZCL_$(a);b.value=""};var zcalFreebusy=function(){var a,b,c,d=!1,e,f,g,h,i=0,j=23,k,l,m=1,n={},o=[],p={},q=[],r=[],s,t={},u=null,v=0,w=0,x=0,y=1,z=onedayAllTimeWidth=0,A=600,B=function(){isFreeBusyClicked=!0,I(),W();for(var a=0;a<q.length;a++){var b=q[a];p[b]||(p[b]=!1,X(b),ba({email:b,date:l.getDate(),month:l.getMonth()+1,year:l.getFullYear()}))}},C=function(a){var b=ZCL_Evl(1,a.responseText);for(var c in b){var d=b[c];p[c]=!0;if(typeof d=="object")for(var e in d)$.publish("/calendar/fillfb",{date:e,fbdata:d[e]}),D({email:c,date:e,fbdata:d[e]})}},D=function(a){var b=a.email,c=a.date,d=a.fbdata,e=n[c][b]||new bc;e.setFBSlot({fbslot:d}),n[c][b]=e;var f=q.indexOf(b);if(ZCL_$("zcl_fb"+c)&&f!=-1){var g=ZCL_$("zcl_fb"+c);g.replaceChild(e.$el[0],g.childNodes[f])}},E=function(){var a=new Date;a.setTime(l.getTime());var b=a.clone();b.setDate(1),b.setHours(0,0,0,0);var c=a.clone();return c.setMonth(c.getMonth()+2),c.setDate(c.getDaysInMonth()),c.setHours(0,0,0,0),[b,c]},F=function(){var a=o[0].clone();while(a<=o[1]){var b=a.dateBy("yyyyMMdd");t[b]=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],a.setDate(a.getDate()+1)}},G=function(a){var b=a.date,c=a.fbdata;if(c[0])t[b]=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];else if(c[1])for(var d=0;d<c[1].length;d++){var e=c[1][d].split("-");for(var f=e[0];f<e[1];f++)t[b][f]=1}},H=function(a){var b=q.indexOf(a);if(b!=-1){q.splice(b,1);for(var c in n)n[c][a]&&delete n[c][a],ZCL_$("zcl_fb"+c)&&ZCL_$("zcl_fb"+c).removeChild(ZCL_$("zcl_fb"+c).childNodes[b])}},I=function(){s=zcal.cdata.opt.MID;var a=ZCL_getAttendee();a!==""&&(q=a.split(",")),ZCL_in_array(zcal.cdata.opt.MID,q)||q.splice(0,0,zcal.cdata.opt.MID),r=q.slice();var n=ZCL_splitDateVal(ZCL_$("zcl_ce_sd").value);d=ZCL_$("zcl_ce_aday").className=="msi-check"?!0:!1;var p=new Date;p.setYear(n[2]),p.setMonth(n[1]-1),p.setDate(n[0]),p.setHours(0,0,0,0);if(!d){var t=ZCL_parseTime(ZCL_$("zcl_ce_st").value);p.setHours(t.HH,t.mm,0,0)}b=p.clone(),e=b.dateBy("HHmm");var u=ZCL_splitDateVal(ZCL_$("zcl_ce_ed").value),x=new Date;x.setYear(u[2]),x.setMonth(u[1]-1),x.setDate(u[0]),x.setHours(0,0,0,0);if(!d){var A=ZCL_parseTime(ZCL_$("zcl_ce_et").value);x.setHours(A.HH,A.mm,0,0)}c=x.clone(),f=c.dateBy("HHmm"),y=Math.ceil((c-b)/18e5),y+=d?48:0,k=new Date,k.setTime(zcal.cdate),l=p.clone(),o=E(),bb(),F(),g=l.clone(),g.setDate(g.getDate()-4),g.setHours(0,0,0,0),g<o[0]&&(g=o[0].clone()),h=l.clone(),h.setDate(h.getDate()+6),h.setHours(0,0,0,0),h>o[1]&&(h=o[1].clone()),i=parseInt(zcal.cdata.opt.HS),j=parseInt(zcal.cdata.opt.HE);var B=b.getHours(),C=c.getHours();if(B<i||B>j||C<i||C>j+1)m=0;onedayAllTimeWidth=1450,z=(j-i+1)*60+10;var D=ZCL_daysBetween(g.dateBy("yyyyMMdd"),b.dateBy("yyyyMMdd"));v=b.getHours(),m==0?w=-(D*onedayAllTimeWidth+v*60):w=-(D*z+(v-i)*60)},J=function(a,b){var c=b.data.eid;try{zmAutoFill.removeContact(b.elm)}catch(d){}a&&(a[0].value="",a[0].style.width="100%"),c!=""&&q.indexOf(c)==-1&&(q.push(c),p[c]=!1,X(c),ba({email:c,date:l.getDate(),month:l.getMonth()+1,year:l.getFullYear()}))},K=function(){var a=$("<li class='zcl_table'></li>"),b=$("<ul class='zcl_fbnv'></ul>"),c=$("<li></li>"),d=y>=48?"zcl_lk zcl_dis":"zcl_lk";c.html('<span class="'+d+'">'+zcal.i18n.find_next_freetime+"</span>"),y<48&&c.bind("click",function(){M()}),b.append(c);var e=document.createElement("select");e.className="select",ZCL_putValues(e,m,{0:zcal.i18n.alltimes,1:zcal.i18n.workinghours}),e.addEventListener("change",function(){m=e.selectedIndex;var a=Math.abs(w);if(m==0){var b=a%z,c=(a-b)/z;$(".zcl_fbhdn").removeClass("zcl_fbhdn").addClass("zcl_tmp"),w=-(c*onedayAllTimeWidth+v*60)}else{var b=a%onedayAllTimeWidth,c=(a-b)/onedayAllTimeWidth,d=v>=i&&v<=j?v-i:0;$(".zcl_tmp").removeClass("zcl_tmp").addClass("zcl_fbhdn"),w=-(c*z+d*60)}ZCL_$("zcl_fbdtgrid").style.left=w+"px",ZCL_$("zcl_fbgrid").style.left=w+"px",N()});var f=document.createElement("div");f.className="SC_select",f.appendChild(e);var g=$("<li></li>").append(f);return b.append(g),a.append(b),a},L=function(){var a=$("<li class='zcl_table'></li>"),b=$("<ul class='zcl_fbtime'></ul>"),c=$("<li></li>");c.append($("<span>"+zcal.i18n.attendee+"</span>"));var d=$("<u/>");d.html("<i class='msi-add'></i>"),d.bind("click",function(a){var b=$("<input type='text' id='zcl_fbadd'/>"),c={contentArray:"",compare:["fn","ln","nn","eid"],LType:"1",OType:"1",drag:!1,actionCallback:zcalFreebusy.getSelectedEmail};zmAutoFill.setAutofill(c,b),$par=$(this).parent(),$par.empty(),$par.append($("<div/>").append(b)),b.focus()}),c.append(d),b.append(c);var e=$("<li></li>"),f=$("<u id='zcl_fblftnv'></u>"),i=$("<u id='zcl_fbrgtnv'></u>");f.html("<i class='msi-larrow'></i>"),f.bind("click",function(){R(this)}),i.html("<i class='msi-rarrow'></i>"),i.bind("click",function(){Q(this)}),e.append(f),e.append(i);var j=$("<div id='zcl_fbdtgrid'/>"),k=o[0].clone();while(k<=o[1]){if(k>=g&&k<=h){var l=U(k);j.append(l)}n[k.dateBy("yyyyMMdd")]={},k.setDate(k.getDate()+1)}return e.append(j),b.append(e),a.append(b),a},M=function(){var a="",d=!1,e,f;for(var g=0;g<y;g++)a+="0";var h=c.clone(),k=m===1?(c.getHours()-i)*2:c.getHours()*2;k+=c.getMinutes()>0?1:0;while(h<=o[1]){T(1);var l=h.dateBy("yyyyMMdd");if(t[l]){var n=m===0?t[l]:t[l].slice(i*2,(j+1)*2),p=n.join(""),q=l===c.dateBy("yyyyMMdd")?k:0,r=p.indexOf(a,q);if(r!=-1){e=h.clone(),e.setHours(0,0,0,0),m===1&&(r=i*2+r),f=r,d=!0;break}}h.setDate(h.getDate()+1)}if(d){b=e.clone();var s=(f-f%2)/2,u=f%2?30:0;b.setHours(s,u,0,0),c.setTime(b.getTime()+y*30*60*1e3),v=b.getHours(),N()}},N=function(){var a=Math.ceil((c-b)/18e5)+(d?48:0);if(a<48){var e=ZCL_daysBetween(g.dateBy("yyyyMMdd"),b.dateBy("yyyyMMdd")),f=e*(m===0?onedayAllTimeWidth:z),h=m===0?v:v>=i&&v<=j?v-i:0;f+=h*60+(b.getMinutes()>0?30:0);var k=ZCL_$("zcl_fbsslot")||document.createElement("SPAN"),l=Math.abs(w);k.id="zcl_fbsslot",k.style.left=f+"px",k.style.width=a*30+"px",ZCL_$("zcl_fbgrid").appendChild(k);if(l!=0&&f-l>=600){var n=f-l-(f-l)%20;O(n,ZCL_$("zcl_fbrgtnv"))}}},O=function(a,b){u&&window.clearTimeout(u),a>0&&(w>-x?(w-=20,ZCL_$("zcl_fbdtgrid").style.left=w+"px",ZCL_$("zcl_fbgrid").style.left=w+"px",a-=20,u=setTimeout(function(){zcalFreebusy.scrollRight(a,b)},1),b.className=""):(w=-x,ZCL_$("zcl_fbdtgrid").style.left=w+"px",ZCL_$("zcl_fbgrid").style.left=w+"px",b.className="zcl_dis"),a==0&&(ZCL_$("zcl_fblftnv").className="",S("right")))},P=function(a,b){u&&window.clearTimeout(u),a>0&&(w<0?(w+=20,ZCL_$("zcl_fbdtgrid").style.left=w+"px",ZCL_$("zcl_fbgrid").style.left=w+"px",a-=20,u=setTimeout(function(){zcalFreebusy.scrollLeft(a,b)},1),b.className=""):(w=0,ZCL_$("zcl_fbdtgrid").style.left=w+"px",ZCL_$("zcl_fbgrid").style.left=w+"px",b.className="zcl_dis"),a==0&&(ZCL_$("zcl_fbrgtnv").className="",S("left")))},Q=function(a){O(A,a)},R=function(a){P(A,a)},S=function(a){var b=Math.abs(w),c=1;if(m==0){var d=b%onedayAllTimeWidth,e=(b-d)/onedayAllTimeWidth,f=(d-d%60)/60;f=d%60>0?f+1:0,v=f}else{c=A<z?1:Math.round(A/z);var d=b%z,e=(b-d)/z,f=(d-d%60)/60;f=f+i+(d%60>0?1:0),f=f>=i&&f<=j?f:0,v=f}a==="right"&&T(c)},T=function(a){var b=h.clone(),c=0,d=$("#zcl_fbdtgrid");while(c<a){b.setDate(b.getDate()+1);var e=b.dateBy("yyyyMMdd");if(!ZCL_$("zcl_fb"+e)&&b<=o[1]){var f=U(b);d.append(f);for(var g=0;g<q.length;g++){var i=q[g],j=n[e][i]||new bc,k=ZCL_$("zcl_fb"+e)||document.createElement("DIV");k.id="zcl_fb"+e,k.appendChild(j.$el[0]),ZCL_$("zcl_fbgrid").appendChild(k),n[e][i]=j}h=b.clone()}c++}Y()},U=function(a){var b=$("<div/>");b.append("<s>"+a.dateBy("MMM dd, yyyy")+"</s>");var c=$("<ul/>");for(var d=0;d<24;d++){var e=d<i||d>j?"class='"+(m==0?"zcl_tmp":"zcl_fbhdn")+"'":"";c.append("<li "+e+">"+zcal.TT[d]+"</li>")}return b.append(c),b},V=function(){return $('<li class="zcl_fbhgt"><div class="zcl_table"><ul class="zcl_fbgrid"><li><div id="zcl_fbatt" class="zcl_table"></div></li><li><div id="zcl_fbgrid"></div></li></ul></div></li>')},W=function(){ZCL_$("zcl_freebusy")||$("body").append("<ul id='zcl_freebusy' class='zcl_fb'/>"),a=$("#zcl_freebusy"),a.html("");var b=K();a.append(b);var c=L();a.append(c);var d=V();a.append(d);var e={title:zcal.i18n.freebusytime,style:{left:"500px",top:"100px","max-width":"900px"},drag:!1,mask:!0,ptr:"tright",closeaction:function(){zcalFreebusy.cleanUp()},buttons:[{txt:zcal.i18n.ok,callback:function(){zcalFreebusy.getSelAttendee()}},{txt:zcal.i18n.cancel,callback:function(){zcalFreebusy.cleanUp()}}]};zmsDialog.create("zcl_freebusy",e)},X=function(a){var b=document.createElement("UL");b.appendChild($("<li>"+a+"</li>")[0]);if(a!==s){var c=$("<li><i class='msi-delete'></i></li>");c.bind("click",function(){this.parentNode.parentNode.removeChild(this.parentNode),zcalFreebusy.removeAttedee(a)}),b.appendChild(c[0])}else b.appendChild($("<li/>")[0]);ZCL_$("zcl_fbatt").appendChild(b);var d=g.clone();while(d<=h){var e=d.dateBy("yyyyMMdd"),f=n[e][a]||new bc,i=ZCL_$("zcl_fb"+e)||document.createElement("DIV");i.id="zcl_fb"+e,i.appendChild(f.$el[0]),ZCL_$("zcl_fbgrid").appendChild(i),n[d.dateBy("yyyyMMdd")][a]=f,d.setDate(d.getDate()+1)}ZCL_$("zcl_fbdtgrid").style.left=w+"px",ZCL_$("zcl_fbgrid").style.left=w+"px",N(),Y()},Y=function(){var a=ZCL_daysBetween(g.dateBy("yyyyMMdd"),h.dateBy("yyyyMMdd"))+1;m==0?x=a*onedayAllTimeWidth-ZCL_$("zcl_fbgrid").offsetWidth:x=a*z-ZCL_$("zcl_fbgrid").offsetWidth},Z=function(){isFreeBusyClicked=!1,zmsDialog.remove(!0),n={},p={},q=[],t={},o=[],$.unsubscribe("/calendar/fillfb"),a&&a.remove(),a=null},_=function(){ZCL_$("zcl_ce_sd").value=ZCL_putDate(b.dateBy("yyyyMMdd")),ZCL_$("zcl_ce_ed").value=ZCL_putDate(c.dateBy("yyyyMMdd"));if(!d){var a=zcal.timeformat[zcal.cdata.opt.TF];ZCL_$("zcl_ce_st").value=b.dateBy("HHmm").getTimeBy(a),ZCL_$("zcl_ce_et").value=c.dateBy("HHmm").getTimeBy(a)}for(var e=0;e<q.length;e++)ZCL_in_array(q[e],r)||zmAutoFill.contactFill(q[e],$("#zcl_ce_att .zm_sgst"));Z()},ba=function(a){var b="/cal/userFB.do?uemail="+a.email+"&date="+a.date+"&month="+a.month+"&year="+a.year;ZCL_XHR(b,"zcalFreebusy.getFBRes")},bb=function(){$.subscribe("/calendar/fillfb",function(a,b){G(b)})},bc=function(a){this.fbslot=[],this.$el=$("<ul/>"),this.setFBSlot(a)};bc.prototype={setFBSlot:function(a){this.$el.empty();var b=a&&a.fbslot?a.fbslot:[];if(b.length>0){if(b[0])for(var c=0;c<24;c++){this.fbslot.push([1,1]);var d=c<i||c>j?"class='"+(m==0?"zcl_tmp":"zcl_fbhdn")+"'":"";this.$el.append($("<li "+d+"><b></b><b></b></li>"))}else if(b[1]){for(var c=0;c<b[1].length;c++){var e=b[1][c].split("-");for(var f=e[0];f<e[1];f++){var g=(f-f%2)/2,h=f%2!=0?1:0;this.fbslot[g][h]=1}}for(var c=0;c<24;c++){var d=c<i||c>j?"class='"+(m==0?"zcl_tmp":"zcl_fbhdn")+"'":"",k="";for(var f=0;f<this.fbslot[c].length;f++)k+=this.fbslot[c][f]==1?"<b></b>":"<u></u>";this.$el.append($("<li "+d+">"+k+"</li>"))}}}else for(var c=0;c<24;c++){this.fbslot.push([0,0]);var d=c<i||c>j?"class='"+(m==0?"zcl_tmp":"zcl_fbhdn")+"'":"";this.$el.append($("<li "+d+"><u></u><u></u></li>"))}}};var bd={loadFB:B,getFBRes:C,cleanUp:Z,getSelAttendee:_,scrollRight:O,scrollLeft:P,removeAttedee:H,getSelectedEmail:J};return bd}(),zcalGroup=function(){var a={},b=[],c=[],d="personal",e=[],f=[],g,h=[],j=function(){var a=[{type:"personal",icon:"msi-group"},{type:"org",icon:"msi-Ogrp"}],b=$("<div/>");for(var c=0;c<a.length;c++){var e=a[c],f=document.createElement("i");f.className=e.icon+(e.type===d?" zcl_sl":""),k(f,e.type),b.append(f)}return b},k=function(a,b){var c=$(a);c.off("click").click(function(){d=b,c.parent().find("i").removeClass("zcl_sl"),c.addClass("zcl_sl"),m()})},l=function(){var a=$("<div class='zcl_table'/>"),b=["UL",{child:[["LI",{attrs:{"class":"zcl_adgrpls"},child:[["DIV",{child:[["DIV",{attrs:{id:"zcl_glist","class":"zcl_table"}}]]}]]}],["LI",{attrs:{"class":"zcl_adgrpils",id:"zcl_gmemlist"}}]]}],c=_zm.getDOM(b);return a.append(c),a},m=function(){var e=d==="org"?c:b;$("#zcl_glist").empty();for(var f in e)if(a[e[f]]){var g=a[e[f]],h=$("<ul>"),i=$("<li><span><img src='"+g.photo+"'/></span><span>"+ZCL_getHTML(g.name)+"</span></li>");i.on("click",{group:g,encrytid:e[f]},function(a){n(a.data.group,a.data.encrytid)}),h.append(i);var j=$("<li><i class='msi-addgroup'></i></li>");j.on("click",{gid:e[f]},function(a){q(a.data.gid)}),h.append(j),$("#zcl_glist").append(h)}},n=function(a,b){if(e.indexOf(b)==-1){var c={attr:{"data-ty":"group","data-gid":a.id},name:a.name,img:a.photo?!0:!1,ph:a.photo,iclass:"msi-close",cls:"SC_cs",eid:a.name,ret:"dom"},d=zmConUtil.bubbleUtil(c),f=d.querySelector(".msi-close");f.addEventListener("click",function(a){var c=f.parentNode.getAttribute("data-gid"),d=e.indexOf(b);f.parentNode.parentNode.removeChild(f.parentNode),d!=-1&&e.splice(d,1),ZCL_stopEvents(a)}),g.children()[2].appendChild(d),e.push(b)}},o=function(a){if(f.indexOf(a.eid)==-1){var b={attr:{"data-eid":a.eid,"data-uid":a.zid},name:a.eid,img:a.photo?!0:!1,ph:a.photo,iclass:"msi-close",cls:"SC_cs",eid:a.eid,ret:"dom"},c=zmConUtil.bubbleUtil(b),d=c.querySelector(".msi-close");d.addEventListener("click",function(a){var b=d.parentNode.getAttribute("data-eid"),c=f.indexOf(b);d.parentNode.parentNode.removeChild(d.parentNode),c!=-1&&f.splice(c,1),ZCL_stopEvents(a)}),g.children()[2].appendChild(c),f.push(a.eid)}},p=function(b,c){ZCL_uXHR("/cal/grpDtl.do?mode=grp-membs&comid="+b,function(b){var d=JSON.parse(b.responseText);d.GRP_ID&&a[d.GRP_ID]&&(a[d.GRP_ID].setMembers(d),typeof c!="undefined"&&c.apply(arguments))})},q=function(b){ZCL_isEmpty(a[b].getMembers())?p(b,function(){r(b)}):r(b)},r=function(a){var b,c,d=$("#zcl_gmemlist");d.empty(),b=$("<input type='text' class='zm_sgst' placeholder='Search individuals' id='zcl_gmemsrch'>"),b.attr("gid",a),b.off("keyup").keyup(function(a){w(a,this)}),d.append($("<div/>").append(b)),d.append($("<div/>")),s(a)},s=function(b){var c=a[b].getMembers(),d=$("#zcl_gmemlist"),e=$(d.children()[1]),f=$("<div class='zcl_table'/>");e.empty();for(var g in c){var h=c[g].photo||zmail.defaultPhoto,i=$("<ul><li><span><img src='"+h+"'/></span><span>"+c[g].eid+"</span></li></ul>");i.on("click",{zid:g,eid:c[g].eid,photo:h},function(a){o(a.data)}),f.append(i)}e.append(f)},u=function(a){var b=$("#zcl_gmemlist"),c=$(b.children()[1]),d=$("<div class='zcl_table'/>");c.empty();for(var e in a){var f=a[e].photo||zmail.defaultPhoto,g=$("<ul><li><span><img src='"+f+"'/></span><span>"+a[e].eid+"</span></li></ul>");g.on("click",{zid:a[e].zid,eid:a[e].eid,photo:f},function(a){o(a.data)}),d.append(g)}c.append(d)},v=function(a,b,c){b=b.replace(/&#39;/gi,"'");var d=[],e=[],f=b.substring(0,1).toLowerCase();f=='"'&&(f=b.charAt(1).toLowerCase());var g=/[^a-zA-Z]$/,h=f.match(g);h&&(f="others"),a[f]&&(e=a[f]),b.indexOf("+")!=0&&(b=b.replace(/\+/,"\\+")),b=b.replace(/\s/,"\\s"),b=b.replace(/\(/,"\\("),b=b.replace(/\)/,"\\)"),b=b.replace(/\*/,"\\*"),b=b.replace(/\&/,"\\&"),b=b.replace(/\$/,"\\$");for(z=0;z<e.length;z++){if(c&&d.length==c)break;var j=e[z].dtxt;j=j.replace(/"/gi,""),j=j.replace(/</gi,""),j=j.replace(/>/gi,""),j=j.replace(/\(/gi," ");var k=j.split(" ");k[k.length]=e[z];for(i=0;i<k.length;i++){t=k[i];var l=new RegExp("^(\"|')?"+b+".*?","gi"),m=l.exec(t);if(m&&m.index==0){d[d.length]=e[z];break}}}return d},w=function(b,c){var d=c.value,e=c.getAttribute("gid"),f=a[e].getMembersSearchRec(),g=d.lastIndexOf(",");g>-1&&(d=d.substring(g+1,fldval.length)),d=d.trim();if(d=="\n")return 0;h=v(f,d,10),h&&h.length>0?u(h):s(e)},x=function(a,b){var c=b.value,d=b.getAttribute("gid");c=c.trim(),c==""&&(h=[]),a.keyCode==9&&a.preventDefault()},y=function(){f.length>0&&zmAutoFill.contactFill(f.join(","),$("#zcl_ce_att .zm_sgst"));if(e.length>0){var b={};for(var c=0;c<e.length;c++){var d=e[c];b[a[d].id]={gid:a[d].id,name:a[d].name,photo:a[d].photo,egid:d}}try{var g=$("#attlist");for(var c in b){var h=document.createElement("ul");h.setAttribute("id",b[c].egid),h.setAttribute("gid",b[c].gid),h.innerHTML="<li><img src="+b[c].photo+"></li><li><b>"+b[c].name+'</b></li><li class="zcl_txr"><i class="msi-close" title="Remove" ></i></li>';var i=h.querySelector(".msi-close");i.addEventListener("click",function(a){i.parentNode.parentNode.remove()}),$("#zcl_ce_attlst")[0]?$("#zcl_ce_attlst").append(g.append($(h))):g.append($(h))}}catch(j){}}A()},A=function(){zmsDialog.remove(!0),d="personal",e=[],f=[];if(ZCL_$("zcl_addgroup")){var a=ZCL_$("zcl_addgroup");a.parentNode.removeChild(a)}},B=function(){$("#zcl_addgroup").length==0&&document.body.appendChild($("<div class='zcl_adgrp' id='zcl_addgroup'/>")[0]),g=$("#zcl_addgroup"),g.empty(),g.append(j()),g.append(l()),g.append($("<div class='zcl_grpatt'/>")),m();var a={title:zcal.i18n.add_group_attendees,style:{left:"500px",top:"100px"},drag:!1,mask:!0,ptr:"tright",closeaction:function(){zcalGroup.close()},buttons:[{txt:zcal.i18n.ok,callback:function(){zcalGroup.getSelectedGroup()}},{txt:zcal.i18n.cancel,callback:function(){zcalGroup.close()}}]};zmsDialog.create("zcl_addgroup",a)},C=function(){if(zcal.cdata.grpLst){var d=zcal.cdata.grpLst;for(var e in d.pgrp)a[e]=new F({id:d.pgrp[e].GID,name:d.pgrp[e].GNAME,type:"personal",photo:d.pgrp[e].PHOTO,desc:d.pgrp[e].GDESC?d.pgrp[e].GDESC:zcal.i18n.nodescription}),b.push(e);for(var e in d.ogrp)a[e]=new F({id:d.ogrp[e].GID,name:d.ogrp[e].GNAME,type:"org",photo:d.ogrp[e].PHOTO,desc:d.ogrp[e].GDESC?d.ogrp[e].GDESC:zcal.i18n.nodescription}),c.push(e)}},D=function(a){if(a=="personal")return b;if(a=="org")return c},E=function(b){if(a[b])return a[b]},F=function(a){this.id,this.name,this.photo,this.desc,this.members={},this.srchIndArr={},this.type,this.init(a)};F.prototype={init:function(a){this.id=a&&a.id,this.name=a&&a.name,this.photo=a&&a.photo,this.desc=a&&a.desc},setMembers:function(a){this.members=a&&a.GRP_MEM_OBJ,this.srchIndArr=a&&a.GRP_MEM_ARR&&a.GRP_MEM_ARR[0]},getMembers:function(){return this.members},getMembersSearchRec:function(){return this.srchIndArr}};var G={loadGroup:C,listGroupForAttSel:B,getSelectedGroup:y,close:A,getGroupList:D,getGroup:E,fetchMembers:p};return G}();ZCL_createCal=function(a){ZCL_openCalPopup({id:"",gId:a?a:"",name:"",desc:"",color:0,txtcolor:0})},ZCL_openCalPopup=function(a){ZCL_clrStck();var b=$(".zm_compose"),c,d,e,f;quickCal=$(zcalTemplate.popupCreateCal(a)),c=b.offset(),d=c.top+"px",e=c.left+b.width()+"px";var g={title:zcal.i18n.addcalendar,mask:!0,style:{"min-width":"400px",width:"400px"},posParent:{top:d,left:e},buttons:[{txt:zcal.i18n.save,callback:function(){ZCL_addCal()}},{isCancel:!0,txt:zcal.i18n.cancel,callback:function(){ZCL_closeAddCal()}}],closeaction:function(){ZCL_closeAddCal()}};ZCL_$("zcl_addcal")||$("body").append('<div id="zcl_addcal" class="zcl_addcalcn" ></div>'),$("#zcl_addcal").html(quickCal),zmsDialog.create("zcl_addcal",g),$("#zmsdialog_zcl_addcal").mousedown(function(a){zmUtil.stopEvents(a,!0)}),$("#zcl_calname").off("keydown").on("keydown",function(a,b){var c=a.which||a.keyCode;c==13&&ZCL_addCal()});var h=quickCal.find("[data-marker=textColor]").removeAttr("data-marker");h.on("click",function(a){var b=$(this);b.parent().find("i").removeClass("msi-option").addClass("msi-unoption"),b.find("i").removeClass("msi-unoption").addClass("msi-option")}),$("#zcl_opencaldesc").off("click").on("click",function(){ZCL_$("zcl_caldesc").style.display="",this.style.display="none"})},ZCL_closeAddCal=function(){var a=$("#zcl_addcal");a.length>0&&a.remove(),zmUtil.hideMenu()},ZCL_addCal=function(){if(ZCL_$("zcl_calname").value.trim()=="")return zmUtil.succErrMsg("e",zcal.i18n.entercalname),ZCL_$("zcl_calname").focus(),!1;if(!zcal.validate(zcal.$("zcl_calname").value))return zmUtil.succErrMsg("e",zcal.i18n.spchcalnam),ZCL_$("zcl_calname").focus(),!1;var a=ZCL_$("zcl_calcol").getElementsByTagName("li"),b=0;for(var c in a){var d=a[c].getElementsByTagName("i");if(d.length>0&&d[0].className=="msi-tick"){b=a[c].getAttribute("rel");break}}var e=zcal.$("zcl_calname").value.trim().replace(zcal.REG,"").zcalescape(),f=zcal.$("zcl_caldesc").value.trim().replace(zcal.REG,"").zcalescape(),g=zcal.$("zcl_calid").value,h=zcal.$("zcl_calgid").value,i=ZCL_$("zcl_txtcol").getElementsByTagName("i"),j=1;i[0].className=="msi-option"&&(j=0),zmUtil.hideMenu();var k="/cal/calAct.do?calname="+e;g!=""?k+="&mode=edit-info&calid="+g+"&caldesc="+f+"&calcol="+b+"&txtcol="+j:k+="&mode=add&caldesc="+f+"&calcol="+b+"&txtcol="+j+(h?"&gid="+h:""),ZCL_XHR(k,"zcal.retCAL")},ZCL_editCal=function(a){var b=zcal.getCalObj(a),c=b[1].split(":")[0],d=b[1].split(":")[1];ZCL_openCalPopup({id:a,name:b[0],desc:b[4],color:c,txtcolor:d})},zcal.calColorSel=function(a){a=a?a:"0";var b="<ul>",c=!1;for(var d=0;d<zcal.calcolor.length;d++)c=a==d||zcal.calcolor[d][1].toLowerCase()==a.toLowerCase()?!0:c,b+='<li onclick="zcal.selColor(this)" style="background-color:'+zcal.calcolor[d][1]+';" rel="'+d+'">',b+=a==d||zcal.calcolor[d][1].toLowerCase()==a.toLowerCase()?'<i class="msi-tick"></i>':"",b+=d==9?"</ul><ul>":"";return b+="</ul>",c||(b+='<ul><li onclick="zcal.selColor(this)" style="background-color:'+a+'" rel="'+a+'"><i class="msi-tick"></i></li>',b+="<li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>"),b},zcal.selColor=function(a){var b=zcal.$("zcl_calcol").getElementsByTagName("li");for(var c in b)b[c].innerHTML="";a.innerHTML='<i class="msi-tick"></i>'},zcal.openCalDesc=function(a){zcal.$("zcl_caldesc").style.display="",a.style.display="none"},ZCL_delCal=function(a,b){ZCL_clrStck();var c,d=b?zcal.i18n.areyousureunsub:zcal.i18n.deletecalendar;zmsDialog.confirm(d,{onOk:function(){c=zcal.getCalObj(a),ZCL_XHR("/cal/calAct.do?mode=del&calid="+a+"&calencpt="+c[9],function(b){var c=ZCL_Evl(1,b.responseText);c.status=="success"&&$.publish("/calendar/deleted",{calid:a,caluid:c.uid,mode:"delete"})})}})},ZCL_enableCal=function(a){var b=zcal.getCalObj(a);b&&b[2]==0&&ZCL_sendChgCalStsReq(a,!0,b)},ZCL_ChgCalSts=function(a){var b,c;a.indexOf("zcrm_")!=-1?(a=a.replace("zcrm_",""),zcalCRM.chgUserSts(a)):(b=zcal.getCalObj(a),b!=undefined&&(c=b[2]==1?!1:!0,ZCL_sendChgCalStsReq(a,c,b)))},ZCL_sendChgCalStsReq=function(a,b,c){var d="/cal/calAct.do?mode=en-dis&calid="+a+"&isen="+b;ZCL_XHR(d,function(d){var e=ZCL_Evl(1,d.responseText);e.status=="success"&&(c[2]=b?"1":"0",$.publish("/calendar/statusChanged",{calid:a,sts:c[2]}))})},ZCL_openEmbed=function(a){var b=zcal.getCalObj(a);b&&zcalEmbed.render(a,b)},ZCL_empCal=function(a){ZCL_clrStck(),zmsDialog.confirm(zcal.i18n.emptycal,{onOk:function(){cObj=zcal.getCalObj(a),ZCL_XHR("/cal/calAct.do?mode=empty&calid="+a,ZCL_retEmptyCal)}})},ZCL_retEmptyCal=function(a){var b=ZCL_Evl(1,a.responseText);b.status=="success"&&(zcalEvents.loadMonthData(),zmUtil.succErrMsg("s",zcal.i18n.emptingsucc))},zcal.retCAL=function(a){ZCL_clrStck();if(a.status==200){var b=ZCL_Evl(1,a.responseText),c=b.mode,d=b.id?b.id:null;if(c=="add")if(b.status=="success"){zmUtil.succErrMsg("s",zcal.i18n.caladd);var e=b.obj;b.gid?(zcal.cdata.calOLst=e.clst,zcal.cdata.calOUids=e.Uids,zcal.CALMODE==0&&(zcal.cdata.calGLst=e.gclst,zcal.cdata.calALst=e.aclst,zcal.cdata.calByGrp=e.gclstbygrp)):(zcal.cdata.calLst[d]=b.obj,zcal.cdata.calOrdArr[zcal.cdata.calOrdArr.length]=d),$.publish("/calendar/added",{calid:d,mode:"add"})}else zmUtil.succErrMsg("e",b.error);else if(c=="edit-info")if(b.status=="success"){zmUtil.succErrMsg("s",zcal.i18n.caledited);var e=b.obj,f=zcal.getCalObj(d);f[0]=e[0],f[1]=e[1],f[4]=e[4],$.publish("/calendar/updated")}else zmUtil.succErrMsg("e",b.error);else if(c=="del"||c=="delByUid")ZCL_cleanDeletedCal(d);else if(c=="gcal_del")b.service&&b.service=="gcal"&&(ZCL_removeGCal(b),b.status=="success"&&zmUtil.succErrMsg("s",zcal.i18n.unsubscribesuc));else if(c=="en-dis"&&b.status=="success"){var g=b.isenable,h=zcal.getCalObj(b.id);h[2]=g?"1":"0",zmUtil.succErrMsg("s",zcal.i18n.statuschange)}}else zmUtil.succErrMsg("e",zcal.i18n.errmsg)},ZCL_cleanDeletedCal=function(a){var b=a.calid,c=a.caluid;if(zcal.cdata.calLst[b])delete zcal.cdata.calLst[b],ZCL_remCalid(b),zmUtil.succErrMsg("s",zcal.i18n.caldeleted);else if(zcal.cdata.calOLst[b]||zcal.cdata.calGLst[b]||zcal.cdata.calALst[b])zcal.cdata.calGLst[b]?delete zcal.cdata.calGLst[b]:zcal.cdata.calALst[b]?delete zcal.cdata.calALst[b]:delete zcal.cdata.calOLst[b]&&delete zcal.cdata.calOLst[b],ZCL_remOCalid(c),zmUtil.succErrMsg("s",zcal.i18n.unsubscribesuc);ZCL_setCalendars(),zcalEvents.loadMonthData()},ZCL_remCalid=function(a){for(var b in zcal.cdata.calOrdArr)if(zcal.cdata.calOrdArr[b]==a){zcal.cdata.calOrdArr.splice(b,1);break}},ZCL_remOCalid=function(a){var b=zcal.cdata.calOUids;zcal.cdata.calOUids=b.substring(0,b.indexOf(a))+b.substring(b.indexOf(a)+a.length+1,b.length)},ZCL_gothro=function(a){for(var b in zcal.cdata.evelst){var c=zcal.cdata.evelst[b];for(var d in c)for(var e in c[d])a==c[d][e].CNAME&&(c.length==1?delete zcal.cdata.evelst[b]:zcal.cdata.evelst[b].splice(d,1))}for(var b in zcal.cdata.eveAll){var c=zcal.cdata.eveAll[b];for(var d in c)for(var e in c[d])a==c[d][e].CNAME&&(c.length==1?delete zcal.cdata.eveAll[b]:zcal.cdata.eveAll[b].splice(d,1))}},ZCL_subscribeToCalUpdate=function(){zcal.isSubToCalUpd=!0,$.subscribe("/calendar/added",ZCL_updateCalAndEvents),$.subscribe("/calendar/subscribed",function(){ZCL_setCalendars(),zcal.settingsUpdated=!0,zcalEvents.loadMonthData()}),$.subscribe("/calendar/updated",ZCL_updateCalAndEvents),$.subscribe("/calendar/deleted",function(a,b){zcal.settingsUpdated=!0,ZCL_cleanDeletedCal(b)}),$.subscribe("/calendar/statusChanged",function(a,b){ZCL_setCalendars(),zcal.settingsUpdated=!0,ZCL_updateEvents()}),$.subscribe("/calendar/visibilityChanged",function(a,b){ZCL_setCalendars(),b.visibility?zcalEvents.loadMonthData():(zcal.settingsUpdated=!0,ZCL_gothro(b.calid),ZCL_updateEvents())})},ZCL_updateCalAndEvents=function(){ZCL_setCalendars(),ZCL_updateEvents()},ZCL_updateEvents=function(){zcal.view==4?zcalAgenda.dispEvents():zcalView.plotEvents()},ZCL_setCalendars=function(){zcal.disabledcal="",ZCL_CALNAME="",zcal.mcal=zcalInit.formatCalData(zcal.cdata.calLst,zcal.cdata.calOrdArr),ZCL_setGrpOdr(),ZCL_updateGroupCalList(),ZCL_updateAppCalList(),zcal.acal=zcalInit.formatCalData(zcal.cdata.calALst),zcal.ocal=zcalInit.formatCalData(zcal.cdata.calOLst),zmApp.currentApp=="c"&&zcalInit.constructLeft()},ZCL_setGrpOdr=function(){if(zcal.cdata.calGLst){var a=zcal.cdata.calGLst,b=[],c={};for(var d in a)c={id:d,value:a[d][0]},b.push(c);b.sort(function(a,b){var c=a.value.toUpperCase(),d=b.value.toUpperCase();return c<d?-1:c>d?1:0}),zcal.cdata.gcalOdrArr=[];for(var e in b)zcal.cdata.gcalOdrArr.push(b[e].id)}},ZCL_getCalColor=function(a){return a+="",a=a.indexOf(":")!=-1?a.substring(0,a.indexOf(":")):a,/^#([A-Fa-f0-9]{6})$/.test(a)?[a,a]:/0?[0-9]|1[0-9]/.test(a)?zcal.calcolor[parseInt(a,10)]:zcal.calcolor[0]},ZCL_getColorNo=function(a){for(var b=0;b<zcal.calcolor.length;b++){var c=zcal.calcolor[b];if(c[0].toLowerCase()==a.toLowerCase()||c[1].toLowerCase()==a.toLowerCase())return b}return-1},zcal.getCalLst=function(){var a={};for(var b=0;b<zcal.cdata.calOrdArr.length;b++){var c=zcal.cdata.calOrdArr[b],d=zcal.cdata.calLst[c];a[c]=d[0]}for(var e in zcal.cdata.calGLst){var f=zcal.cdata.calGLst[e];f[8]=="1"&&(f[12]==2||f[12]==3)&&(a[e]=f[0]+"("+f[14]+")")}for(var e in zcal.cdata.calALst){var f=zcal.cdata.calALst[e];f[8]=="1"&&(f[12]==2||f[12]==3)&&(a[e]=f[0]+"("+f[14]+")")}for(var e in zcal.cdata.calOLst){var f=zcal.cdata.calOLst[e];f[8]=="1"&&(f[12]==2||f[12]==3)&&(a[e]=f[0]+"(others)")}return a},zcal.showDD=function(a,b){if(b=="remlst")zcalDD.ddList(a,zcal.REMSTR);else if(b=="rem_rtype")zcalDD.ddList(a,zcal.ALARM_REMTYPE);else if(b=="rem_atype")zcalDD.ddList(a,zcal.ALARM_ACTTYPE);else if(b=="repfreq")zcalDD.ddList(a,zcal.REPEAT_FREQ);else if(b=="callst"){var c=zcal.getCalLst();zcalDD.ddList(a,c)}else b=="weekdays"?zcalDD.ddList(a,Date.WEEK_DAYS[0]):b=="wktype"?zcalDD.ddList(a,zcal.WEEK_TYPE):b=="months"?zcalDD.ddList(a,Date.MONTH_NAMES[0]):b=="freebusy_db"&&zcalDD.ddList(a,zcal.FREEBUSY_DD)};var zcalDD={};zcalDD.CUR_ELEMENT=null,zcalDD.valObj=null,zcalDD.isTZ=!1,zcalDD.ddList=function(a,b,c){this.CUR_ELEMENT=a,this.valObj=b,this.isTZ=c,this.constDD()},zcalDD.close=function(a){var b=document.getElementById&&!document.all?a.target:event.srcElement;if(!b.id||b.id!="zcl_ddlst")document.attachEvent?document.detachEvent("onmousedown",zcalDD.close):document.removeEventListener("mousedown",zcalDD.close,!1),zcalDD.delDD();return},zcalDD.delDD=function(){var a=document.getElementById("zcl_ddlst");return a?(a.parentNode.removeChild(a),!0):!1},zcalDD.constDD=function(){document.attachEvent?document.attachEvent("onmousedown",zcalDD.close):document.addEventListener("mousedown",zcalDD.close,!1);var a=document.createElement("ul");a.className="zcl_optiondrpbx",a.setAttribute("id","zcl_ddlst"),a.onmousedown=function(a){zcalDD.returnVal(this,a)};var b="";b+=this.constLst(),a.innerHTML=b,this.CUR_ELEMENT.appendChild(a),a.style.display="block"},zcalDD.constLst=function(){var a="";if(this.isTZ)for(var b in this.valObj)for(var c in this.valObj[b])a+="<li rel="+c+">"+unescape(this.valObj[b][c])+" ("+c+")"+"</li>";else for(var b in this.valObj)a+='<li rel="'+b+'">'+ZCL_getHTML(this.valObj[b])+"</li>";return a},zcalDD.returnVal=function(a,b){var c=document.getElementById&&!document.all?b.target:event.srcElement;if(c.tagName=="LI"){if(this.CUR_ELEMENT){this.CUR_ELEMENT.childNodes[0].value=c.innerHTML;var d=c.getAttribute("rel");this.CUR_ELEMENT.childNodes[1].value=d,this.CUR_ELEMENT.getAttribute("callback")&&ZCL_Evl(0,this.CUR_ELEMENT.getAttribute("callback"),d)}this.CUR_ELEMENT=null,this.valObj=null,this.isTZ=!1,this.delDD(),this.stopEvent(b)}return},zcalDD.stopEvent=function(a){a=a||event,a.stopPropagation?(a.preventDefault(),a.stopPropagation()):(a.cancelBubble=!0,a.returnValue=!1)},ZCL_openSAdd=function(a){zcal.CAStck(new Array("zcl_smAdd")),document.addEventListener("mousedown",ZCL_mdownClr,!1),document.addEventListener("keydown",zcal.keyCtrl,!1);var b=$(zcalTemplate.popupSmartAdd());ZCL_$("zcl_smAdd")||$("body").append('<ul id="zcl_smAdd" class="zcl_smtadd"></ul>');var c=$("#zcl_smAdd");c.html(b);var d=$(zcal.calCenter.listElem).offset();c.css({left:d.left+"px",top:$(a).offset().top+$(a).height()+8+"px",display:""}),$("#zcl_smaddtxt").focus(),$("#zcl_smaddtxt").off("keydown").on("keydown",function(a,b){var c=a.which||a.keyCode;c==13&&(ZCL_clrStck(),ZCL_smartAdd(this))})},ZCL_openSAddHelp=function(){zcal.$("zcl_saddhelp").style.display=zcal.$("zcl_saddhelp").style.display=="none"?"":"none"},ZCL_smartAdd=function(a){var b=a.value.trim();if(b=="")return!1;if(!zcal.validate(b))return alert(zcal.i18n.spchsmad),!1;b=b.replace(zcal.REG,"").replace(/ /g," "),b==""&&(b="NO SUBJECT");var c=ZCL_nlp(b,1),d=c.SUM.trim();d==""&&(d="NO SUBJECT");var e=c.SD&&c.SD!=""?c.SD:"",f=ZCL_parseDateStr(e);e=f.dateBy(zcal.DFORMAT[zcal.cdata.opt.DF]);var g=c.ED&&c.ED!=""?c.ED:"",f=ZCL_parseDateStr(g);g=f.dateBy(zcal.DFORMAT[zcal.cdata.opt.DF]);var h=c.ST?c.ST:"0000",i=c.ET?c.ET:"0000",j=!c.ST&&!c.ET?1:0,k={EID:"",EUID:"",RIDX:"",EPERM:2,DPERM:2,SD:e,ST:h,ED:g,ET:i,ATT:"",RMVATT:"",GATT:"",RMVGATT:"",CLASS:0,ADAY:j,IMP:0,USTAT:0,UCMNT:"",SKEY:"",CNAME:zcal.cdata.defcal,LOC:"",TRANS:1,DESC:"",LINK:"",ETSK:0,ECRM:0,ENTS:0,EMET:0,SUM:d,ALARM:"",REP:"",TYPE:1,ISDMY:!1,ETZ:"",IN_ETZ:!1,DELRTO:!1,EC:-1,ADD_MODE:"DET"};return ZCL_detailObj(k),a.blur(),!1},ZCL_retsAdd=function(a){var b=ZCL_Evl(1,a.responseText);if(b.status=="success"){var c=b.obj,d=b.rdats?b.rdats:"",e=c.LOC,f={CNAME:c.CNAME,ORG:c.ORG,SD:c.SD,ST:c.ST,ED:c.ED,ET:c.ET,SUM:c.SUM,LOC:e,REF:c.REF,RTO:c.RTO,ADAY:c.ADAY,EPERM:"2",DPERM:"2",EUID:c.EUID,EC:"-1"},g=ZCL_Evl(1,'{"'+c.EID+'":'+JSON.stringify(f)+"}");if(d!="")ZCL_insertRepEvents(g,d,c.EID);else{ZCL_insertEvent(g,c.EID);if(zcal.view==4){f.EID=c.EID;var h=JSON.stringify(f);zcalAgenda.add(h)}}ZCL_enableCal(c.CNAME),zcalView.plotEvents(),zmUtil.succErrMsg("s",zcal.i18n.evtadded)}else b.error=="Parser Error"?ZCL_callAdd(b.sub):zmUtil.succErrMsg("s",b.error)};var ZCL_RQ=[],ZCL_URL=[],ZCL_LOGIN_STATE=!0;ZCL_uXHR=function(a,b,c,d){return a="/mail"+a,rt=ZCL_RQ.length,ZCL_RQ[rt]=ZCL_GetHTTPTransport(),ZCL_URL[rt]=a,typeof b=="function"?(ZCL_RQ[rt].zcal_callback=b,ZCL_RQ[rt].zcal_reqindex=rt,ZCL_RQ[rt].onreadystatechange=function(){var a=this.zcal_callback,b=this.zcal_reqindex;if(this.readyState==4){var c=this.getResponseHeader("Content-Type").toLowerCase().indexOf("text/xml");c!=-1?a(this.responseXML,ZCL_URL[b]):a(this,ZCL_URL[b]),ZCL_RQ[b]=null}}):ZCL_RQ[rt].onreadystatechange=new Function("{\t\t\tif( ZCL_RQ["+rt+"].readyState == 4 ) { \t\t\t\tZCL_XHRInclude(ZCL_RQ["+rt+"],ZCL_URL["+rt+"]);\t\t\t\tvar ret = ZCL_RQ["+rt+'].getResponseHeader("Content-Type").toLowerCase().indexOf("text/xml");\t\t\t\t'+b+"((ret !=-1 ? ZCL_RQ["+rt+"].responseXML:ZCL_RQ["+rt+"]) ,ZCL_URL["+rt+"]);ZCL_RQ["+rt+"]=null;}}"),ZCL_RQ[rt].open("GET",a,!0),ZCL_RQ[rt].setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),ZCL_RQ[rt].send(null),!0},ZCL_GetHTTPTransport=function(){if(window.XMLHttpRequest)return new XMLHttpRequest;if(window.ActiveXObject)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(a){throw new Exception("Browser not supported")}}},ZCL_formSubmit=function(a,b,c){if(!ZCL_$("zcl_tarFrame")){var d=_zm.getDOM(["IFRAME",{attrs:{id:"zcl_tarFrame",name:"zcl_tarFrame",style:"display:none",width:"0",height:"0",frameborder:"0"}}]);document.body.appendChild(d)}var e=_zm.getDOM(["FORM",{attrs:{id:"dwnldForm",name:"dwnldForm",style:"display:none",target:"zcl_tarFrame",method:c||"post",action:"/mail"+b+"?frameorigin="+window.location.protocol+"//"+window.location.hostname}}]);for(var f in a)e.appendChild(_zm.getDOM(["INPUT",{attrs:{type:"hidden",name:f,value:a[f]}}]));var g=document.cookie,h;g=g.substring(g.indexOf("aprmjrnpkcrkks=")+15,g.length),h=g.indexOf(";")!=-1?g.substring(0,g.indexOf(";")):g,e.appendChild(_zm.getDOM(["INPUT",{attrs:{type:"hidden",name:"mstpcrdhkur",value:h}}])),document.body.appendChild(e),e.submit(),e.parentNode.removeChild(e)};var zcalSettings=function(a){return a.getCalConfig=function(){var a={orders:[["Preferences","Import","Subscribe","Sync","Groups","ZohoApps","OwnCalendars","GroupCalendars","AppCalendars","OtherCalendars"]],rows:{Preferences:{title:zcal.i18n.mypreference,html:function(){return zcalSettings.zcalMyPreferences.myprefRowHTML()},invokable:!0,uId:"zcalSettings.zcalMyPreferences"},Import:{title:zcal.i18n.import,html:zcal.i18n.mailimport,invokable:!0,uId:"zcalSettings.Import"},Subscribe:{title:zcal.i18n.subscribe,html:zcal.i18n.mailsubscibe,invokable:!0,uId:"zcalSettings.Subscribe"},Sync:{title:zcal.i18n.sync,html:zcal.i18n.mailsync,invokable:!0,uId:"zcalSettings.Sync"},Groups:{title:zcal.i18n.groups,html:zcal.i18n.mailgroupcalendars,invokable:!0,uId:"zcalSettings.zcalGroupList"},ZohoApps:{title:ZCL_replaceComName(zcal.i18n.zohoapps),html:ZCL_replaceComName(zcal.i18n.appsubscribe),invokable:!0,uId:"zcalSettings.appList"},OwnCalendars:{title:zcal.i18n.mycalendars,html:zcal.i18n.mailowncalendar,invokable:!0,uId:"zcalSettings.ownCalList"},GroupCalendars:{title:zcal.i18n.groupcalendars,html:zcal.i18n.mailgroupcalendar,invokable:!0,uId:"zcalSettings.grpCalList"},AppCalendars:{title:zcal.i18n.appcalendars,html:zcal.i18n.mailappcalendar,invokable:!0,uId:"zcalSettings.appCalList"},OtherCalendars:{title:zcal.i18n.othercalendars,html:zcal.i18n.mailotherscalendar,invokable:!0,uId:"zcalSettings.othCalList"}}};return a},a}(zcalSettings||{}),zcalSettings=window.zcalSettings||{};zcalSettings.zcalMyPreferences=function(a){a=a||{};var b="settings",c,d,e,f,g,h="general",i={},j=function(){return{general:{text:zcal.i18n.general,type:"general",id:"zcl_mypref_general",click:function(){h="general",m()}},emailnotify:{text:zcal.i18n.emailnotify,type:"emailnotify",id:"zcl_mypref_enotify",click:function(){h="emailnotify",m()}}}},k=function(){zcal.timezones.length>0?z():ZCL_getTZ({mode:"mypref",callback:function(){zcalSettings.zcalMyPreferences.showAllTimezone()}})},l=function(){d=$('<div class="SC_filt"><div class="SC_filt_Tabs"/></div>');var a=j();for(var b in a){var c=$('<a id="'+a[b].id+'"/>');c.addClass(h==a[b].type?"sel":""),c.text(a[b].text),c.off("click").on("click",{click:a[b].click},function(a){var b=$(this);b.parent().find("a").removeClass("sel"),b.addClass("sel"),a.data.click()}),d.find(".SC_filt_Tabs").append(c)}f.append(d)},m=function(){e=$('<div class="SC_setInner"><div class="SC_filt_bottom"/></div>');var a=zcal.cdata.opt;if(h=="emailnotify"){var b,c="",d=a.MT,f=a.MTO;if(a.CMAIL&&a.CMAIL!="")c+='<div class="folderRow"><div class="folderRowBox">',c+="<p>"+ZCL_replaceString(zcal.i18n.rnote1,['<span class="SC_lnk">'+a.CMAIL+"</span>",'<span class="SC_lnk" data-marker="resendEmail">',"</span>"])+"</p>",c+="<p>"+ZCL_replaceString(zcal.i18n.rnote2,['<span class="SC_lnk">'+f+"</span>"])+"</p>",c+='<div class="SC_PUbtm"><span data-marker="reverttoPrevious">'+zcal.i18n.rbutton+"</span></div>",c+="</div></div>";else{c='<ul class="SC_cal_prefer"><li>';if(zcal.emlNfy=="1"){var i=a.REMID.split(",");c+="<span>"+zcal.i18n.emailaddress+"<span>"+zcal.i18n.emailaddress_msg2+"</span></span><em><div>"+ZCL_selBox("zcl_MTO",f,i)}else c+="<span>"+zcal.i18n.emailaddress+"<span>"+zcal.i18n.emailaddress_msg1+"</span></span><em><div>"+f,zcal.emlNfy!="0"&&zcal.emlNfy!="1"&&(c+='<span class="cnew SC_lnk pl5" data-marker="changeEmailNotify">'+zcal.i18n.change+"</span>");c+='<div class="block" id="enotifyType"><span data-marker="notifyType"><i class="'+(d==0?"msi-option":"msi-unoption")+'"></i><span class="pl5">'+zcal.i18n.ashtml+'</span></span><span data-marker="notifyType"><i class="'+(d==1?"msi-option":"msi-unoption")+'"></i><span class="pl5">'+zcal.i18n.asplaintext+"</span></span></div></div></em>",c+="</li>",d==0&&(c+="<li>",c+="<span>"+zcal.i18n.agendanotification+"<span>"+zcal.i18n.agendanotification_msg+"</span></span><em>"+ZCL_selBox1("zcl_AI",a.AI,zcal.AGENDA_INTERVAL)+"</em>",c+="</li>"),c+='<div class="SC_PUbtm left"><span class="sel" data-marker="saveENotify">'+zcal.i18n.save+"</span></div>",c+="</ul>"}b=$(c);var j=b.find("[data-marker=notifyType]").removeAttr("data-marker");j.length&&j.on("click",function(a){var b=$(this);b.parent().find("i").removeClass("msi-option").addClass("msi-unoption"),b.find("i").removeClass("msi-unoption").addClass("msi-option"),r(b.index())});var l=b.find("[data-marker=changeEmailNotify]").removeAttr("data-marker");l.length&&l.on("click",function(a){s()});var m=b.find("[data-marker=resendEmail]").removeAttr("data-marker");m.length&&m.on("click",function(a){ZCL_XHR("/cal/set.do?type=resendemail",B)});var o=b.find("[data-marker=reverttoPrevious]").removeAttr("data-marker");o.length&&o.on("click",function(a){ZCL_XHR("/cal/set.do?type=revert",C)});var q=b.find("[data-marker=saveENotify]").removeAttr("data-marker");q.length&&q.on("click",function(a){p()}),e.find(".SC_filt_bottom").append(b)}else{var b,c='<ul class="SC_cal_prefer">';c+="<li><span>"+zcal.i18n.timezone+'</span><em><div class="SC_select default">'+z()+'</div><span class="cnew SC_lnk pl5" data-marker="showallTimezone">'+zcal.i18n.showall+"</span></em></li>",c+="<li><span>"+zcal.i18n.dateformat+"</span><em>"+ZCL_selBox("zcl_DF",a.DF,zcal.DATEFORMAT)+"</em></li>",c+="<li><span>"+zcal.i18n.timeformat+"</span><em>"+ZCL_selBox("zcl_TF",a.TF,zcal.TIMEFORMAT)+"</em></li>",c+="<li><span>"+zcal.i18n.defaultview+"</span><em>"+ZCL_selBox("zcl_DEF",a.DEF,zcal.DEFAULTVIEW)+"</em></li>",c+="<li><span>"+zcal.i18n.weekstartson+"</span><em>"+ZCL_selBox("zcl_WK",a.WK,Date.WEEK_DAYS[0])+"</em></li>",c+="<li><span>"+zcal.i18n.workweek+"</span><em><strong>"+zcal.i18n.startson+ZCL_selBox("zcl_WS",a.WS,Date.WEEK_DAYS[0])+"</strong><strong>"+zcal.i18n.endson+ZCL_selBox("zcl_WE",a.WE,Date.WEEK_DAYS[0])+"</strong></em></li>";var t=a.SIE,u=a.DDE,v=a.REM,w=a.NWTB;c+="<li><span>"+zcal.i18n.workhours+"</span><em><strong>"+zcal.i18n.startson+ZCL_selBox("zcl_HS",a.HS,zcal.HOURS)+"</strong><strong>"+zcal.i18n.endson+ZCL_selBox("zcl_HE",a.HE,zcal.HOURS)+'</strong><div class="block"><span data-marker="nonworkingHour" id="zcl_nonWHr"><i class="'+(w==1?"msi-check":"msi-uncheck")+'"></i><span class="pl5">'+zcal.i18n.nonworktime_busy+"</span></span></div></em></li>",c+="<li><span>"+zcal.i18n.automatic_inv+"<span>"+zcal.i18n.automatic_invmsg+'</span></span><em id="zcl_autoInv"><span data-marker="automaticInvitation"><i class="'+(t==0?"msi-option":"msi-unoption")+'"></i><span class="pl5">'+zcal.i18n.allow+'</span></span><span data-marker="automaticInvitation"><i class="'+(t==2?"msi-option":"msi-unoption")+'"></i><span class="pl5">'+zcal.i18n.allowiffree+'</span></span><span data-marker="automaticInvitation"><i class="'+(t==1?"msi-option":"msi-unoption")+'"></i><span class="pl5">'+zcal.i18n.dontallow+"</span></span></em></li>",c+="<li><span>"+zcal.i18n.denied_events+"<span>"+zcal.i18n.denied_eventsmsg+'</span></span><em id="zcl_showDE"><span data-marker="deniedEvents"><i class="'+(u==1?"msi-option":"msi-unoption")+'"></i><span class="pl5">'+zcal.i18n.show+'</span></span><span data-marker="deniedEvents"><i class="'+(u==0?"msi-option":"msi-unoption")+'"></i><span class="pl5">'+zcal.i18n.hide+"</span></span></em></li>",c+="<li><span>"+zcal.i18n.reminder_notification+"<span>"+zcal.i18n.reminder_notification_msg+'</span></span><em id="zcl_remNotify"><span data-marker="reminderNotify"><i class="'+(v==1?"msi-option":"msi-unoption")+'"></i><span class="pl5">'+zcal.i18n.on+'</span></span><span data-marker="reminderNotify"><i class="'+(v==0?"msi-option":"msi-unoption")+'"></i><span class="pl5">'+zcal.i18n.off+"</span></span></em></li>",c+='<div class="SC_PUbtm left"><span class="sel" data-marker="saveMyPrefGeneral">'+zcal.i18n.save+"</span></div>",c+="</ul>",b=$(c);var x=b.find("[data-marker=showallTimezone]").removeAttr("data-marker");x&&x.on("click",function(a){k(),$(this).remove()}),b.find("#zcl_TZ").on("click",function(a){if(zcal.timezones.length>0){var b=zcal.timezones,c=[];for(var d in b)for(var e in b[d]){var f={};f.id=e,f.name=b[d][e]+" ("+e+")",f.display_text=b[d][e]+" ("+e+")",c.push(f)}var g={},h=$(this),i;g.parentDOM=h.parent(),g.displayAs="dropdown",g.parWidth=!0,g.onSelect=function(a,b){n(h,a,b),i.hide()},g.dataCallback=function(){return c},i=zmUtil.createFLComp("generic",g),i.show()}});var A=b.find("[data-marker=nonworkingHour]").removeAttr("data-marker");A&&A.on("click",function(a){var b=$(this);b.find("i")[0].className=="msi-check"?b.find("i").removeClass("msi-check").addClass("msi-uncheck"):b.find("i").removeClass("msi-uncheck").addClass("msi-check")});var D=b.find("[data-marker=automaticInvitation]").removeAttr("data-marker");D&&D.on("click",function(a){var b=$(this);b.parent().find("i").removeClass("msi-option").addClass("msi-unoption"),b.find("i").removeClass("msi-unoption").addClass("msi-option")});var E=b.find("[data-marker=deniedEvents]").removeAttr("data-marker");E&&E.on("click",function(a){var b=$(this);b.parent().find("i").removeClass("msi-option").addClass("msi-unoption"),b.find("i").removeClass("msi-unoption").addClass("msi-option")});var F=b.find("[data-marker=reminderNotify]").removeAttr("data-marker");F&&F.on("click",function(a){var b=$(this);b.parent().find("i").removeClass("msi-option").addClass("msi-unoption"),b.find("i").removeClass("msi-unoption").addClass("msi-option")});var G=b.find("[data-marker=saveMyPrefGeneral]").removeAttr("data-marker");G&&G.on("click",function(a){y()}),e.find(".SC_filt_bottom").append(b)}g.empty().append(e)},n=function(a,b,c){a.val(c.display_text),a.attr("rel",b),a.attr("value",c.display_text)},o=function(){var a=zcal.cdata.opt,b=$("#enotifyType");if(ZCL_$("zcl_MTO")){var c=ZCL_$("zcl_MTO").value;if(!ZCL_isEmail(c))return _zm.succErrMsg("e",zcal.i18n.entervalidemailid),ZCL_$("zcl_MTO").focus(),!1;if(c!=a.MTO)return!0}if(b.length){var d=b.find(".msi-option").parent().index();if(a.MT!=d)return!0;var e=-1;d===0&&(e=$("#zcl_AI").val());if(e!=a.AI)return!0}return!1},p=function(){if(o()){var a=zcal.cdata.opt,b=$("#enotifyType");i={},i.MTO=ZCL_$("zcl_MTO")?ZCL_$("zcl_MTO").value:a.MTO,i.MT=b.length?b.find(".msi-option").parent().index():a.MT,i.AI=i.MT==0?$("#zcl_AI").val():-1,ZCL_XHR("/cal/set.do?type=notify&mailto="+i.MTO.zcalescape()+"&as="+i.MT+"&agenda_notify="+i.AI,q)}},q=function(a){var b=ZCL_Evl(1,a.responseText);b.status=="success"&&(_zm.succErrMsg("s",zcal.i18n.successedit),zcal.cdata.opt.MTO=b.MTO,zcal.cdata.opt.MT=b.MT,zcal.cdata.opt.AI=b.AI)},r=function(a){if(a===0){if($("#zcl_AI").length==0){var b=$("<li/>");b.html("<span>"+zcal.i18n.agendanotification+"<span>"+zcal.i18n.agendanotification_msg+"</span></span><em>"+ZCL_selBox1("zcl_AI",zcal.cdata.opt.AI,zcal.AGENDA_INTERVAL)+"</em>"),$(".SC_cal_prefer>li:first").after(b)}}else $("#zcl_AI").length>0&&$("#zcl_AI").parents("LI").remove()},s=function(){var a,b="";e=$('<div class="SC_setInner"><div class="SC_filt_bottom"/></div>'),b+='<ul class="SC_cal_prefer"><li><span>'+zcal.i18n.emailaddress+"<span>"+zcal.i18n.emailaddress_msg3+"</span></span>",b+='<em><input type="text" id="zcl_MTO" value="'+zcal.cdata.opt.MTO+'" class="inputDefault"></em></li>',b+='<div class="SC_PUbtm left"><span class="sel" data-marker="confirmEmail">'+zcal.i18n.confirm+'</span><span data-val="Cancel" data-marker="cancelEmail">'+zcal.i18n.cancel+"</span></div></ul>",a=$(b);var c=a.find("[data-marker=confirmEmail]").removeAttr("data-marker");c&&c.on("click",function(){t()});var d=a.find("[data-marker=cancelEmail]").removeAttr("data-marker");d&&d.on("click",function(){m()}),e.find(".SC_filt_bottom").append(a),g.empty().append(e)},t=function(){var a=zcal.cdata.opt,b=ZCL_$("zcl_MTO").value.trim();if(a.CMAIL&&a.CMAIL!=""&&b!=a.CMAIL||a.CMAIL==undefined||a.CMAIL==""&&b!=a.MTO){if(!ZCL_isEmail(b))return _zm.succErrMsg("e",zcal.i18n.entervalidemailid),ZCL_$("zcl_MTO").focus(),!1;a.CMAIL=b,ZCL_XHR("/cal/set.do?type=changeemail&mailto="+b.zcalescape(),D)}else m()},u=function(){var a=zcal.cdata.opt,b,c,d,e,f;if(ZCL_$("zcl_TZ")){var g=ZCL_$("zcl_TZ").getAttribute("rel");if(g&&g!=a.TIM)return!0}var b=["DF","TF","DEF","WK","WS","WE","HS","HE"];for(var h=0;h<b.length;h++)if(a[b[h]]!=parseInt(ZCL_$("zcl_"+b[h]).value,10))return!0;f=$("#zcl_nonWHr").find(".msi-check").length==1?1:0;var i=$("#zcl_autoInv"),j=$("#zcl_showDE"),k=$("#zcl_remNotify"),l;return l=i.find(".msi-option").parent().index(),c=l==2?1:l==1?2:0,d=j.find(".msi-option").parent().index()==0?1:0,e=k.find(".msi-option").parent().index()==0?1:0,a.DDE!=d||a.SIE!=c||a.REM!=e||a.NWTB!=f?!0:!1},v=function(){i={};var a,b,c;a=[["DF",3],["TF",1],["DEF",4],["WK",6],["WS",6],["WE",6]],b=parseInt(ZCL_$("zcl_HS").value,10),c=parseInt(ZCL_$("zcl_HE").value,10);if(b>=c)return _zm.succErrMsg("e",zcal.i18n.wkhretgrwkhrst),!1;i.HS=b,i.HE=c;var d=ZCL_$("zcl_TZ")?ZCL_$("zcl_TZ").getAttribute("rel"):null;d&&d!=zcal.cdata.opt.TIM?(i.TIM=d,i.CTIM=ZCL_$("zcl_TZ").value):i.TIM=zcal.cdata.opt.TIM;for(var e=0;e<a.length;e++){var f=a[e][0],g=parseInt(ZCL_$("zcl_"+f).value,10);i[f]=g>=0&&g<=a[e][1]?g:opt[f]}var h=$("#zcl_autoInv"),j=$("#zcl_showDE"),k=$("#zcl_remNotify"),l;return l=h.find(".msi-option").parent().index(),i.SIE=l==2?1:l==1?2:0,i.DDE=j.find(".msi-option").parent().index()==0?1:0,i.REM=k.find(".msi-option").parent().index()==0?1:0,i.NWTB=$("#zcl_nonWHr").find(".msi-check").length==1?1:0,!0},w=function(){var a=zcal.cdata.opt;v()&&ZCL_XHR("/cal/set.do?type=gen&obj="+encodeURIComponent('{"DF":'+i.DF+',"TF":'+i.TF+',"DEF":'+i.DEF+',"WK":'+i.WK+',"WS":'+i.WS+',"WE":'+i.WE+',"HS":'+i.HS+',"HE":'+i.HE+',"MTO":'+a.MTO+', "TH":'+a.TH+',"FS":'+a.FS+',"TIM":"'+i.TIM+'", "DDE":'+i.DDE+', "SIE":'+i.SIE+',"REM":'+i.REM+',"NWTB":'+i.NWTB+"}"),x)},x=function(a){var b=ZCL_Evl(1,a.responseText);if(b.status=="success"){var c=zcal.cdata.opt;b.TZLBL&&(c.TZLBL=b.TZLBL);for(var d in i)c[d]=i[d];_zm.succErrMsg("s",zcal.i18n.successedit)}},y=function(){u()?w():_zm.succErrMsg("i","No Changes made in My Preferences")},z=function(){var a='<input type="text" readonly  value="'+unescape(zcal.cdata.opt.CTIM)+'" id="zcl_TZ" class="SC_tiput zcl_nrbr" rel="'+zcal.cdata.opt.TIM+'" />\t\t  ';return a},A=function(){var a="<select>";for(var b in zcal.timezones)for(var c in zcal.timezones[b]){var d=zcal.cdata.opt.TIM==c?"selected":"";a+="<option "+d+" value="+c+">"+unescape(zcal.timezones[b][c])+" ("+c+")"+"</option>"}a+="</select>",$("#zcl_TZ").html(a)},B=function(a){var b=ZCL_Evl(1,a.responseText);zcal.cdata.opt.CMAIL=b.CMAIL,_zm.succErrMsg("s",zcal.i18n.mailsendsuccess)},C=function(a){var b=ZCL_Evl(1,a.responseText);zcal.cdata.opt.CMAIL=b.CMAIL,m()},D=function(a){var b=ZCL_Evl(1,a.responseText);b.MTO!=""&&b.CMAIL==""?(zcal.cdata.opt.MTO=b.MTO,zcal.cdata.opt.CMAIL=b.CMAIL,b.MSG!=undefined?b.MSG=="INVALID_ID"?_zm.succErrMsg("e",zcal.i18n.nonregisteredemailid):b.MSG=="NOPERM"&&_zm.succErrMsg("e",zcal.i18n.nonregisteredemailid):_zm.succErrMsg("s",zcal.i18n.mailconfirmed)):(zcal.cdata.opt.CMAIL=b.CMAIL,_zm.succErrMsg("s",zcal.i18n.verifymailsend)),m()},E=function(){zmailSettings.views.showPreview();var a=$(zmailSettings.views.getPreviewDOM());f=a.find(".SC_ptit"),l(),g=a.find(".SC_Twpr"),m()},F=function(){d.remove(),e.remove()},G=function(){if(!zmsuite.isWorkspaceAvailable(b))return;E()},H=function(){h="general",F(),zmailSettings.currentAppName=undefined};return a.myprefRowHTML=function(){var a="",b=zcal.cdata.opt.TIM,c=zcal.DFORMAT[zcal.cdata.opt.DF],d=zcal.timeformat[zcal.cdata.opt.TF],e=zcal.cdata.opt.MTO;return a+=ZCL_replaceString(zcal.i18n.mailtimezone,[b]),a+="<strong>|</strong>",a+=ZCL_replaceString(zcal.i18n.maildateformat,[c]),a},a.init=G,a.clearTrace=H,a.showAllTimezone=z,a}(zcalSettings.zcalMyPreferences||{}),zcalSettings.Import=function(a){a=a||{};var b="settings",c,d,e,f,g="file",h=function(){return{file:{text:zcal.i18n.file,type:"file",id:"zcl_imp_file",click:function(){g="file",j()}},url:{text:zcal.i18n.url,type:"url",id:"zcl_imp_url",click:function(){g="url",j()}}}},i=function(){c=$('<div class="SC_filt"><div class="SC_filt_Tabs"/></div>');var a=h();for(var b in a){var d=$('<a id="'+a[b].id+'"/>');d.addClass(g==a[b].type?"sel":""),d.text(a[b].text),d.off("click").on("click",{click:a[b].click},function(a){var b=$(this);b.parent().find("a").removeClass("sel"),b.addClass("sel"),a.data.click()}),c.find(".SC_filt_Tabs").append(d)}e.append(c)},j=function(){d=$('<div class="SC_setInner"><div class="SC_filt_bottom"/></div>');var a,b='<ul class="SC_cal_prefer">';g=="url"?(b+="<li><span>"+zcal.i18n.weburl+"<span>"+zcal.i18n.weburl_msg+"</span></span>",b+='<em><input type="text" id="zcl_impUrl" class="inputDefault"/>'):(b+="<li><span>"+zcal.i18n.filename+"<span>"+zcal.i18n.browsefile+"</span></span>",b+="<em>",b+='<iframe name="zcl_imp" id="zcl_imp" style="display:none"></iframe><form action="/mail/cal/import.do" method="post" enctype="multipart/form-data" target="zcl_imp" onSubmit="return false;" id="zcl_impEve" name="zcl_impEve">',b+='<input id="zcl_impCkey" value="0" name="zcl_impCkey" type="hidden"/>',b+='<input id="zcl_owrEvent" value="false" name="zcl_owrEvent" type="hidden"/>',b+='<input id="zcl_incAtt" value="false" name="zcl_incAtt" type="hidden"/>',b+='<input id="zcl_incRem" value="false" name="zcl_incRem" type="hidden"/>',b+='<input id="zcl_mkPvt" value="false" name="zcl_mkPvt" type="hidden"/>',b+='<div class="SC_select default"><input type="file" id="zcl_impFil" name="zcl_impFil"/></div>',b+="</form>"),b+='<span id="zcl_impMoreOptTxt" class="cnew SC_lnk pl5">'+zcal.i18n.moreoptions+'</span><div style="display:none;" id="zcl_impMoreOpt" class="moreOptions"></div>',b+="</em></li>",b+="<li><span>"+zcal.i18n.calname+'</span><em><div class="SC_select default">'+m()+"</div></em></li>",b+='<div class="SC_PUbtm left"><span class="sel" data-marker="calImport">'+zcal.i18n.import+"</span></div>",b+="</ul>",a=$(b);var c=a.find("[data-marker=calImport]").removeAttr("data-marker");c.length&&c.on("click",{type:g},function(a){a.data.type==="url"?q():s()});var e=a.find("#zcl_impMoreOptTxt");e.off("click").on("click",function(a){k()});var h=a.find("select");h.length&&h.change(function(){var a=this.value;a==0&&ZCL_createCal()}),d.find(".SC_filt_bottom").append(a),f.empty().append(d)},k=function(){var a=$("#zcl_impMoreOpt"),b=$("#zcl_impMoreOptTxt");if(!a.is(":visible")){var c,d,e,f;c=$('<span id="zcl_impOvr"><div><i class="msi-uncheck"/><span class="pl5">'+zcal.i18n.overrideevent+"</span></div></span>"),c.off("click").on("click",function(a){var b=$(this),c;c=b.find("i"),l(c)}),a.append(c),d=$('<span id="zcl_impAtt"><div><i class="msi-uncheck"/><span class="pl5">'+zcal.i18n.includeattendees+"</span></div></span>"),d.off("click").on("click",function(a){var b=$(this),c;c=b.find("i"),l(c)}),a.append(d),e=$('<span id="zcl_impRem"><div><i class="msi-uncheck"/><span class="pl5">'+zcal.i18n.includereminder+"</span></div></span>"),e.off("click").on("click",function(a){var b=$(this),c;c=b.find("i"),l(c)}),a.append(e),f=$('<span id="zcl_impPvt"><div><i class="msi-uncheck"/><span class="pl5">'+zcal.i18n.markallasprivate+"</span></div></span>"),f.off("click").on("click",function(a){var b=$(this),c;c=b.find("i"),l(c)}),a.append(f),b.text(zcal.i18n.hideoptions),a.show()}else a.html(""),b.text(zcal.i18n.moreoptions),a.hide()},l=function(a){a.hasClass("msi-check")?a.removeClass("msi-check").addClass("msi-uncheck"):a.removeClass("msi-uncheck").addClass("msi-check")},m=function(){var a='<select id="zcl_impCal">';return a+=n(),a+="</select>",a},n=function(a){var b=zcal.cdata.calOrdArr,c,d="";return b.forEach(function(b){var c=zcal.cdata.calLst;c[b][8]=="1"&&(d+='<option value="'+c[b][9]+'" data-cid="'+b+'" '+(b==a?"selected":"")+">"+ZCL_getHTML(c[b][0])+"</option>")}),b.length<100&&(d+='<option value="0">'+zcal.i18n.newcal+"</option>"),d},o=function(a,b){var c=$("#zcl_impCal"),d;d=b&&b.calid?n(b.calid):n(),d!=""&&(c.empty(),c.html(d))},p=function(a){if(a=="")zmUtil.succErrMsg("e",zcal.i18n.failimport);else{var b=ZCL_Evl(1,a);b.PCNT==0?zmUtil.succErrMsg("e",zcal.i18n.failimport):(b.TCNT>"10000"?zmUtil.succErrMsg("e",zcal.i18n.failimport+"<br/>Unable to import as it exceeds the limit of 10000 events."):(zmUtil.succErrMsg("s",zcal.i18n.successimport+". "+zcal.i18n.totallyprocessed+" : "+(b.PCNT==undefined?0:b.PCNT)+". "+zcal.i18n.actuallyimported+" : "+(b.ACNT==undefined?0:b.ACNT)),zcalEvents.loadMonthData()),ZCL_$("zcl_impFil").value="")}},q=function(){var a,b,c,d=ZCL_$("zcl_impUrl").value.trim(),e=!1,f=!1,g=!1,h=!1,i=$("#zcl_impMoreOpt");c=/^(http|https|webcal|webcals)\:\/\/[-.\w]*(\/?)([a-zA-Z0-9\-\.\?\,\:\'\/\\\+=&amp;%\$#_@]*)?$/i;if(!c.test(d))return zmUtil.succErrMsg("e",zcal.i18n.entervalidhttpurl),!1;if(i.is(":visible")){var j=$("#zcl_impOvr").find("i"),k=$("#zcl_impAtt").find("i"),l=$("#zcl_impRem").find("i"),m=$("#zcl_impPvt").find("i");e=j.hasClass("msi-check")?!0:!1,f=k.hasClass("msi-check")?!0:!1,g=l.hasClass("msi-check")?!0:!1,h=m.hasClass("msi-check")?!0:!1}a=ZCL_$("zcl_impCal").value;if(a==undefined)return zmUtil.succErrMsg("e",zcal.i18n.selvacalnam),!1;b=$("#zcl_impCal option:selected").data("cid");var n="/cal/impurl.do?url="+encodeURIComponent(d)+"&impCkey="+a+"&incAtt="+f+"&owrEvent="+e+"&incRem="+g+"&mkPvt="+h+(b?"&calId="+b:"");ZCL_XHR(n,function(a){var b=ZCL_Evl(1,a.responseText);r(b)})},r=function(a){a==""?zmUtil.succErrMsg("e",zcal.i18n.failimport):a.PCNT==0?zmUtil.succErrMsg("e",zcal.i18n.failimport):(a.TCNT>"10000"?zmUtil.succErrMsg("e",zcal.i18n.importfailure_exceedlimit):(zmUtil.succErrMsg("s",zcal.i18n.successimport+". "+zcal.i18n.totallyprocessed+" : "+(a.PCNT==undefined?0:a.PCNT)+". "+zcal.i18n.actuallyimported+" : "+(a.ACNT==undefined?0:a.ACNT)),zcalEvents.loadMonthData()),ZCL_$("zcl_impUrl").value="")},s=function(){var a,b,c=!1,d=!1,e=!1,f=!1,g=$("#zcl_impFil").val().trim(),h=$("#zcl_impMoreOpt");b=g.substr(g.lastIndexOf("."));if(b!=".ics")return zmUtil.succErrMsg("e",zcal.i18n.validicsfile),!1;if(h.is(":visible")){var i=$("#zcl_impOvr").find("i"),j=$("#zcl_impAtt").find("i"),k=$("#zcl_impRem").find("i"),l=$("#zcl_impPvt").find("i");c=i.hasClass("msi-check")?!0:!1,d=j.hasClass("msi-check")?!0:!1,e=k.hasClass("msi-check")?!0:!1,f=l.hasClass("msi-check")?!0:!1}a=$("#zcl_impCal").val();if(a==undefined)return zmUtil.succErrMsg("e",zcal.i18n.selvacalnam),!1;$("#zcl_impCkey").val(a);var m=document.cookie,n;m=m.substring(m.indexOf("aprmjrnpkcrkks=")+15,m.length),n=m.indexOf(";")!=-1?m.substring(0,m.indexOf(";")):m,document.zcl_impEve.appendChild(_zm.getDOM(["INPUT",{attrs:{type:"hidden",name:"mstpcrdhkur",value:n}}])),$("#zcl_owrEvent").val(c),$("#zcl_incAtt").val(d),$("#zcl_incRem").val(e),$("#zcl_mkPvt").val(f),document.zcl_impEve.submit()},t=function(){zmailSettings.views.showPreview();var a=$(zmailSettings.views.getPreviewDOM());e=a.find(".SC_ptit"),i(),f=a.find(".SC_Twpr"),j()},u=function(){if(!zmsuite.isWorkspaceAvailable(b))return;t(),v()},v=function(){$.subscribe("/calendar/added",o),$.subscribe("/calendar/updated",o),$.subscribe("/calendar/deleted",o),$.subscribe("/calendar/statusChanged",o)},w=function(){c.remove(),d.remove()},x=function(){$.unsubscribe("/calendar/added",o),$.unsubscribe("/calendar/updated",o),$.unsubscribe("/calendar/deleted",o),$.unsubscribe("/calendar/statusChanged",o)},y=function(){g="file",w(),zmailSettings.currentAppName=undefined,x()};return a.init=u,a.clearTrace=y,a.showImportStatus=p,a}(zcalSettings.Import||{}),zcalSettings.Subscribe=function(a){a=a||{};var b="settings",c=[],d=[],e,f,g,h,i,j,k="weburl",l=function(){return{weburl:{text:zcal.i18n.weburl,type:"weburl",id:"zcl_subscribe_weburl",click:function(){k="weburl",t()}},friendscal:{text:zcal.i18n.friendscalendar,type:"friendscal",id:"zcl_subscribe_friendscal",click:function(){k="friendscal",t()}},holidays:{text:zcal.i18n.holidays,type:"holidays",id:"zcl_subscribe_holidays",click:function(){k="holidays",t()}}}},m=function(){e=$('<div class="SC_filt"><div class="SC_filt_Tabs"/></div>');var a=l();for(var b in a){var c=$('<a id="'+a[b].id+'"/>');c.addClass(k==a[b].type?"sel":""),c.text(a[b].text),c.off("click").on("click",{click:a[b].click},function(a){var b=$(this);b.parent().find("a").removeClass("sel"),b.addClass("sel"),a.data.click()}),e.find(".SC_filt_Tabs").append(c)}g.append(e)},n=function(a){var b=ZCL_Evl(1,a.responseText),d=b.mode;d=="list"&&(c=b.obj,q())},o=function(a,b,c){a.on("click",{uid:b,name:c},function(a){r(a.data.uid,a.data.name)})},p=function(a,b){a.on("click",{uid:b},function(a){E(a.data.uid)})},q=function(){var a=c,b=$('<ul class="SC_cal_groups" id="zcl_hlist"/>');for(var d=0;d<a.length;d++){var e=$("<li/>"),g="";g+="<span>"+ZCL_getHTML(a[d][0]),zcal.cdata.calOUids.indexOf(a[d][1])==-1?g+='<span class="button" data-marker="sub">'+zcal.i18n.subscribe+"</span>":g+='<span class="button zcl_vis" data-marker="unsub">'+zcal.i18n.unsubscribe+"</span>",g+="</span>",e.html(g);var h=e.find("[data-marker=sub]").removeAttr("data-marker");h.length&&o(h,a[d][1],a[d][0]);var k=e.find("[data-marker=unsub]").removeAttr("data-marker");k.length&&p(k,a[d][1]),b.append(e)}f.find(".SC_filt_bottom").empty().append(b),i.hide(),j.show()},r=function(a,b){var c="/cal/subHoli.do?mode=sub&huid="+encodeURIComponent(a)+"&loc="+b;ZCL_XHR(c,function(a){x(a)})},s=function(){i.show(),j.html("").hide();if(c.length==0){var a="/cal/subHoli.do?mode=list";ZCL_XHR(a,function(a){n(a)})}else q()},t=function(){f=$('<div class="SC_setInner"><div class="SC_filt_bottom" data-marker="listContainer"/><div data-marker="loadingAnimation"/></div>'),i=f.find("[data-marker=loadingAnimation]").removeAttr("data-marker"),j=f.find("[data-marker=listContainer]").removeAttr("data-marker");if(k=="holidays")h.empty().append(f),zmComponent.loadingBand({container:i[0],type:"pagination"}),s();else{var a,b;f=$('<div class="SC_setInner"><div class="SC_filt_bottom"/></div>'),b='<ul class="SC_cal_prefer">',k=="friendscal"?(b+="<li><span>"+zcal.i18n.friendemailaddress+"<span>"+zcal.i18n.friendemailaddress_msg+'</span></span><em><input type="text" class="inputDefault" id="zcl_fEmailId"></em></li>',b+='<div class="SC_PUbtm left"><span class="sel" data-marker="listFCal">'+zcal.i18n.ok+"</span></div>"):(b+="<li><span>"+zcal.i18n.weburl+"<span>"+zcal.i18n.weburl_msg+'</span></span><em><input type="text" class="inputDefault" id="zcl_subLink"></em></li>',b+='<div class="SC_PUbtm left"><span class="sel" data-marker="subToCal">'+zcal.i18n.subscribe+"</span></div>"),b+="</ul>",a=$(b);var c=a.find("[data-marker=listFCal]").removeAttr("data-marker");c.length&&c.on("click",function(a){G()});var d=a.find("[data-marker=subToCal]").removeAttr("data-marker");d.length&&d.on("click",function(a){var b=ZCL_$("zcl_subLink").value.trim();if(b=="")return _zm.succErrMsg("e",zcal.i18n.entervalidhttpurl),ZCL_$("zcl_subLink").focus(),!1;w(b)}),f.find(".SC_filt_bottom").append(a),h.empty().append(f)}},u=function(a){var b,c=$.Deferred();$("#zcl_urlsubscribe_confirm").length||$("body").append("<div id='zcl_urlsubscribe_confirm' />"),b=$("#zcl_urlsubscribe_confirm"),b.html(a);var d={title:"Do you want to add calendar?",style:{left:"500px",top:"100px"},drag:!1,mask:!0,ptr:"tright",closeaction:function(){v(),c.reject()},buttons:[{txt:"Yes",callback:function(){w(a),v(),c.resolve()}},{txt:"No",callback:function(){v(),c.reject()}}]};return zmsDialog.create("zcl_urlsubscribe_confirm",d),c.promise()},v=function(){zmsDialog.remove(!0),$("#zcl_urlsubscribe_confirm").remove()},w=function(a){var b="/cal/subCal.do?mode=sub-url&url="+encodeURIComponent(a);ZCL_XHR(b,function(a){x(a)})},x=function(a){if(a.status===200){var b=ZCL_Evl(1,a.responseText);if(b.status=="success"){var c=b.obj,d;zcal.cdata.calOLst=c.clst,zcal.cdata.calOUids=c.Uids,zcal.cdata.calGLst=c.gclst,ZCL_updateAppCalList(c.aclst),_zm.succErrMsg("s",zcal.i18n.calSubSuccess),$.publish("/calendar/subscribed"),e&&(d=e.find(".sel"),d[0].id=="zcl_subscribe_holidays"?q():d[0].id=="zcl_subscribe_friendscal"&&A())}else _zm.succErrMsg("e",zcal.i18n[b.status])}else _zm.succErrMsg("e",zcal.i18n.errmsg)},y=function(a){var b=ZCL_Evl(1,a.responseText);if(b.status=="success"){var c=b.id,d;if(zcal.cdata.calLst[c])delete zcal.cdata.calLst[c],ZCL_remCalid(c),_zm.succErrMsg("s",zcal.i18n.caldeleted);else if(zcal.cdata.calOLst[c]||zcal.cdata.calGLst[c]||zcal.cdata.calALst[c])zcal.cdata.calGLst[c]?delete zcal.cdata.calGLst[c]:zcal.cdata.calALst[c]?delete zcal.cdata.calALst[c]:delete zcal.cdata.calOLst[c],ZCL_remOCalid(b.uid),_zm.succErrMsg("s",zcal.i18n.unsubscribesuc);ZCL_gothro(c),d=e.find(".sel"),d[0].id=="zcl_subscribe_holidays"?q():d[0].id=="zcl_subscribe_friendscal"&&A()}else _zm.succErrMsg("e",b.status)},z=function(a){var b=ZCL_Evl(1,a.responseText);if(b.mode=="pub-lst")if(b.result=="du"){var c=b.obj;d=[c.pub,c.pvt,b.mid],A()}else obj.result=="su"?_zm.succErrMsg("i",zcal.i18n.cannotsubtoowncal):obj.result=="nonzoho"?_zm.succErrMsg("i",ZCL_replaceComName(zcal.i18n.theuserdonthavezohoacc)):obj.result=="np"&&_zm.succErrMsg("e",zcal.i18n.cannotsubnonorgmemcal)},A=function(){var a=d[0],b=d[1],c,e;e=f.find("#zcl_FPubCalList"),e.length||(e=$('<div id="zcl_FPubCalList"/>'),f.append(e)),e.html("<h3>"+zcal.i18n.publiccal+'</h3><ul class="SC_cal_groups"></li>'),c=e.find(".SC_cal_groups");if(!ZCL_isEmpty(a))for(var g in a){var h=$("<li/>"),i="";i+="<span>"+ZCL_getHTML(a[g][0]),zcal.cdata.calOUids.indexOf(a[g][2])==-1?i+='<span class="button" data-marker="sub">'+zcal.i18n.subscribe+"</span>":i+='<span class="button zcl_vis" data-marker="unsub">'+zcal.i18n.unsubscribe+"</span>",i+="</span>",i+="<em>"+(a[g][1]==1?zcal.i18n.viewonlyfreebusy:zcal.i18n.vieweventdetail)+"</em>",h.html(i);var j=h.find("[data-marker=sub]").removeAttr("data-marker");j.length&&j.on("click",{id:g},function(a){C(a.data.id)});var k=h.find("[data-marker=unsub]").removeAttr("data-marker");k.length&&k.on("click",{uid:a[g][2]},function(a){E(a.data.uid)}),c.append(h)}else{var l="<li><em>"+zcal.i18n.calnotfound+"</em></li>";c.html(l)}if(!ZCL_isEmpty(b)){var m,n;m=f.find("#zcl_FPvtCalList"),m.length||(m=$('<div id="zcl_FPvtCalList"/>'),f.append(m)),m.html("<h3>"+zcal.i18n.privatecal+'</h3><ul class="SC_cal_groups"/>'),n=m.find(".SC_cal_groups");for(var g in b){var h=$("<li/>"),i="";i+="<span>"+ZCL_getHTML(b[g][0]),zcal.cdata.calOUids.indexOf(b[g][2])==-1?i+='<span class="button" data-marker="sub">'+zcal.i18n.subscribe+"</span>":i+='<span class="button zcl_vis" data-marker="unsub">'+zcal.i18n.unsubscribe+"</span>",i+="</span>",i+="<em>"+(b[g][1]==1?zcal.i18n.viewonlyfreebusy:zcal.i18n.vieweventdetail)+"</em>",h.html(i);var j=h.find("[data-marker=sub]").removeAttr("data-marker");j.length&&j.on("click",{id:g},function(a){D(a.data.id)});var k=h.find("[data-marker=unsub]").removeAttr("data-marker");k.length&&k.on("click",{uid:b[g][2]},function(a){E(a.data.uid)}),n.append(h)}}var o=f.find("#zcl_pvtshreqlnk");o.length||(o=$('<span class="SC_lnk" id="zcl_pvtshreqlnk"/>'),f.append(o)),o.html("&raquo;"+zcal.i18n.sendreqforindividualshare),o.off("click").on("click",{eid:d[2]},function(a){B(a.data.eid)}),f.append(o)},B=function(a){var b="/cal/sentReq.do?mailId="+a.zcalescape();ZCL_XHR(b,function(a){F(a)})},C=function(a){var b="/cal/subCal.do?mode=sub-url&url="+encodeURIComponent(location.protocol+"//"+zcal.ZCAL+"/ical/"+a);ZCL_XHR(b,function(a){x(a)})},D=function(a){var b=d[1];ZCL_XHR("/cal/shareCal.do?mode=pvtshcal-sub&ckey="+b[a][4],function(a){x(a)})},E=function(a){ZCL_XHR("/cal/calAct.do?mode=delByUid&caluid="+encodeURIComponent(a),function(a){y(a)})},F=function(a){_zm.succErrMsg("s",zcal.i18n.requestmailsent)},G=function(){var a=$("#zcl_fEmailId").val();if(!ZCL_isEmail(a))return _zm.succErrMsg("e",zcal.i18n.entervalidemailid),ZCL_$("zcl_fEmailId").focus(),!1;ZCL_XHR("/cal/subCal.do?mode=pub-lst&mailId="+a.zcalescape(),function(a){z(a)})},H=function(){zmailSettings.views.showPreview();var a=$(zmailSettings.views.getPreviewDOM());g=a.find(".SC_ptit"),m(),h=a.find(".SC_Twpr"),t()},I=function(){if(!zmsuite.isWorkspaceAvailable(b))return;H()},J=function(){e.remove(),f.remove()},K=function(){k="weburl",J(),zmailSettings.currentAppName=undefined};return a.init=I,a.clearTrace=K,a.confirmAndSubscribe=u,a}(zcalSettings.Subscribe||{}),zcalSettings.Sync=function(a){a=a||{};var b="settings",c,d,e,f,g,h,i=[],j=1,k=!1,l=null,m=0,n=function(){var a={};return zcal.ZCAL.indexOf("zoho")!=-1&&zcal.ZCAL.indexOf("zoho.com.cn")==-1&&zcal.ZCAL.indexOf("baihui")==-1&&(a.outlook={text:zcal.i18n.outlook,msg:ZCL_replaceProName(zcal.i18n.outlook_subnote),type:"outlook",click:function(){p()}}),zcal.ZCAL.indexOf("zoho.com.cn")==-1&&zcal.ZCAL.indexOf("baihui")==-1&&(a.gcal={text:zcal.i18n.gcal,msg:ZCL_replaceProName(zcal.i18n.gcal_subnote),type:"gcal",click:function(){p()}}),a.caldav={text:zcal.i18n.caldav,msg:ZCL_replaceProName(zcal.i18n.caldav_subnote),type:"caldav",click:function(){p()}},zcal.ZCAL.indexOf("zoho.com.cn")==-1&&zcal.ZCAL.indexOf("baihui")==-1&&(a.zcalsync={text:ZCL_replaceComName(zcal.i18n.zcalsync),msg:ZCL_replaceProName(zcal.i18n.zcalsync_subnote),type:"zcalsync",click:function(){p()}}),a},o=function(){c=$('<div class="SC_settHead"><div class="SC_phd">'+zcal.i18n.sync+"</div></div>"),e.append(c)},p=function(){d=$('<div class="SC_setInner"><div class="SC_filt_bottom"><ul class="SC_cal_groups"/></div></div>');var a=d.find(".SC_cal_groups"),b=n();for(var c in b){var e=b[c],g=$("<li/>");g.html("<span>"+e.text+"</span><em>"+e.msg+"</em>"),g.on("click",{type:e.type},function(a){q(a.data.type)}),a.append(g)}f.empty().append(d)},q=function(a){a==="caldav"?s():a==="gcal"?u():a==="outlook"?D():a==="zcalsync"&&r()},r=function(){var a="https://"+zcal.ZOHOSTATIC+"/help/user-guide/calsync-android.html";window.open(a,"_blank")},s=function(){var a;ZCL_$("zcl_caldav_pp")||$("body").append("<div id='zcl_caldav_pp'/>"),a=$("#zcl_caldav_pp"),a.html('<div><div class="SC_filt_bottom zcl_cdavovr" data-marker="listContainer"/><div data-marker="loadingAnimation"/></div>'),g=a.find("[data-marker=loadingAnimation]").removeAttr("data-marker"),h=a.find("[data-marker=listContainer]").removeAttr("data-marker");var b={title:zcal.i18n.caldav_help,mask:!0,drag:!1,mask:!0,ptr:"tright",pos:"center",style:{"min-width":"600px","max-width":"750px"},customClass:"SC_SetPop",buttons:[{txt:zcal.i18n.ok,callback:function(){$("#zcl_caldav_pp").remove(),zmsDialog.remove(!0)}}],closeaction:function(){$("#zcl_caldav_pp").remove(),zmsDialog.remove()}};zmsDialog.create("zcl_caldav_pp",b),zmComponent.loadingBand({container:g[0],type:"pagination"}),g.show(),h.html("").hide(),ZCL_XHR("/cal/caldavCalLst.do?mode=callist",function(a){var b=ZCL_Evl(1,a.responseText);t(b)})},t=function(a){h.empty();var b=$('<div class="SC_cal_groups"><ul></ul></div>');for(var c in a){var d=a[c],e=ZCL_getHTML(d.NAME),f=d.SHOWHIDE==1?!0:!1,i=d.CALID,j=d.ISDEF==1?!0:!1,k=d.SYNC==1?!0:!1,l=$('<li class="'+(f?"":"disable")+'"><i class="'+(j||k?"msi-check":"msi-uncheck")+'"></i><span>'+e+"</span></li>");j||l.off("click").on("click",{calid:i},function(a){var b=a.data.calid,c=$(this),d,e;d=c.find("i"),d[0].className=="msi-uncheck"?d.removeClass("msi-uncheck").addClass("msi-check"):d.removeClass("msi-check").addClass("msi-uncheck"),e=d[0].className=="msi-check"?"enable":"disable",ZCL_XHR("/cal/enablecaldav.do?mode="+e+"&calid="+b,function(a){var b=ZCL_Evl(1,a.responseText)})}),b.find("ul").append(l)}h.append(b),g.hide(),h.show()},u=function(){var a;ZCL_$("zcl_gcal_pp")||$("body").append("<div id='zcl_gcal_pp'/>"),a=$("#zcl_gcal_pp"),a.html('<div><div data-marker="loadingAnimation"/><div><ul class="SC_cal_groups SC_setInner zcl_ovr" id="zcl_gcallst"/><div/></div>'),g=a.find("[data-marker=loadingAnimation]").removeAttr("data-marker");var b={title:zcal.i18n.gcal,mask:!0,drag:!1,mask:!0,ptr:"tright",pos:"center",style:{"min-width":"600px","max-width":"750px"},customClass:"SC_SetPop",closeaction:function(){$("#zcl_gcal_pp").remove(),zmsDialog.remove()}};zmsDialog.create("zcl_gcal_pp",b),i&&i.length>0?x():(zmComponent.loadingBand({container:g[0],type:"pagination"}),g.show(),ZCL_XHR("/cal/getGCal.do?mode=auth",function(a){i=ZCL_Evl(1,a.responseText),v()}))},v=function(){if(!i){var a=document.location.protocol+"//"+zcal.ZCAL,b=function(c){var d=c.origin||c.originalEvent.origin;d===a&&(w(),c.source.close(),window.addEventListener?window.removeEventListener("message",b,!1):window.detachEvent("onmessage",b))};window.addEventListener?window.addEventListener("message",b,!1):window.attachEvent("onmessage",b);var c=(document.body.offsetHeight-500)/2,d=(document.body.offsetWidth-700)/2,e="GoogleAuthenticationWindow_"+location.hostname.split(".")[0];k=window.open(zcal.GCALSYNC,e,"menubar=no,toolbar=no,location=no,status=no,scrollbars=yes,resizable=no,width=700,height=500,left="+d+",top="+c),l||(l=setTimeout(function(){checkGCalWinStatus()},5e3))}else g.hide(),x()};checkGCalWinStatus=function(){l&&clearTimeout(l),j==12||k.closed?(k&&k.close(),$("#zcl_gcal_pp").length>0&&(zmsDialog.remove(),$("#zcl_gcal_pp").remove()),j=1,l=null,k=!1):(j++,l=setTimeout(function(){checkGCalWinStatus()},5e3))};var w=function(){l&&clearTimeout(l),ZCL_XHR("/cal/getGCal.do?mode=list",function(a){i=ZCL_Evl(1,a.responseText),v()})},x=function(){if(i&&i.length>0){var a=$("#zcl_gcallst");if(a.length>0){a.empty();for(var b=0;b<i.length;b++){var c=$("<li/>"),d="";i[b].gcalName=i[b].gcalName.replace("<","&lt;").replace(">","&gt;"),d+='<span id="zcl_synccal">'+i[b].gcalName,zcal.cdata.calOUids.indexOf("gCal_"+decodeURIComponent(i[b].gcalId))==-1?d+='<span class="button" data-marker="sub">'+zcal.i18n.synchronize+"</span>":d+='<span class="button zcl_vis" data-marker="unsub">'+zcal.i18n.unsynchronize+"</span>",d+="</span>",m===1&&(c.addClass("zcl_disls"),d+='<s id="zcl_syncstatus">'+zcal.i18n.syncmsg+"</s>"),c.html(d);var e=c.find("[data-marker=sub]").removeAttr("data-marker");e.length&&y(e,{gcalId:i[b].gcalId,gcalName:i[b].gcalName,authMail:i[b].authMail});var f=c.find("[data-marker=unsub]").removeAttr("data-marker");f.length&&z(f,{gcalId:i[b].gcalId,gcalName:i[b].gcalName,authMail:i[b].authMail}),a.append(c)}}}},y=function(a,b){a.off("click").on("click",{calid:b.gcalId,calname:b.gcalName,email:b.authMail},function(a){C(),ZCL_XHR("/cal/getGCal.do?mode=sub&calId="+a.data.calid+"&calName="+a.data.calname+"&ownerMailID="+a.data.email,A)})},z=function(a,b){a.off("click").on("click",{calid:b.gcalId,calname:b.gcalName},function(a){ZCL_XHR("/cal/getGCal.do?mode=unsub&calId="+a.data.calid+"&calName="+a.data.calname,function(a){var b=ZCL_Evl(1,a.responseText);b.status=="success"&&(m=0,i=null,$("#zcl_gcal_pp").length>0&&(zmsDialog.remove(),$("#zcl_gcal_pp").remove()),$.publish("/calendar/deleted",{calid:b.id,caluid:b.uid,mode:"delete"}))})})},A=function(a){ZCL_clrStck();if(a.status==200){var b=ZCL_Evl(1,a.responseText);if(b.status=="success"){var c=b.obj;zcal.cdata.calOLst=c.clst,zcal.cdata.calOUids=c.Uids,zcal.cdata.calGLst=c.gclst,ZCL_updateAppCalList(c.aclst),$.publish("/calendar/subscribed")}}},B=function(a){m=a},C=function(){var a=$("#zcl_gcallst");B(1);var b,c=a.find("#zcl_synccal");a.find("#zcl_syncstatus").length==0&&c.after($('<s id="zcl_syncstatus">'+zcal.i18n.syncmsg+"</s>")),b=a.find("#zcl_syncstatus"),b.parent().addClass("zcl_disls"),c.find("span.button").off("click")},D=function(){var a=$(zcalTemplate.OutlookPopup());a.find("a").addClass("SC_lnk");var b={title:ZCL_replaceProName(zcal.i18n.mstitle),mask:!0,drag:!1,mask:!0,ptr:"tright",pos:"center",style:{"min-width":"600px","max-width":"750px"},customClass:"SC_SetPop",closeaction:function(){$("#zcl_grpcallst_pp").remove(),zmsDialog.remove()}};ZCL_$("zcl_olpp")||$("body").append('<div id="zcl_olpp"></div>'),$("#zcl_olpp").html(a),zmsDialog.create("zcl_olpp",b)},E=function(){zmailSettings.views.showPreview();var a=$(zmailSettings.views.getPreviewDOM());e=a.find(".SC_ptit"),o(),f=a.find(".SC_Twpr"),p()},F=function(){if(!zmsuite.isWorkspaceAvailable(b))return;E()},G=function(){c.remove(),d.remove()},H=function(){G(),zmailSettings.currentAppName=undefined};return a.init=F,a.clearTrace=H,a.reqGCalList=w,a.setGCalSyncStatus=B,a.listGCal=x,a}(zcalSettings.Sync||{}),zcalSettings.zcalGroupList=function(a){a=a||{};var b="settings",c={},d,e,f,g,h,i="personal",j=function(){return{personal:{text:zcal.i18n.personal_group,type:"personal",id:"zcl_group_personal",click:function(){i="personal",m()}},org:{text:zcal.i18n.org_group,type:"org",id:"zcl_group_org",click:function(){i="org",m()}}}},k=function(){e=$('<div class="SC_filt"><div class="SC_filt_Tabs"/></div>');var a=j();for(var b in a){var c=$('<a id="'+a[b].id+'"/>');c.addClass(i==a[b].type?"sel":""),c.text(a[b].text),c.off("click").on("click",{click:a[b].click},function(a){var b=$(this);b.parent().find("a").removeClass("sel"),b.addClass("sel"),a.data.click()}),e.find(".SC_filt_Tabs").append(c)}g.append(e)},l=function(a,b,c){a.on("click",{id:b,name:c},function(a){d=a.data.name,q(a.data.id)})},m=function(){var a,b;f=$('<div class="SC_setInner"><div class="SC_filt_bottom"><ul class="SC_cal_groups"/></div></div>'),a=f.find(".SC_cal_groups"),b=zcalGroup.getGroupList(i);for(var c=0;c<b.length;c++){var d=zcalGroup.getGroup(b[c]);if(d){var e=$("<li/>"),g=ZCL_getHTML(d.name);e.html("<span>"+g+"</span><em>"+ZCL_getDescHTML(d.desc)+"</em>"),l(e,b[c],g),a.append(e)}}h.empty().append(f)},n=function(a){var b=$.Deferred();return ZCL_XHR("/cal/grpDtl.do?mode=grp-callst&comid="+a,function(a){c=ZCL_Evl(1,a.responseText),b.resolve(c)}),b},o=function(a){var b=ZCL_Evl(1,a.responseText);if(b.status=="success"){var c=b.obj,d,e,f=b.uid;zcal.cdata.calOLst=c.clst,zcal.cdata.calOUids=c.Uids,zcal.cdata.calGLst=c.gclst,ZCL_updateAppCalList(c.aclst),_zm.succErrMsg("s",zcal.i18n.calSubSuccess),updateGrpCalLst(f),d=$("#zcl_grpcallst_tabs"),e=d.find(".sel"),e[0].id=="zcl_grpcal_sh"?t("sh"):e[0].id=="zcl_grpcal_sub"?t("sub"):t("def"),$.publish("/calendar/subscribed")}else b.status=="available"?_zm.succErrMsg("s",zcal.i18n.calSubSuccess):_zm.succErrMsg("e",b.status)};updateGrpCalLst=function(a){if(!ZCL_isEmpty(c)){if(c.owncLst&&c.owncLst[a]){c.owncLst[a].IS_SUB=c.owncLst[a].IS_SUB==0?1:0;return}if(c.shdcLst&&c.shdcLst[a]){c.shdcLst[a].IS_SUB=c.shdcLst[a].IS_SUB==0?1:0;return}c.subcLst&&c.subcLst[a]&&(c.subcLst[a].IS_SUB=c.subcLst[a].IS_SUB==0?1:0)}};var p=function(a){var b=ZCL_Evl(1,a.responseText);if(b.status=="success"){var c=b.id,d,e,f=b.uid;$.publish("/calendar/deleted",{calid:c,caluid:f,mode:"unsubscribe"}),updateGrpCalLst(f);var d=$("#zcl_grpcallst_tabs"),e=d.find(".sel");e[0].id=="zcl_grpcal_sh"?t("sh"):e[0].id=="zcl_grpcal_sub"?t("sub"):t("def")}else _zm.succErrMsg("e",b.status)},q=function(a){var b;ZCL_$("zcl_grpcallst_pp")||$("body").append("<div id='zcl_grpcallst_pp' class='zcl_ovr'/>"),b=$("#zcl_grpcallst_pp"),b.html('<div><div class="SC_filt_Tabs none" id="zcl_grpcallst_tabs"></div><div data-marker="loadingAnimation"></div><div id="zcl_heigGrp" ><ul class="SC_cal_groups SC_setInner zcl_ovr" id="zcl_grpcallst"/></div></div>'),$loadAnimationDOM=b.find("[data-marker=loadingAnimation]").removeAttr("data-marker"),s();var c={title:d,mask:!0,drag:!1,ptr:"tright",pos:"center",style:{"min-width":"600px","max-width":"750px"},customClass:"SC_SetPop",closeaction:function(){$("#zcl_grpcallst_pp").remove(),zmsDialog.remove()}};zmsDialog.create("zcl_grpcallst_pp",c),zmComponent.loadingBand({container:$loadAnimationDOM[0],type:"pagination"}),$loadAnimationDOM.show(),$.when(n(a)).then(function(a){$loadAnimationDOM.hide(),t("def")})},r=function(a,b){a.off("click").on("click",{type:b},function(a){var b=$(this);b.parent().find("a").removeClass("sel"),b.addClass("sel"),t(a.data.type)})},s=function(){var a=$("#zcl_grpcallst_tabs"),b="def",c=[{type:"def",text:zcal.i18n.default},{type:"sh",text:zcal.i18n.shared},{type:"sub",text:zcal.i18n.subscribed}];for(var d=0;d<c.length;d++){var e=$('<a id="zcl_grpcal_'+c[d].type+'"/>');e.addClass(c[d].type==b?"sel":""),e.text(c[d].text),r(e,c[d].type),a.append(e)}},t=function(a){var b,d=$("#zcl_grpcallst");a=="sh"?b=c.shdcLst:a=="sub"?b=c.subcLst:b=c.owncLst,d.empty(),Object.keys(c.shdcLst).length>5&&$("#zcl_heigGrp").css({height:"300px","overflow-x":"hidden","overflow-y":"auto"});if(!ZCL_isEmpty(b))for(var e in b){var f=b[e],g=$("<li/>"),h="";h+="<span>"+f.CNAME,f.IS_SUB==0?h+='<span class="button" data-marker="sub">'+zcal.i18n.subscribe+"</span>":h+='<span class="button zcl_vis" data-marker="unsub">'+zcal.i18n.unsubscribe+"</span>",h+="</span>",g.html(h);var i=g.find("[data-marker=sub]").removeAttr("data-marker");i.length&&i.on("click",{uid:e,gid:c.comid},function(a){u(a.data.uid,a.data.gid)});var j=g.find("[data-marker=unsub]").removeAttr("data-marker");j.length&&j.on("click",{uid:e},function(a){v(a.data.uid)}),d.append(g)}else if(d.is(":empty")){var g=$("<li><em>"+zcal.i18n.nocalendar+"</em></li>");d.append(g)}},u=function(a,b){var c="/cal/subCal.do?mode=grpcal-sub&caluid="+encodeURIComponent(a)+"&grpid="+b;ZCL_XHR(c,o)},v=function(a){ZCL_XHR("/cal/calAct.do?mode=delByUid&caluid="+encodeURIComponent(a),p)},w=function(){zmailSettings.views.showPreview();var a=$(zmailSettings.views.getPreviewDOM());g=a.find(".SC_ptit"),k(),h=a.find(".SC_Twpr"),m()},x=function(){if(!zmsuite.isWorkspaceAvailable(b))return;w()},y=function(){e.remove(),f.remove()},z=function(){i="personal",y(),zmailSettings.currentAppName=undefined};return a.init=x,a.clearTrace=z,a}(zcalSettings.zcalGroupList),zcalSettings.appList=function(a){a=a||{};var b="settings",c,d,e,f,g,h,i={},j,k,l,m,n=function(){return{zcrm:{text:ZCL_replaceComName(zcal.i18n.zohocrm),msg:zcal.i18n.sync,type:"crm",click:function(){p()}},zrecruit:{text:ZCL_replaceComName(zcal.i18n.zohorecruit),msg:zcal.i18n.sync,type:"recruit",click:function(){p()}},ztask:{text:ZCL_replaceComName(zcal.i18n.zohotask),msg:zcal.i18n.sync,type:"task-sync",click:function(){p()}},zprojects:{text:ZCL_replaceComName(zcal.i18n.zohoprojects),msg:zcal.i18n.subscribe,type:"project",click:function(){p()}},zcontacts:{text:ZCL_replaceComName(zcal.i18n.zohocontacts),msg:zcal.i18n.subscribe,type:"contacts",click:function(){p()}}}},o=function(){c=$('<div class="SC_settHead"><div class="SC_phd">'+ZCL_replaceComName(zcal.i18n.zohoapps)+"</div></div>"),e.append(c)},p=function(){d=$('<div class="SC_setInner"><div class="SC_filt_bottom"><ul class="SC_cal_groups"/></div></div>');var a=d.find(".SC_cal_groups"),b=n();for(var c in b){var e=b[c],g;if(e.type=="crm"&&zcal.ZCRM!=""||e.type=="recruit"&&zcal.ZRECRUIT!=""||e.type=="task-sync"&&zcal.ZTSK!=""||e.type=="project"||e.type=="contacts")i[e.type]==="error"?g=$('<li class="zcl_disable"/>'):g=$("<li/>"),g.html("<span>"+e.text+"</span><em>"+e.msg+"</em>"),g.hasClass("zcl_disable")||g.on("click",{type:e.type,txt:e.text},function(a){q(a.data.type,a.data.txt)}),a.append(g)}f.empty().append(d)},q=function(a,b){var c;ZCL_$("zcl_appcallst_pp")||$("body").append("<div id='zcl_appcallst_pp' class='zcl_ovr'/>"),c=$("#zcl_appcallst_pp"),c.html('<div><div data-marker="loadingAnimation"></div><div><ul class="SC_cal_groups SC_setInner zcl_ovr" id="zcl_appcallst" data-app="'+a+'"/></div>'+"</div>"),g=c.find("[data-marker=loadingAnimation]").removeAttr("data-marker");var d={title:b,mask:!0,drag:!1,ptr:"tright",pos:"center",style:{"min-width":"600px","max-width":"750px"},customClass:"SC_SetPop",closeaction:function(){$("#zcl_appcallst_pp").remove(),zmsDialog.remove()}};zmsDialog.create("zcl_appcallst_pp",d),zmComponent.loadingBand({container:g[0],type:"pagination"}),g.show(),ZCL_uXHR("/cal/getPortal.do?mode="+a,function(b){g.hide(),r(a,b)})},r=function(a,b){if(a=="contacts"){var c=b.getElementsByTagName("status")[0].firstChild.nodeValue;if(c=="ok")t();else{i.contacts="error";var d=c=="503"?zcal.i18n.subscribeunavailable:ZCL_replaceComName(zcal.i18n.noacc_inzcontact);s(d)}}else if(a=="task-sync"){m=ZCL_Evl(1,b.getElementsByTagName("obj")[0].firstChild.nodeValue);if(m.status=="in-process"||m.status=="success")u();else{i.task="error";var d=m=="503"?zcal.i18n.subscribeunavailable:ZCL_replaceComName(zcal.i18n.noacc_inztask);s(d)}}else if(a=="project"){var e=b.getElementsByTagName("obj")[0].firstChild.nodeValue;if(e!="503"&&e!="Empty result set"&&e!="error")j=ZCL_Evl(1,e),v();else{i.project="error";var d=e=="503"?zcal.i18n.subscribeunavailable:ZCL_replaceComName(zcal.i18n.noacc_inzproject);s(d)}}else if(a=="crm"){k=ZCL_Evl(1,b.getElementsByTagName("obj")[0].firstChild.nodeValue);if(k.status=="in-process"||k.status=="success")x();else{i.crm="error";var d=k.status=="503"?zcal.i18n.subscribeunavailable:k.status=="sync-noperm"?ZCL_replaceComName(zcal.i18n.crmcal_noperm):ZCL_replaceComName(zcal.i18n.noacc_inzcrm);s(d)}}else if(a=="recruit"){l=ZCL_Evl(1,b.getElementsByTagName("obj")[0].firstChild.nodeValue);var f=l.obj.VERSION;if(l.obj!="503"&&l.obj!="error")y();else{i.recruit="error";var d=l.obj=="503"?zcal.i18n.subscribeunavailable:ZCL_replaceComName(zcal.i18n.noacc_inzrecruit);s(d)}}},s=function(a){var b=$("#zcl_appcallst").parent();b.empty(),b.append(a),p()},t=function(){var a=$("#zcl_appcallst");a.empty();var b=$("<li/>"),c="";c+="<span>"+zcal.i18n.contactscal,zcal.cdata.calOUids.indexOf("zohoContacts_")==-1?c+='<span class="button" data-marker="sub">'+zcal.i18n.subscribe+"</span>":c+='<span class="button zcl_vis" data-marker="unsub">'+zcal.i18n.unsubscribe+"</span>",c+="</span>",b.html(c);var d=b.find("[data-marker=sub]").removeAttr("data-marker");d.length&&d.on("click",function(a){ZCL_XHR("/cal/subCal.do?mode=contactcal-sub",A)});var e=b.find("[data-marker=unsub]").removeAttr("data-marker");if(e.length){var f=zcal.cdata.calOUids.substring(zcal.cdata.calOUids.indexOf("zohoContacts_"));f=f.indexOf(",")!=-1?f.substring(0,f.indexOf(",")):f,e.on("click",{uid:f,mode:"contacts"},function(a){C(a.data.uid,a.data.mode)})}a.append(b)},u=function(){var a=$("#zcl_appcallst");a.empty();var b=$("<li/>"),c="";c+="<span>"+ZCL_replaceComName(zcal.i18n.zohotask),zcal.cdata.calOUids.indexOf("zohoTask_")==-1?c+='<span class="button" data-marker="sub">'+zcal.i18n.synchronize+"</span>":c+='<span class="button zcl_vis" data-marker="unsub">'+(m.isOldTaskSubscribed?zcal.i18n.unsubscribe:zcal.i18n.unsynchronize)+"</span>",c+="</span>",m.status=="in-process"&&(b.addClass("zcl_disls"),c+='<s id="zcl_syncstatus">'+zcal.i18n.syncmsg+"</s>"),b.html(c);var d=b.find("[data-marker=sub]").removeAttr("data-marker");d.length&&d.on("click",function(a){ZCL_XHR("/cal/subCal.do?mode=task-sync",A)});var e=b.find("[data-marker=unsub]").removeAttr("data-marker");if(e.length){var f=zcal.cdata.calOUids.substring(zcal.cdata.calOUids.indexOf("zohoTask_"));f=f.indexOf(",")!=-1?f.substring(0,f.indexOf(",")):f,e.on("click",{uid:f,mode:"task"},function(a){C(a.data.uid,a.data.mode)})}a.append(b)},v=function(){var a=$("#zcl_appcallst"),b=j;a.empty();for(var c in b){var d=$("<li/>"),e="";e+="<span>"+ZCL_getHTML(b[c].portal),zcal.cdata.calOUids.indexOf("zohoProject_"+b[c].portal_zoid)==-1?e+='<span class="button" data-marker="sub">'+zcal.i18n.subscribe+"</span>":e+='<span class="button zcl_vis" data-marker="unsub">'+zcal.i18n.unsubscribe+"</span>",e+="</span>",d.html(e);var f=d.find("[data-marker=sub]").removeAttr("data-marker");f.length&&f.on("click",function(a){ZCL_XHR("/cal/subCal.do?mode=project-sub&portal="+b[c].portal+"&portalId="+encodeURIComponent(b[c].portal_zoid),A)});var g=d.find("[data-marker=unsub]").removeAttr("data-marker");g.length&&g.on("click",{uid:"zohoProject_"+b[c].portal_zoid,mode:"project"},function(a){C(a.data.uid,a.data.mode)}),a.append(d)}},w=function(a){var b,c=a.find("#zcl_synccal");a.find("#zcl_syncstatus").length==0&&c.after($('<s id="zcl_syncstatus">'+zcal.i18n.syncmsg+"</s>")),b=a.find("#zcl_syncstatus"),b.parent().addClass("zcl_disls"),c.find("span.button").off("click")},x=function(){var a=$("#zcl_appcallst");if(a.length>0){a.empty();var b=$("<li/>"),c="";c+='<span id="zcl_synccal">'+ZCL_replaceComName(zcal.i18n.crmcal),zcal.cdata.calOUids.indexOf("zohoCrm_")==-1?c+='<span class="button" data-marker="sub">'+zcal.i18n.synchronize+"</span>":c+='<span class="button zcl_vis" data-marker="unsub">'+zcal.i18n.unsynchronize+"</span>",c+="</span>",k.status=="in-process"&&(b.addClass("zcl_disls"),c+='<s id="zcl_syncstatus">'+zcal.i18n.syncmsg+"</s>"),b.html(c);var d=b.find("[data-marker=sub]").removeAttr("data-marker");d.length&&d.off("click").on("click",{soid:k.obj.ZSOID},function(b){w(a),ZCL_XHR("/cal/subCal.do?mode=crm-sync&crmid="+b.data.soid,z)});var e=b.find("[data-marker=unsub]").removeAttr("data-marker");if(e.length){var f=zcal.cdata.calOUids.substring(zcal.cdata.calOUids.indexOf("zohoCrm_"));f=f.indexOf(",")!=-1?f.substring(0,f.indexOf(",")):f,e.off("click").on("click",{uid:f,mode:"crm"},function(a){C(a.data.uid,a.data.mode)})}a.append(b)}},y=function(){var a=$("#zcl_appcallst"),b=l.obj.VERSION;a.empty();var c=$("<li/>"),d="";d+="<span>"+ZCL_replaceComName(zcal.i18n.recruitcal),b=="new"?zcal.cdata.calOUids.indexOf("zohoRecruit4_")==-1?d+='<span class="button" data-marker="sub">'+zcal.i18n.synchronize+"</span>":d+='<span class="button zcl_vis" data-marker="unsub">'+zcal.i18n.unsynchronize+"</span>":zcal.cdata.calOUids.indexOf("zohoRecruit_")==-1?d+='<span class="button" data-marker="sub">'+zcal.i18n.subscribe+"</span>":d+='<span class="button zcl_vis" data-marker="unsub">'+zcal.i18n.unsubscribe+"</span>",d+="</span>",c.html(d);var e=c.find("[data-marker=sub]").removeAttr("data-marker");e.length&&e.off("click").on("click",{soid:l.obj.ZSOID},function(a){ZCL_XHR("/cal/subCal.do?mode=recruitcal-sub&recid="+a.data.soid,A)});var f=c.find("[data-marker=unsub]").removeAttr("data-marker");if(f.length){var g=zcal.cdata.calOUids.substring(zcal.cdata.calOUids.indexOf("zohoRecruit"));g=g.indexOf(",")!=-1?g.substring(0,g.indexOf(",")):g,f.on("click",{uid:g,mode:"recruit"},function(a){C(a.data.uid,a.data.mode)})}a.append(c)},z=function(a){ZCL_clrStck();if(a.status==200){var b=ZCL_Evl(1,a.responseText);if(b.status=="success"){if(b.sync_mode=="sync-initiated")b.sync_status=="in-process"?k.status=b.sync_status:(k.status="success",setTimeout(function(){_zm.succErrMsg("s",zcal.i18n.synccompmsg)},2e3));else if(b.sync_status=="success"){k.status=b.sync_status;var c=b.obj;zcal.cdata.calOLst=c.clst,zcal.cdata.calOUids=c.Uids,zcal.cdata.calGLst=c.gclst,zcal.cdata.calALst=c.aclst,ZCL_updateAppCalList(c.aclst),setTimeout(function(){_zm.succErrMsg("s",zcal.i18n.synccompmsg)},2e3),zcalCRM.loadCRMUsers()}else b.sync_status=="in-process"?k.status=b.sync_status:setTimeout(function(){_zm.succErrMsg("e",ZCL_replaceComName(zcal.i18n.crmcal_syncfailed))},2e3);x(),$.publish("/calendar/subscribed")}else setTimeout(function(){_zm.succErrMsg("e",ZCL_replaceComName(zcal.i18n.crmcal_syncfailed))},2e3)}},A=function(a){var b=ZCL_Evl(1,a.responseText);if(b.status=="success"){var c=b.obj,d=b.mode,e=b.uid;zcal.cdata.calOLst=c.clst,zcal.cdata.calOUids=c.Uids,zcal.cdata.calGLst=c.gclst,zcal.cdata.calALst=c.aclst,ZCL_updateAppCalList(c.aclst),d==="contactcal-sub"?(_zm.succErrMsg("s",zcal.i18n.calSubSuccess),t()):d==="project-sub"?(_zm.succErrMsg("s",zcal.i18n.calSubSuccess),v()):d==="task-sync"?(b.sync_status=="completed"?(m.status="success",_zm.succErrMsg("s",zcal.i18n.synccompmsg)):b.sync_status=="in-process"&&(m.status="in-process"),u()):d=="recruitcal-sub"&&(_zm.succErrMsg("s",zcal.i18n.synccompmsg),y()),$.publish("/calendar/subscribed")}},B=function(a,b){var c=ZCL_Evl(1,a.responseText);if(c.status=="success"){var d=c.id,e=c.uid;$.publish("/calendar/deleted",{calid:d,caluid:e,mode:"unsubscribe"}),b==="contacts"?t():b==="project"?v():b==="task"?u():b==="crm"?x():b==="recruit"&&y()}else _zm.succErrMsg("e",c.status)},C=function(a,b){ZCL_XHR("/cal/calAct.do?mode=delByUid&caluid="+encodeURIComponent(a),function(a){B(a,b)})},D=function(){zmailSettings.views.showPreview();var a=$(zmailSettings.views.getPreviewDOM());e=a.find(".SC_ptit"),o(),f=a.find(".SC_Twpr"),p()},E=function(){if(!zmsuite.isWorkspaceAvailable(b))return;D()},F=function(){c.remove(),d.remove()},G=function(){F(),zmailSettings.currentAppName=undefined},H=function(a){k.status=a},I=function(){k.status="success",_zm.succErrMsg("e",ZCL_replaceComName(zcal.i18n.crmcal_syncfailed)),x()},J=function(a){m.status=a};return a.init=E,a.clearTrace=G,a.setCrmSyncStatus=H,a.setCrmSyncFailedStatus=I,a.listCrmCal=x,a.listTaskCal=u,a.listRecruitCal=y,a.setTaskSyncStatus=J,a}(zcalSettings.appList||{}),zcalSettings.ownCalList=function(a){a=a||{};var b="settings",c,d,e,f,g,h="106px",i,j,k,l=function(){c=$('<div class="SC_settHead"><div class="SC_phd">'+zcal.i18n.mycalendars+"</div></div>"),f.append(c)},m=function(){j=zcal.cdata.calOrdArr,k=zcal.cdata.calLst,e.empty(),j.forEach(function(a){k[a]&&n(a,k[a])});if(i&&i.action==="share"){var a=i.id,b,c;b=d.find("[data-id="+a+"]"),b.length>0&&(c=b.find("[data-id=sh]"),o(c,b,a,k[a]))}},n=function(a,b){var c,d,f,g,h,i,j,k=$('<div class="zmL '+(b[8]==1?"":"disableFilter")+'" data-id="'+a+'"><ul></ul></div>'),l=ZCL_getCalColor(b[1])[1],m=ZCL_getHTML(b[0]),n=$('<li><div style="background-color:'+l+'" class="SClbl"><i class="'+(b[2]==1?"msi-tick":"")+'"></i></div></li>');i=n.find(".SClbl"),i.off("click").on("click",{calid:a},function(a){var b=a.data.calid;ZCL_ChgCalSts(b)}),k.find("ul").append(n);var p=$('<li><strong class="filterControl">'+m+"<b></b></strong></li>"),q=p.find("b");c=$('<span data-id="det">'+zcal.i18n.details+"</span>"),c.off("click").on("click",{calid:a,cobj:b},function(a){var b=$(this),c;zcalDetails.close(),zcalShare.close(),b.closest("ul").attr("class","sel"),b.parent().find("span").removeClass("zcl_sl"),b.addClass("zcl_sl"),c=zcalDetails.render(a.data.calid,a.data.cobj),c.insertAfter(k)}),q.append(c),j=$('<span data-id="edit">'+zcal.i18n.edit+"</span>"),j.off("click").on("click",{calId:a},function(a){var b=zcal.getCalObj(a.data.calId),c=b[1].split(":")[0],d=b[1].split(":")[1];ZCL_openCalPopup({id:a.data.calId,name:b[0],desc:b[4],color:c,txtcolor:d})}),q.append(j);if(zcal.shrCal!="0"||zcal.pvtUrl!="0")d=$('<span data-id="sh">'+zcal.i18n.share+"</span>"),d.off("click").on("click",{calid:a,cobj:b},function(a){o($(this),k,a.data.calid,a.data.cobj)}),q.append(d);zcal.impExp!="0"&&b[13][2]==1&&(f=$('<span data-id="exp">'+zcal.i18n.exports+"</span>"),f.off("click").on("click",{calid:a,ckey:b[9]},function(a){ZCL_formSubmit({ckey:a.data.ckey,mode:"calexp"},"/cal/export.do","GET")}),q.append(f)),b[13][3]==1&&(g=$('<span data-id="emp">'+zcal.i18n.empty+"</span>"),g.off("click").on("click",{calid:a},function(a){var b=a.data.calid;ZCL_empCal(b)}),q.append(g)),b[13][4]==1&&(h=$('<span data-id="del">'+zcal.i18n.del+"</span>"),h.off("click").on("click",{calid:a,ckey:b[9]},function(a){var b=a.data.calid;ZCL_delCal(b,!1)}),q.append(h)),k.find("ul").append(p);var r=$('<li><strong class="filterControl"><span class="filterSate"/></strong></li>');if(b[3]=="false"){var s=$("<div/>");b[8]==0?s.addClass("sdiv sadiv"):s.addClass("sdiv inctop"),s.off("click").on("click",{calid:a},function(a){var c=$(this),d=c.parents(".zmL"),e=a.data.calid;ZCL_XHR("/cal/calAct.do?mode=sh-hde&calid="+e+"&isshow="+(c.hasClass("sadiv")?!0:!1),function(a){var f=ZCL_Evl(1,a.responseText);f.status=="success"&&(b[8]=f.isshow?1:0,c.removeAttr("class").addClass(f.isshow?"sdiv inctop":"sdiv sadiv"),d.removeAttr("class").addClass(f.isshow?"zmL":"zmL disableFilter"),$.publish("/calendar/visibilityChanged",{calid:e,visibility:f.isshow}))})}),r.find(".filterSate").append(s)}k.find("ul").append(r),e.append(k)},o=function(a,b,c,d){zcalDetails.close(),zcalShare.close(),a.closest("ul").attr("class","sel"),a.parent().find("span").removeClass("zcl_sl"),a.addClass("zcl_sl");var e=zcalShare.render(c,d);e.insertAfter(b)},p=function(a,b){var c=b.calid,e=b.sts,f;f=d.find("[data-id="+c+"]"),f.find("i").length>0&&f.find("i").removeAttr("class").addClass(b.sts==1?"msi-tick":"")},q=function(a,b){var c=b.calid;$ele=d.find("[data-id="+c+"]"),$ele.length&&$ele.remove()},r=function(){var a="<div>";return a+='<div class="SC_filt_bottom SC_Calendar">',a+='<div class="zmL SC_filt_bld">',a+='<ul class="bld custom">',a+="<li>&nbsp;</li>",a+="<li>"+zcal.i18n.calname+"</li>",a+="<li>"+zcal.i18n.status+"</li>",a+="</ul>",a+="</div>",a+="</div>",a+='<div style="bottom:0px;top:'+h+';" class="SC_Twpr">',a+='<div class="SC_filt_bottom SC_Calendar" id="zcl_callist"></div>',a+="</div>",a+="</div>",a},s=function(){zmailSettings.views.showPreview();var a=$(zmailSettings.views.getPreviewDOM());f=a.find(".SC_ptit"),l(),g=a.find(".SC_Twpr"),g.removeClass("SC_Twpr").removeAttr("style"),d=$(r()),e=d.find("#zcl_callist"),g.append(d),m()},t=function(a){i=a;if(!zmsuite.isWorkspaceAvailable(b))return;s(),u()},u=function(){$.subscribe("/calendar/added",m),$.subscribe("/calendar/updated",m),$.subscribe("/calendar/deleted",a.delCal),$.subscribe("/calendar/statusChanged",a.updCalSts)},v=function(){c.remove(),d.remove(),k=undefined,g.addClass("SC_Twpr"),g.css("top","61px")},w=function(){$.unsubscribe("/calendar/added",m),$.unsubscribe("/calendar/updated",m),$.unsubscribe("/calendar/deleted",a.delCal),$.unsubscribe("/calendar/statusChanged",a.updCalSts)},x=function(){v(),zmailSettings.currentAppName=undefined,w()};return a.init=t,a.clearTrace=x,a.updCalSts=p,a.delCal=q,a}(zcalSettings.ownCalList||{}),zcalSettings.grpCalList=function(a){a=a||{};var b="settings",c,d,e,f,g,h="106px",i,j,k=function(){c=$('<div class="SC_settHead"><div class="SC_phd">'+zcal.i18n.groupcalendars+"</div></div>"),f.append(c)},l=function(){j=zcal.cdata.calGLst,e.empty();for(var a in j)n(a,j[a]);if(i&&i.action==="share"){var b=i.id,c,f;c=d.find("[data-id="+b+"]"),c.length>0&&(f=c.find("[data-id=sh]"),o(f,c,b,j[b]))}m()},m=function(){if(e.is(":empty")){var a;e.html('<div class="SC_nmsg">No calendars found, <font>click here</font> to subscribe.</div>'),$("#zcl_callist_hdr").empty(),a=e.find("font"),a.off("click").on("click",function(a){zmailSettings.init("calendar","zcalSettings.zcalGroupList")}),$(e.parent()).css("top","86px")}},n=function(a,b){var c,d,f,g,h,i=$('<div class="zmL '+(b[8]==1?"":"disableFilter")+'" data-id="'+a+'"><ul></ul></div>'),j=ZCL_getCalColor(b[1])[1],k=ZCL_getHTML(b[0]),l=$('<li><div style="background-color:'+j+'" class="SClbl"><i class="'+(b[2]==1?"msi-tick":"")+'"></i></div></li>');g=l.find(".SClbl"),g.off("click").on("click",{calid:a},function(a){var b=a.data.calid;ZCL_ChgCalSts(b)}),i.find("ul").append(l);var m=$('<li><strong class="filterControl">'+k+"<b></b></strong></li>"),n=m.find("b");c=$('<span data-id="det">'+zcal.i18n.details+"</span>"),c.off("click").on("click",{calid:a,cobj:b},function(a){var b=$(this),c;zcalDetails.close(),zcalShare.close(),b.closest("ul").attr("class","sel"),b.parent().find("span").removeClass("zcl_sl"),b.addClass("zcl_sl"),c=zcalDetails.render(a.data.calid,a.data.cobj),c.insertAfter(i)}),n.append(c),h=$('<span data-id="edit">'+zcal.i18n.edit+"</span>"),h.off("click").on("click",{calId:a},function(a){var b=zcal.getCalObj(a.data.calId),c=b[1].split(":")[0],d=b[1].split(":")[1];ZCL_openCalPopup({id:a.data.calId,name:b[0],desc:b[4],color:c,txtcolor:d})}),n.append(h);if(b[13][0]!=0||b[13][7]!=0)d=$('<span data-id="sh">'+zcal.i18n.share+"</span>"),d.off("click").on("click",{calid:a,cobj:b},function(a){o($(this),i,a.data.calid,a.data.cobj)}),n.append(d);b[13][5]==1&&(f=$('<span data-id="del">'+zcal.i18n.unsubscribe+"</span>"),f.off("click").on("click",{calid:a,ckey:b[9]},function(a){var b=a.data.calid;ZCL_delCal(b,!0)}),n.append(f)),i.find("ul").append(m);var p=$('<li><strong class="filterControl"><span class="filterSate"/></strong></li>');if(b[3]=="false"){var q=$("<div/>");b[8]==0?q.addClass("sdiv sadiv"):q.addClass("sdiv inctop"),q.off("click").on("click",{calid:a},function(a){var c=$(this),d=c.parents(".zmL"),e=a.data.calid;ZCL_XHR("/cal/calAct.do?mode=sh-hde&calid="+e+"&isshow="+(c.hasClass("sadiv")?!0:!1),function(a){var f=ZCL_Evl(1,a.responseText);f.status=="success"&&(b[8]=f.isshow?1:0,c.removeAttr("class").addClass(f.isshow?"sdiv inctop":"sdiv sadiv"),d.removeAttr("class").addClass(f.isshow?"zmL":"zmL disableFilter"),$.publish("/calendar/visibilityChanged",{calid:e,visibility:f.isshow}))})}),p.find(".filterSate").append(q)}i.find("ul").append(p),e.append(i)},o=function(a,b,c,d){zcalDetails.close(),zcalShare.close(),a.closest("ul").attr("class","sel"),a.parent().find("span").removeClass("zcl_sl"),a.addClass("zcl_sl");var e=zcalShare.render(c,d);e.insertAfter(b)},p=function(a,b){var c=b.calid,e=b.sts,f;f=d.find("[data-id="+c+"]"),f.find("i").length>0&&f.find("i").removeAttr("class").addClass(b.sts==1?"msi-tick":"")},q=function(a,b){var c=b.calid;$ele=d.find("[data-id="+c+"]"),$ele.length&&$ele.remove(),m()},r=function(){var a="<div>";return a+='<div class="SC_filt_bottom SC_Calendar" id="zcl_callist_hdr">',a+='<div class="zmL SC_filt_bld">',a+='<ul class="bld custom">',a+="<li>&nbsp;</li>",a+="<li>"+zcal.i18n.calname+"</li>",a+="<li>"+zcal.i18n.status+"</li>",a+="</ul>",a+="</div>",a+="</div>",a+='<div style="bottom:0px;top:'+h+';" class="SC_Twpr">',a+='<div class="SC_filt_bottom SC_Calendar" id="zcl_callist"></div>',a+="</div>",a+="</div>",a},s=function(){zmailSettings.views.showPreview();var a=$(zmailSettings.views.getPreviewDOM());f=a.find(".SC_ptit"),k(),g=a.find(".SC_Twpr"),g.removeClass("SC_Twpr").removeAttr("style"),d=$(r()),e=d.find("#zcl_callist"),g.append(d),l()},t=function(a){i=a;if(!zmsuite.isWorkspaceAvailable(b))return;s(),u()},u=function(){$.subscribe("/calendar/subscribed",l),$.subscribe("/calendar/updated",l),$.subscribe("/calendar/deleted",a.delCal),$.subscribe("/calendar/statusChanged",a.updCalSts)},v=function(){c.remove(),d.remove(),j=undefined,g.addClass("SC_Twpr"),g.css("top","61px")},w=function(){$.unsubscribe("/calendar/subscribed",l),$.unsubscribe("/calendar/updated",l),$.unsubscribe("/calendar/deleted",a.delCal),$.unsubscribe("/calendar/statusChanged",a.updCalSts)},x=function(){v(),zmailSettings.currentAppName=undefined,w()};return a.init=t,a.clearTrace=x,a.updCalSts=p,a.delCal=q,a}(zcalSettings.grpCalList||{}),zcalSettings.appCalList=function(a){a=a||{};var b="settings",c,d,e,f,g,h="106px",i,j,k=function(){c=$('<div class="SC_settHead"><div class="SC_phd">'+zcal.i18n.appcalendars+"</div></div>"),f.append(c)},l=function(){j=zcal.cdata.calALst,e.empty();for(var a in j)o(a,j[a]);if(i&&i.action==="share"){var b=i.id,c,f;c=d.find("[data-id="+b+"]"),c.length>0&&(f=c.find("[data-id=sh]"),p(f,c,b,j[b]))}m()},m=function(){if(e.is(":empty")){var a;e.html('<div class="SC_nmsg">'+zcal.i18n.noappcal+"</div>"),$("#zcl_callist_hdr").empty(),$(e.parent()).css("top","86px")}},n=function(a){var b=zcal.CALMODE==1?"/cal/gsubCal.do?&grpid="+ZCL_ZGID+"&mode=userUpd&calid="+a:"/cal/subCal.do?mode=userUpd&calid="+a;ZCL_XHR(b,function(){ZCL_setCalendars(),zcalEvents.loadMonthData(),zmUtil.succErrMsg("s",zcal.i18n.updatedsuccessfully)})},o=function(a,b){var c,d,f,g,h,i,j=$('<div class="zmL '+(b[8]==1?"":"disableFilter")+'" data-id="'+a+'"><ul></ul></div>'),k=ZCL_getCalColor(b[1])[1],l=ZCL_getHTML(b[0]),m=$('<li><div style="background-color:'+k+'" class="SClbl"><i class="'+(b[2]==1?"msi-tick":"")+'"></i></div></li>');g=m.find(".SClbl"),g.off("click").on("click",{calid:a},function(a){var b=a.data.calid;ZCL_ChgCalSts(b)}),j.find("ul").append(m);var o=$('<li><strong class="filterControl">'+l+"<b></b></strong></li>"),q=o.find("b");c=$('<span data-id="det">'+zcal.i18n.details+"</span>"),c.off("click").on("click",{calid:a,cobj:b},function(a){var b=$(this),c;zcalDetails.close(),zcalShare.close(),b.closest("ul").attr("class","sel"),b.parent().find("span").removeClass("zcl_sl"),b.addClass("zcl_sl"),c=zcalDetails.render(a.data.calid,a.data.cobj),c.insertAfter(j)}),q.append(c),i=$('<span data-id="edit">'+zcal.i18n.edit+"</span>"),i.off("click").on("click",{calId:a},function(a){var b=zcal.getCalObj(a.data.calId),c=b[1].split(":")[0],d=b[1].split(":")[1];ZCL_openCalPopup({id:a.data.calId,name:b[0],desc:b[4],color:c,txtcolor:d})}),q.append(i);if(b[13][0]!=0||b[13][7]!=0)d=$('<span data-id="sh">'+zcal.i18n.share+"</span>"),d.off("click").on("click",{calid:a,cobj:b},function(a){p($(this),j,a.data.calid,a.data.cobj)}),q.append(d);b[13][5]==1&&(f=$('<span data-id="del">'+zcal.i18n.unsubscribe+"</span>"),f.off("click").on("click",{calid:a,ckey:b[9]},function(a){var b=a.data.calid;ZCL_delCal(b,!0)}),q.append(f));if(b[5]==2||b[5]==5&&(b[14]=="zcontacts"||b[14]=="zprojects"))h=$('<span data-id="upd">'+zcal.i18n.update+"</span>"),h.off("click").on("click",{calid:a,ckey:b[9]},function(a){var b=a.data.calid;n(b)}),q.append(h);j.find("ul").append(o);var r=$('<li><strong class="filterControl"><span class="filterSate"/></strong></li>');if(b[3]=="false"){var s=$("<div/>");b[8]==0?s.addClass("sdiv sadiv"):s.addClass("sdiv inctop"),s.off("click").on("click",{calid:a},function(a){var c=$(this),d=c.parents(".zmL"),e=a.data.calid;ZCL_XHR("/cal/calAct.do?mode=sh-hde&calid="+e+"&isshow="+(c.hasClass("sadiv")?!0:!1),function(a){var f=ZCL_Evl(1,a.responseText);f.status=="success"&&(b[8]=f.isshow?1:0,c.removeAttr("class").addClass(f.isshow?"sdiv inctop":"sdiv sadiv"),d.removeAttr("class").addClass(f.isshow?"zmL":"zmL disableFilter"),$.publish("/calendar/visibilityChanged",{calid:e,visibility:f.isshow}))})}),r.find(".filterSate").append(s)}j.find("ul").append(r),e.append(j)},p=function(a,b,c,d){zcalDetails.close(),zcalShare.close(),a.closest("ul").attr("class","sel"),a.parent().find("span").removeClass("zcl_sl"),a.addClass("zcl_sl");var e=zcalShare.render(c,d);e.insertAfter(b)},q=function(a,b){var c=b.calid,e=b.sts,f;f=d.find("[data-id="+c+"]"),f.find("i").length>0&&f.find("i").removeAttr("class").addClass(b.sts==1?"msi-tick":"")},r=function(a,b){var c=b.calid;$ele=d.find("[data-id="+c+"]"),$ele.length&&$ele.remove(),m()},s=function(){var a="<div>";return a+='<div class="SC_filt_bottom SC_Calendar" id="zcl_callist_hdr">',a+='<div class="zmL SC_filt_bld">',a+='<ul class="bld custom">',a+="<li>&nbsp;</li>",a+="<li>"+zcal.i18n.calname+"</li>",a+="<li>"+zcal.i18n.status+"</li>",a+="</ul>",a+="</div>",a+="</div>",a+='<div style="bottom:0px;top:'+h+';" class="SC_Twpr">',a+='<div class="SC_filt_bottom SC_Calendar" id="zcl_callist"></div>',a+="</div>",a+="</div>",a},t=function(){zmailSettings.views.showPreview();var a=$(zmailSettings.views.getPreviewDOM());f=a.find(".SC_ptit"),k(),g=a.find(".SC_Twpr"),g.removeClass("SC_Twpr").removeAttr("style"),d=$(s()),e=d.find("#zcl_callist"),g.append(d),l()},u=function(a){i=a;if(!zmsuite.isWorkspaceAvailable(b))return;t(),v()},v=function(){$.subscribe("/calendar/subscribed",l),$.subscribe("/calendar/updated",l),$.subscribe("/calendar/deleted",a.delCal),$.subscribe("/calendar/statusChanged",a.updCalSts)},w=function(){c.remove(),d.remove(),j=undefined,g.addClass("SC_Twpr"),g.css("top","61px")},x=function(){$.unsubscribe("/calendar/subscribed",l),$.unsubscribe("/calendar/updated",l),$.unsubscribe("/calendar/deleted",a.delCal),$.unsubscribe("/calendar/statusChanged",a.updCalSts)},y=function(){w(),zmailSettings.currentAppName=undefined,x()};return a.init=u,a.clearTrace=y,a.updCalSts=q,a.delCal=r,a}(zcalSettings.appCalList||{}),zcalSettings.othCalList=function(a){a=a||{};var b="settings",c,d,e,f,g,h="106px",i,j,k=function(){c=$('<div class="SC_settHead"><div class="SC_phd">'+zcal.i18n.othercalendars+"</div></div>"),f.append(c)},l=function(){j=zcal.cdata.calOLst,e.empty();for(var a in j)n(a,j[a]);if(i&&i.action==="share"){var b=i.id,c,f;c=d.find("[data-id="+b+"]"),c.length>0&&(f=c.find("[data-id=sh]"),o(f,c,b,j[b]))}m()},m=function(){if(e.is(":empty")){var a;e.html('<div class="SC_nmsg">No calendars found, <font>click here</font> to subscribe.</div>'),$("#zcl_callist_hdr").empty(),a=e.find("font"),a.off("click").on("click",function(a){zmailSettings.init("calendar","zcalSettings.Subscribe")}),$(e.parent()).css("top","86px")}},n=function(a,b){var c,d,f,g,h,i,j,k=$('<div class="zmL '+(b[8]==1?"":"disableFilter")+'" data-id="'+a+'"><ul></ul></div>'),l=ZCL_getCalColor(b[1])[1],m=ZCL_getHTML(b[0]),n=$('<li><div style="background-color:'+l+'" class="SClbl"><i class="'+(b[2]==1?"msi-tick":"")+'"></i></div></li>');h=n.find(".SClbl"),h.off("click").on("click",{calid:a},function(a){var b=a.data.calid;ZCL_ChgCalSts(b)}),k.find("ul").append(n);var q=$('<li><strong class="filterControl">'+m+"<b></b></strong></li>"),r=q.find("b");c=$('<span data-id="det">'+zcal.i18n.details+"</span>"),c.off("click").on("click",{calid:a,cobj:b},function(a){var b=$(this),c;zcalDetails.close(),zcalShare.close(),b.closest("ul").attr("class","sel"),b.parent().find("span").removeClass("zcl_sl"),b.addClass("zcl_sl"),c=zcalDetails.render(a.data.calid,a.data.cobj),c.insertAfter(k)}),r.append(c),j=$('<span data-id="edit">'+zcal.i18n.edit+"</span>"),j.off("click").on("click",{calId:a},function(a){var b=zcal.getCalObj(a.data.calId),c=b[1].split(":")[0],d=b[1].split(":")[1];ZCL_openCalPopup({id:a.data.calId,name:b[0],desc:b[4],color:c,txtcolor:d})}),r.append(j),b[13][0]!=0&&zcal.shrCal!="0"&&(d=$('<span data-id="sh">'+zcal.i18n.share+"</span>"),d.off("click").on("click",{calid:a,cobj:b},function(a){o($(this),k,a.data.calid,a.data.cobj)}),r.append(d)),b[13][2]!=0&&(f=$('<span data-id="exp">'+zcal.i18n.exports+"</span>"),f.off("click").on("click",{calid:a,ckey:b[9]},function(a){ZCL_formSubmit({ckey:a.data.ckey,mode:"calexp"},"/cal/export.do","GET")}),r.append(f)),b[13][5]==1&&(g=$('<span data-id="del">'+zcal.i18n.unsubscribe+"</span>"),g.off("click").on("click",{calid:a,ckey:b[9]},function(a){var b=a.data.calid;ZCL_delCal(b,!0)}),r.append(g)),b[5]==2&&(i=$('<span data-id="upd">'+zcal.i18n.update+"</span>"),i.off("click").on("click",{calid:a,ckey:b[9]},function(a){var b=a.data.calid;p(b)}),r.append(i)),k.find("ul").append(q);var s=$('<li><strong class="filterControl"><span class="filterSate"/></strong></li>');if(b[3]=="false"){var t=$("<div/>");b[8]==0?t.addClass("sdiv sadiv"):t.addClass("sdiv inctop"),t.off("click").on("click",{calid:a},function(a){var c=$(this),d=c.parents(".zmL"),e=a.data.calid;ZCL_XHR("/cal/calAct.do?mode=sh-hde&calid="+e+"&isshow="+(c.hasClass("sadiv")?!0:!1),function(a){var f=ZCL_Evl(1,a.responseText);f.status=="success"&&(b[8]=f.isshow?1:0,c.removeAttr("class").addClass(f.isshow?"sdiv inctop":"sdiv sadiv"),d.removeAttr("class").addClass(f.isshow?"zmL":"zmL disableFilter"),$.publish("/calendar/visibilityChanged",{calid:e,visibility:f.isshow}))})}),s.find(".filterSate").append(t)}k.find("ul").append(s),e.append(k)},o=function(a,b,c,d){zcalDetails.close(),zcalShare.close(),a.closest("ul").attr("class","sel"),a.parent().find("span").removeClass("zcl_sl"),a.addClass("zcl_sl");var e=zcalShare.render(c,d);e.insertAfter(b)},p=function(a){var b=zcal.CALMODE==1?"/cal/gsubCal.do?&grpid="+ZCL_ZGID+"&mode=userUpd&calid="+a:"/cal/subCal.do?mode=userUpd&calid="+a;ZCL_XHR(b,function(){ZCL_setCalendars(),zcalEvents.loadMonthData(),zmUtil.succErrMsg("s",zcal.i18n.updatedsuccessfully)})},q=function(a,b){var c=b.calid,e=b.sts,f;f=d.find("[data-id="+c+"]"),f.find("i").length>0&&f.find("i").removeAttr("class").addClass(b.sts==1?"msi-tick":"")},r=function(a,b){var c=b.calid;$ele=d.find("[data-id="+c+"]"),$ele.length&&$ele.remove(),m()},s=function(){var a="<div>";return a+='<div class="SC_filt_bottom SC_Calendar" id="zcl_callist_hdr">',a+='<div class="zmL SC_filt_bld">',a+='<ul class="bld custom">',a+="<li>&nbsp;</li>",a+="<li>"+zcal.i18n.calname+"</li>",a+="<li>"+zcal.i18n.status+"</li>",a+="</ul>",a+="</div>",a+="</div>",a+='<div style="bottom:0px;top:'+h+';" class="SC_Twpr">',a+='<div class="SC_filt_bottom SC_Calendar" id="zcl_callist"></div>',a+="</div>",a+="</div>",a},t=function(){zmailSettings.views.showPreview();var a=$(zmailSettings.views.getPreviewDOM());f=a.find(".SC_ptit"),k(),g=a.find(".SC_Twpr"),g.removeClass("SC_Twpr").removeAttr("style"),d=$(s()),e=d.find("#zcl_callist"),g.append(d),l()},u=function(a){i=a;if(!zmsuite.isWorkspaceAvailable(b))return;t(),v()},v=function(){$.subscribe("/calendar/deleted",a.delCal),$.subscribe("/calendar/statusChanged",a.updCalSts)},w=function(){c.remove(),d.remove(),j=undefined,g.addClass("SC_Twpr"),g.css("top","61px")},x=function(){$.unsubscribe("/calendar/deleted",a.delCal),$.unsubscribe("/calendar/statusChanged",a.updCalSts)},y=function(){w(),zmailSettings.currentAppName=undefined,x()};return a.init=u,a.clearTrace=y,a.updCalSts=q,a.delCal=r,a}(zcalSettings.othcalList||{});var zcalDetails=function(a){a=a||{};var b,c,d,e,f,g,h,i,j,k=function(){var a=$("#zcl_callist");a&&a.find("ul.sel").removeClass(),b&&(b.remove(),b=undefined)},l=function(){var a,b,h=g&&g.find(".msi-check").length>0?"1":"0";a=ZCL_getAlarmObj(f[0].childNodes)[0];var i=j&&j.find(".msi-check").length>0?"1":"0";if(!!a.ACTYPE||a.ACTYPE==d[6].ACTYPE&&a.ACTYPE!=undefined){if(a.ACTYPE!=d[6].ACTYPE||a.REMTIME!=d[6].REMTIME||a.REMTYPE!=d[6].REMTYPE||markAsBusy!=d[16])b="&remt="+a.REMTIME+"&remty="+a.REMTYPE+"&actty="+a.ACTYPE+"&busy="+h+"&invNtfy="+i}else b="&remt=&remty=&actty=&busy="+h+"&invNtfy="+i;b&&ZCL_XHR("/cal/calAct.do?mode=edit-adv&caluid="+e+"&calid="+c+b,function(a){var b=ZCL_Evl(1,a.responseText);b.status==="success"&&(d[6]=b.obj.REM,d[16]=b.obj.BUSY,d[17]=b.obj.INVNOTIFY,zmUtil.succErrMsg("s",zcal.i18n.updatedsuccessfully),k())})};return a.render=function(a,m){c=a,d=m,e=d[9],b=$('<div id="zcl_caldetails" class="editFilterParent"></div>');var n=$(zcalTemplate.calDetials(c,m)),o=n.find("[data-marker=embedMore]");o.off("click").on("click",function(a){zcalEmbed.render(c,d)}),f=n.find("[data-marker=calReminder]").removeAttr("data-marker"),f.html(ZCL_putCalAlarm(d[6])),f.find(".msi-close").off("click").on("click",function(){$(this).closest("ul").remove(),f.find("#zcl_addrem").length||ZCL_AppendRemAddLnk(f[0])}),g=n.find("[data-marker=markAsBusy]").removeAttr("data-marker");if(d[16]!=undefined&&d[16]!=""){var p=g.find("i");p.length>0&&(p.removeAttr("class").addClass(d[16]=="1"?"msi-check":"msi-uncheck"),p.off("click").on("click",function(){this.className=this.className=="msi-check"?"msi-uncheck":"msi-check"}))}else g.remove();j=n.find("[data-marker=dlgInvNtfy]").removeAttr("data-marker");if(d[13][0]==2&&d[5]==1){var q=j.find("i");q.length>0&&(q.removeAttr("class").addClass(d[17]=="1"?"msi-check":"msi-uncheck"),q.off("click").on("click",function(){this.className=this.className=="msi-check"?"msi-uncheck":"msi-check"}))}else j.remove();return h=n.find("[data-marker=detailSave]").removeAttr("data-marker"),h.off("click").on("click",l),i=n.find("[data-val=Cancel]"),i.off("click").on("click",k),b.html(n),b},a.close=k,a}(zcalDetails||{}),zcalShare=function(a){a=a||{};var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r={},s=function(){var a=$("#zcl_callist");a&&a.find("ul.sel").removeClass(),b&&(b.remove(),b=undefined,g=undefined,h=undefined,i=j=k=undefined,n&&zmAutoFill.removeAutoFill(n)),r={},p=undefined,q=undefined},t=function(a){var b=[{value:0,text:zcal.i18n.private_shperm_freebusy},{value:1,text:zcal.i18n.private_shperm_viewevent}];return a==0&&(b.push({value:2,text:zcal.i18n.private_shperm_editevent}),b.push({value:3,text:zcal.i18n.private_shperm_delegate})),b};a.render=function(a,k){c=a,d=k,e=d[9],p=ZCL_Evl(1,JSON.stringify(zcal.cdata.grpLst)),b=$('<div id="zcl_calshare" class="editFilterParent"></div>');var l=$(zcalTemplate.calShare());if(d[13][0]!=0||d[13][7]==1)return h=l.find("[data-marker=publicShare]").removeAttr("data-marker"),i=l.find("[data-marker=privateAddress]").removeAttr("data-marker"),j=l.find("[data-marker=indShare]").removeAttr("data-marker"),o=l.find("[data-marker=sharedList]").removeAttr("data-marker"),g=l.find("[data-marker=loadingAnimation]").removeAttr("data-marker"),d[13][0]==0&&d[13][7]==1?zcal.pvtUrl!=0&&(d[5]==3?u():R()):d[13][0]==1&&d[13][7]==0?zcal.shCal!=0&&zcal.shCal!=1&&(d[5]==3?u():G()):d[13][0]==1&&d[13][7]==1?zcal.shCal==0&&zcal.pvtUrl!=0?d[5]==3?u():R():zcal.shCal!=0&&zcal.shCal!=1&&zcal.pvtUrl==0?d[5]==3?u():G():zcal.shCal!=0&&zcal.shCal!=1&&zcal.pvtUrl!=0&&(d[5]==3?u():(G(),R())):zcal.shCal==0&&zcal.pvtUrl!=0?(h&&(h.remove(),h=undefined),j&&(j.remove(),j=undefined),o&&(o.remove(),o=undefined),R()):zcal.shCal==1&&zcal.pvtUrl==0?(h&&(h.remove(),h=undefined),i&&(i.remove(),i=undefined),zcal.cdata.calLst[c]?w():v()):zcal.shCal==1&&zcal.pvtUrl!=0?(h&&(h.remove(),h=undefined),zcal.cdata.calLst[c]?(R(),w()):v()):zcal.shCal==2&&zcal.pvtUrl==0?(i&&(i.remove(),i=undefined),zcal.cdata.calLst[c]?(G(),w()):v()):zcal.cdata.calLst[c]?(G(),R(),w()):v(),f=l.find("[data-val=Cancel]"),f.off("click").on("click",s),b.html(l),b;b=undefined,b.remove()};var u=function(){zmComponent.loadingBand({container:g[0],type:"pagination"}),g.show();var a="/cal/shareCal.do?mode=cal-pubpvtinfo&caluid="+d[9]+"&calid="+c+"&calmode=0";ZCL_XHR(a,function(a){var b=ZCL_Evl(1,a.responseText);g.hide(),b.obj&&(d[10]=b.obj),G()})},v=function(){zmComponent.loadingBand({container:g[0],type:"pagination"}),g.show();var a="/cal/shareCal.do?mode=sh-calinfo&caluid="+d[9]+"&calid="+c+"&calmode=0";ZCL_XHR(a,function(a){g.hide();var b=ZCL_Evl(1,a.responseText);b.calinfo&&(d[10]=b.calInfo[10],d[11]=b.calInfo[11],d[12]=b.calInfo[12]),b.pvtLst&&(q=b.pvtLst,y()),b.grpInfo&&(p.grp=b.grpInfo),G()})},w=function(){zmComponent.loadingBand({container:g[0],type:"pagination"}),g.show();var a="/cal/shareCal.do?mode=priv-shlst&calid="+c+"&calmode=0";ZCL_XHR(a,function(a){g.hide();var b=ZCL_Evl(1,a.responseText);b.obj&&(q=b.obj,y())})},x=function(a){var b=[],c=a.menuItems||[];c.forEach(function(a){var c=a.value,d=a.text;b.push({htm:"<div>"+d+"</div>",data:{value:c,text:d}})});var d=$.Deferred();return a.list=b,a.clk=function(a,b,c){d.resolve(a,b,c)},a.onHide=function(){d.reject()},b.length?zmsuite.showMenu(a):d.reject(),d.fail(zmUtil.hideMenu),d.promise()},y=function(){var a='<h2 class="recom_conditionHeading">Share with individuals or groups</h2>';a+='<div class="zmL">',a+='<div class="SC_srch shw">',a+='<table class="condition"><tr><td>',a+='<table><tr><td width="60px"><div class="SC_select" data-marker="shareType">',a+='<i class="msi-invitee"></i>',a+="</div></td>",a+='<td width="43%"><div class="SC_select SC_selectnoneArw">',a+='<input type="text" placeholder="'+zcal.i18n.typeaemailid+'" value="" class="zm_sgst" data-marker="shareTo">',a+="</div></td>",a+='<td width="29%"><div class="SC_select">',a+='<input type="text" class="disabled" readonly value="'+zcal.i18n.private_shperm_viewevent+'" data-marker="sharePerm">',a+="</div></td>",a+='<td class="tRht"><span><i class="msi-plus"></i></span></td>',a+="</tr></table>",a+="</tr></table>",a+="</div>",a+="</div>",j.html(a),k=j.find("[data-marker=shareType]").removeAttr("data-marker"),l=j.find("[data-marker=shareTo]").removeAttr("data-marker"),m=j.find("[data-marker=sharePerm]").removeAttr("data-marker");var b=j.find(".msi-plus");b.off("click").on("click",function(a){if(r.type==1){var b=l.attr("data-gid");if(b==null)return!1;r.grpid=b}else{var c=l[0].value;if(!ZCL_isEmail(c))return zmUtil.succErrMsg("e",zcal.i18n.entervalidemail),l[0].focus(),!1;r.email=c}E(r)}),A({value:0}),z()},z=function(){var a=$("<table/>");for(var b in q[0]){var c,d,e=t(0),f,g=e[q[0][b]].text;c=$('<tr><td><i class="msi-invitee"></i></td><td width="43%"><span>'+ZCL_getHTML(b)+'</span></td><td width="29%"><div class="SC_select"><input type="text" class="disabled" readonly value="'+g+'"></div></td><td><i class="msi-close"></i></td></tr>'),d=c.find("input"),d.off("click").on("click",{menuItems:e,email:b},function(a){x({menuItems:a.data.menuItems,par:this,parWidth:!0}).then(function(b){E({type:0,email:a.data.email,perm:b.value}),zmUtil.hideMenu()})}),f=c.find(".msi-close"),f.off("click").on("click",{email:b},function(a){F({email:a.data.email,mode:0})}),a.append(c)}for(var h in q[1]){var i=p.pgrp[h]||p.ogrp[h];if(i){var c,d,e=t(1),f,g=e[q[1][h]].text;c=$('<tr><td width="5%"><i class="msi-group"></i></td><td width="43%"><span>'+ZCL_getHTML(i.GNAME)+'</span></td><td width="29%"><div class="SC_select"><input type="text" class="disabled" readonly value="'+g+'"></div></td><td><i class="msi-close"></i></td></tr>'),d=c.find("input"),d.off("click").on("click",{menuItems:e,grpid:h},function(a){x({menuItems:a.data.menuItems,par:this,parWidth:!0}).then(function(b){E({type:1,grpid:a.data.grpid,perm:b.value}),zmUtil.hideMenu()})}),f=c.find(".msi-close"),f.off("click").on("click",{grpid:h},function(a){F({grpid:a.data.grpid,mode:1})}),a.append(c)}}o.html(a)},A=function(a){var b=ZCL_isEmpty(p.pgrp)&&ZCL_isEmpty(p.ogrp)?!1:!0,c=a.value,d=t(c);r.type=c,r.perm=d[1].value,k&&(k.html('<i class="'+(c==1?"msi-group":"msi-invitee")+'"></i>'),k.off("click").on("click",{isgrp:b},function(a){var b=[{value:0,text:zcal.i18n.individuals}];a.data.isgrp&&b.push({value:1,text:zcal.i18n.groups}),x({menuItems:b,par:this,parWidth:!1}).then(function(a){A(a),zmUtil.hideMenu()})})),n&&zmAutoFill.removeAutoFill(n);if(l){l.off("click"),l.val("");if(c==1){l.attr("placeholder",zcal.i18n.selectagroup);var e=D();l.off("click").on("click",function(a){var b={},c=$(this),d;b.parentDOM=c.parent(),b.displayAs="dropdown",b.onSelect=function(a,b){B(c,a,b),d.hide()},b.dataCallback=function(){return e},d=zmUtil.createFLComp("generic",b),d.show()})}else{l.attr("placeholder",zcal.i18n.typeaemailid);var f=zmSearch.getAFObj(0,function(a,b){l[0].value=a.eid,r.email=a.eid});n=zmAutoFill.setAutofill(f,l)}}m&&m.off("click").on("click",function(a){var b=this;x({menuItems:d,par:this,parWidth:!0}).then(function(a){b.value=a.text,r.perm=a.value,zmUtil.hideMenu()})})},B=function(a,b,c){a.val(c.display_text),a.attr("data-gid",b)},C=function(a,b){for(var c=0;c<b.length;c++){var d=zcalGroup.getGroup(b[c]);d&&a.push({id:b[c],name:d.name,display_text:d.name})}},D=function(){var a=[],b;return b=zcalGroup.getGroupList("personal"),C(a,b),b=zcalGroup.getGroupList("org"),C(a,b),a},E=function(a){var b="/cal/shareCal.do?calid="+c+"&perm="+a.perm+"&caluid="+e+"&calmode=0";a.type==1?b+="&mode=grp-sh&grpid="+a.grpid:b+="&mode=priv-sh&shuser="+a.email.zcalescape(),ZCL_XHR(b,function(a){var b=ZCL_Evl(1,a.responseText),c;if(b.status!="success"){b.status=="maxLmtReached"?zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.maxLmtReached,[60])):b.status=="noPermission"?zmUtil.succErrMsg("e",zcal.i18n.NoPermission):b.status=="WaitForApprvl"&&zmUtil.succErrMsg("e",zcal.i18n.waitingforapproval);return}zmUtil.succErrMsg("s",zcal.i18n.sharedsuccessfully),c=b.obj,b.mode==="grp-sh"?q[1][c[0]]=c[1]:q[0][c[0]]=c[1],y()})},F=function(a){var b=a.mode,e="/cal/shareCal.do?&calid="+c+"&caluid="+d[9]+"&calmode=0";e+=b==0?"&mode=priv-sh-del&shuser="+a.email.zcalescape():"&mode=grp-sh-del&grpid="+a.grpid,ZCL_XHR(e,function(a){var b=ZCL_Evl(1,a.responseText),c,d;c=b.mode,d=b.obj,c=="grp-sh-del"?delete q[1][d[0]]:delete q[0][d[0]],zmUtil.succErrMsg("s","Calendar sharing removed successfully"),z()})},G=function(){var a,b,c,e,f,g,i='<h2 class="recom_conditionHeading">'+zcal.i18n.public_share+"</h2>";i+='<div class="zmL">',i+="<div>",i+='<table class="condition">',i+="<tr><td>",i+='<div><span data-marker="makePublic"><i class="'+(d[10][1]!=0?"msi-check":"msi-uncheck")+'"></i><span class="pl5">'+zcal.i18n.makethiscalpub+"</span></span></div>",d[10][1]!=0&&(i+='<div class="zcl_Sshp zcl_Sshpu">',i+="<div>",i+='<span data-marker="chgPubPerm" rel="fb"><i class="'+(d[10][1]==1||d[10][1]==4?"msi-option":"msi-unoption")+'"></i><span class="pl5">'+zcal.i18n.public_shperm_freebusy+"</span></span>",i+='<span data-marker="chgPubPerm" rel="vd"><i class="'+(d[10][1]==2||d[10][1]==3?"msi-option":"msi-unoption")+'"></i><span class="pl5">'+zcal.i18n.public_shperm_viewevent+"</span></span>",d[13][1]==1&&(i+='<div><span data-marker="allowER"><i class="'+(d[10][1]==3||d[10][1]==4?"msi-check":"msi-uncheck")+'"></i><span class="pl5">'+zcal.i18n.allow_requisition+"</span></span>",i+=d[10][1]==3||d[10][1]==4?'<ul><li><span class="zcl_lk" data-marker="webAPI">'+zcal.i18n.webapiforevent+'</span></li><li><span class="zcl_lk" data-marker="eventReq">'+zcal.i18n.calpubevtreq+"</span></li></ul>":"",i+="</div>"),i+="</div>",i+='<div><span class="zcl_lk" data-marker="pubICAL">'+zcal.i18n.ical+'</span><span class="zcl_sp"></span><span class="zcl_lk" data-marker="pubHTML">'+zcal.i18n.html+"</span></div>",i+="</div>"),i+="</td></tr>",i+="</table>",i+="</div>",i+="</div>",h.html(i),a=h.find("[data-marker=makePublic]").removeAttr("data-marker"),a.off("click").on("click",function(a){var b=$(this).find("i"),c;b.hasClass("msi-check")?(b.removeClass("msi-check").addClass("msi-uncheck"),c=0):(b.removeClass("msi-uncheck").addClass("msi-check"),c=1),H({perm:c,mode:"enable/disable"})}),b=h.find("[data-marker=chgPubPerm]").removeAttr("data-marker"),b.off("click").on("click",function(a){var b=$(this),c=b.parent(),e;e=$(this).attr("rel")==="vd"?2:1,e=d[10][1]>=3?e==1?4:3:e,c.find(".msi-option").removeClass().addClass("msi-unoption"),b.find("i").addClass("msi-option"),H({perm:e,mode:"change"})}),g=h.find("[data-marker=allowER]").removeAttr("data-marker"),g.off("click").on("click",function(a){var b=$(this).find("i"),c;b.hasClass("msi-check")?(b.removeClass("msi-check").addClass("msi-uncheck"),c=0):(b.removeClass("msi-uncheck").addClass("msi-check"),c=1),I(c)}),c=h.find("[data-marker=pubICAL]").removeAttr("data-marker"),c.off("click").on("click",function(a){J("ical")}),e=h.find("[data-marker=pubHTML]").removeAttr("data-marker"),e.off("click").on("click",function(a){J("embed")}),f=h.find("[data-marker=webAPI]").removeAttr("data-marker"),f.off("click").on("click",function(a){K()}),g=h.find("[data-marker=eventReq]").removeAttr("data-marker"),g.off("click").on("click",function(a){Q()})},H=function(a){var b=a.perm,e="/cal/shareCal.do?pubshare="+b+"&mode=pub-sh&calid="+c+"&caluid="+d[9]+"&calmode=0";ZCL_XHR(e,function(c){var e=ZCL_Evl(1,c.responseText),f;e.status==="success"&&(d[10][1]=e.pub,f=a.mode==="change"?zcal.i18n.publicsharechanged:b==0?zcal.i18n.publicshare_disabled:zcal.i18n.publicshare_enabled,zmUtil.succErrMsg("s",f)),G()})},I=function(a){var b=d[10][1],e;a==1?b=b==2?3:4:b=b==4?1:2,e="/cal/shareCal.do?pubshare="+b+"&mode=pub-sh&calid="+c+"&caluid="+d[9]+"&calmode=0",ZCL_XHR(e,function(b){var c=ZCL_Evl(1,b.responseText),e;c.status==="success"&&(d[10][1]=c.pub,e=a==0?zcal.i18n.allow_requisition_disabled:zcal.i18n.allow_requisition_enabled,zmUtil.succErrMsg("s",e)),G()})},J=function(a){$("#zcl_calpubaddress").length||$("body").append("<div id='zcl_calpubaddress' class='zcl_ovr'/>");var b,c=$("#zcl_calpubaddress");b='<div class="SC_set SC_filt_bottom">',b+='<textarea type="text" class="zcl_Stxt">'+location.protocol+"//"+zcal.ZCAL+"/"+(d[14]==""||d[14]=="gcal"?"":d[14]+"/")+a+"/"+d[9]+"</textarea>",b+='<span class="zcl_grey">'+zcal.i18n.calurlmsg+"</span>",b+="</div>",c.html(b);var e={title:zcal.i18n.publicaddress,mask:!0,pos:"center",closeaction:function(){c.remove(),zmsDialog.remove()},customClass:"SC_SetPop"};zmsDialog.create("zcl_calpubaddress",e)},K=function(){$("#zcl_calwebapi").length||$("body").append("<div id='zcl_calwebapi' class='zcl_ovr'/>");var a,b=$("#zcl_calwebapi");a='<div class="SC_set SC_filt_bottom">',a+='<div class="zmL">',a+='<div class="SC_srch shw"><table class="condition">',a+='<tr><td class="gbld">'+zcal.i18n.calwebapimsg+"</td></tr>",a+="<tr><td><table>",a+='<tr><td><textarea type="text" class="zcl_Stxt">'+location.protocol+"//"+zcal.ZCAL+"/eventreq/"+d[9]+"?name=[name]&mailId=[EmailId]&date=[MM/dd/yyyy]&time=[13:00]&reason=[Reason for Appointment]</textarea></td></tr>",a+="</table></td></tr>",a+="</table></div>",a+="</div>",a+="</div>",b.html(a);var c={title:zcal.i18n.apiforeventreq,mask:!0,pos:"center",closeaction:function(){b.remove(),zmsDialog.remove()},customClass:"SC_SetPop"};zmsDialog.create("zcl_calwebapi",c)},L=function(){var a=zcalEmbed.languages(),b='<select class="select">';for(var c in a)b+='<option value="'+c+'">'+a[c]+"</option>";return b+="</select>",b},M,N,O=function(a){this.theme=a&&a.theme||0,this.language=a&&a.lang||"en",this.calKey=a&&a.ckey};O.prototype={setTheme:function(a){this.theme=a},setLanguage:function(a){this.language=a},getURL:function(){var a='<iframe src="'+location.protocol+"//"+zcal.ZCAL+"/eventreqForm/"+this.calKey+"?theme="+this.theme+"&l="+this.language+'" frameborder="0" scrolling="no" marginWidth="0" border="0px" marginHeight="0" height="300px" width="432px" allowTransparency="true" align="center"></iframe>';return a}};var P=function(){N&&N.html('<textarea class="zcl_Stxt">'+M.getURL()+"</textarea>")},Q=function(){$("#zcl_calereq").length||$("body").append("<div id='zcl_calereq' class='zcl_ovr'/>");var a,b=$("#zcl_calereq"),c;M=new O({lang:"en",theme:0,ckey:d[9]}),c=["#D5E4F7","#899AFF","#6FC252","#D4D4D4","#FF8F8F","#FF8FC1","#C9CE46","#FFAE00","#6F0DC2","#C81515"],a='<div class="SC_set SC_filt_bottom">',a+='<div class="conditionDiv">',a+="<table><tr><td>",a+='<div><div class="zmL">',a+='<div class="SC_srch shw">',a+='<table class="condition">',a+='<tr><td class="gbld">'+zcal.i18n.chooseyourclolor+"</td></tr>",a+='<tr><td><ul class="zcl_cecolr" id="zcl_ereqTheme">';for(var e=0;e<c.length;e++)a+='<li style="background-color:'+c[e]+'" class='+(e===M.theme?"zcl_sl":"")+'><i class="msi-tick"></i></li>';a+="</ul></td></tr>",a+="</table>",a+="</div>",a+="</div></div>",a+="</td>",a+="<td>",a+='<div><div class="zmL">',a+='<div class="SC_srch shw">',a+='<table class="condition">',a+='<tr><td class="gbld">'+zcal.i18n.language+"</td></tr>",a+='<tr><td><table><tr><td><div class="SC_select" style="width:100%" data-marker="languageSel"/></td></tr></table></td></tr>',a+="</table>",a+="</div>",a+="</div></div>",a+="</td></tr></table>",a+="</div>",a+='<div class="zmL">',a+='<div class="SC_srch shw"><table class="condition">',a+='<tr><td class="gbld">'+zcal.i18n.calwebapimsg+"</td></tr>",a+="<tr><td><table>",a+='<tr><td data-marker="ereqCode"><textarea class="zcl_Stxt">'+M.getURL()+"</textarea></td></tr>",a+="</table></td></tr>",a+="</table></div>",a+="</div>",a+="</div>",b.html(a),N=b.find("[data-marker=ereqCode]").removeAttr("data-marker");var f=b.find("#zcl_ereqTheme");f.find("li").off("click").on("click",function(a){var b=$(this);b.parent().find("li").removeClass("zcl_sl"),b.addClass("zcl_sl"),M.setTheme(b.index()),P()});var g=b.find("[data-marker=languageSel]").removeAttr("data-marker"),h=L();g.html(h),g.find("select").off("change").on("change",function(a){M.setLanguage(this.value),P()});var i={title:zcal.i18n.calpubevtreq,mask:!0,pos:"center",closeaction:function(){b.remove(),zmsDialog.remove()},customClass:"SC_SetPop",buttons:[{txt:zcal.i18n.preview,callback:function(){var a=window.open(),b;a.document.open(),b=M.getURL().replace(/&lt;/gi,"<").replace(/&gt;/gi,">"),a.document.write("<html><body>"+b+"</body></html>"),a.document.close()}}]};zmsDialog.create("zcl_calereq",i)},R=function(){var a,b,c,e,f='<h2 class="recom_conditionHeading">'+zcal.i18n.privateaddress+"</h2>";f+='<div class="zmL">',f+="<div>",f+='<table class="condition">',f+="<tr><td>",f+='<span data-marker="enablePvtURL"><i class="'+(d[10][0]?"msi-check":"msi-uncheck")+'"></i><span class="pl5">'+zcal.i18n.endableprivateadd+"</span></span>",d[10][0]&&(f+='<div class="zcl_Sshp"><div><span class="zcl_lk" data-marker="pvtICAL">'+zcal.i18n.ical+'</span><span class="zcl_sp"></span><span class="zcl_lk" data-marker="pvtHTML">'+zcal.i18n.html+"</span>",f+='<span class="SC_button zcl_ovr" data-marker="pvtReset">'+zcal.i18n.reset+"</span></div></div>"),f+="</td></tr>",f+="</table>",f+="</div>",f+="</div>",i.html(f),a=i.find("[data-marker=enablePvtURL]").removeAttr("data-marker"),a.off("click").on("click",function(a){var b=$(this).find("i"),c;b.hasClass("msi-check")?(b.removeClass("msi-check").addClass("msi-uncheck"),c="priv-dis"):(c="priv-reset",b.removeClass("msi-uncheck").addClass("msi-check")),S({mode:c,msg:"enable/disable"})}),b=i.find("[data-marker=pvtICAL]").removeAttr("data-marker"),b.off("click").on("click",function(a){T("ical")}),c=i.find("[data-marker=pvtHTML]").removeAttr("data-marker"),c.off("click").on("click",function(a){T("embed")}),$pvtReset=i.find("[data-marker=pvtReset]").removeAttr("data-marker"),$pvtReset.off("click").on("click",function(a){S({mode:"priv-reset",msg:"reset"})})},S=function(a){var b=d[9],e,f=a.mode;e="/cal/shareCal.do?calid="+c+"&caluid="+b+"&mode="+f+"&calmode=0",ZCL_XHR(e,function(b){var c=ZCL_Evl(1,b.responseText);f==="priv-reset"?(d[10][0]=c.pvtId,zmUtil.succErrMsg("s",a.msg=="reset"?zcal.i18n.privateurlchanged:zcal.i18n.privateshare_enabled)):(d[10][0]=null,zmUtil.succErrMsg("s",zcal.i18n.privateshare_disabled)),R()})},T=function(a){var b;$("#zcl_calpvtaddress").length||$("body").append("<div id='zcl_calpvtaddress' class='zcl_ovr'/>"),b=$("#zcl_calpvtaddress");var c='<div class="SC_set SC_filt_bottom">';c+='<textarea type="text" class="zcl_Stxt">'+location.protocol+"//"+zcal.ZCAL+"/"+(d[14]==""?"":d[14]+"/")+a+"/"+d[9]+"/pvt_"+d[10][0]+"</textarea>",c+='<span class="zcl_grey">'+zcal.i18n.calurlmsg+"</span>",c+="</div>",b.html(c);var e={title:zcal.i18n.privateaddress,mask:!0,pos:"center",closeaction:function(){b.remove(),zmsDialog.remove()},customClass:"SC_SetPop"};zmsDialog.create("zcl_calpvtaddress",e)};return a.close=s,a}(zcalShare||{}),zcalEmbed=function(a){a=a||{};var b,c,d,e,f,g,h,i,j=[{w:"600",h:"500",c:-1,v:0},{w:"300",h:"500",c:0,v:-1},{w:"350",h:"500",c:10,v:-1},{w:"300",h:"500",c:0,v:-1},{w:"400",h:"400",c:-1,v:-1},{w:"700",h:"270",c:0,v:-1},{w:"300",h:"400",c:-1,v:-1},{w:"350",h:"500",c:1,v:-1},{w:"300",h:"500",c:7,v:-1},{w:"300",h:"500",c:0,v:-1}],k=function(){return[zcal.i18n.blue,zcal.i18n.green,zcal.i18n.red,zcal.i18n.pink,zcal.i18n.violet,zcal.i18n.rosybrown,zcal.i18n.purple,zcal.i18n.grey,zcal.i18n.orange,zcal.i18n.brown,zcal.i18n.yellow]},l=function(){return zcal.ZCAL.indexOf(".baihui.com")!=-1?{zh:zcal.i18n.chines,en:zcal.i18n.english}:{en:zcal.i18n.english,da:zcal.i18n.danish,de:zcal.i18n.german,es:zcal.i18n.spanish,fr:zcal.i18n.french,hu:zcal.i18n.hungarian,it:zcal.i18n.italian,ja:zcal.i18n.japanes,nl:zcal.i18n.dutch,pl:zcal.i18n.polish,pt:zcal.i18n.portuguese,ru:zcal.i18n.russian,sv:zcal.i18n.swedish,tr:zcal.i18n.turkish,zh:zcal.i18n.chines}},m=function(a){this.template=a&&a.type||0,this.title=a&&a.title,this.defaultCal=a&&a.dcal,this.selectedCal=[],this.view=j[this.template].v,this.color=j[this.template].c,this.language=a&&a.lang||"en",this.width=j[this.template].w,this.height=j[this.template].h,this.timezone=a&&a.tz,this.showTitle=!0,this.showTimezone=!0,this.detailview=!1};m.prototype={setTemplate:function(a){this.template=parseInt(a),this.view=j[this.template].v,this.color=j[this.template].c,this.width=j[this.template].w,this.height=j[this.template].h},setTitle:function(a){this.title=a},setCalendars:function(a){this.selectedCal=a!=""?a.split(","):[]},setView:function(a){this.view=parseInt(a)},setColor:function(a){this.color=parseInt(a)},setLanguage:function(a){this.language=a},setWidth:function(a){this.width=parseInt(a)},setHeight:function(a){this.height=parseInt(a)},setTimezone:function(a){this.timezone=a},setShowTitle:function(a){this.showTitle=a},setShowTimezone:function(a){this.showTimezone=a},setDetailview:function(a){this.detailview=a},getURL:function(){var a='<iframe src="'+location.protocol+"//"+zcal.ZCAL+(d[14]===""||d[14]==="gcal"?"":"/"+d[14])+"/embed/"+this.defaultCal+"?";if(zcal.cdata.calLst[c]){var b=this.selectedCal.length,e="";if(b!=0)for(var f=0;f<b;f++)e+=(f==0?"":",")+this.selectedCal[f];a+=e!=""?"cal="+e+"&":""}return a+="title="+ZCL_getHTML(this.title).replace("&#39;",""),a+="&type="+(this.template+1),a+="&l="+this.language,a+="&tz="+this.timezone,a+="&sh=["+(this.showTitle?1:0)+","+(this.showTimezone?1:0)+","+(this.detailview?1:0)+"]",a+=this.color!=-1?"&c="+this.color:"",a+=this.view!=-1?"&v="+this.view:"",a+='" width="'+this.width+'" height="'+this.height+'" frameborder="0" scrolling="no"></iframe>',a}};var n=function(){return{title:zcal.i18n.calendardetails,style:{"max-width":"750px"},mask:!0,pos:"center",closeaction:t,customClass:"SC_SetPop",buttons:[{txt:zcal.i18n.preview,callback:function(){var a=window.open(),b;a.document.open(),b=e.getURL().replace(/&lt;/gi,"<").replace(/&gt;/gi,">"),a.document.write("<html><body>"+b+"</body></html>"),a.document.close()}},{txt:zcal.i18n.refresh,callback:function(){e=new m({title:d[0],dcal:d[9],tz:zcal.cdata.opt.TIM,lang:zcal.cdata.opt.LANG,type:e.template}),B()}}]}},o=function(){var a=zcal.cdata.calOrdArr,b,c="";return a.forEach(function(a){var b=zcal.cdata.calLst,d=b[a][9]==e.defaultCal||e.selectedCal.indexOf(b[a][9])!=-1?"selected":"";c+='<option value="'+b[a][9]+'" '+d+">"+ZCL_getHTML(b[a][0])+"</option>"}),c},p=function(){var a=k(),b='<select class="select">';for(var c=0;c<a.length;c++)b+='<option value="'+c+'" '+(e.color==c?"selected":"")+">"+a[c]+"</option>";return b+="</select>",b},q=function(){var a=[zcal.i18n.vday,zcal.i18n.week,zcal.i18n.month],b='<select class="select">';for(var c=0;c<a.length;c++)b+='<option value="'+c+'" '+(e.view==c?"selected":"")+">"+a[c]+"</option>";return b+="</select>",b},r=function(){var a=l(),b='<select class="select">';for(var c in a)b+='<option value="'+c+'" '+(e.lang==c?"selected":"")+">"+a[c]+"</option>";return b+="</select>",b},s=function(){var a='<input type="text" readonly  value="'+unescape(zcal.cdata.opt.CTIM)+'" id="zcl_TZ" class="SC_tiput zcl_nrbr" rel="'+zcal.cdata.opt.TIM+'" />\t\t  ';return a},t=function(){b&&(zmsDialog.remove(!0),b.remove(),b=undefined)},u=function(){f&&f.html('<div><div class="zcl_emb'+(e.template+1)+'"></div></div>')},v=function(){var a,b,c,d;if(g){d='<div class="zmL">',d+='<div class="SC_srch shw"><table class="condition">',d+='<tr><td class="gbld">'+zcal.i18n.title+"</td></tr>",d+='<tr><td><input type="text" class="SC_tiput" value="'+ZCL_getHTML(e.title)+'"/></td></tr>',d+="</table></div>",d+="</div>",d+='<div class="zmL">',d+='<div class="SC_srch shw"><table class="condition">',d+='<tr><td class="gbld">'+zcal.i18n.select_calendar+"</td></tr>",d+='<tr><td><select style="width:100%" size="4" multiple="multiple"/></td></tr>',d+="</table></div>",d+="</div>";if(e.color!=-1||e.view!=-1)d+='<div class="zmL">',d+='<div class="SC_srch shw"><table class="condition">',d+='<tr><td class="gbld">'+(e.view!=-1?zcal.i18n.chooseyourview:zcal.i18n.chooseacolor)+"</td></tr>",d+='<tr><td><table><tr><td><div class="SC_select" data-marker="viewColorSel"/></td></tr></table></td></tr>',d+="</table></div>",d+="</div>";g.html(d),a=g.find("input.SC_tiput"),a.off("change").on("change",function(a){e.setTitle(this.value),A()}),b=g.find("select");var f=o();b.html(f),b.off("click").on("click",function(a){var b=$(this),c=[];$.each(b.find("option:selected"),function(){var a=$(this).val();a!=e.defaultCal&&c.push(a)}),e.setCalendars(c.join(",")),A()}),c=g.find("[data-marker=viewColorSel]").removeAttr("data-marker");if(c){var h,i;e.color!=-1?(i=$(p()),i.off("change").on("change",function(a){e.setColor(this.value),A()}),c.html(i)):e.view!=-1&&(i=$(q()),i.off("change").on("change",function(a){e.setView(this.value),A()}),c.html(i))}}},w=function(){var a,b,c,d,f,g;if(h){g='<div class="zmL">',g+='<div class="SC_srch shw"><table class="condition">',g+='<tr><td class="gbld">'+zcal.i18n.language+"</td></tr>",g+='<tr><td><table><tr><td><div class="SC_select" data-marker="languageSel"/></td></tr></table></td></tr>',g+="</table></div>",g+="</div>",g+='<div class="zmL">',g+='<div class="SC_srch shw"><table>',g+='<tr><td><table class="condition">',g+='<tr><td class="gbld">'+zcal.i18n.width+"</td></tr>",g+='<tr><td><table><tr><td><input type="text" id="zcl_embedWdt" class="SC_tiput zcl_nrbr" value="'+e.width+'px"></td></tr></table></td></tr>',g+="</table></td>",g+='<td><table class="condition">',g+='<tr><td class="gbld">'+zcal.i18n.height+"</td></tr>",g+='<tr><td><table><tr><td><input type="text" id="zcl_embedHgt" class="SC_tiput" value="'+e.height+'px"></td></tr></table></td></tr>',g+="</table></td></tr>",g+="</table></div>",g+="</div>",g+='<div class="zmL">',g+='<div class="SC_srch shw"><table class="condition">',g+='<tr><td class="gbld">'+zcal.i18n.timezone+'<span class="zcl_smlk SC_lnk pl5" data-marker="showallTimezone">('+zcal.i18n.showall+")</span></td></tr>",g+='<tr><td><table><tr><td><div class="SC_select" id="zcl_embedTZ">'+s()+"</div></td></tr></table></td></tr>",g+="</table></div>",g+="</div>",g+='<div class="zmL">',g+='<div class="SC_srch shw"><table class="condition">',g+="<tr><td><table>",g+="<tr>",g+='<td><span class="mLnone" id="zcl_embedShowTitle"><i class="'+(e.showTitle?"msi-check":"msi-uncheck")+'"></i><span class="pl5">'+zcal.i18n.title+"</span></span></td>",g+='<td><span class="mLnone" id="zcl_embedShowTz"><i class="'+(e.showTimezone?"msi-check":"msi-uncheck")+'"></i><span class="pl5">'+zcal.i18n.timezone+"</span></span></td>",g+="</tr>",g+="</table></td></tr>",e.template==0&&(g+='<tr><td><span class="mLnone" id="zcl_embedDview"><i class="'+(e.detailview?"msi-check":"msi-uncheck")+'"></i><span class="pl5">'+zcal.i18n.detailsview+"</span></span></td></tr>"),g+="</table></div>",g+="</div>",h.html(g),a=h.find("[data-marker=languageSel]").removeAttr("data-marker");var i=r();a.html(i),a.find("select").off("change").on("change",function(a){e.setLanguage(this.value),A()}),$wdtDOM=h.find("#zcl_embedWdt"),$wdtDOM.off("change").on("change",function(a){var b=this.value;b!=""&&(b=b.replace(/\D/g,""),e.setWidth(b),A())}),c=h.find("#zcl_embedHgt"),c.off("change").on("change",function(a){var b=this.value;b!=""&&(b=b.replace(/\D/g,""),e.setHeight(b),A())}),d=h.find("#zcl_embedTZ select"),d.off("change").on("change",function(a){e.setTimezone(this.value),A()}),f=h.find("[data-marker=showallTimezone]").removeAttr("data-marker"),f&&f.off("click").on("click",function(a){z(),$(this).remove()}),h.find("#zcl_TZ").on("click",function(a){var b=zcal.timezones,c=[];for(var d in b)for(var e in b[d]){var f={};f.id=e,f.name=b[d][e]+" ("+e+")",f.display_text=b[d][e]+" ("+e+")",c.push(f)}var g={},h=$(this),i;g.parentDOM=h.parent(),g.displayAs="dropdown",g.parWidth=!0,g.onSelect=function(a,b){x(h,a,b),i.hide()},g.dataCallback=function(){return c},i=zmUtil.createFLComp("generic",g),i.show()});var j=h.find("#zcl_embedShowTitle");j.off("click").on("click",function(a){var b=$(this),c,d,f;d=b.find("i"),c=d.hasClass("msi-check")?"msi-uncheck":"msi-check",f=c==="msi-check"?!0:!1,d.attr("class",c),e.setShowTitle(f),A()});var k=h.find("#zcl_embedShowTz");k.off("click").on("click",function(a){var b=$(this),c,d,f;d=b.find("i"),c=d.hasClass("msi-check")?"msi-uncheck":"msi-check",f=c==="msi-check"?!0:!1,d.attr("class",c),e.setShowTimezone(f),A()});var l=h.find("#zcl_embedDview");l.off("click").on("click",function(a){var b=$(this),c,d,f;d=b.find("i"),c=d.hasClass("msi-check")?"msi-uncheck":"msi-check",f=c==="msi-check"?!0:!1,d.attr("class",c),e.setDetailview(f),A()})}},x=function(a,b,c){a.val(c.display_text),a.attr("rel",b),a.attr("value",c.display_text),e.setTimezone(b),A()},y=function(){var a="<select>";for(var b in zcal.timezones)for(var c in zcal.timezones[b]){var d=zcal.cdata.opt.TIM==c?"selected":"";a+="<option "+d+" value="+c+">"+unescape(zcal.timezones[b][c])+" ("+c+")"+"</option>"}a+="</select>",$("#zcl_embedTZ").html(a);var f=h.find("#zcl_embedTZ select");f.off("change").on("change",function(a){e.setTimezone(this.value),A()})},z=function(){zcal.timezones.length>0?s():ZCL_getTZ({mode:"embed",callback:function(){zcalEmbed.showAllTimezone()}})},A=function(){i&&i.html('<textarea class="zcl_Stxt">'+e.getURL()+"</textarea>")},B=function(){u(),v(),w(),A()},C=function(a,j){c=a,d=j,e=new m({title:d[0],dcal:d[9],tz:zcal.cdata.opt.TIM,lang:zcal.cdata.opt.LANG}),b||(b=$('<div id="zcl_calembed" class="zcl_ovr zcl_Semd"></div>'),$("body").append(b));var k=$(zcalTemplate.calEmbed()),l,o="";l=k.find("[data-marker=embedTpl]").removeAttr("data-marker");for(var p=0;p<10;p++)o+="<span "+(p==e.template?'class="zcl_sl"':"")+">"+(p+1)+"</span>";l.html(o),l.find("span").off("click").on("click",function(a){var b=$(this);b.parent().find("span").removeClass("zcl_sl"),b.addClass("zcl_sl"),e.setTemplate(b.index()),B()}),f=k.find("[data-marker=embedTplImg]").removeAttr("data-marker"),g=k.find("[data-marker=embedTitleSec]").removeAttr("data-marker"),h=k.find("[data-marker=embedTZSec]").removeAttr("data-marker"),i=k.find("[data-marker=embedCode]").removeAttr("data-marker"),B();var q=n();b.html(k),zmsDialog.create("zcl_calembed",q)};return a.render=C,a.showAllTimezone=s,a.languages=l,a}(zcalEmbed||{});ZCL_prntTitle=function(){return'<div class="zcl_prntlk"><b style="font-size:14px">'+zcal.i18n.calendar+"</b> : "+ZCL_getHTML(ZCL_CALNAME)+"</div>"},ZCL_getPrntWdt=function(){return zcal.view==3?1051:ZCL_getEleWdt(ZCL_$("zcl_workarea"))-zcalInit.scrollWidth()},ZCL_prntPageHdTxt=function(){var a="<!DOCTYPE html><html><head>";return a+='<meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>'+ZCL_replaceProName(zcal.i18n.prttitle)+'</title><link type="text/css" rel="stylesheet" href="'+location.protocol+zcal.cssPath+'zmscal.css"</link><link href="'+(zmail.cssPath.indexOf("zohostatic")!=-1?location.protocol:"")+zmail.cssPath+'zmcss-theme3.css" rel="stylesheet" type="text/css"></link><link href="'+location.protocol+zcal.cssPath+'zmscal-print.css" rel="stylesheet" type="text/css"></link>',a+="</head>",a},ZCL_iPrnt=function(){ZCL_EClrStck();var a,b,c=navigator.userAgent,d={id:"zcl_prntFrame",frameborder:0,style:"top:50px;display:none"};c.match(/rv:11.0/i)?d.src="":d.src="/mail/cal/jsp/print.jsp",a=$("<IFRAME/>",d),ZCL_$("zcl_pdfLoad")||$("body").append("<div id='zcl_pdfLoad' style='display:none'/>");var e=$("#zcl_pdfLoad");b=ZCL_prntPageHdTxt(),b+='<body style="padding-bottom:5px;padding-left:5px;padding-top:10px;overflow:auto;width:'+ZCL_getPrntWdt()+'px;height:100%" class="zcl" id="zcl_print" onload="printDoc()">',b+='<div class="zcl_P">'+ZCL_constructData()+"</div>",b+="<script>printDoc=function(){window.print()}</script></body></html>",e.empty(),e.append(a);var f=a[0].contentWindow||a[0].contentDocument;f.document&&(f=f.document),f.write(b),f.close()},isIE=function(){var a=window.navigator.userAgent,b=a.indexOf("MSIE");return b>0?!0:navigator.userAgent.match(/Trident/)?!0:!1},ZCL_print=function(){isIE()?ZCL_prntPreview(!0):ZCL_iPrnt()},ZCL_prntPreview=function(a){ZCL_EClrStck();var b=ZCL_prntPageHdTxt();b+='<body style="padding-bottom:5px;padding-left:5px;padding-top:10px;overflow:auto;width:'+ZCL_getPrntWdt()+'px;height:100%;display:none" class="zcl" id="zcl_print" onload="ZCL_dispPrntData();'+(a?"window.print()":"")+'">',b+='<div class="zcl_P">',b+=ZCL_constructData(),b+="</div>",b+='<script>ZCL_dispPrntData=function(){document.getElementById("zcl_print").style.display="";}</script></body></html>';var c=navigator.userAgent,d="";c.match(/rv:11.0/i)?d=window.open("","_blank"):d=window.open("/mail/cal/print.do"),d.document.write(b),d.document.close(),d.focus()},ZCL_svPdf=function(){ZCL_EClrStck();var a=ZCL_prntPageHdTxt();a+='<body style="padding-bottom:5px;padding-left:5px;padding-top:10px;overflow:auto;width:'+ZCL_getPrntWdt()+'px;height:100%" class="zcl" id="zcl_print">',a+='<div class="zcl_P">',a+=ZCL_constructData(),a+="</div>",a+="</body></html>",ZCL_formSubmit({zcl_file:ZCL_prntTxt(a),zcl_ori:zcal.view==3?"landscape":"portrait"},"/cal/Pdf.do")},ZCL_prntTxt=function(a){var b=new RegExp(String.fromCharCode(160),"gi");return a=a.replace(b,String.fromCharCode(32)),a=a.replace(/\n\t\r/g,""),a=a.replace(/https/g,"http"),encodeURIComponent(a)};var ZCL_PRINTDATA=[],zcalMonthPrint=function(){var a=[],b,c=150,d="/<|>|&lt;|&gt;|&lt|&gt/gi",e=function(){var b=zcal.mlimit[0].clone();for(var c=0;c<ZCL_PRINTDATA.length;c++)a[c]=0,m(ZCL_PRINTDATA[c],b.dateBy("yyyyMMdd"),7,c),b.setDate(b.getDate()+7)},f=function(a,b){return b==null&&(b=0),new Date(a.substring(0,4),parseInt(a.substring(4,6),10)-1,parseInt(a.substring(6,8),10)+b)},g=[],h=1,i=[],j=16,k={},l=0,m=function(a,c,d,e){h=d,p();var j=ZCL_parseDateStr(c);i[0]=j,i[1]=f(c,d-1);for(var m=0;m<d;m++){var o=new Date,q;o.setTime(j),o.setDate(o.getDate()+m),q=o.dateBy("yyyyMMdd"),a[q]&&a[q].length>0&&n(a[q],m,q,e);var r=7*e+m,s=b.querySelector("#zcl_pm"+r),t=s.offsetHeight-18,u=0,v=0;v=k[r]?k[r].elements.length:0,l=v>=l?v:l,u=v;for(var w=0;w<u;w++)s.appendChild(k[r].elements[w])}var x=b.querySelector("#zcl_pm_r"+e),y;y=l<5?100:l*17+18,x.style.height=y+"px",g=[],k={},l=0},n=function(a,c,d,e){var f,g,h=7*e+c,i=b.querySelector("#zcl_pm"+h);for(var j=0;j<a.length;j++)f=q(c),g=s(f,c,a[j],d),o(f,h,a[j],g,d,e)},o=function(a,b,c,e,f,g){k[b]=k[b]||{};var h=k[b],j=b%7;h.elements=h.elements||[],h.events=h.events||[];for(var l in c){var m=c[l].SUM.replace(d,"").replace(/ /g,"&nbsp;"),n,o,p,q,r,s,t,u=zcal.getCalObj(c[l].CNAME);m==""&&(m="NO SUBJECT"),n=ZCL_parseDateStr(c[l].SD),o=ZCL_parseDateStr(c[l].ED),p=ZCL_timeInUFormat(c[l].ST),q=zcalEvents.alltime(c[l]),r=u[1].split(":"),s=ZCL_getCalColor(r[0]),t=r[1]==0?"zcl_event zcl_evwh":"zcl_event zcl_evbl";if(c[l].ADAY=="1"||o>n){var v=document.createElement("DIV");v.style.width=e+"px",v.className="zcl_mallev";var w='<div class="zcl_mthev"><div class="'+t+'" style="background-color:#ffffff;border-color:'+s[0]+'">';w+='<ul><li class="zcl_sp"></li><li>'+q+"<span>"+ZCL_getHTML(m)+"</span></li></ul>",w+="</div></div>",v.innerHTML=w,h.elements.splice(a,0,v),h.events.splice(a,0,c);var x=c[l].ED;x=ZCL_parseDateStr(x);var y=0;x>=i[1]?y=ZCL_daysBetween(f,i[1].dateBy("yyyyMMdd"))+1:x<i[1]&&(y=ZCL_daysBetween(f,x.dateBy("yyyyMMdd"))+1);for(var z=b+1;z<b+y;z++){k[z]=k[z]||{};var A=k[z],B;A.elements=A.elements||[],A.events=A.events||[],B=document.createElement("DIV"),B.className="zcl_edmy",A.elements.splice(a,0,B),A.events.splice(a,0,c)}}else{var C=document.createElement("DIV");C.className="zcl_mevent",C.innerHTML='<div><em class="zcl_st" style="color:'+s[0]+';">'+p+'</em><span style="color:'+s[0]+';">'+ZCL_getHTML(m)+"</span></div>",h.elements.splice(a,0,C),h.events.splice(a,0,c)}}},p=function(){var a=g[g.length]=new Array;for(var b=0;b<h;b++)a[b]=0;return g.length-1},q=function(a){for(var b=0;b<g.length;b++)if(g[b][a]==0)return b;return p()},r=function(a,b,c){var d=g[a];for(var e=b;e<c+b;e++)d[e]=1},s=function(a,b,d,e){var f="",g="",h=0;for(var j in d)g=d[j].ED;return g=ZCL_parseDateStr(g),g>=i[1]?f=ZCL_daysBetween(e,i[1].dateBy("yyyyMMdd"))+1:g<i[1]&&(f=ZCL_daysBetween(e,g.dateBy("yyyyMMdd"))+1),r(a,b,f),f*c-5},t=function(){return b=zcalView.constMonthPrintView(),e(),b.outerHTML},u={printMonth:t};return u}(),crmCalId,zcalCRM=function(){var a="Contact Name",b="Related To",c="Created Time",d="Modified Time",e,f=0,g,h,i=[],j=[],k=[],l=[],n="",o={},p={},q={},r={},s,t=function(){f=zcal.getCalObj(crmCalId)[14]=="recruit"?1:0,zcal.EOBJ.EID==null&&u(),e?x():ZCL_uXHR("/cal/getCRMFlds.do?service="+(f==1?"ZohoRecruit":"ZohoCrm"),function(a){var b=ZCL_Evl(1,a.responseText);(b.status="success")&&w(b)})},u=function(){zcal.EOBJ.SUM=ZCL_$("zcl_ce_tit")?ZCL_$("zcl_ce_tit").value:zcal.EOBJ.SUM,zcal.EOBJ.Venue=ZCL_$("zcl_ce_loc")?ZCL_$("zcl_ce_loc").value:"",zcal.EOBJ.Description=ZCL_$("zcl_ce_desc")?ZCL_$("zcl_ce_desc").value:"",zcal.EOBJ.SD=ZCL_$("zcl_ce_sd")?ZCL_DFDate(ZCL_$("zcl_ce_sd").value):zcal.EOBJ.SD,zcal.EOBJ.ST=ZCL_$("zcl_ce_st")?ZCL_TimetoNo(ZCL_$("zcl_ce_st").style.display==""?ZCL_$("zcl_ce_st").value:"00:00"):zcal.EOBJ.ST,zcal.EOBJ.ED=ZCL_$("zcl_ce_ed")?ZCL_DFDate(ZCL_$("zcl_ce_ed").value):zcal.EOBJ.ED,zcal.EOBJ.ET=ZCL_$("zcl_ce_et")?ZCL_TimetoNo(ZCL_$("zcl_ce_et").style.display==""?ZCL_$("zcl_ce_et").value:"00:00"):zcal.EOBJ.ET},v=function(){e=undefined,g=[],h=[],l=[],k=[],crmCalId=undefined,f=0},w=function(a){zcal.EOBJ.SERVICE=a.mode||"crm",crmCalId=zcal.EOBJ.CNAME,e={},e.flds=a.flds.Events.section,e.fieldname=a.fieldname,e.fieldtype=a.fieldtype,e.fieldlabel=a.fieldlabel,g=a.relatedto_modules,h=a.associate_modules,x()},x=function(){ZCL_clrStck();var b=e.flds,c="",d=!1;if(zcal.EOBJ.SEMODULE)if(zcal.EOBJ.SEMODULE=="Leads")n="Leads";else if(zcal.EOBJ.SEMODULE=="Candidates")n="Candidates";else if(zcal.EOBJ[a]||zcal.EOBJ.SEMODULE=="Contacts")n="Contacts";c+='<div class="zcl zcl_CMS zcl_H100" id="zcl_ce">',c+=z(),c+='<div class="zcl_table zcl_H100">',zcal.EMODE==0?(d=!0,c+='<ul><li><ul class="zcl_crevnt" id="zcl_ce_ele"><li><ul class="zcl_vwev"><li>'+B()+y(b)+"</li>"+'<li class="zcl_crmnt">'+'<div class="zcl_table">'+"<ul>"+"<li>"+zcal.i18n.notes+"</li>"+'<li class="zcl_txr">'+'<span class="zcl_lk" id="zcl_addnote"><i class="msi-add"></i>'+zcal.i18n.addnotes+"</span>"+"</li>"+"</ul>"+"</div>"+'<div data-marker="loadingAnimation"></div>'+"</li>"+"</ul>"+"</li>"+"</ul>"+'<li class="zcl_Cer zcl_vwCer" id="zcl_ce_ext">'+S()+T()+"</li>"+"</ul>"):c+='<ul><li><ul class="zcl_crevnt" id="zcl_ce_ele"><li>'+B()+y(b)+A()+"</li>"+"</ul>"+"</li>"+'<li class="zcl_Cer" id="zcl_ce_ext">'+S()+T()+"</li>"+"</ul>",c+="</div></div>",ZCL_$("zcl_ce")?(ZCL_updEventPrevHeader("crm"),$("#zcl_ce").parent().html(c)):ZCL_setEventWorkSpace(c,"crm"),k.length>0&&($("#zcl_custfldname").val(k.join(";")),$("#zcl_custfldlbl").val(l.join(";"))),W();if(d){var g,h;h=$("#zcl_ce").find("span#zcl_addnote"),h.length&&h.off("click").on("click",function(){var a=$(this).closest("li.zcl_crmnt");bu(a)}),g=$("#zcl_ce").find("[data-marker=loadingAnimation]").removeAttr("data-marker"),zmComponent.loadingBand({container:g[0],type:"pagination"}),g.show();var i=zcal.EOBJ.ACTIVITYID,j=f==1?"ZohoRecruit":"ZohoCrm";ZCL_uXHR("/cal/crmNotes.do?mode=list&eventId="+i+"&service="+j,function(a){g.hide(),bo(a)})}zcal.EOBJ.ACTIVITYID&&by(zcal.EOBJ.ACTIVITYID)},y=function(a){k=[],l=[];var b="";for(var c=0;c<a.length;c++){var d=a[c],e=d.FL,f="";for(var g in e){var h=e[g];h.customfield=="true"&&(k.push(h.label),l.push(h.dv));switch(h.type){case"Lookup":f+=G(h);break;case"Text":case"Email":case"Currency":case"Phone":case"Website":h.label!="Recurring Activity"&&h.label!="Subject"&&h.label!="Remind At"&&(f+=H(h));break;case"Date":f+=I(h);break;case"DateTime":h.label!="Start DateTime"&&h.label!="End DateTime"&&(f+=J(h));break;case"TextArea":f+=K(h);break;case"Boolean":f+=L(h);break;case"Integer":case"Double":f+=M(h);break;case"Pick List":f+=N(h);break;case"Multiselect Pick List":f+=O(h);break;case"AutoNumber":f+=P(h);break;case"Formula":f+=Q(h)}}b+=f}return b},z=function(){var a=ZCL_hdnFld("zcl_activityid",zcal.EOBJ.ACTIVITYID?zcal.EOBJ.ACTIVITYID:"")+ZCL_hdnFld("zcl_eid",zcal.EOBJ.EID?zcal.EOBJ.EID:"")+ZCL_hdnFld("zcl_ekey",zcal.EOBJ.EUID?zcal.EOBJ.EUID:"")+ZCL_hdnFld("zcl_crel",crmCalId)+ZCL_hdnFld("zcl_rmvatt","")+ZCL_hdnFld("zcl_crmfldname",e.fieldname)+ZCL_hdnFld("zcl_crmfldtype",e.fieldtype)+ZCL_hdnFld("zcl_crmfldlabel",e.fieldlabel)+ZCL_hdnFld("zcl_custfldname","")+ZCL_hdnFld("zcl_custfldlbl","");return a},A=function(){var a='<ul class="zcl_frmrw"><li><div class="SC_PUbtm"><span data-marker="crmEventSave">'+zcal.i18n.save+"</span>"+'<span data-marker="crmFormClose" data-val="Cancel">'+zcal.i18n.cancel+"</span>"+"</div>"+"</li>"+"</ul>";return a},B=function(){var a=C();return a+=D(),a+=E(),a},C=function(){var a='<ul class="zcl_frmrw">',b;return zcal.EMODE==0?(b=zcal.EOBJ.SUM?ZCL_getHTML(zcal.EOBJ.SUM):"",a+='<li><div class="zcl_evttvw">'+b+"</div>"+F()+"</li>"):(b=zcal.EOBJ.SUM?ZCL_getHTML(zcal.EOBJ.SUM):"",a+='<li class="zcl_W70pc"><input type="text" placeholder="Untitled event" class="zcl_crevntt SC_tiput" value="'+b+'" id="zcl_ce_tit">'+"</li>"),a+="</ul>",a},D=function(){var a=zcal.timeformat[zcal.cdata.opt.TF],b=zcal.EOBJ.ADAY&&zcal.EOBJ.ADAY==1?!0:!1,c=zcal.EOBJ.SD,d=zcal.EOBJ.ED,e=b?"8:00 am":zcal.EOBJ.ST,f=b?"8:30 am":zcal.EOBJ.ET,g=e.getTimeBy(a),h=f.getTimeBy(a),i=ZCL_splitDateVal(ZCL_putDate(c)),j=ZCL_splitDateVal(ZCL_putDate(d)),k=ZCL_parseTime(g),l=ZCL_parseTime(h);ZCL_ESDATE=new Date(i[2],i[1]-1,i[0],k.HH,k.mm,0,0),ZCL_EEDATE=new Date(j[2],j[1]-1,j[0],l.HH,l.mm,0,0);if(zcal.EMODE==0){var m=ZCL_parseDateStr(c),n=ZCL_parseDateStr(d),o='<ul class="zcl_frmrw"><li>'+m.dateBy("MMM dd, yyyy");return b?o+=c!=d?" - "+n.dateBy("MMM dd, yyyy"):"":o+=c!=d?", "+g+" - "+n.dateBy("MMM dd, yyyy")+", "+h:", "+g+" - "+h,o+="</li></ul>",o}var p=b?'style="display:none"':"",o='<ul class="zcl_frmrw zcl_when"><li class="zcl_select"><input class="zcl_w100 SC_tiput" type="text" value="'+ZCL_putDate(c)+'" id="zcl_ce_sd" readonly />'+"</li>"+"&nbsp;&nbsp;"+'<li class="zcl_select" '+p+">"+'<input class="zcl_w70 SC_tiput" type="text" id="zcl_ce_st" value="'+g+'"/>'+"</li>"+'<li class="zcl_tmto">to</li>'+'<li class="zcl_select">'+'<input class="zcl_w100 SC_tiput" type="text" value="'+ZCL_putDate(d)+'" id="zcl_ce_ed" readonly />'+"</li>"+"&nbsp;&nbsp;"+'<li class="zcl_select" '+p+">"+'<input class="zcl_w70 SC_tiput" type="text" id="zcl_ce_et" value="'+h+'"/>'+"</li>"+"</ul>";return o+='<ul class="zcl_frmrw"><li class="zcl_curpt"><i class="'+(zcal.EOBJ.ADAY&&zcal.EOBJ.ADAY==1?"msi-check":"msi-uncheck")+'" id="zcl_ce_aday"></i>'+zcal.i18n.allday+"</li>"+"</ul>",o},E=function(){return'<ul class="zcl_frmrw"><li><u class="zcl_grey">'+zcal.i18n.calendar+"</u><span>"+ZCL_GetCalName(crmCalId)+"</span></li></ul>"},F=function(){var c="";if(zcal.EMODE==0){var d="",e="",f="",i="",j="",k;g&&g.length>0&&(!zcal.EOBJ.SEMODULE||zcal.EOBJ.SEMODULE!="Leads"&&zcal.EOBJ.SEMODULE!="Candidates"?zcal.EOBJ[a]&&(e=zcal.EOBJ[a],d=zcal.EOBJ.CONTACTID):(e=zcal.EOBJ[b],d=zcal.EOBJ.RELATEDTOID)),h&&h.length>0&&zcal.EOBJ.SEMODULE&&zcal.EOBJ.SEMODULE!="Leads"&&zcal.EOBJ.SEMODULE!="Candidates"&&zcal.EOBJ.SEMODULE!="Contacts"&&(f=zcal.EOBJ.SEMODULE,i=zcal.EOBJ.RELATEDTOID?zcal.EOBJ.RELATEDTOID:"",j=zcal.EOBJ[b]?zcal.EOBJ[b]:"",k=bd(f));if(e!=""||j!="")c+='<div class="zcl_crminf"><span class="zcl_grey">'+ZCL_replaceString(zcal.i18n.eventfor,["</span><span>"+e])+"</span>",c!=""&&j!=""&&(c+='<div class="zcl_SDot"></div>'),j!=""&&(c+='<span class="zcl_grey">'+k+" </span><span>"+j+"</span>"),c+="</div>"}return c},G=function(c){if(c.label=="Event Owner")return c.isreadonly=="true"&&(f==1?j=[]:i=[]),"";var d="";if(zcal.EMODE==0)var e="",k="";else if(c.label=="Who Id"&&g&&g.length>0){var l="",m="",k="";g.unshift({None:zcal.i18n.none}),h&&h.length>0&&g.push({Others:"Others"}),!zcal.EOBJ.SEMODULE||zcal.EOBJ.SEMODULE!="Leads"&&zcal.EOBJ.SEMODULE!="Candidates"?zcal.EOBJ[a]&&(m=zcal.EOBJ[a],l=zcal.EOBJ.CONTACTID):(m=zcal.EOBJ[b],l=zcal.EOBJ.RELATEDTOID);var o=n!=""?n:zcal.EOBJ.SEMODULE?"Others":"";d+='<ul class="zcl_frmrw"><li><u>'+zcal.i18n.relatedto+"</u></li>",d+='<li><div class="SC_select"><select id="zcl_CrmEvents_CONTACTMODULE" class="select">';for(var p=0;p<g.length;p++){var q=g[p];for(var r in q)k=k==""&&r==o?q[r]:k,d+='<option value="'+r+'" '+(r==o?'selected="selected"':"")+">"+q[r]+"</option>"}d+="</select>",d+="</div>",d+="</li></ul>",n!=""&&(d+=Y(k,m,l))}else if(c.label=="What Id"&&h&&h.length>0&&zcal.EOBJ.SEMODULE&&zcal.EOBJ.SEMODULE!="Leads"&&zcal.EOBJ.SEMODULE!="Candidates"&&zcal.EOBJ.SEMODULE!="Contacts"){var s=zcal.EOBJ.SEMODULE,t=zcal.EOBJ.RELATEDTOID?zcal.EOBJ.RELATEDTOID:"",u=zcal.EOBJ[b]?zcal.EOBJ[b]:"";d+=bc(s,u,t)}return d},H=function(a){var b="",c=R(a);return b+='<ul class="zcl_frmrw"><li class="zcl_W70pc"><u>'+(zcal.EMODE==1&&a.req=="true"?"&#42;":"")+a.dv+"</u>",zcal.EMODE==0||a.isreadonly=="true"?b+=c!=""?c:"---":b+='<input type="text" class="zcl_crlk SC_tiput" value="'+c+'" id="zcl_'+a.label+'" maxlength="'+a.maxlength+'">',b+="</li>",b+="</ul>",b},I=function(a){var b=zcal.timeformat[zcal.cdata.opt.TF],c="",d=R(a);c+='<ul class="zcl_frmrw"><li class="zcl_select"><u>'+(zcal.EMODE==1&&a.req=="true"?"&#42;":"")+a.dv+"</u>";if(zcal.EMODE==0||a.isreadonly=="true")c+=d!=""?d:"---";else{var e=d!=""?ZCL_putDate(U(d,0)[0]):"";c+='<input class="zcl_w100 SC_tiput" type="text" data-marker="dateField" value="'+e+'" id="zcl_'+a.label+'" readonly />'}return c+="</li>",c+="</ul>",c},J=function(a){var b=zcal.timeformat[zcal.cdata.opt.TF],c="",d=R(a),e="",f=V().getTimeBy(b);c+='<ul class="zcl_frmrw">';if(zcal.EMODE==0||a.isreadonly=="true")c+="<li><u>"+(zcal.EMODE==1&&a.req=="true"?"&#42;":"")+a.dv+"</u>"+(d!=""?d:"---")+"</li>";else{if(d!=""){var g=U(d,0);e=ZCL_putDate(g[0]),f=g[1].getTimeBy(b)}c+='<li class="zcl_select"><u>'+(zcal.EMODE==1&&a.req=="true"?"&#42;":"")+a.dv+"</u>"+'<input class="zcl_w100 SC_tiput zcl_m20" type="text" data-marker="dateField" value="'+e+'" id="zcl_'+a.label+'" readonly />'+'<input class="zcl_w70 SC_tiput" type="text" data-marker="timeField" id="zcl_'+a.label+'_time" value="'+f+'"/>'+"</li>"}return c+="</ul>",c},K=function(a){var b=R(a),c="";return c+='<ul class="zcl_frmrw"><li class="zcl_W70pc"><u>'+(zcal.EMODE==1&&a.req=="true"?"&#42;":"")+a.dv+"</u>",zcal.EMODE==0||a.isreadonly=="true"?c+=b!=""?ZCL_getDescHTML(b):"---":c+='<textarea style="height:44px;" class="zcl_Cedes SC_tiput" id="zcl_'+a.label+'">'+b+"</textarea>",c+="</li>",c+="</ul>",c},L=function(a){var b=R(a)=="true"?!0:!1,c="";return c+='<ul class="zcl_frmrw"><li class="zcl_curpt">',zcal.EMODE==0||a.isreadonly=="true"?(c+="<u>"+(zcal.EMODE==1&&a.req=="true"?"&#42;":"")+a.dv+"</u>",c+=b?zcal.i18n.yes:"---"):(c+='<i class="'+(b?"msi-check":"msi-uncheck")+'" data-marker="chkboxField" id="zcl_'+a.label+'"></i>',c+=(zcal.EMODE==1&&a.req=="true"?"&#42;":"")+a.dv),c+="</li>",c+="</ul>",c},M=function(a){var b=R(a),c="";return c+='<ul class="zcl_frmrw"><li class="zcl_W70pc"><u>'+(zcal.EMODE==1&&a.req=="true"?"&#42;":"")+a.dv+"</u>",zcal.EMODE==0||a.isreadonly=="true"?c+=b!=""?b:"---":c+='<input class="zcl_w70 SC_tiput" type="text" id="zcl_'+a.label+'" value="'+b+'" maxlength="'+a.maxlength+'"/>',c+="</li>",c+="</ul>",c},N=function(a){var b=R(a),c=a.val,d="";d+='<ul class="zcl_frmrw"><li><u>'+(zcal.EMODE==1&&a.req=="true"?"&#42;":"")+a.dv+"</u>";if(zcal.EMODE==0||a.isreadonly=="true")d+=b!=""?b:"---";else{d+='<div class="SC_select"><select id="zcl_'+a.label+'" class="select">';for(var e=0;e<c.length;e++)c[e].content&&c[e].default?d+='<option value="'+c[e].content+'" selected="true">'+c[e].content+"</option>":d+='<option value="'+c[e]+'" '+(c[e]==b?"selected":"")+">"+c[e]+"</option>";d+="</select>",d+="</div>"}return d+="</li>",d+="</ul>",d},O=function(a){var b=R(a),c=a.val,d="";d+='<ul class="zcl_frmrw"><li class="zcl_W70pc"><u>'+(zcal.EMODE==1&&a.req=="true"?"&#42;":"")+a.dv+"</u>";if(zcal.EMODE==0||a.isreadonly=="true")d+=b!=""?b:"---";else{var e=b!=""?b+";":"";d+='<div class="SC_select"><select id="zcl_'+a.label+'" class="select" multiple="multiple" style="height:auto">';for(var f=0;f<c.length;f++)c[f].content&&c[f].default?d+='<option value="'+c[f].content+'" selected="true">'+c[f].content+"</option>":d+='<option value="'+c[f]+'" '+(e.indexOf(c[f]+";")!=-1?"selected='true'":"")+">"+c[f]+"</option>";d+="</select>",d+="</div>"}return d+="</li>",d+="</ul>",d},P=function(a){var b="";if(zcal.EMODE==0){var c=R(a);b+='<ul class="zcl_frmrw"><li><u>'+a.dv+"</u>"+(c!=""?c:"---")+"</li>"+"</ul>"}return b},Q=function(a){var b="";if(zcal.EMODE==0){var c=R(a);b+='<ul class="zcl_frmrw"><li><u>'+a.dv+"</u>"+(c!=""?c:"---")+"</li>"+"</ul>"}return b},R=function(a){return a.customfield=="true"?zcal.EOBJ[a.dv]?zcal.EOBJ[a.dv]:"":zcal.EOBJ[a.label]?zcal.EOBJ[a.label]:""},S=function(){var a=zcal.EOBJ.ORGM?zcal.EOBJ.ORGM:f==1?o.Name:p.Name,b=zcal.EOBJ.SMOWNERID?zcal.EOBJ.SMOWNERID:f==1?o.USERID:p.USERID,c='<ul class="zcl_vwmeta"><li><span onclick="ZCL_tgleNxtEle(this)"><i class="msi-barrow"></i>'+zcal.i18n.eventinfo+"</span></li>";c+='<li><div class="zcl_table">',c+="<ul><li>"+(zcal.EOBJ.ORG_PH?'<img src="'+zcal.EOBJ.ORG_PH+'"/>':"")+"</li>"+"<li>"+"<b>"+zcal.i18n.organizer,c+='</b><span class="zcl_lk" id="zcl_ownerName">'+a+"</span>"+'<input type="hidden" value="'+b+'" id="zcl_ownerId"/>'+"</li>"+"</ul>";if(zcal.EOBJ.ACTIVITYID){var d=zcal.EOBJ.CRETIME.split(","),e=zcal.EOBJ.LSTMODTIME.split(",");c+="<ul><li>"+(zcal.EOBJ.CREBY_PH?'<img src="'+zcal.EOBJ.CREBY_PH+'">':"")+"</li>"+"<li>"+(zcal.EOBJ.CREBY?"<b>"+zcal.i18n.createdby+'</b><span class="zcl_lk">'+zcal.EOBJ.CREBY+"</span>":"<b>"+zcal.i18n.createdon+"</b>")+"<u>"+ZCL_parseDateStr(d[1]).dateBy("NNN dd, yyyy")+" @ "+ZCL_parseTime(d[2]).HH+":"+ZCL_parseTime(d[2]).mm+"</u>"+"</li>"+"</ul>",c+="<ul><li>"+(zcal.EOBJ.MODBY_PH?'<img src="'+zcal.EOBJ.MODBY_PH+'"/>':"")+"</li>"+"<li>"+(zcal.EOBJ.MODBY?"<b>"+zcal.i18n.modifiedby+'</b><span class="zcl_lk">'+zcal.EOBJ.MODBY+"</span>":"<b>"+zcal.i18n.modifiedon+"</b>")+"<u>"+ZCL_parseDateStr(e[1]).dateBy("NNN dd, yyyy")+" @ "+ZCL_parseTime(e[2]).HH+":"+ZCL_parseTime(e[2]).mm+"</u>"+"</li>"+"</ul>"}return c+="</div></li></ul>",c},T=function(){var a='<ul class="zcl_frmrw" id="zcl_crmatt_info"><li class="zcl_att"><u>'+zcal.i18n.attendees+"</u>";return zcal.EMODE==1&&(a+='<ul class="zcl_frmrw zcl_pddbz"><li class="zcl_atte"><div id="zcl_crmatt"><input type="text" id="zcl_ce_att_tbox" class="zm_sgst" placeholder="'+zcal.i18n.typeaemailid+'">'+"</div>"+"</li>"+"</ul>"),a+="</li>",a+='<div><div class="zcl_viwatlst zcl_table" id="attlist"></div></div></ul>',a},U=function(a,b){if(a){var c=a.substring(0,4),d=a.substring(5,7),e=a.substring(8,10),f=a.substring(11,13),g=a.substring(14,16);return[c+d+e,f+g]}var h=new Date,i,j,k;return h.setTime(zcal.cdata.opt.DATE),i=h.getHours(),j=h.getMinutes(),k=i*2+(j>30?2:1),k=k>46?46:k,[h.dateBy("yyyyMMdd"),zcal.TTT[k+b]]},V=function(){var a=new Date,b=a.getHours(),c=a.getMinutes(),d=b*2+(c>30?2:1);return d=d>46?46:d,zcal.TTT[d]},W=function(){var a=$("#zcl_ce"),b=ZCL_$("zcl_ce_sd"),c=ZCL_$("zcl_ce_ed"),d,e;_stEle=ZCL_$("zcl_ce_st"),_etEle=ZCL_$("zcl_ce_et"),$allday=a.find("#zcl_ce_aday"),$dateField=a.find("[data-marker=dateField]"),$timeField=a.find("[data-marker=timeField]"),$chkboxField=a.find("[data-marker=chkboxField]"),$searchIcon=a.find(".msi-search"),$crmAtt=a.find("#zcl_crmatt"),$attAdd=$("#zcl_crmatt_info").find("[data-marker=attendeeAdd]"),$saveBtn=a.find("[data-marker=crmEventSave]"),$closeBtn=a.find("[data-marker=crmFormClose]"),b&&ZEVENTS(b.parentNode).picker("date",{dform:zcal.DFORMAT[zcal.cdata.opt.DF],refer:"zcl_ce_sd",wkst:0,mode:"popup",update:"yes",minhgt:251}).on("dateclick",function(){ZCL_calcEed(b)}).bind(),c&&ZEVENTS(c.parentNode).picker("date",{dform:zcal.DFORMAT[zcal.cdata.opt.DF],refer:"zcl_ce_ed",wkst:0,mode:"popup",update:"yes",minhgt:251}).on("dateclick",function(){ZCL_setEed(c)}).bind(),_stEle&&ZEVENTS(_stEle).picker("time",{tform:zcal.timeformat[zcal.cdata.opt.TF],refer:"zcl_ce_st"}).on("change",function(){ZCL_calcEed(_stEle,!0)}).bind(),_etEle&&ZEVENTS(_etEle).picker("time",{tform:zcal.timeformat[zcal.cdata.opt.TF],refer:"zcl_ce_et"}).on("change",function(){ZCL_setEed(_etEle,!0)}).bind(),$allday.length>0&&$allday.parent().off("click").on("click",function(){ZCL_ChgChk(this),ZCL_checkAll()});if($dateField.length>0){$dateField.removeAttr("data-marker");for(var g=0;g<$dateField.length;g++){var h=$dateField[g];ZEVENTS(h).picker("date",{dform:zcal.DFORMAT[zcal.cdata.opt.DF],refer:h.id,wkst:0,mode:"popup",update:"yes",minhgt:251}).bind()}}if($timeField.length>0){$timeField.removeAttr("data-marker");for(var g=0;g<$timeField.length;g++){var i=$timeField[g];ZEVENTS(i).picker("time",{tform:zcal.timeformat[zcal.cdata.opt.TF],refer:i.id}).bind()}}$chkboxField.length>0&&($chkboxField.removeAttr("data-marker"),$chkboxField.parent().off("click").on("click",function(){ZCL_ChgChk(this)})),d=a.find("#zcl_CrmEvents_CONTACTMODULE"),d.length>0&&d.off("change").on("change",function(){var a=this.value,b=$(this);switch(a){case"Leads":case"Candidates":bf(b),Z(b);break;case"Contacts":bf(b),ba(b);break;case"Others":bf(b),bb(b);break;case"None":bf(b)}}),e=a.find("#zcl_CrmEvents_SEMODULE"),e.length>0&&e.off("change").on("change",function(){$("#zcl_CrmEvents_SEID").val(""),$("#zcl_CrmEvents_SENAME").val("")}),$searchIcon.length>0&&$searchIcon.off("click").on("click",function(a){var b=$(this),c=b.data("fname"),d=b.data("fid"),e;d==="zcl_CrmEvents_SEID"?e=$("#zcl_CrmEvents_SEMODULE").val():d==="zcl_CrmEvents_CONTACTID"&&(e=$("#zcl_CrmEvents_CONTACTMODULE").val());if(e){var g=document.location.hostname.startsWith("zmail")?"mail":"zmail",h=(f==1?zcal.ZRECRUIT+"/recruit":zcal.ZCRM+"/crm")+"/Search.do?service="+g+"&searchmodule="+e+"&fldName="+c+"&fldId="+d+"&fldValue=",i=(document.body.offsetHeight-400)/2,j=(document.body.offsetWidth-700)/2;window.addEventListener("message",function(a){_(a,{fldName:c,fldId:d,module:e}),this.removeEventListener("message",arguments.caller?arguments.caller.callee:arguments.callee)},!1),window.open(h,"calwindow","menubar=no,toolbar=no,location=no,status=no,scrollbars=yes,resizable=yes,width=700,height=400,left="+j+",top="+i)}}),$crmAtt.length>0&&($("#zcl_ce_att_tbox").on("keydown",function(a){if(a.keyCode==13&&this.id=="zcl_ce_att_tbox"){var b=this.value.split(",");for(var c=0;c<b.length;c++){var d=b[c].trim(),e=d.indexOf("<"),f=d.indexOf(">");e>-1&&f>-1&&(d=d.substring(e+1,f)),d=d.replace(/,/g,"")}if(ZCL_isEmail(d)){var g={};g.id=d,X(g),$("#zcl_ce_att_tbox").val("")}}}),zmAppLoader.load("zmContactsAutoComplete").done(function(){zmContactsAutoComplete.autoComplete({input:$("#zcl_ce_att_tbox")[0],contactType:["org","crm"],excludeMe:!0,exclude:function(){var a=[];if($("#attlist")[0].childNodes){var b=$("#attlist")[0].childNodes;for(var c in b)a.push(b[c].id)}return a},onSelect:function(a,b){var b=b.item.attributes;X(b)}})}),$attAdd.length>0&&$attAdd.off("click").on("click",function(){var a=ZCL_getAttendee($("#attlist"));if(a!=""){var b,c=$("#zcl_activityid").val(),d=f==1?"ZohoRecruit":"ZohoCrm";b="/cal/crmInvitees.do?mode=add&eventId="+c+"&service="+d+"&att="+a.zcalescape(),ZCL_XHR(b,function(a){var b=ZCL_Evl(1,a.responseText);bz(b,c)})}})),$saveBtn.length>0&&$saveBtn.off("click").on("click",function(){bg()}),$closeBtn.length>0&&$closeBtn.off("click").on("click",function(){v(),ZCL_eClose()})},X=function(a){var b=$("#attlist"),c=document.createElement("ul");a.zid&&c.setAttribute("data-zid",a.zid),c.setAttribute("id",a.id),c.setAttribute("class","zcl_sl"),c.innerHTML="<li>"+(a.profileImage?"<img src="+a.profileImage+">":"")+"</li><li><b>"+a.id+'</b></li><li class="zcl_txr"><i class="msi-close" onclick="ZCL_rmvAtt(this,\''+a.id+'\')" title="Remove" ></i></li>',$("#zcl_crm_attlist")[0]?(c.innerHTML="<li>"+(a.profileImage?"<img src="+a.profileImage+">":"")+"</li><li><b>"+a.id+'</b></li><li><i class="msi-close" onclick="ZCL_rmvAtt(this,\''+a.id+'\')" title="Remove" ></i></li>',$("#zcl_crm_attlist").prepend(b.append($(c)))):(c.innerHTML="<li>"+(a.profileImage?"<img src="+a.profileImage+">":"")+"</li><li><b>"+a.id+'</b></li><li class="zcl_txr"><i class="msi-close" onclick="ZCL_rmvAtt(this,\''+a.id+'\')" title="Remove" ></i></li>',b.append($(c))),$("#zcl_ce_att_tbox").val("")},Y=function(a,b,c){var d='<ul class="zcl_frmrw"><li><u>'+a+"</u>"+'<input type="text" class="zcl_w200 SC_tiput zcl_m10" id="zcl_CrmEvents_CONTACTNAME" value="'+b+'" readonly>'+'<input type="hidden" value="'+c+'" id="zcl_CrmEvents_CONTACTID">'+'<i class="msi-search" data-fname="zcl_CrmEvents_CONTACTNAME" data-fid="zcl_CrmEvents_CONTACTID"></i>'+"</li>"+"</ul>";return d},Z=function(a){var c=a.find("option:selected").text(),d,e="",g="",h;zcal.EOBJ.SEMODULE&&(zcal.EOBJ.SEMODULE=="Leads"||zcal.EOBJ.SEMODULE=="Candidates")&&(e=zcal.EOBJ.RELATEDTOID,g=zcal.EOBJ[b]),h=$(Y(c,g,e)),d=h.find(".msi-search"),d.off("click").on("click",function(a){var b=document.location.hostname.startsWith("zmail")?"mail":"zmail",c=(f==1?zcal.ZRECRUIT+"/recruit":zcal.ZCRM+"/crm")+"/Search.do?service="+b+"&searchmodule=Leads&fldName=zcl_CrmEvents_CONTACTNAME&fldId=zcl_CrmEvents_CONTACTID&fldValue=",d=(document.body.offsetHeight-400)/2,e=(document.body.offsetWidth-700)/2;window.addEventListener("message",function(a){_(a,{fldName:"zcl_CrmEvents_CONTACTNAME",fldId:"zcl_CrmEvents_CONTACTID",module:"Leads"}),this.removeEventListener("message",arguments.caller?arguments.caller.callee:arguments.callee)},!1),window.open(c,"calwindow","menubar=no,toolbar=no,location=no,status=no,scrollbars=yes,resizable=yes,width=700,height=400,left="+e+",top="+d)}),a.parents("ul.zcl_frmrw").after(h)},_=function(a,b){var c=a.origin||a.originalEvent.origin,d=document.location.protocol+zcal.ZCRM.substring(zcal.ZCRM.indexOf("//"));if(c===d){a.source.close(),b.module==="PriceBooks"?ZCL_$(b.fldName).value=a.data.pbname:ZCL_$(b.fldName).value=a.data.fldName,ZCL_$(b.fldId).value=a.data.fldId;var e=$("#zcl_CrmEvents_SEMODULE");a.data.acName&&a.data.acName!="null"&&e.length>0&&e.val()==="Accounts"&&(ZCL_$("zcl_CrmEvents_SEID").value=a.data.acId,ZCL_$("zcl_CrmEvents_SENAME").value=a.data.acName)}},ba=function(b){var c=b.find("option:selected").text(),d,e="",g="",h;zcal.EOBJ[a]&&(g=zcal.EOBJ[a],e=zcal.EOBJ.CONTACTID),h=$(Y(c,g,e)),d=h.find(".msi-search"),d.off("click").on("click",function(a){var b=document.location.hostname.startsWith("zmail")?"mail":"zmail",c=(f==1?zcal.ZRECRUIT+"/recruit":zcal.ZCRM+"/crm")+"/Search.do?service="+b+"&searchmodule=Contacts&fldName=zcl_CrmEvents_CONTACTNAME&fldId=zcl_CrmEvents_CONTACTID&fldValue=",d=(document.body.offsetHeight-400)/2,e=(document.body.offsetWidth-700)/2;window.addEventListener("message",function(a){_(a,{fldName:"zcl_CrmEvents_CONTACTNAME",fldId:"zcl_CrmEvents_CONTACTID",module:"Contacts"}),this.removeEventListener("message",arguments.caller?arguments.caller.callee:arguments.callee)},!1),window.open(c,"calwindow","menubar=no,toolbar=no,location=no,status=no,scrollbars=yes,resizable=yes,width=700,height=400,left="+e+",top="+d)}),b.parents("ul.zcl_frmrw").after(h),bb($("#zcl_CrmEvents_CONTACTID"))},bb=function(a){if(h&&h.length>0){var c,d,e="",g="",i="";zcal.EOBJ.SEMODULE&&zcal.EOBJ.SEMODULE!="Leads"&&zcal.EOBJ.SEMODULE!="Candidates"&&zcal.EOBJ.SEMODULE!="Contacts"&&(e=zcal.EOBJ.SEMODULE,g=zcal.EOBJ[b],i=zcal.EOBJ.RELATEDTOID),c=$(bc(e,g,i));var j=c.find("#zcl_CrmEvents_SEMODULE"),k=c.find(".msi-search");j.length>0&&j.off("change").on("change",function(){$("#zcl_CrmEvents_SENAME").val(""),$("#zcl_CrmEvents_SEID").val("")}),k.off("click").on("click",function(a){var b=document.location.hostname.startsWith("zmail")?"mail":"zmail",c=$("#zcl_CrmEvents_SEMODULE").val(),d=(f==1?zcal.ZRECRUIT+"/recruit":zcal.ZCRM+"/crm")+"/Search.do?service="+b+"&searchmodule="+c+"&fldName=zcl_CrmEvents_SENAME&fldId=zcl_CrmEvents_SEID&fldValue=",e=(document.body.offsetHeight-400)/2,g=(document.body.offsetWidth-700)/2;window.addEventListener("message",function(a){_(a,{fldName:"zcl_CrmEvents_SENAME",fldId:"zcl_CrmEvents_SEID",module:m}),this.removeEventListener("message",arguments.caller?arguments.caller.callee:arguments.callee)},!1),window.open(d,"calwindow","menubar=no,toolbar=no,location=no,status=no,scrollbars=yes,resizable=yes,width=700,height=400,left="+g+",top="+e)}),a.parents("ul.zcl_frmrw").after(c)}},bc=function(a,b,c){var d='<ul class="zcl_frmrw"><li><div class="SC_select"><select class="select" id="zcl_CrmEvents_SEMODULE">'+be(a)+"</select>"+"<div/>"+"</li>"+"<li>"+'<input type="text" class="zcl_crlk SC_tiput" id="zcl_CrmEvents_SENAME" value="'+b+'"/>'+'<input type="hidden" value="'+c+'" id="zcl_CrmEvents_SEID"/>'+"</li>"+'<li><i class="msi-search" data-fname="zcl_CrmEvents_SENAME" data-fid="zcl_CrmEvents_SEID"></i></li>'+"</ul>";return d},bd=function(a){var b,c="";for(var d=0;d<h.length;d++){b=h[d];for(var e in b)if(e==a){c=b[e];break}if(c!="")break}return c},be=function(a){var b="",c;for(var d=0;d<h.length;d++){c=h[d];for(var e in c)b+='<option value="'+e+'" '+(e==a?'selected="selected"':"")+">"+c[e]+"</option>"}return b},bf=function(){$("#zcl_CrmEvents_CONTACTID").parents("ul.zcl_frmrw").remove(),$("#zcl_CrmEvents_SEID").parents("ul.zcl_frmrw").remove()},bg=function(){if(!ZCL_crmFormValidate())return!1;var a,b,c;c={EID:ZCL_$("zcl_eid").value,EUID:ZCL_$("zcl_ekey").value,EPERM:2,DPERM:2,SD:ZCL_$("zcl_ce_sd").value,ST:ZCL_TimetoNo(ZCL_$("zcl_ce_st").value),ED:ZCL_$("zcl_ce_ed").value,ET:ZCL_TimetoNo(ZCL_$("zcl_ce_et").value),ATT:ZCL_getAttendee($("#attlist")),RMVATT:ZCL_$("zcl_rmvatt").value,ADAY:0,CNAME:ZCL_$("zcl_crel").value,SUM:ZCL_$("zcl_ce_tit").value,LOC:ZCL_$("zcl_Venue")?ZCL_$("zcl_Venue").value:"",EC:-1,ETZ:"",LINK:"",ETSK:0,ECRM:0,ENTS:0,EMET:0,EMIL:0};var d="/cal/crmAddEvent.do?Subject="+c.SUM.zcalescape()+"&dateformat="+zcal.DFORMAT[zcal.cdata.opt.DF]+"&Start DateTime="+ZCL_$("zcl_ce_sd").value+"&Start DateTime_time="+ZCL_TimetoNo(ZCL_$("zcl_ce_st").value)+"&End DateTime="+ZCL_$("zcl_ce_ed").value+"&End DateTime_time="+ZCL_TimetoNo(ZCL_$("zcl_ce_et").value)+"&ownerId="+ZCL_$("zcl_ownerId").value+"&ownerName="+ZCL_$("zcl_ownerName").innerHTML+(ZCL_$("zcl_Venue")?"&Venue="+ZCL_$("zcl_Venue").value.zcalescape():"")+(ZCL_$("zcl_Description")?"&Description="+ZCL_$("zcl_Description").value.zcalescape():"")+(c.ATT?"&att="+c.ATT.zcalescape():"")+(c.RMVATT?"&rmatt="+c.RMVATT.zcalescape():"");a=ZCL_$("zcl_CrmEvents_CONTACTMODULE")?ZCL_$("zcl_CrmEvents_CONTACTMODULE").value:"None",a!="None"&&a!="Others"&&(d+=ZCL_$("zcl_CrmEvents_CONTACTNAME").value!=""?"&leContModSel="+a+"&leContModId="+ZCL_$("zcl_CrmEvents_CONTACTID").value:""),b=ZCL_$("zcl_CrmEvents_SEMODULE")?ZCL_$("zcl_CrmEvents_SEMODULE").value:"",b!=""&&(a=="None"||a!="Leads"||a!="Candidates")&&(d+=ZCL_$("zcl_CrmEvents_SENAME").value!=""?"&modsel="+b+"&modid="+ZCL_$("zcl_CrmEvents_SEID").value:""),d+="&Send Notification Email=false&Recurring Activity=false";if(ZCL_$("zcl_custfldname")&&ZCL_$("zcl_custfldname").value!=""){var e=ZCL_$("zcl_custfldname").value.split(";"),f=ZCL_$("zcl_custfldlbl").value.split(";"),g="";for(var h=0;h<e.length;h++)if(e[h].indexOf("boolean")!=-1){if(ZCL_$("zcl_"+e[h])){var i=ZCL_$("zcl_"+e[h]).className=="msi-check"?"true":"false";d+="&"+e[h]+"="+i,g+=(g!=""?",":"")+'"'+e[h]+'":"'+f[h]+'"'}}else if(e[h].indexOf("datetime")!=-1)ZCL_$("zcl_"+e[h])&&(d+="&"+e[h]+"="+ZCL_$("zcl_"+e[h]).value,g+=(g!=""?",":"")+'"'+e[h]+'":"'+f[h]+'"',d+="&"+e[h]+"_time="+ZCL_TimetoNo(ZCL_$("zcl_"+e[h]+"_time").value));else if(e[h].indexOf("mselect")!=-1){if(ZCL_$("zcl_"+e[h])){var j=ZCL_$("zcl_"+e[h]),i="";for(var k=0;k<j.length;k++)j[k].selected==1&&(i+=i==""?j[k].value:";"+j[k].value);d+="&"+e[h]+"="+i,g+=(g!=""?",":"")+'"'+e[h]+'":"'+f[h]+'"'}}else{if(e[h].indexOf("anumber")!=-1||e[h].indexOf("formula")!=-1)continue;ZCL_$("zcl_"+e[h])&&(d+="&"+e[h]+"="+ZCL_$("zcl_"+e[h]).value.zcalescape(),g+=(g!=""?",":"")+'"'+e[h]+'":"'+f[h]+'"')}g=g!=""?"{"+g+"}":g,d+=g!=""?"&customFlds="+encodeURIComponent(g):""}c.EID&&(d+="&eid="+c.EID+"&ekey="+c.EUID),d+="&mstart="+zcal.mlimit[0].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF])+"&mend=",d+=zcal.mlimit[1].dateBy(zcal.DFORMAT[zcal.cdata.opt.DF]);var l=zcal.getCalObj(ZCL_$("zcl_crel").value);d+="&ckey="+l[9],ZCL_OLD_COBJ!=null&&(d+="&oldckey="+ZCL_OLD_COBJ[9],d+="&oldctype="+ZCL_OLD_COBJ[5]),ZCL_TEMP_EOBJ=c,ZCL_XHR(d,function(a){ZCL_retDET(a)})},bh=function(){zcal.cdata.calOUids.indexOf("zohoCrm_")!=-1&&ZCL_uXHR("/cal/getCRMUsers.do",function(a){bi(a)}),zcal.cdata.calOUids.indexOf("zohoRecruit4_")!=-1&&ZCL_uXHR("/cal/getCRMUsers.do?service=ZohoRecruit",function(a){bi(a)})},bi=function(a){var b=JSON.parse(a.responseText);b.status=="success"&&(b.mode=="recruit"?(j=b.uobj,o=b.cuser):(i=b.uobj,p=b.cuser,s=b.ccode,ZCL_updateCalAndEvents()))},bj=function(){return p},bk=function(){return o},bl=function(){return s},bm=function(a,b){var c={};for(var d in s){var e=ZCL_getCalColor(a),f=ZCL_getColorNo(e[0]);d=="OTHERS"&&(f=f==19?0:f+1,e=ZCL_getCalColor(f)),c["zcrm_"+d]={CN:s[d][0],STS:s[d][2],CC:e[1],ID:"zcrm_"+d,HC:0,SE:d=="OTHERS"?"2":"1"},zcal.appCount["zcrm_"+d]={c:"0",p:b}}return c},bn=function(a){for(var b in s)if(b==a){s[b][2]=s[b][2]=="0"?"1":"0",ZCL_updateCalAndEvents();break}},bo=function(a){var b=ZCL_Evl(1,a.responseText);if(b.mode=="list")bp(b.notes);else if(b.mode=="add"){if(b.status=="success"){var c=b.nobj,d,e;$("div#zcl_addnoteform").remove(),$("#zcl_addnote").parent().show(),d=bq(c),e=$("#zcl_crm_noteslst").find("li:first"),e.length>0?e.before(d):$("#zcl_crm_noteslst").append(d)}}else if(b.mode=="edit"){if(b.status=="success"){var c=b.nobj,d,f=$("li#zcl_crmnote_"+c.id);$("div#zcl_addnoteform").remove(),$("#zcl_addnote").parent().show(),d=$("<div>"+(c.Title?"<b>"+c.Title+"</b>":"")+"<p>"+ZCL_getDescHTML(c["Note Content"])+"</p>"+"</div>"),f.find("div:first").replaceWith(d),f.find(".zcl_txr").show()}}else b.mode=="del"&&b.status=="success"&&$("#zcl_crmnote_"+b.noteid).remove()},bp=function(a){var b;$("#zcl_crm_noteslst").length||$("#zcl_ce").find("li.zcl_crmnt").append('<ul id="zcl_crm_noteslst"/>'),b=$("#zcl_ce").find("#zcl_crm_noteslst");if(b.length)for(var c=0;c<a.length;c++)b.append(bq(a[c]))},bq=function(a){var b,c="",d,e;return c+='<li id="zcl_crmnote_'+a.id+'">'+"<div>"+(a.Title?"<b>"+a.Title+"</b>":"")+"<p>"+ZCL_getDescHTML(a["Note Content"])+"</p>"+"</div>"+'<div class="zcl_table">'+"<ul>"+"<li>"+'<span class="zcl_lk">'+a["Owner Name"]+"</spam>"+'<span class="zcl_grey">'+a["Created Time"]+"</span>"+"</li>"+'<li class="zcl_txr"><i class="msi-edit"></i><span></span><i class="msi-trash"></i></li>'+"</ul>"+"</div>"+"</li>",b=$(c),d=b.find("i.msi-edit"),d.length&&d.off("click").on("click",{title:a.Title||"",content:a["Note Content"],id:a.id},function(a){br($(this).parent(),a.data.id,a.data.title,a.data.content)}),e=b.find("i.msi-trash"),e.length&&e.off("click").on("click",function(){var b=a.id,c=f==1?"ZohoRecruit":"ZohoCrm";ZCL_XHR("/cal/crmNotes.do?mode=del&noteId="+b+"&service="+c,function(a){bo(a)})}),b},br=function(a,b,c,d){a.hide();var e=a.closest("li#zcl_crmnote_"+b),f;f=$("#zcl_addnoteform"),f.length&&(f.parent().parent().attr("id")=="zcl_crm_noteslst"&&(f.parent().find("div:first").show(),f.parent().find("li.zcl_txr").show()),f.remove()),e.length&&(e.find("div:first").hide(),bu(e,b,c,d))},bs=function(a){var b="",c=e.notetype;for(var d=0;d<c.length;d++){var f=c[d];b+='<option value="'+f.id+'" '+(a==f.name?'selected="selected"':"")+">"+f.name+"</option>"}return b},bt=function(a){if(f==1){var b,c=e.notetype;return b='<div class="SC_select"><select id="zcl_crmnote_title" class="select">'+bs(a)+"</select>"+"</div>",b}return'<input type="text" class="zcl_crlk SC_tiput" id="zcl_crmnote_title" value="'+(a||"")+'">'},bu=function(a,b,c,d){var e=$("#zcl_ce").find("span#zcl_addnote"),f,g,h;e.parent().hide();var i='<div class="zcl_crmntad" id="zcl_addnoteform"><input type="hidden" id="zcl_crmnote_id" value="'+(b||"")+'"/>'+'<ul class="zcl_frmrw">'+"<li>"+"<u>"+zcal.i18n.title+"</u>"+bt(c)+"</li>"+"</ul>"+'<ul class="zcl_frmrw">'+"<li>"+"<u>"+zcal.i18n.content+"</u>"+'<textarea style="height: 49px;" class="zcl_Cedes SC_tiput" id="zcl_crmnote_content">'+(d||"")+"</textarea>"+"</li>"+"</ul>"+'<ul class="zcl_frmrw">'+"<li>"+'<div class="SC_PUbtm">'+'<span data-marker="saveNote">'+zcal.i18n.save+"</span>"+'<span data-marker="closeNote" data-val="Cancel">'+zcal.i18n.cancel+"</span>"+"</div>"+"</li>"+"</ul>"+"</div>";f=$(i),g=f.find("[data-marker=saveNote]").removeAttr("data-marker"),g.length&&g.off("click").on("click",function(){bv()}),h=f.find("[data-marker=closeNote]").removeAttr("data-marker"),h.length&&h.off("click").on("click",function(){$(this).parents("div#zcl_addnoteform").remove(),e.parent().show(),a.find("div:first").show(),a.find("li.zcl_txr").show()}),a.find("div:first").after(f)},bv=function(){if($("#zcl_crmnote_title").val()=="")return zmUtil.succErrMsg("e","Please enter note title"),ZCL_$("zcl_crmnote_title").focus(),!1;if($("#zcl_crmnote_content").val()=="")return zmUtil.succErrMsg("e","Please enter note content"),ZCL_$("zcl_crmnote_content").focus(),!1;bw()},bw=function(){var a,b,c,d=f==1?"ZohoRecruit":"ZohoCrm";a=f==1?$("#zcl_crmnote_title").find("option:selected").text():$("#zcl_crmnote_title").val(),b=$("#zcl_crmnote_content").val(),c=$("#zcl_crmnote_id").val();var e="/cal/crmNotes.do?note="+b+"&title="+a+"&service="+d+(f==1?"&id="+$("#zcl_crmnote_title").val():"");c!=""?e+="&mode=edit&noteId="+c:e+="&mode=add&eventId="+$("#zcl_activityid").val(),ZCL_XHR(e,function(a){bo(a)})},bx=function(a){var b=$("#zcl_activityid").val(),c=f==1?"ZohoRecruit":"ZohoCrm",d="/cal/crmInvitees.do?mode=del&attId="+a+"&eventId="+b+"&service="+c;ZCL_XHR(d,function(a){var c=ZCL_Evl(1,a.responseText);bz(c,b)})},by=function(a){var b,c=f==1?"ZohoRecruit":"ZohoCrm";b="/cal/crmInvitees.do?mode=list&eventId="+a+"&service="+c,ZCL_uXHR(b,function(b){var c=ZCL_Evl(1,b.responseText);bz(c,a)})},bz=function(a,b){a.mode=="list"?(q[b]=a.invitees,bA()):a.mode=="del"?a.status=="success"&&$("#zcl_crm_attlist").find("UL").length==0&&$("#zcl_crm_attlist").html('<ul><li><span class="zcl_grey">No attendee</span></li></ul>'):a.mode=="add"&&a.status=="success"&&by(b)},bA=function(){var a=zcal.EOBJ.ACTIVITYID,b,c=["all"];b=q[a]||[];if(b.length>0){var d,e;$("#zcl_crm_attlist").length||(e=$('<ul class="zcl_frmrw zcl_vwatte"><li><div><ul class="zcl_viwatt"/><div class="zcl_viwatlst zcl_table" id="zcl_crm_attlist"/></div></li></ul>'),$("ul#zcl_crmatt_info>li").append(e)),e=$("#zcl_crm_attlist").parents("ul.zcl_vwatte"),d=e.find("ul.zcl_viwatt");for(var f=0;f<c.length;f++){var g=$('<li data-usts="'+c[f]+'" '+(f==0?'class="zcl_sl"':"")+">"+zcal.i18n[c[f]]+"</li>");bB(g),d.append(g)}bC("all")}},bB=function(a){a.off("click").on("click",function(){var a=$(this);a.parent().find("li").removeClass("zcl_sl"),a.addClass("zcl_sl"),bC(a.data("usts"))})},bC=function(a){var b=zcal.EOBJ.ACTIVITYID,c,d=$("#zcl_crm_attlist");c=q[b]||[],d.empty();for(var e=0;e<c.length;e++){var f,g=c[e],h=$("<ul/>"),i;f='<li><img src="'+zmail.defaultPhoto+'"></li>'+"<li>"+"<b>"+ZCL_getHTML(g.EMAIL)+"</b>"+"</li>"+"<li>"+ZCL_AttStsIcn(g.STATUS)+'<i class="msi-delete"/>'+"</li>",h.append(f),i=h.find("i.msi-delete"),bD(i,g),d.append(h)}},bD=function(a,b){a.off("click").on("click",{attId:b.INVITEEID,mode:zcal.EMODE},function(a){var b=$(this).parent().parent(),c=a.data.attId;b.remove(),bx(c)})},bE={showCRMForm:t,updateCRMData:w,reset:v,saveEvent:bg,loadCRMUsers:bh,getCRMCurrentUser:bj,getRecruitCurrentUser:bk,getCRMColorCode:bl,getCRMCalChild:bm,chgUserSts:bn};return bE}();ZCL_nlp=function(a,b){function cT(a){try{for(var c=0;c<bD.length;c++)if(a.match(bD[c])){b$=cY(a.match(bD[c]),c,a),p=c!=17?a.match(bD[c]):"";var d=a.match(bD[c]),e=a.match(bD[c]);if(c==12&&a.match(bD[20])){b$=cY(a.match(bD[20]),20,a);var f=a.match(bD[20]);p=a.match(bD[20]),e=""}if(c==10)if(a.match(bD[21])){b$=cY(a.match(bD[21]),21,a);var f=a.match(bD[21]);p=a.match(bD[21]),e=""}else if(a.match(by)){var g=a;p=a.match(by),a=a.replace(/\'/g," ");if(a.match(bD[10])){b$=cY(a.match(bD[10]),10,a);var f=g.match(by);e=""}}if(c==11){if(a.match(bs)){b$=cY(a.match(bs),22,a);var f=a.match(bs);p=a.match(bs),e=""}if(a.match(br)){b$=cY(a.match(br),23,a);var f=a.match(br);p=a.match(br),e=""}if(a.match(bw)){var f=bX.match(bw);e=""}if(a.match(bA)){var f=bX.match(bA);e=""}}if(c==14)if(a.match(bt)){b$=cY(a.match(bt),24,a);var f=a.match(bt);p=a.match(bt),e=""}else if(a.match(bv)){var f=bX.match(bv);e=""}else if(a.match(bB)){var f=bX.match(bB);e=""}else if(a.match(bC)){var f=bX.match(bC);e=""}if(c=15){var g;if(a.match(bz)){g=a;var h=a.split("'"),i="20"+h[1];a=a.replace(/\'/g," ");var j=a.match(bD[15])[0]+" "+i;if(j.match(bD[15])){b$=cY(j.match(bD[15]),15,a);var f=g.match(bz);p=g.match(bz),e=""}}if(g&&g.match(bx)||a.match(bx)){if(g){var k=g,h=g.split("'"),i="20"+h[1];g=g.replace(/\'/g," ");var j=g.match(bD[15])[0]+" "+i;j.match(bD[15])&&(b$=cY(j.match(bD[15]),15,g),p=k.match(bx))}var f=bX.match(bx);e=""}}if(e==""&&f&&b!=0){var l=bX.substring(0,bX.indexOf(f[0]));l=l.trim();var m=l.split(bH);m.length=m[m.length-1]==""||m[m.length-1]==","?m.length-1:m.length;if(m[m.length-1]&&(m[m.length-1].match(/\b(from|(begin)s?|(start)s?|between|(open)s?|starting|commence|at|on|tomorrow|today|saturday|sunday|monday|tuesday|wednesday|thursday|friday|sat|sun|mon|tue|wed|thu|fri)\b/)||m[m.length-1].match(/@/)))if(m[m.length-1].match(/\b(tomorrow|today|saturday|sunday|monday|tuesday|wednesday|thursday|friday|sat|sun|mon|tue|wed|thu|fri)\b/)&&m[m.length-2]&&(m[m.length-2].match(/\b(from|(begin)s?|(start)s?|between|(open)s?|starting|commence|at|on)\b/)||m[m.length-2].match(/@/))){l=l.replace(m[m.length-1],"");var n=bX.substring(l.lastIndexOf(m[m.length-2]),bX.indexOf(f[0])+f[0].length);bX=bX.replace(n,"")}else if(m[m.length-1]&&m[m.length-1].match(/\b(from|on)\b/)&&m[m.length-2]&&m[m.length-2].match(/\b(start)s?|(open)s?|starting|commence/)){l=l.replace(m[m.length-1],"");var n=bX.substring(l.lastIndexOf(m[m.length-2]),bX.indexOf(f[0])+f[0].length);bX=bX.replace(n,"")}else{var n=bX.substring(l.lastIndexOf(m[m.length-1]),bX.indexOf(f[0])+f[0].length);bX=bX.replace(n,"")}else if(m[m.length-1].match(/\b(next|this|first|second|third|fourth|last)/))if(m[m.length-2]&&m[m.length-2].match(/\b(from)/)&&m[m.length-3]&&m[m.length-3].match(/\b(start)s?|(open)s?|starting|commence/)){l=l.replace(m[m.length-1],"");var n=bX.substring(l.lastIndexOf(m[m.length-3]),bX.indexOf(f[0])+f[0].length);bX=bX.replace(n,"")}else if(m[m.length-2]&&m[m.length-2].match(/\b(starts)s?|(commence)s?|from|starting|(open)s?|on|at|between?/)){l=l.replace(m[m.length-1],"");var n=bX.substring(l.lastIndexOf(m[m.length-2]),bX.indexOf(f[0])+f[0].length);bX=bX.replace(n,"")}else{var n=bX.substring(l.lastIndexOf(m[m.length-1]),bX.indexOf(e[0])+e[0].length);bX=bX.replace(n,"")}else bX=bX.replace(f[0],"")}else if(e!=""&&b!=0){var l=bX.substring(0,bX.indexOf(e[0])),o=bX.substring(bX.indexOf(e[0])+e[0].length,bX.length);o=o.trim();var q=o.split(bH);l=l.trim();var m=l.split(bH);m.length=m[m.length-1]==""||m[m.length-1]==","?m.length-1:m.length;if(m[m.length-1]&&(m[m.length-1].match(/\b(from|(begin)s?|(start)s?|between|(open)s?|starting|commence|at|on|tomorrow|today|saturday|sunday|monday|tuesday|wednesday|thursday|friday|sat|sun|mon|tue|wed|thu|fri)\b/)||m[m.length-1].match(/@/)))if(m[m.length-1].match(/\b(tomorrow|today|saturday|sunday|monday|tuesday|wednesday|thursday|friday|sat|sun|mon|tue|wed|thu|fri)\b/)&&m[m.length-2]&&(m[m.length-2].match(/\b(from|(begin)s?|(start)s?|between|(open)s?|starting|commence|at|on)\b/)||m[m.length-2].match(/@/))){l=l.replace(m[m.length-1],"");var n=bX.substring(l.lastIndexOf(m[m.length-2]),bX.indexOf(e[0])+e[0].length);bX=bX.replace(n,"")}else if(m[m.length-1]&&m[m.length-1].match(/\b(from|on)\b/)&&m[m.length-2]&&m[m.length-2].match(/\b(start)s?|(open)s?|starting|commence/)){l=l.replace(m[m.length-1],"");var n=bX.substring(l.lastIndexOf(m[m.length-2]),bX.indexOf(e[0])+e[0].length);bX=bX.replace(n,"")}else{var n=bX.substring(l.lastIndexOf(m[m.length-1]),bX.indexOf(e[0])+e[0].length);bX=bX.replace(n,"")}else if(m[m.length-1].match(/\b(next|this|first|second|third|last|fourth)/))if(m[m.length-2]&&m[m.length-2].match(/\b(from|on|at)\b/)&&m[m.length-3]&&m[m.length-3].match(/\b(start)s?|(open)s?|starting|commence\b/)){l=l.replace(m[m.length-1],"");var n=bX.substring(l.lastIndexOf(m[m.length-3]),bX.indexOf(e[0])+e[0].length);bX=bX.replace(n,"");if(q[0]&&q[0].match(/\b(of)\b/)&&q[1]&&K.indexOf(q[1])>-1){var n=bX.substring(o.indexOf(m[1])+m[1].length,bX.length);bX=bX.replace(n,"")}}else if(m[m.length-2]&&m[m.length-2].match(/\b(starts)s?|(commence)s?|from|starting|(open)s?|on|at|between?\b/)){l=l.replace(m[m.length-1],"");var n=bX.substring(l.lastIndexOf(m[m.length-2]),bX.indexOf(e[0])+e[0].length);bX=bX.replace(n,"")}else{var n=bX.substring(l.lastIndexOf(m[m.length-1]),bX.indexOf(e[0])+e[0].length);bX=bX.replace(n,"")}else bX=bX.replace(e[0],"");bY.push(ch.indexOf(e[0]))}return b$}}catch(r){}}function cU(a){try{for(var c=0;c<bD.length;c++)if(a.match(bD[c])){b_=cY(a.match(bD[c]),c,a),p=c!=16?a.match(bD[c]):"";var d=a.match(bD[c]),e=a.match(bD[c]),f;if(c==10&&a.match(by)){var g=a;p=a.match(by),a=a.replace(/\'/g," ");if(a.match(bD[10])){b$=cY(a.match(bD[10]),10,a);var f=g.match(by);e=""}}if(c==11){if(a.match(bw)){var f=bX.match(bw);e=""}if(a.match(bA)){var f=bX.match(bA);e=""}}if(c==14)if(a.match(bB)){var f=bX.match(bB);e=""}else if(a.match(bC)){var f=bX.match(bC);e=""}if(c=15){var g;if(a.match(bz)){g=a;var h=a.split("'"),i="20"+h[1];a=a.replace(/\'/g," ");var j=a.match(bD[15])[0]+" "+i;if(j.match(bD[15])){b$=cY(j.match(bD[15]),15,a);var f=g.match(bz);p=g.match(bz),e=""}}if(g&&g.match(bx)||a.match(bx)){if(g){var k=g,h=g.split("'"),i="20"+h[1];g=g.replace(/\'/g," ");var j=g.match(bD[15])[0]+" "+i;j.match(bD[15])&&(b$=cY(j.match(bD[15]),15,g),p=k.match(bx))}var f=bX.match(bx);e=""}}if(e==""&&f&&b!=0){var l=bX.substring(0,bX.indexOf(f[0]));l=l.trim();var m=l.split(bH);m.length=m[m.length-1]==""||m[m.length-1]==","?m.length-1:m.length;if(m[m.length-1]&&m[m.length-1].match(/\b(to|(end)s?|-|and|on|(close)s?|till|until|over|ending|tomorrow|today|saturday|sunday|monday|tuesday|wednesday|thursday|friday|sat|sun|mon|tue|wed|thu|fri)\b/))if(m[m.length-1].match(/\b(tomorrow|today|saturday|sunday|monday|tuesday|wednesday|thursday|friday|sat|sun|mon|tue|wed|thu|fri)\b/)&&m[m.length-2]&&m[m.length-2].match(/\b(to|(end)s?|-|and|on|(close)s?|till|until|over|ending)\b/)){l=l.replace(m[m.length-1],"");var n=bX.substring(l.lastIndexOf(m[m.length-2]),bX.indexOf(f[0])+f[0].length);bX=bX.replace(n,"")}else if(m[m.length-1]&&m[m.length-1].match(/\b(on)\b/)&&m[m.length-2]&&m[m.length-2].match(/\b(end)?s|(close)s?\b/)){l=l.replace(m[m.length-1],"");if(m[m.length-3]&&m[m.length-3].match(/\b(and)\b/))var n=bX.substring(l.lastIndexOf(m[m.length-3]),bX.indexOf(f[0])+f[0].length);else var n=bX.substring(l.lastIndexOf(m[m.length-2]),bX.indexOf(f[0])+f[0].length);bX=bX.replace(n,"")}else{var n=bX.substring(l.lastIndexOf(m[m.length-1]),bX.indexOf(f[0])+f[0].length);bX=bX.replace(n,"")}else bX=bX.replace(f[0],"")}else if(e&&b!=0){var l=bX.substring(0,bX.indexOf(e[0]));l=l.trim();var m=l.split(bH);m.length=m[m.length-1]==""||m[m.length-1]==","?m.length-1:m.length;if(m[m.length-1]&&(m[m.length-1].match(/\b(to|(end)s?|and|on|(close)s?|till|until|over|ending|today|tomorrow|saturday|sunday|monday|tuesday|wednesday|thursday|friday|sat|sun|mon|tue|wed|thu|fri)\b/)||m[m.length-1].match("-")))if(m[m.length-1].match(/\b(today|tomorrow|saturday|sunday|monday|tuesday|wednesday|thursday|friday|sat|sun|mon|tue|wed|thu|fri)\b/)&&m[m.length-2]&&m[m.length-2].match(/\b(to|(end)s?|-|and|on|(close)s?|till|until|over|ending)\b/)){l=l.replace(m[m.length-1],"");var n=bX.substring(l.lastIndexOf(m[m.length-2]),bX.indexOf(e[0])+e[0].length);bX=bX.replace(n,"")}else if(m[m.length-1]&&m[m.length-1].match(/\b(on)\b/)&&m[m.length-2]&&m[m.length-2].match(/\b(end)?s|(close)s?\b/)){l=l.replace(m[m.length-1],"");if(m[m.length-3]&&m[m.length-3].match(/\b(and)\b/))var n=bX.substring(l.lastIndexOf(m[m.length-3]),bX.indexOf(e[0])+e[0].length);else var n=bX.substring(l.lastIndexOf(m[m.length-2]),bX.indexOf(e[0])+e[0].length);bX=bX.replace(n,"")}else{var n=bX.substring(l.lastIndexOf(m[m.length-1]),bX.indexOf(e[0])+e[0].length);bX=bX.replace(n,"")}else if(m[m.length-1].match(/\b(next|this|first|second|third|fourth|last)\b/))if(m[m.length-2]&&m[m.length-2].match(/\b(on)\b/)&&m[m.length-3]&&m[m.length-3].match(/\b(end)?s|(close)s?|ending\b/)){l=l.replace(m[m.length-1],"");if(m[m.length-4]&&m[m.length-4].match(/\b(and)\b/))var n=bX.substring(l.lastIndexOf(m[m.length-4]),bX.indexOf(e[0])+e[0].length);else var n=bX.substring(l.lastIndexOf(m[m.length-3]),bX.indexOf(e[0])+e[0].length);bX=bX.replace(n,"")}else if(m[m.length-2]&&m[m.length-2].match(/\bto|(end)s?|till|untill|ending|over|(close)s?/)){l=l.replace(m[m.length-1],"");var n=bX.substring(l.lastIndexOf(m[m.length-2]),bX.indexOf(e[0])+e[0].length);bX=bX.replace(n,"")}else{var n=bX.substring(l.lastIndexOf(m[m.length-1]),bX.indexOf(e[0])+e[0].length);bX=bX.replace(n,"")}else bX=bX.replace(e[0],"")}return b_}}catch(o){}}function cV(a){try{a=p?a.replace(p[0]," "):a;for(var c=0;c<bM.length;c++)if(a.match(bM[c])){var d=a?a.match(/[0-9]{1,2}\s?(hour|hours|minutes|minute)\s?after/)?a.match(/[0-9]{1,2}\s?(hour|hours|minutes|minute)\s?after/):a.match(/(after)\s?[0-9]{1,2}\s?(hour|hours|minutes|minute)/)?a.match(/(after)\s?[0-9]{1,2}\s?(hour|hours|minutes|minute)/):"":"",e=d?d[0].match(/[0-9]{1,2}/):"",f=d?a.match(/(hour|hours)/)?36e5*e[0]:6e4*e[0]:"";st=cZ(a.match(bM[c]),c),st=f?parseInt(st)+parseInt(f):st;var g=a?a.match(/(for)\s?[0-9]{1,2}\s?(hour|hours|minutes|minute)/)?a.match(/(for)\s?[0-9]{1,2}\s?(hour|hours|minutes|minute)/):a.match(/[0-9]{1,2}\s?(hours|hour|minutes|minute)\s?(from)/):"";e=g?g[0].match(/[0-9]{1,2}/):"",f=g?a.match(/(hour|hours)/)?36e5*e[0]:6e4*e[0]:"",d||(st=g?cZ(a.match(bM[c]),c):st),cg=f?st?parseInt(st)+parseInt(f):"":"";var h=a.match(bM[c]),i;if(c==0)if(a.match(bM[4]))st=cZ(a.match(bM[4]),4),i=a.match(bM[4]),bY.push(ch.indexOf(i[0])),h="";else{var j=a.match(bM[c]);if(!j[0].match(/(am|pm)/)&&a.match(/\b(0?[0-9]|1[0-9]|2[0-3])([:|.](0[0-9]|[1-4][0-9]|5[0-9]))\s?(am|pm|hrs)?\b/)&&b==0){i=a.match(/\b(0?[0-9]|1[0-9]|2[0-3])([:|.](0[0-9]|[1-4][0-9]|5[0-9]))\s?(am|pm|hrs)?\b/),h="",bY.push(ch.indexOf(i[0]));var k=a.match(/(am|pm|hrs)/);st=cZ(a.match(/\b(0?[0-9]|1[0-9]|2[0-3])([:|.](0[0-9]|[1-4][0-9]|5[0-9]))\s?(am|pm|hrs)?\b/),k?0:1)}else!j[0].match(/(am|pm)/)&&a.match(/\b(0?[0-9]|1[0-9]|2[0-3])\s?(am|pm)\b/)&&b==0&&(i=a.match(/\b(0?[0-9]|1[0-9]|2[0-3])\s?(am|pm)\b/),h="",bY.push(ch.indexOf(i[0])),st=cZ(a.match(/\b(0?[0-9]|1[0-9]|2[0-3])\s?(am|pm)\b/),0))}if(h==""&&i)if(bX.indexOf(i[0])>0){var l=bX.substring(0,bX.indexOf(i[0])),m=l.split(bH);m.length=m[m.length-1]==""?m.length-1:m.length;if(m[m.length-1].match(/\b(from|(begin)s?|(start)s?|between|(open)s?|starting|commence|at|on)\b/)||m[m.length-1].match(/@/)){var n=bX.substring(l.lastIndexOf(m[m.length-1]),bX.indexOf(i[0])+i[0].length);bX=bX.replace(n,"")}else bX=bX.replace(i[0],"")}else bX=bX.replace(i[0],"");else if(h!="")if(bX.indexOf(h[0])>0){var l=bX.substring(0,bX.indexOf(h[0])),m=l.split(bH);m.length=m[m.length-1]==""?m.length-1:m.length;if(m[m.length-1].match(/\b(from|(begin)s?|(start)s?|between|(open)s?|starting|commence|at|on)\b/)||m[m.length-1].match(/@/)){var n=bX.substring(l.lastIndexOf(m[m.length-1]),bX.indexOf(h[0])+h[0].length);bX=bX.replace(n,"")}else bX=bX.replace(h[0],"");bY.push(ch.indexOf(h[0]))}else bX=bX.replace(h[0],"");return st}}catch(o){}}function cW(a){try{a=p?a?a.replace(p[0]," "):a:a;for(var b=0;b<bM.length;b++)if(a.match(bM[b])){var c=a?a.match(/[0-9]{1,2}\s?(hour|hours|minutes|minute)\s?after/):"",d=c?c[0].match(/[0-9]{1,2}/):"",e=c?a.match(/(hour|hours)/)?36e5*d[0]:6e4*d[0]:"";if(b==0&&a.match(bM[4])){cf=cZ(a.match(bM[4]),4);var f=a.match(bM[4]),g=f[0].split("-");a=g[1]}et=cZ(a.match(bM[b]),b),et=e&&c?parseInt(et)+parseInt(e):et;var h=a.match(bM[b]);if(h){var i=bX.substring(1,bX.indexOf(h[0])),j=i.split(bH);j.length=j[j.length-1]==""?j.length-1:j.length;if(j[j.length-1].match(/(to|(end)s?|-|and|on|(close)s?|till|until|over|ending|at)/)){var k=bX.substring(i.lastIndexOf(j[j.length-1]),bX.indexOf(h[0])+h[0].length);bX=bX.replace(k,"")}else bX=bX.replace(h[0],"")}return bY.push(ch.indexOf(h[0])),et}}catch(l){}}function cY(a,b,c){try{if(b==0||b==1||b==2||b==3||b==4||b==5||b==6||b==7){var d=c.split(bH),m=d.indexOf(a[0]);a[0]=a[0].replace(/(-|\.)/g,"/");var p=a[0].split("/");if(!(d[m-1]&&d[m-1].match(/(from|after|before)/)&&d[m-2].match(/(day)s?/)&&d[m-3]&&d[m-3].match(/[0-9]{1,2}/)&&!bU.isrem))return d[m+1]&&d[m+1].match("for")&&d[m+2]&&d[m+2].match(/[0-9]{1,2}/)&&d[m+3]&&d[m+3].match(/(day)s?/)&&(ce=Date.parse((b==0||b==2||b==4||b==6?b==0||b==4||b==6?p[1]<=12&&p[0]<=12?p[0]:p[1]:p[1]:b==1||b==5||b==7?p[0]:b==3?p[2]:"")+"/"+(parseInt(b==0||b==4||b==6?p[1]<=12&&p[0]<=12?p[1]:p[0]:b==1||b==3||b==5||b==7?p[1]:b==2?p[2]:"")+parseInt(d[m+2]))+"/"+(b==0||b==1?p[2]:b==2||b==3?p[0]:b==4||b==5?"20"+p[2]:b==6||b==7?n.getFullYear():""))),Date.parse((b==0||b==2||b==4||b==6?b==0||b==4||b==6?p[1]<=12&&p[0]<=12?p[0]:p[1]:p[1]:b==1||b==5||b==7?p[0]:b==3?p[2]:"")+"/"+(b==0||b==4||b==6?p[1]<=12&&p[0]<=12?p[1]:p[0]:b==1||b==3||b==5||b==7?p[1]:b==2?p[2]:"")+"/"+(b==0||b==1?p[2]:b==2||b==3?p[0]:b==4||b==5?"20"+p[2]:b==6||b==7?n.getFullYear():""));var A=new Date(Date.parse((b==0||b==2||b==4||b==6?b==0||b==4||b==6?p[1]<=12&&p[0]<=12?p[0]:p[1]:p[1]:b==1||b==5||b==7?p[0]:b==3?p[2]:"")+"/"+(b==0||b==4||b==6?p[1]<=12&&p[0]<=12?p[1]:p[0]:b==1||b==3||b==5||b==7?p[1]:b==2?p[2]:"")+"/"+(b==0||b==1?p[2]:b==2||b==3?p[0]:b==4||b==5?"20"+p[2]:b==6||b==7?n.getFullYear():"")));if(A!="Invalid Date"&&d[m-4]&&d[m-4]!="for"){d[m-1].match(/(from|after)/)?A.setDate(A.getDate()+parseInt(d[m-3])):d[m-1].match(/(before)/)&&A.setDate(A.getDate()-parseInt(d[m-3]));if(d[m+1]&&d[m+1].match(/(for)/)&&d[m+2]&&d[m+2].match(/[0-9]{1,2}/)&&d[m+3]&&d[m+3].match(/(day)s?/)){var B=new Date(Date.parse(A.getMonth()+parseInt(1)+"/"+A.getDate()+"/"+A.getFullYear()));B.setDate(B.getDate()+parseInt(d[m+2])),ce=Date.parse(B.getMonth()+parseInt(1)+"/"+B.getDate()+"/"+B.getFullYear())}return Date.parse(A.getMonth()+parseInt(1)+"/"+A.getDate()+"/"+A.getFullYear())}if(A!="Invalid Date"&&d[m-4]&&d[m-4]=="for"){var B=new Date(Date.parse(A.getMonth()+parseInt(1)+"/"+A.getDate()+"/"+A.getFullYear()));return B.setDate(B.getDate()+parseInt(d[m-3])),ce=Date.parse(B.getMonth()+parseInt(1)+"/"+B.getDate()+"/"+B.getFullYear()),A}if(A=="Invalid Date")return o}if(b==8||b==9||b==10||b==12||b==13){var d=c.split(bH),H=a[0],p=a[0].match("-")?a[0].split("-"):a[0].match(/\./)?a[0].split("."):"";a[0]=p!=""?p[0]+" "+p[1]+" "+(p.length==3?p[2]:n.getFullYear()):a[0];if(p==""){var L=a[0].match(/[0-9]{4}/);if(L){var M=/january|february|march|april|may|june|july|august|september|october|november|december|jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/,N=a[0].match(M),O=a[0].match(/[0-9]{1,2}/);a[0]=(N[0]?N[0]:n.getMonth()+parseInt(1))+" "+(O?O:n.getDate())+" "+L}else{var M=/january|february|march|april|may|june|july|august|september|october|november|december|jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/,P=a[0].split(M),N=a[0].match(M),O=b==10?P[0]?P[0]:"":b==12?P[1]?P[1]:"":"",Q=b==10?P[1]?P[1]:n.getFullYear():n.getFullYear();O=O?O.replace(" ",""):"",Q=b==10&&P[1]?Q.replace(" ",""):Q,N[0]=N[0]?N[0].replace(" ",""):"",a[0]=(N[0]?N[0]:n.getMonth()+parseInt(1))+" "+(O?O:n.getDate())+" "+(b==10&&P[1]?20+Q:n.getFullYear())}}var R=H.split(" "),m=p==""?d.indexOf(R[0]):d.indexOf(H);if(!(d[m-1]&&d[m-1].match(/(from|after|before)/)&&d[m-2]&&d[m-2].match(/(day)s?/)&&d[m-3]&&d[m-3].match(/[0-9]{1,2}/)&&!bU.isrem)){if(d[m-1]&&d[m-1].match("every")||c.match(/(every\s?year)/)){var X=a[0].match(/[0-9]{1,2}/),Y=a[0];Y=Y.replace(/[^A-Za-z]/g,""),q.yearly=1,r="",w=X[0],s=Y,v=1}if(c.match(/(every|all)\s?(weekday)s?/))q.daily=1,G=1;else if(c.match(/(every|all)\s?(weekend)s?/))q.weekly=1,D="saturday,sunday",cc=1;else if(!cd){var Z=ch,$=Z.replace(c," @ ");$=$?$.split(bH):"";var m=$.indexOf("@");$[m-1]&&$[m-1].match(/\b(weekday)s?\b/)&&$[m-2]&&$[m-2].match(/\b(every|all)\b/)&&(q.daily=1,G=1),$[m-1]&&$[m-1].match(/\b(weekend)s?\b/)&&$[m-2]&&$[m-2].match(/\b(every|all)\b/)&&(q.weekly=1,D="saturday,sunday"),$[m-1]=="days"&&$[m-2]&&$[m-2].match(/[0-9]{1,2}/)&&$[m-3]=="every"&&(q.daily=1,F=$[m-2],G=1)}p==""?m=R.length==3?d.indexOf(R[2]):d.indexOf(R[1]):m=d.indexOf(H);if(d[m+1]&&d[m+1].match("for")&&d[m+2]&&d[m+2].match(/[0-9]{1,2}/)&&d[m+3]&&d[m+3].match(/(((day)s?)|((year)s?))/))if(d[m+3].match(/(day)s?/)){var _=new Date(Date.parse(a[0]));ce=Date.parse(_.getMonth()+parseInt(1)+"/"+(parseInt(_.getDate())+parseInt(d[m+2]))+"/"+_.getFullYear())}else if(d[m+3].match(/(year)s?/)||q.yearly==1)u=Date.parse("12/31/"+(n.getFullYear()+parseInt(d[m+2])));d[m+1]&&d[m+1].match("for")&&d[m+2]&&d[m+2].match("every")&&d[m+3]&&d[m+3].match(/[0-9]{1,2}/)&&d[m+4]&&d[m+4].match(/(day)s?/)&&(q.daily=1,F=d[m+3],cd&&(G=1));if(Date.parse(a[0]))return Date.parse(a[0]);var S=a[0].split(" "),T=S.length==3?b==8?S[1]+" "+S[0]+" "+(S[2].match(/[0-9]{2}/)?20+S[2]:""):"":"";return T=T==""?o:T,Date.parse(T)}var A;if(Date.parse(a[0]))A=new Date(Date.parse(a[0]));else{var S=a[0].split(" "),T=S.length==3?b==8?S[1]+" "+S[0]+" "+(S[2].match(/[0-9]{2}/)?20+S[2]:""):"":"";if(b==10||b==12){var U=S[0].split(/[0-9]{1,2}/),V=U[0]!=""?U[0]:U[1],W=S[0].match(/[0-9]{1,2}/);T=S.length==2?V+" "+W[0]+" "+(S[1].match(/[0-9]{4}/)?S[1]:20+S[1]):S.length==1?V+" "+W[0]+" "+n.getFullYear():""}A=new Date(Date.parse(T))}if(A!="Invalid Date"&&(d[m-4]&&d[m-4]!="for"||!d[m-4])){d[m-4]&&d[m-4]=="every"?(q.daily=1,F=d[m-3]):d[m-1].match(/(from|after)/)?A.setDate(A.getDate()+parseInt(d[m-3])):d[m-1].match(/(before)/)&&A.setDate(A.getDate()-parseInt(d[m-3])),m=R.length==3?d.indexOf(R[2]):d.indexOf(R[1]);if(d[m+1]&&d[m+1].match(/(for)/)&&d[m+2]&&d[m+2].match(/[0-9]{1,2}/)&&d[m+3]&&d[m+3].match(/(day)s?/)){var B=new Date(Date.parse(A.getMonth()+parseInt(1)+"/"+A.getDate()+"/"+A.getFullYear()));B.setDate(B.getDate()+parseInt(d[m+2])),ce=Date.parse(B.getMonth()+parseInt(1)+"/"+B.getDate()+"/"+B.getFullYear())}return d[m+1]&&d[m+1].match("for")&&d[m+2]&&d[m+2].match("every")&&d[m+3].match(/[0-9]{1,2}/)&&d[m+4]&&d[m+4].match(/(day)s?/)&&(q.daily=1,F=d[m+3]),Date.parse(A.getMonth()+parseInt(1)+"/"+A.getDate()+"/"+A.getFullYear())}if(A!="Invalid Date"&&d[m-4]&&d[m-4]=="for"){var B=new Date(Date.parse(A.getMonth()+parseInt(1)+"/"+A.getDate()+"/"+A.getFullYear()));return B.setDate(B.getDate()+parseInt(d[m-3])),ce=Date.parse(B.getMonth()+parseInt(1)+"/"+B.getDate()+"/"+B.getFullYear()),A}if(A=="Invalid Date")return o}if(b==14||b==11){var d=c.split(bH),p=a[0].replace(/(\s|,)/g,"/"),ba=p.split("/"),m=d.indexOf(ba[0]);if(!(d[m-1]&&d[m-1].match(/(from|after|before)/)&&d[m-2]&&d[m-2].match(/(day)s?/)&&d[m-3]&&d[m-3].match(/[0-9]{1,2}/)&&!bU.isrem))return m=ba.length==3?d.indexOf(ba[2]):d.indexOf(ba[1]),d[m+1]&&d[m+1].match("for")&&d[m+2]&&d[m+2].match(/[0-9]{1,2}/)&&d[m+3]&&d[m+3].match(/(day)s?/)&&(ba.length==3?ce=Date.parse((b==14?ba[0]:ba[1])+"/"+(parseInt(b==14?ba[1]:ba[0])+parseInt(d[m+2]))+"/"+(ba[2].match(/((19|20)\d\d)/)?ba[2]:20+ba[2])):ce=Date.parse((b==14?ba[0]:ba[1])+"/"+(parseInt(b==14?ba[1]:ba[0])+parseInt(d[m+2]))+"/"+n.getFullYear())),ba.length==3?Date.parse((b==14?ba[0]:ba[1])+(b==14?ba[1].replace(/[^(\d+)]/g,""):ba[0].replace(/[^(\d+)]/g,""))+"/"+(ba[2].match(/((19|20)\d\d)/)?ba[2]:20+ba[2])):Date.parse((b==14?ba[0]:ba[1])+(b==14?ba[1].replace(/[^(\d+)]/g,""):ba[0].replace(/[^(\d+)]/g,""))+"/"+n.getFullYear());if(ba.length==3)var A=new Date(Date.parse((b==14?ba[0]:ba[1])+(b==14?ba[1].replace(/[^(\d+)]/g,""):ba[0].replace(/[^(\d+)]/g,""))+"/"+(ba[2].match(/((19|20)\d\d)/)?ba[2]:20+ba[2])));else var A=new Date(Date.parse((b==14?ba[0]:ba[1])+(b==14?ba[1].replace(/[^(\d+)]/g,""):ba[0].replace(/[^(\d+)]/g,""))+"/"+n.getFullYear()));if(A!="Invalid Date"&&d[m-4]&&d[m-4]!="for"){d[m-1].match(/(from|after)/)?A.setDate(A.getDate()+parseInt(d[m-3])):d[m-1].match(/(before)/)&&A.setDate(A.getDate()-parseInt(d[m-3])),m=ba.length==3?d.indexOf(ba[2]):d.indexOf(ba[1]);if(d[m+1]&&d[m+1].match(/(for)/)&&d[m+2]&&d[m+2].match(/[0-9]{1,2}/)&&d[m+3]&&d[m+3].match(/(day)s?/)){var B=new Date(Date.parse(A.getMonth()+parseInt(1)+"/"+A.getDate()+"/"+A.getFullYear()));B.setDate(B.getDate()+parseInt(d[m+2])),ce=Date.parse(B.getMonth()+parseInt(1)+"/"+B.getDate()+"/"+B.getFullYear())}return Date.parse(A.getMonth()+parseInt(1)+"/"+A.getDate()+"/"+A.getFullYear())}if(A!="Invalid Date"&&d[m-4]&&d[m-4]=="for"){var B=new Date(Date.parse(A.getMonth()+parseInt(1)+"/"+A.getDate()+"/"+A.getFullYear()));return B.setDate(B.getDate()+parseInt(d[m-3])),ce=Date.parse(B.getMonth()+parseInt(1)+"/"+B.getDate()+"/"+B.getFullYear()),A}if(A=="Invalid Date")return o}if(b==16||b==17){var bb=a[0];a[0]=b!=16?j.indexOf(a[0].toLowerCase())<0?j[l.indexOf(a[0].toLowerCase())]:a[0]:a[0];var d=c.split(bH),bc=c.match(bm),bd=b==17?d.indexOf(a[0])>-1?g[f.indexOf(a[0])]:bc?g[f.indexOf(bc[0])]:"":"";if((d.indexOf("from")>-1||d.indexOf("after")>-1||d.indexOf("before")>-1)&&(d.indexOf("days")>-1||d.indexOf("day")>-1)&&d.indexOf(bb)>-1&&d[d.indexOf(bb)-1].match(/(from|after|before)/)&&!bU.isrem){var m=d.indexOf(bb)-1;if(d[m-1]&&d[m-1].match(/(day)s?/)&&d[m-2]&&d[m-2].match(/[0-9]{1,2}/)){var be=c.split(bH),bf=be.indexOf(bb),bg=be[bf-1]&&be[bf-1].match(/(next)/)?j.indexOf(a[0])>-1?e[j.indexOf(a[0])]:l.indexOf(a[0])>-1?e[l.indexOf(a[0])]:"":be[bf-1]&&be[bf-1].match(/(this)/)?j.indexOf(a[0])>-1?h[j.indexOf(a[0])]:l.indexOf(a[0])>-1?h[l.indexOf(a[0])]:"":bd?bd:j.indexOf(a[0])>-1?h[j.indexOf(a[0])]:l.indexOf(a[0])>-1?h[l.indexOf(a[0])]:"",A=new Date(Date.parse(bg.getMonth()+parseInt(1)+"/"+bg.getDate()+"/"+bg.getFullYear()));if(A!="Invalid Date"&&(d[m-3]&&d[m-3]!="for"||!d[m-3])){d[m-3]&&d[m-3]!="every"||!d[m-3]?d[m]&&d[m].match(/(from|after)/)?A.setDate(A.getDate()+parseInt(d[m-2])):d[m]&&d[m].match(/(before)/)&&A.setDate(A.getDate()-parseInt(d[m-2])):d[m-3]&&(q.daily=1,F=d[m-2]),m=d.indexOf(bb);if(d[m+1]&&d[m+1].match(/(for)/)&&d[m+2]&&d[m+2].match(/[0-9]{1,2}/)&&d[m+3]&&d[m+3].match(/(day)s?/)){var B=new Date(Date.parse(A.getMonth()+parseInt(1)+"/"+A.getDate()+"/"+A.getFullYear()));B.setDate(B.getDate()+parseInt(d[m+2])),ce=Date.parse(B.getMonth()+parseInt(1)+"/"+B.getDate()+"/"+B.getFullYear())}var bh=Date.parse(A.getMonth()+parseInt(1)+"/"+A.getDate()+"/"+A.getFullYear()),bi;if(cd!=undefined){if(cd>bh||cd<bh){bh=new Date(bh);var bj=new Date(cd);bg=be[bf-1]&&be[bf-1].match(/(next)/)?c$(bj,bh.getDay()):be[bf-1]&&be[bf-1].match(/(this)/)?c_(bj,bh.getDay()):c_(bj,bh.getDay()),bh=Date.parse(bg.getMonth()+parseInt(1)+"/"+bg.getDate()+"/"+bg.getFullYear()),bi=bh}}else bi=bh;return bi}if(A!="Invalid Date"&&d[m-3]&&d[m-3]=="for"){var B=new Date(Date.parse(A.getMonth()+parseInt(1)+"/"+A.getDate()+"/"+A.getFullYear()));return B.setDate(B.getDate()+parseInt(d[m-2])),ce=Date.parse(B.getMonth()+parseInt(1)+"/"+B.getDate()+"/"+B.getFullYear()),A}if(A=="Invalid Date")return o}else{m=d.indexOf(bb);var bg=d[m-1].match(/(next)/)?j.indexOf(a[0])>-1?e[j.indexOf(a[0])]:l.indexOf(a[0])>-1?e[l.indexOf(a[0])]:"":d[m-1].match(/(this)/)?j.indexOf(a[0])>-1?h[j.indexOf(a[0])]:l.indexOf(a[0])>-1?h[l.indexOf(a[0])]:"":bd?bd:j.indexOf(a[0])>-1?h[j.indexOf(a[0])]:l.indexOf(a[0])>-1?h[l.indexOf(a[0])]:"";if(bg!="Invalid Date"&&d[m+1]&&d[m+1].match("for")&&d[m+2]&&d[m+2].match(/[0-9]{1,2}/)&&d[m+3]&&d[m+3].match(/(day)s?/)){var bl=new Date;bl.setDate(bg.getDate()),bl.setMonth(bg.getMonth()),bl.setFullYear(bg.getFullYear()),bl.setDate(bl.getDate()+parseInt(d[m+2])),ce=ce?ce:Date.parse(bl.getMonth()+parseInt(1)+"/"+bl.getDate()+"/"+bl.getFullYear())}if(bg!="Invalid Date")return Date.parse(bg.getMonth()+parseInt(1)+"/"+bg.getDate()+"/"+bg.getFullYear());if(bg=="Invalid Date")return o}}else{if(!c.match(bk)){var be=c.split(bH),bf=be.indexOf(bb),bv=0;if(d[bf+1]&&d[bf+1].match("of")&&d[bf+2]&&d[bf+2].match(/(next|last|every)/)){if(d[bf+3]!="month"&&I.indexOf(d[bf+3])<0)var bg=d[bf+2]=="next"?j.indexOf(a[0])>-1?e[j.indexOf(a[0])]:l.indexOf(a[0])>-1?e[l.indexOf(a[0])]:"":d[bf+2]=="last"?j.indexOf(a[0])>-1?i[j.indexOf(a[0])]:l.indexOf(a[0])>-1?i[l.indexOf(a[0])]:"":j.indexOf(a[0])>-1?h[j.indexOf(a[0])]:l.indexOf(a[0])>-1?h[l.indexOf(a[0])]:"";else if(d[bf+2].match(/(next|last)/)&&I.indexOf(d[bf+3])<0){var bw=J[n.getMonth()+parseInt(1)],bg=dc("first",a[0],bw,"");if(cd&&q.weekly==1){var bx=new Date(cd);bx=dc("first",j[bx.getDay()],bw,""),cd=Date.parse(bx.getMonth()+parseInt(1)+"/"+bx.getDate()+"/"+bx.getFullYear());var a=new Date(bx.getFullYear(),bx.getMonth()+1,0,0,0,0);C=C?C:Date.parse(a.getMonth()+1+"/"+a.getDate()+"/"+a.getFullYear())}if(c.match("every")){q.weekly=1;if(!cd&&q.weekly==1&&bg!="Invalid Date"){var a=new Date(bg.getFullYear(),bg.getMonth()+1,0,0,0,0);C=C?C:Date.parse(a.getMonth()+1+"/"+a.getDate()+"/"+a.getFullYear())}else if(bg=="Invalid Date")return o}}else if(d[bf+2]&&d[bf+2].match(/(next|last)/)&&I.indexOf(d[bf+3])>-1){var bg=dc("first",a[0],I[I.indexOf(d[bf+3])],n.getFullYear()+1);if(cd&&q.weekly==1){var bx=new Date(cd);bx=dc("first",j[bx.getDay()],I[I.indexOf(d[bf+3])],n.getFullYear()+1),cd=Date.parse(bx.getMonth()+parseInt(1)+"/"+bx.getDate()+"/"+bx.getFullYear());var a=new Date(bx.getFullYear(),bx.getMonth()+1,0,0,0,0);C=C?C:Date.parse(a.getMonth()+1+"/"+a.getDate()+"/"+a.getFullYear())}if(c.match("every")){q.weekly=1;if(!cd&&q.weekly==1&&bg!="Invalid Date"){var a=new Date(bg.getFullYear(),bg.getMonth()+1,0,0,0,0);C=C?C:Date.parse(a.getMonth()+1+"/"+a.getDate()+"/"+a.getFullYear())}else if(bg=="Invalid Date")return o}}if(d[bf+2]=="every")if(d[bf+3].match(/(month|week)/)){q.weekly=1;var bg=h[j.indexOf(a[0])]}else if(d[bf+3]&&d[bf+3].match(/[0-9]{1,2}/)&&d[bf+4]&&d[bf+4].match(/(week)/)){q.weekly=1;var bg=h[j.indexOf(a[0])];E=d[bf+3]}bv=d[bf+2]=="next"?"1":"2"}else if(d[bf+1]&&d[bf+1].match("of")&&d[bf+2]&&I.indexOf(d[bf+2])>-1){if(cd&&q.weekly==1){var bg=dc("first",a[0],d[bf+2],""),a=new Date(cd);cd=dc("first",l[a.getDay()],d[bf+2],"");var b=bg!="Invalid Date"?new Date(bg.getFullYear(),bg.getMonth()+1,0,0,0,0):"";b=b!=""?Date.parse(b.getMonth()+parseInt(1)+"/"+b.getDate()+"/"+b.getFullYear()):"",C=C?C:b}else if(c.match("every")){var bg=dc("first",a[0],d[bf+2],""),b=bg!="Invalid Date"?new Date(bg.getFullYear(),bg.getMonth()+1,0,0,0,0):"";b=b!=""?Date.parse(b.getMonth()+parseInt(1)+"/"+b.getDate()+"/"+b.getFullYear()):"",C=C?C:b}}else if(d[bf+1]&&d[bf+1].match("for")&&d[bf+2]&&d[bf+2].match(/[0-9]{1,2}/)&&d[bf+3]&&d[bf+3].match(/((day)s?|(month)s?|(week)s?)/))if(d[bf+3].match(/(day)s?/)){var bg=be[bf-1]&&be[bf-1].match(/(next)/)?j.indexOf(a[0])>-1?e[j.indexOf(a[0])]:l.indexOf(a[0])>-1?e[l.indexOf(a[0])]:"":be[bf-1]&&be[bf-1].match(/(this)/)?j.indexOf(a[0])>-1?h[j.indexOf(a[0])]:l.indexOf(a[0])>-1?h[l.indexOf(a[0])]:"":b==17?bc?g[f.indexOf(bc[0])]:"":j.indexOf(a[0])>-1?h[j.indexOf(a[0])]:l.indexOf(a[0])>-1?h[l.indexOf(a[0])]:"";ce=Date.parse(bg.getMonth()+parseInt(1)+"/"+(bg.getDate()+parseInt(d[bf+2]))+"/"+bg.getFullYear())}else if(c.match(/(every|all)/)&&d[bf+3].match(/(month)s?/)||q.weekly==1){q.weekly=1;var by=new Date;by.setMonth(by.getMonth()+(parseInt(d[bf+2])+1)),by.setDate(0);var bg=be[bf-1]&&be[bf-1].match(/(next)/)?j.indexOf(a[0])>-1?e[j.indexOf(a[0])]:l.indexOf(a[0])>-1?e[l.indexOf(a[0])]:"":be[bf-1]&&be[bf-1].match(/(this)/)?j.indexOf(a[0])>-1?h[j.indexOf(a[0])]:l.indexOf(a[0])>-1?h[l.indexOf(a[0])]:"":b==17?bc?g[f.indexOf(bc[0])]:"":j.indexOf(a[0])>-1?h[j.indexOf(a[0])]:l.indexOf(a[0])>-1?h[l.indexOf(a[0])]:"";C=by}else if(c.match(/(every|all)/)&&d[bf+3].match(/(week)s?/)||q.weekly==1){var by=new Date,bz=by.getDay(),bA=bz==0?7*(d[bf+2]-1):7*(d[bf+2]-1)+(7-bz);by.setDate(by.getDate()+parseInt(bA));var bg=be[bf-1].match(/(next)/)?j.indexOf(a[0])>-1?e[j.indexOf(a[0])]:l.indexOf(a[0])>-1?e[l.indexOf(a[0])]:"":be[bf-1].match(/(this)/)?j.indexOf(a[0])>-1?h[j.indexOf(a[0])]:l.indexOf(a[0])>-1?h[l.indexOf(a[0])]:"":b==17?bc?g[f.indexOf(bc[0])]:"":j.indexOf(a[0])>-1?h[j.indexOf(a[0])]:l.indexOf(a[0])>-1?h[l.indexOf(a[0])]:"";q.weekly=1,C=by}else var bg=be[bf-1].match(/(next)/)?j.indexOf(a[0])>-1?e[j.indexOf(a[0])]:l.indexOf(a[0])>-1?e[l.indexOf(a[0])]:"":be[bf-1].match(/(this)/)?j.indexOf(a[0])>-1?h[j.indexOf(a[0])]:l.indexOf(a[0])>-1?h[l.indexOf(a[0])]:"":b==17?bc?g[f.indexOf(bc[0])]:"":j.indexOf(a[0])>-1?h[j.indexOf(a[0])]:l.indexOf(a[0])>-1?h[l.indexOf(a[0])]:"";else{if(c.match("every"))if(c.match(/(every|all)\s?(weekday)s?/))q.daily=1,G=1;else if(c.match(/(every|all)\s?(weekend)s?/))q.weekly=1,D="saturday,sunday",cc=1;else{q.weekly=1,D=cd?"":a[0];if(c.match(/(for)\s?[0-9]{1,2}\s?(month)s?/)){var bB=c.match(/(for)\s?[0-9]{1,2}\s?(month)s?/),ba=bB[0].match(/[0-9]{1,2}/),bC=new Date;bC.setMonth(bC.getMonth()+parseInt(ba[0])),bC.setDate(0),C=bC}if(c.match(/(for)\s?[0-9]{1,2}\s?(week)s?/)){var bB=c.match(/(for)\s?[0-9]{1,2}\s?(week)s?/),ba=bB[0].match(/[0-9]{1,2}/),by=new Date,bz=by.getDay(),bA=bz==0?7*(d[bf+2]-1):7*(d[bf+2]-1)+(7-bz);by.setDate(by.getDate()+parseInt(bA)),C=bC}if(c.match(/(every)\s?[0-9]{1,2}\s?(week)s?/)){var bB=c.match(/(every)\s?[0-9]{1,2}\s?(week)s?/),ba=bB[0].match(/[0-9]{1,2}/);q.weekly=1,E=ba[0]}}else if(!cd){var Z=ch,$=Z.replace(c," @ ");$=$.split(bH);var m=$.indexOf("@");$[m-1]&&$[m-1].match(/\b(weekday)s?\b/)&&$[m-2].match(/\b(every|all)\b/)&&(q.daily=1,G=1),$[m-1]&&$[m-1].match(/\b(weekend)s?\b/)&&$[m-2]&&$[m-2].match(/\b(every|all)\b/)&&(q.weekly=1,D="saturday,sunday"),$[m-1]&&$[m-1].match(/(day)s?/)&&$[m-2]&&$[m-2].match(/[0-9]{1,2}/)&&$[m-3]=="every"&&(q.daily=1,F=$[m-2],G=1)}var bg=bf>-1&&be[bf-1].match(/(next)/)?j.indexOf(a[0])>-1?e[j.indexOf(a[0])]:l.indexOf(a[0])>-1?e[l.indexOf(a[0])]:"":bf>-1&&be[bf-1].match(/(this)/)?j.indexOf(a[0])>-1?h[j.indexOf(a[0])]:l.indexOf(a[0])>-1?h[l.indexOf(a[0])]:"":bd?bd:j.indexOf(a[0])>-1?h[j.indexOf(a[0])]:l.indexOf(a[0])>-1?h[l.indexOf(a[0])]:""}var bh=bg!="Invalid Date"&&bg!=undefined?Date.parse(bg.getMonth()+parseInt(1)+"/"+bg.getDate()+"/"+bg.getFullYear()):"",bD;if(cd!=undefined&&bh!="")if(cd>bh){bh=new Date(bh);var bj=new Date(cd);bg=bf>-1&&be[bf-1].match(/(next)/)?c$(bj,bh.getDay()):bf>-1&&be[bf-1].match(/(this)/)?c_(bj,bh.getDay()):bv==1?c$(bj,bh.getDay()):bd?bd:c_(bj,bh.getDay()),bD=bg}else bD=bh;else bD=bh!=""?bh:o;return bD}var bn=c.match(bk),m=d.indexOf(bb),bo,bp;d[m-2]&&d[m-2].match(/(from|after|before)/)&&d[m-3]&&d[m-3].match(/(day)s?/)&&d[m-4]&&d[m-4].match(/[0-9]{1,2}/)&&!bU.isrem&&(d[m-5]&&d[m-5].match(/(for)/)?bp=d[m-4]:d[m-5]&&!d[m-5].match(/(every)/)?bo=d[m-4]:(q.daily=1,F=d[m-4]));if(d[m+1]&&d[m+1].match("of")&&d[m+2]&&d[m+2].match(/(jan|feb|mar|apr|may|jun|july|aug|sep|oct|nov|dec|january|february|march|april|may|june|july|august|september|october|november|december)/)){var bq=d[m+3]&&d[m+3].match(/[0-9]{4}/)?d[m+3]:"";c.match(/every/)&&(q.yearly=1,t=a[0],s=d[m+2],r=bn[1]);var br=dc(bn[1],a[0],d[m+2],bq);bo&&(d[m-2].match(/(from|after)/)&&br.setDate(br.getDate()+parseInt(bo)),d[m-2].match(/(before)/)&&br.setDate(br.getDate()-parseInt(bo)));if(bp){var bs=new Date;bs.setDate(br.getDate()),bs.setMonth(br.getMonth()),bs.setFullYear(br.getFullYear()),bs.setDate(bs.getDate()+parseInt(bp)),ce=Date.parse(bs.getMonth()+parseInt(1)+"/"+bs.getDate()+"/"+bs.getFullYear())}var bh=Date.parse(br.getMonth()+parseInt(1)+"/"+br.getDate()+"/"+br.getFullYear());if(cd==undefined||!bh)return bh?bh:o;if(cd<bh||cd>bh){bh=new Date(bh);var bj=new Date(cd);return bj.getMonth()<bh.getMonth()&&bq==""?(bh=dc(bn[1],a[0],d[m+2],bj.getFullYear()),bo&&(d[m-2].match(/(from|after)/)?bh=Date.parse(bh.getMonth()+parseInt(1)+"/"+(bh.getDate()+parseInt(bo))+"/"+bh.getFullYear()):d[m-2].match(/(from|after)/)&&(bh=Date.parse(bh.getMonth()+parseInt(1)+"/"+(bh.getDate()-parseInt(bo))+"/"+bh.getFullYear()))),bh):(bq==""&&(bh=dc(bn[1],a[0],d[m+2],bj.getFullYear()+1),bo&&(d[m-2].match(/(from|after)/)?bh=Date.parse(bh.getMonth()+parseInt(1)+"/"+(bh.getDate()+parseInt(bo))+"/"+bh.getFullYear()):d[m-2].match(/(before)/)&&(bh=Date.parse(bh.getMonth()+parseInt(1)+"/"+(bh.getDate()-parseInt(bo))+"/"+bh.getFullYear())))),bh?bh:Date.parse(n.getMonth()+parseInt(1)+"/"+n.getDate()+"/"+n.getFullYear()))}}else{if(d[m+1]&&d[m+1].match(/(of|for)/)&&d[m+2]&&d[m+2].match(/(next|this|every)/)&&(d[m+3]&&!d[m+3].match("month")&&d[m+3].match(/[0-9]{1,2}/)&&d[m+4]&&d[m+4].match("month")||d[m+3]&&d[m+3].match("month"))){d[m+2]=="every"&&(q.monthly=1,y=a[0],x=bn[1],d[m+3].match(/[0-9]{1,2}/)&&d[m+4].match("month")&&(z=d[m+3]));var p=d[m+2];d[m+2]=d[m+2]=="next"?K[n.getMonth()+1]:K[n.getMonth()];var br=dc(bn[1],a[0],d[m+2],"");bo&&(d[m-2].match(/(from|after)/)?br.setDate(br.getDate()+parseInt(bo)):d[m-2].match(/(before)/)&&br.setDate(br.getDate()-parseInt(bo)));if(bp){var bs=new Date;bs.setDate(br.getDate()),bs.setMonth(br.getMonth()),bs.setFullYear(br.getFullYear()),bs.setDate(bs.getDate()+parseInt(bp)),ce=Date.parse(bs.getMonth()+parseInt(1)+"/"+bs.getDate()+"/"+bs.getFullYear())}var bh=Date.parse(br.getMonth()+parseInt(1)+"/"+br.getDate()+"/"+br.getFullYear());if(cd!=undefined&&bh){if(cd>bh){bh=new Date(bh);var bj=new Date(cd),bt=p.match("next")&&K.indexOf(d[m+2])!=bj.getMonth()?K[bj.getMonth()+1==12?"0":bj.getMonth()+1]:K[bj.getMonth()];return br=dc(bn[1],a[0],bt,bj.getFullYear()),Date.parse(br.getMonth()+parseInt(1)+"/"+br.getDate()+"/"+br.getFullYear())}return bh}return bh?bh:o}if(d[m+1]&&d[m+1].match(/(of|for)/)&&d[m+2]&&d[m+2].match(/(next|this|every)/)&&I.indexOf(d[m+3])>-1){var bq=d[m+3]&&d[m+3].match(/[0-9]{4}/)?d[m+3]:d[m+2]=="next"?parseInt(n.getFullYear())+parseInt(1):"";c.match(/every/)&&(q.yearly=1,t=a[0],s=d[m+3],r=bn[1]);var br=dc(bn[1],a[0],d[m+3],bq),bh=Date.parse(br.getMonth()+parseInt(1)+"/"+br.getDate()+"/"+br.getFullYear());if(cd==undefined||!bh)return bh?bh:o;if(cd<bh||cd>bh){bh=new Date(bh);var bj=new Date(cd);return bj.getMonth()<bh.getMonth()&&bq==""?(bh=dc(bn[1],a[0],d[m+2],bj.getFullYear()),bh!="Invalid Date"?bh:o):(bq==""&&(bh=dc(bn[1],a[0],d[m+2],bj.getFullYear()+1)),bh!="Invalid Date"?bh:o)}}else{if(d[m-1]&&d[m-1].match("every")||d[m-2]&&d[m-2].match("every")){q.monthly=1,y=a[0],x=bn[1];var bh=dc(bn[1],a[0],J[n.getMonth()],n.getFullYear());return bh!="Invalid Date"?bh:o}if(d[m-3]&&d[m-3].match(/\b(weekday)s?\b/)&&d[m-4]&&d[m-4].match(/\b(every|all)\b/)){q.daily=1,G=1;var bh=dc(bn[1],a[0],J[n.getMonth()],n.getFullYear());return bh!="Invalid Date"?bh:o}if(!c.match(/\b(every|all)\b/)){var br;!bn[0].match("next")&&!bn[0].match("this")?br=bn[0].match("last")&&!cd?j.indexOf(a[0])>-1?i[j.indexOf(a[0])]:l.indexOf(a[0])>-1?i[l.indexOf(a[0])]:"":dc(bn[1],a[0],J[n.getMonth()],""):br=bn[0].match(/(next)/)?j.indexOf(a[0])>-1?e[j.indexOf(a[0])]:l.indexOf(a[0])>-1?e[l.indexOf(a[0])]:"":j.indexOf(a[0])>-1?h[j.indexOf(a[0])]:l.indexOf(a[0])>-1?h[l.indexOf(a[0])]:"";if(br&&d[m+1]&&d[m+1].match("for")&&d[m+2]&&d[m+2].match(/[0-9]{1,2}/)&&d[m+3]&&d[m+3].match(/(day)s?/)){var bl=new Date;bl.setDate(br.getDate()),bl.setMonth(br.getMonth()),bl.setFullYear(br.getFullYear()),bl.setDate(bl.getDate()+parseInt(d[m+2])),ce=ce?ce:Date.parse(bl.getMonth()+parseInt(1)+"/"+bl.getDate()+"/"+bl.getFullYear())}bo&&br.setDate(br.getDate()+parseInt(bo));if(bp){var bs=new Date;bs.setDate(br.getDate()),bs.setMonth(br.getMonth()),bs.setFullYear(br.getFullYear()),bs.setDate(bs.getDate()+parseInt(bp)),bs.setDate(bs.setDate()+parseInt(bp)),ce=Date.parse(bs.getMonth()+parseInt(1)+"/"+bs.getDate()+"/"+bs.getFullYear())}return Date.parse(br.getMonth()+parseInt(1)+"/"+br.getDate()+"/"+br.getFullYear())}if(c.match(/(every|all)\s?(weekday)s?/)){q.daily=1,G=1;var bh=dc(bn[1],a[0],J[n.getMonth()],n.getFullYear());return bh!="Invalid Date"?bh:o}if(c.match(/(every|all)\s?(weekend)s?/)){q.weekly=1,D="saturday,sunday",cc=1;var bh=dc(bn[1],a[0],J[n.getMonth()],n.getFullYear());return bh!="Invalid Date"?bh:o}if(c.match(/every\s([0-9]{1,2})?\s?(month)s?/)){var bu=c.match(/every\s([0-9]{1,2})?\s?(month)s?/),ba=bu[0].match(/[0-9]{1,2}/)?bu[0].match(/[0-9]{1,2}/):"";q.monthly=1,x=d[m-1],y=a[0],z=ba[0]?ba[0]:"";var bh=dc(bn[1],a[0],J[n.getMonth()],n.getFullYear());return bh!="Invalid Date"?bh:o}}}}}if(b==15){var d=c.split(bH),p=a[0].replace(/(\s|,)/g,"/"),ba=p.split("/"),m=d.indexOf(ba[0]);if(!(d[m-1].match(/(from|after)/)&&d[m-2].match(/(day)s?/)&&d[m-3]&&d[m-3].match(/[0-9]{1,2}/)))return m=ba.length==4?d.indexOf(ba[3]):d.indexOf(ba[2]),d[m+1]&&d[m+1].match("for")&&d[m+2]&&d[m+2].match(/[0-9]{1,2}/)&&d[m+3]&&d[m+3].match(/(day)s?/)&&(ba.length==4?b_=Date.parse(ba[2]+(parseInt(ba[0].replace(/[^(\d+)]/g,""))+parseInt(d[m+2]))+"/"+ba[3]):b_=Date.parse(ba[2]+"/"+(parseInt(ba[0].replace(/[^(\d+)]/g,""))+parseInt(d[m+2]))+"/"+n.getFullYear())),ba.length==4?Date.parse(ba[2]+ba[0].replace(/[^(\d+)]/g,"")+"/"+ba[3]):Date.parse(ba[2]+ba[0].replace(/[^(\d+)]/g,"")+"/"+n.getFullYear());if(ba.length==4)var A=new Date(Date.parse(ba[2]+ba[0].replace(/[^(\d+)]/g,"")+"/"+ba[3]));else var A=new Date(Date.parse(ba[2]+ba[0].replace(/[^(\d+)]/g,"")+"/"+n.getFullYear()));if(A!="Invalid Date"&&d[m-4]&&d[m-4]!="for"){A.setDate(A.getDate()+parseInt(d[m-3])),m=ba.length==3?d.indexOf(ba[2]):d.indexOf(ba[1]);if(d[m+1]&&d[m+1].match(/(for)/)&&d[m+2]&&d[m+2].match(/[0-9]{1,2}/)&&d[m+3]&&d[m+3].match(/(day)s?/)){var B=new Date(Date.parse(A.getMonth()+parseInt(1)+"/"+A.getDate()+"/"+A.getFullYear()));B.setDate(B.getDate()+parseInt(d[m+2])),b_=Date.parse(B.getMonth()+parseInt(1)+"/"+B.getDate()+"/"+B.getFullYear())}return Date.parse(A.getMonth()+parseInt(1)+"/"+A.getDate()+"/"+A.getFullYear())}if(A!="Invalid Date"&&d[m-4]&&d[m-4]=="for"){var B=new Date(Date.parse(A.getMonth()+parseInt(1)+"/"+A.getDate()+"/"+A.getFullYear()));return B.setDate(B.getDate()+parseInt(d[m-3])),b_=Date.parse(B.getMonth()+parseInt(1)+"/"+B.getDate()+"/"+B.getFullYear()),A}if(A=="Invalid Date")return o}if(b==18){var be=c.split(bH),m=be.indexOf(a[0]);if(k.indexOf(a[0])>-1&&be[m-1]!="next"){var bg=h[k.indexOf(a[0])];q.weekly=1;if(be[m+1]&&be[m+1].match("for")&&be[m+2]&&be[m+2].match(/[0-9]{1,2}/)&&be[m+3].match(/((month)s?)/)){var by=new Date;by.setMonth(by.getMonth()+(parseInt(be[m+2])+1)),by.setDate(0),C=by}else if(be[m+1]&&be[m+1].match("for")&&be[m+2]&&be[m+2].match(/[0-9]{1,2}/)&&be[m+3].match(/((week)s?)/)){var by=new Date,bz=by.getDay(),bA=bz==0?7*(be[m+2]-1):7*(be[m+2]-1)+(7-bz);by.setDate(by.getDate()+parseInt(bA)),C=by}var bh=bg!="Invalid Date"?Date.parse(bg.getMonth()+parseInt(1)+"/"+bg.getDate()+"/"+bg.getFullYear()):"";return bh!=""?bh:o}}if(b==19){var d=c.split(bH),m=d.indexOf(a[0]);if(cd){var bg=d[m-1]&&d[m-1].match("this")?c_(new Date,0):d[m-1]&&d[m-1].match("next")?c$(new Date,0):c_(new Date,0),bh=Date.parse(bg.getMonth()+parseInt(1)+"/"+bg.getDate()+"/"+bg.getFullYear());return bh}var bg=d[m-1]&&d[m-1].match("this")?c_(new Date,6):d[m-1]&&d[m-1].match("next")?c$(new Date,6):c_(new Date,6),bh=Date.parse(bg.getMonth()+parseInt(1)+"/"+bg.getDate()+"/"+bg.getFullYear());if(d[m+1]&&d[m+1].match("for")&&d[m+2].match(/[0-9]{1,2}/)&&d[m+3].match(/((month)s?|(week)s?)/))if(d[m+3].match(/(month)s?/)){var bB=c.match(/(for)\s?[0-9]{1,2}\s?(month)s?/),ba=bB[0].match(/[0-9]{1,2}/),bC=new Date;bC.setMonth(bC.getMonth()+parseInt(ba[0])),bC.setDate(0),C=bC}else{var bB=c.match(/(for)\s?[0-9]{1,2}\s?(week)s?/),ba=bB[0].match(/[0-9]{1,2}/),by=new Date,bz=by.getDay(),bA=bz==0?7*(d[m+2]-1):7*(d[m+2]-1)+(7-bz);by.setDate(by.getDate()+parseInt(bA)),C=by}if(d[m+1]&&d[m+1].match(/(from|of|in)/)&&I.indexOf(d[m+2])>-1){var bE=J.indexOf(d[m+2])>-1?J.indexOf(d[m+2]):K.indexOf(d[m+2])>-1?K.indexOf(d[m+2]):"";bh=Date.parse(bE+parseInt(1)+"/"+"01"+"/"+n.getFullYear()),q.weekly=1,D="saturday,sunday";if(d[m+1].match(/(of|in)/)){var bF=new Date(bh);bF.setMonth(bF.getMonth()+1),bF.setDate(0),C=Date.parse(bF.getMonth()+parseInt(1)+"/"+bF.getDate()+"/"+bF.getFullYear())}}if(d[m+1]&&d[m+1].match(/(from|of|in)/)&&d[m+2].match(/(this|next)/)&&d[m+3].match("month")){var bE=d[m+2].match("this")?n.getMonth():n.getMonth()+1;bh=Date.parse(bE+parseInt(1)+"/"+"01"+"/"+n.getFullYear());if(d[m+1].match(/(of|in)/)){var bF=new Date(bh);bF.setMonth(bF.getMonth()+1),bF.setDate(0),C=Date.parse(bF.getMonth()+parseInt(1)+"/"+bF.getDate()+"/"+bF.getFullYear())}}return bh}if(b==20||b==21){var bG;c.match(/[0-9]{4}/)&&(bG=c.match(/[0-9]{4}/));var bI=a[0].split("-"),bJ=b==20?bI[0].split(/[0-9]{1,2}/):b==21?bI[1].split(/[0-9]{1,2}/):"";return ce=ce?ce:b==20?Date.parse(bJ[0]+" "+bI[1]+" "+(bG&&bG[0]?bG[0]:n.getFullYear())):b==21?Date.parse(bI[1]+" "+(bG&&bG[0]?bG[0]:n.getFullYear())):"",b==20?Date.parse(bI[0]+" "+(bG&&bG[0]?bG[0]:n.getFullYear())):b==21?Date.parse(bJ[1]+" "+bI[0]+" "+(bG&&bG[0]?bG[0]:n.getFullYear())):""}if(b==22){var bK=a[0].split("-"),p=bK[0].replace(/(\s)/g,"/"),bL=bK[1].replace(/(\s)/g,"/"),ba=p.split("/"),bM=bL.split("/");return ce=ce?ce:Date.parse(bM[0].replace(/[^(\d+)]/g,"")+" "+bM[1]+" "+n.getFullYear()),Date.parse(ba[0].replace(/[^(\d+)]/g,"")+" "+ba[1]+" "+n.getFullYear())}if(b==23||b==24){var bK=a[0].split("-"),bL=b==23?bK[1].replace(/(\s)/g,"/"):bK[0].replace(/(\s)/g,"/"),bM=bL.split("/");return ce=ce?ce:Date.parse((b==23?bM[0].replace(/[^(\d+)]/g,""):bK[1].replace(/[^(\d+)]/g,""))+" "+(b==23?bM[1]:bM[0])+" "+n.getFullYear()),Date.parse((b==23?bK[0].replace(/[^(\d+)]/g,""):bM[1].replace(/[^(\d+)]/g,""))+" "+(b==23?bM[1]:bM[0])+" "+n.getFullYear())}}catch(bN){}}function cZ(a,c){try{if(c==0){if(a[0].match(/(:|\.)/)){var d=a[0].match(/(:)/)?a[0].split(":"):a[0].match(/(.)/)?a[0].split("."):"";d[0]=d[1].match("pm")?d[0]<12?12+parseInt(d[0]):d[0]:d[0]==12||d[0]==24?0:d[0];if(b!=0)d[1]=d[1].match("pm")?d[1].replace("pm",""):d[1].match("am")?d[1].replace("am",""):d[1].match("hrs")?d[1].replace("hrs",""):"";else{if(cf&&cX==1){var e=parseInt(cf/36e5),f=parseInt(cf/6e4)%60,g=d[1].match("pm")?e<12?parseInt(e)+parseInt(12):e:d[1].match("am")?e:d[1].match("hours")?e<12?e+parseInt(12):e:e;cf=g*36e5+parseInt(f*6e4)}cX=d[1].match(/(am|pm|hrs)/)?0:1,d[1]=d[1].match("pm")?d[1].replace("pm",""):d[1].match("am")?d[1].replace("am",""):d[1].match("hrs")?d[1].replace("hrs",""):d[1]}var h=d[0]!=0?d[0]*36e5:1;return h+=d[1]!=0?d[1]*6e4:1e3,h}if(b!=0){if(!a[0].match(/(hrs)/)){var i=a[0].match("pm")?"1":a[0].match("am")?"0":null;a[0]=a[0].match("pm")?a[0].replace("pm",""):a[0].match("am")?a[0].replace("am",""):""}}else{if(cf&&cX==1){var e=parseInt(cf/36e5),f=parseInt(cf/6e4)%60,g=a[0].match("pm")?e<12?parseInt(e)+parseInt(12):e:a[0].match("am")?e:a[0].match("hours")?e<12?e+parseInt(12):e:e;cf=g*36e5+parseInt(f?f*6e4:0)}cX=a[0].match(/(am|pm|hrs)/)?0:1;if(!a[0].match(/(hrs)/)){var i=a[0].match("pm")?"1":a[0].match("am")?"0":"0";a[0]=a[0].match("pm")?a[0].replace("pm",""):a[0].match("am")?a[0].replace("am",""):a[0]}}if(a[0].match(/(hrs)/)){a[0]=a[0].match(/(hrs)/)?a[0].replace("hrs","").trim():a[0];if(a[0].length==2&&a[0]<24||a[0].length==4&&a[0]<2400){var h=a[0].length==2?a[0]*36e5:a[0].length==4?parseInt(a[0]/100)*36e5:"";return h=h==0?1e3:h,h=a[0].length==2?h:a[0].length==4?h+a[0]%100*6e4:"",h}return""}if(!a[0].match(/(hrs)/)){a[0]=i==1?a[0]<12?12+parseInt(a[0]):a[0]:i==0?a[0]==12?-1:a[0]:"";var h=a[0]!=""?a[0]!=-1?a[0]*36e5:1e3:"";return h}}if(c==2||c==3)if(bP[a[0]]){var h=bP[a[0]];return h}if(c==4){var j=a[0].split("-"),k=j[1].match(/(am|pm)/);if(j[0].match(/(:|\.)/)){var d=j[0].match(/(:)/)?j[0].split(":"):j[0].match(/(\.)/)?j[0].split("."):"";d[0]=d[1].match("pm")?d[0]<12?12+parseInt(d[0]):d[0]:d[1].match("am")?d[0]==12?-1:d[0]:k[0].match("pm")?d[0]<12?12+parseInt(d[0]):d[0]:d[0]==12?-1:d[0],d[1]=d[1].match("pm")?d[1].replace("pm",""):d[1].match("am")?d[1].replace("am",""):d[1];var h=d[0]?d[0]!=-1?d[0]*36e5:1e3:"";h+=d[1]*6e4;if(j[1].match(/(:|\.)/)){d=j[1].match(/(:)/)?j[1].split(":"):j[1].match(/(\.)/)?j[1].split("."):"",d[0]=d[1].match("pm")?d[0]<12?12+parseInt(d[0]):d[0]:d[0],d[1]=d[1].match("pm")?d[1].replace("pm",""):d[1].match("am")?d[1].replace("am",""):"";var l=d[0]*36e5;l+=d[1]*6e4,cg=cg?cg:l}else{var i=j[1].match("pm")?"1":j[1].match("am")?"0":"";j[1]=j[1].match("pm")?j[1].replace("pm",""):j[1].match("am")?j[1].replace("am",""):j[1],j[1]=i==1?j[1]<12?12+parseInt(j[1]):j[1]:i==0?j[1]:"";var l=j[1]?j[1]*36e5:"";cg=cg?cg:l}return h}var i=j[0].match("pm")?"1":j[0].match("am")?"0":j[1].match("pm")?"1":j[1].match("am")?"0":"";j[0]=j[0].match("pm")?j[0].replace("pm",""):j[0].match("am")?j[0].replace("am",""):j[0],j[0]=i==1?j[0]<12?12+parseInt(j[0]):j[0]:i==0?j[0]==12?-1:j[0]:"";var h=j[0]?j[0]!=-1?j[0]*36e5:1e3:"";if(j[1].match(/(:|\.)/)){d=j[1].match(/(:)/)?j[1].split(":"):j[1].match(/(.)/)?j[0].split("."):"",d[0]=d[1].match("pm")?d[0]<12?12+parseInt(d[0]):d[0]:d[0],d[1]=d[1].match("pm")?d[1].replace("pm",""):d[1].match("am")?d[1].replace("am",""):"";var l=d[0]*36e5;l+=d[1]*6e4,cg=cg?cg:l}else{var i=j[1].match("pm")?"1":j[1].match("am")?"0":"";j[1]=j[1].match("pm")?j[1].replace("pm",""):j[1].match("am")?j[1].replace("am",""):j[1],j[1]=i==1?j[1]<12?12+parseInt(j[1]):j[1]:i==0?j[1]:"";var l=j[1]?j[1]*36e5:"";cg=cg?cg:l}return h}if(c==1&&a[0].match(/(:|\.)/)){var d=a[0].match(/(:)/)?a[0].split(":"):a[0].match(/(.)/)?a[0].split("."):"",h=d[0]*36e5;return h+=d[1]*6e4,h}if(c==5)return 36e5*n.getHours()+parseInt(6e4*n.getMinutes());if(c==6&&cf){var d=a[0],m=a[0].match(/(hour|hours|hr|hrs)/)?1:a[0].match(/(minute|minutes|min|mins)/)?0:"",o=a[0].match(/[0-9]{1,2}/),p=a[0].match(/(after|in)/)?1:0,q=m==1?36e5*o[0]:m==0?6e4*o[0]:"",r=p==1?q?parseInt(cf)+parseInt(q):"":"";return r}}catch(s){}}function c$(a,b){try{var c=7+b-a.getDay();if(b<a.getDay()&&b==0)var c=14-a.getDay();return a.setDate(a.getDate()+c),a}catch(d){}}function c_(a,b){try{if(b>=a.getDay())var c=b-a.getDay();else var c=7+b-a.getDay();return a.setDate(a.getDate()+c),a}catch(d){}}function da(a,b){try{return a.setDate(a.getDate()+b),a}catch(c){}}function db(a,b){try{return a.setDate(a.getDate()-a.getDay()-(7-b)),a}catch(c){}}function dc(a,b,c,d){try{var e,f,g,h,i,d,k,m;return bT.indexOf(a)==4?(h=new Date,d!=""&&h.setFullYear(d),h.setMonth(J.indexOf(c.toLowerCase())>-1?J.indexOf(c.toLowerCase())+parseInt(1):K.indexOf(c.toLowerCase())+parseInt(1)),h.setDate(0),h.setDate(h.getDate()-7),i=h.getDay(),d=i<(j.indexOf(b)>-1?j.indexOf(b):l.indexOf(b)>-1?l.indexOf(b):"")?(j.indexOf(b)>-1?j.indexOf(b):l.indexOf(b)>-1?l.indexOf(b):"")-i:7-(i-(j.indexOf(b)>-1?j.indexOf(b):l.indexOf(b)>-1?l.indexOf(b):"")),h.setDate(h.getDate()+d),h):(e=bT.indexOf(a),h=new Date,d!=""&&h.setFullYear(d),h.setDate(1),h.setMonth(J.indexOf(c.toLowerCase())>-1?J.indexOf(c.toLowerCase()):K.indexOf(c.toLowerCase())),i=h.getDay(),d=i<=(j.indexOf(b)>-1?j.indexOf(b):l.indexOf(b)>-1?l.indexOf(b):"")?(j.indexOf(b)>-1?j.indexOf(b):l.indexOf(b)>-1?l.indexOf(b):"")-i:7-(i-(j.indexOf(b)>-1?j.indexOf(b):l.indexOf(b)>-1?l.indexOf(b):"")),k=new Date,k.setDate(h.getDate()+d+e*7),k.setMonth(h.getMonth()),k.setFullYear(h.getFullYear()),k)}catch(n){}}function d$(a,b){a==0&&(Q.typ="PC",Q.details.machine=b[0]);if(a==1&&ch.match(R)){var c=ch.match(R);Q.typ="CAB",Q.details.destn=c[0]}if(a==2)if(ch.match(S)){var d=ch.match(S);Q.typ="ROOM",Q.details.room=d[0];var e=ch.match(/[0-9]{1,2}(st|nd|rd)\sfloor/),f=e?e[0].match(/[0-9]{1,2}/):"",g=ch.match(T);Q.details.flrdt=f?f[0]:"",Q.details.loc=g?g[0]:""}else{Q.typ="ROOM";var e=ch.match(/[0-9]{1,2}(st|nd|rd)\sfloor/),f=e?e[0].match(/[0-9]{1,2}/):"",g=ch.match(T);Q.details.flrdt=f?f[0]:"",Q.details.room="",Q.details.loc=g?g[0]:""}return a!=3,0}var c=a;if(c=="")return 0;var d=new Date;input=c;var e=[c$(new Date,0),c$(new Date,1),c$(new Date,2),c$(new Date,3),c$(new Date,4),c$(new Date,5),c$(new Date,6)],f=["tomorrow","today","now","dayaftertomorrow","day after tomorrow"],g=[da(new Date,1),da(new Date,0),da(new Date,0),da(new Date,2),da(new Date,2)],h=[c_(new Date,0),c_(new Date,1),c_(new Date,2),c_(new Date,3),c_(new Date,4),c_(new Date,5),c_(new Date,6)],i=[db(new Date,0),db(new Date,1),db(new Date,2),db(new Date,3),db(new Date,4),db(new Date,5),db(new Date,6)],j=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],k=["sundays","mondays","tuesdays","wednesdays","thursdays","fridays","saturdays"],l=["sun","mon","tue","wed","thu","fri","sat"],m=["first","second","third","fourth","last"],n=new Date,o=Date.parse(n.getMonth()+parseInt(1)+"/"+n.getDate()+"/"+n.getFullYear()),p,q={};q.daily,q.weekly,q.monthly,q.yearly;var r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I=["January","Jan","january","jan","February","february","Feb","feb","March","march","Mar","mar","April","april","Apr","apr","May","may","June","june","Jun","jun","July","july","Jul","jul","August","august","Aug","aug","September","Sep","september","sep","October","Oct","october","oct","November","Nov","november","nov","December","Dec","dec","december"],J=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],K=["january","february","march","april","may","june","july","august","september","october","november","december"],L=/(room|hall)/,M=/\b(test\s?machine|server\s?machine|windows\s?machine|mac\s?machine|windows\sos\smachine|mac\sos\smachine)\b/,N=/\b(projector|speaker)\b/,O=/\b(cab|shuttle)\b/,P=[M,O,L,N],Q={};Q.typ,Q.details={};var R=/\b(avadi|dlf|guindy|puzthivakkam|thirumangalam|vadapalani|velachery|guduvanchery|urapakkam|perungalathur|mogappair|koyambedu|cmbt|medavakkam|vandalur)\b/,S=/\b(confluence|meeting|(video\s)?conference|seminar|training|join|lunch|party)\s(room|hall)\b/,T=/\b((tower|plaza)\s(building)|estancia)\b/,U={},V={},W=/\b((0?[1-9]|[1|2][0-9]|3[0|1])[\-|\/|\.](0?[1-9]|1[012])[\-|\/|\.](19|20)\d\d)\b/,X=/\b(0?[1-9]|1[012])[\-|\/|\.](0?[1-9]|[1|2][0-9]|3[0|1])[\-|\/|\.](19|20)\d\d\b/,Y=/\b(19|20)\d\d[\-|\/|\.](0?[1-9]|1[012])[\-|\/|\.](0?[1-9]|[1|2][0-9]|3[0|1])\b/,Z=/\b(19|20)\d\d[\-|\/|\.](0?[1-9]|[1|2][0-9]|3[0|1])[\-|\/|\.](0?[1-9]|1[012])\b/,$=/\b(0?[1-9]|[1|2][0-9]|3[0|1])[\-|\/|\.](0?[1-9]|1[012])\b[\-|\/|\.]\d\d\b/,_=/\b(0?[1-9]|1[012])\b[\-|\/|\.](0?[1-9]|[1|2][0-9]|3[0|1])[\-|\/|\.]\d\d\b/,ba=/\b(0?[1-9]|[1|2][0-9]|3[0|1])[\/](0?[1-9]|1[012])\b/,bb=/\b(0?[1-9]|1[012])[\/](0?[1-9]|[1|2][0-9]|3[0|1])\b/,bc=/\b(0[1-9]|[1|2][0-9]|3[0|1])[\-|\/|\.]((jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)|(january|february|march|april|may|june|july|august|september|october|november|december))[\-|\/|\.]?((19|20)?\d\d)?\b/,bd=/\b(19|20)\d\d[\-|\/|\.]((jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)|(january|february|march|april|may|june|july|august|september|october|november|december))[\-|\/|\.](0[1-9]|[1|2][0-9]|3[0|1])\b/,be=/\b((jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)|(january|february|march|april|may|june|july|august|september|october|november|december))\s?(0?[1-9]|[1|2][0-9]|3[0|1])((\s|(\s+)?,(\s+)?)?(19|20)\d\d)?\b/,bf=/\b(0?[1-9]|[1|2][0-9]|3[0|1])\s?((jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)|(january|february|march|april|may|june|july|august|september|october|november|december))((\s|(\s+)?,(\s+)?)(19|20)?\d\d(?!:))?\b/,bg=/\b((jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)|(january|february|march|april|may|june|july|august|september|october|november|december))\s(0?[1-9]|[1|2][0-9]|3[0|1])(st|nd|rd|th)((\s|(\s+)?,(\s+)?)(19|20)\d\d)?\b/,bh=/\b(0?[1-9]|[1|2][0-9]|3[0|1])(st|nd|rd|th)\s((jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)|(january|february|march|april|may|june|july|august|september|october|november|december))((\s|(\s+)?,(\s+)?)(19|20)?\d\d)?\b/,bi=/(0?[1-9]|[1|2][0-9]|3[0|1])(st|nd|rd|th)\sof\s((jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)|(january|february|march|april|may|june|july|august|september|october|november|december))((\s|(\s+)?,(\s+)?)(19|20)\d\d)?\b/,bj=/\bsunday\b|\bmonday\b|\btuesday\b|\bwednesday\b|\bthursday\b|\bfriday\b|\bsaturday\b|\bsun\b|\bmon\b|\btue\b|\bwed\b|\bthu\b|\bfri\b|\bsat\b/,bk=/\b(first|second|third|fourth|last|next|this)\s(\bsunday\b|\bmonday\b|\btuesday\b|\bwednesday\b|\bthursday\b|\bfriday\b|\bsaturday\b|\bsun\b|\bmon\b|\btue\b|\bwed\b|\bthu\b|\bfri\b|\bsat\b)\b/,bl=/\b[0-9]{1,2}\s?(day)s?\b/,bm=/\b(today|now|tomorrow|(day\s?after\s?tomorrow))\b/,bn=/\b(saturdays|sundays|mondays|tuesdays|wednesdays|thursdays|fridays)\b/,bo=/\b(weekend)s?\b/,bp=/\b(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec|january|february|march|april|may|june|july|august|september|october|november|december)\s?(0?[1-9]|[1|2][0-9]|3[0|1])-(0?[1-9]|[1|2][0-9]|3[0|1])\b/,bq=/\b(0?[1-9]|[1|2][0-9]|3[0|1])-(0?[1-9]|[1|2][0-9]|3[0|1])\s?(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec|january|february|march|april|may|june|july|august|september|october|november|december)\b/,br=/\b(0?[1-9]|[1|2][0-9]|3[0|1])(st|nd|rd|th)-(0?[1-9]|[1|2][0-9]|3[0|1])(st|nd|rd|th)\s(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec|january|february|march|april|may|june|july|august|september|october|november|december)\b/,bs=/\b(0?[1-9]|[1|2][0-9]|3[0|1])(st|nd|rd|th)\s(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec|january|february|march|april|may|june|july|august|september|october|november|december)-(0?[1-9]|[1|2][0-9]|3[0|1])(st|nd|rd|th)\s(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec|january|february|march|april|may|june|july|august|september|october|november|december)\b/,bt=/\b(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec|january|february|march|april|may|june|july|august|september|october|november|december)\s(0?[1-9]|[1|2][0-9]|3[0|1])(st|nd|rd|th)-(0?[1-9]|[1|2][0-9]|3[0|1])(st|nd|rd|th)\b/,bu=/\b(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec|january|february|march|april|may|june|july|august|september|october|november|december)[\-|\/|\.](0?[1-9]|[1|2][0-9]|3[0|1])[\-|\/|\.]?((19|20)\d\d)?\b/,bv=/((today|tomorrow)(\s+)?(,)?)(\s+)?(monday|tuesday|wednesday|thursday|friday|saturday|sunday|sun|mon|tue|wed|thu|fri|sat)(\s+)?(,)?(\s+)?\(?(\s+)?(january|february|march|april|may|june|july|august|september|october|november|december|jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)(\s+)?[0-9]{1,2}(st|rd|th|nd)(\s+)?\)?/,bw=/((today|tomorrow)(\s+)?(,)?(\s)?)?(sunday|monday|tuesday|wednesday|thursday|friday|saturday|sun|mon|tue|wed|thu|fri|sat)(\s+)?(,)?(\s+)?\(?(\s+)?[0-9]{1,2}(st|rd|nd|th)?(\s+)?(january|february|march|april|may|june|july|august|september|october|november|december|jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)(\s+)?\).?/,bx=/\b(monday|tuesday|wednesday|thursday|friday|saturday|sunday|sun|mon|tue|thu|fri|sat|sun)(,)?(\s+)?(the)?(\s+)?(0?[1-9]|[1|2][0-9]|3[0|1])(st|nd|rd|th)\sof\s((jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)|(january|february|march|april|may|june|july|august|september|october|november|december))((\s(19|20)\d\d)|('[0-9]{1,2}))?\b/,by=/\b[0-9]{1,2}(\s+)?(january|february|march|april|may|june|july|august|sepetember|october|november|december|jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)(')[0-9]{1,2}\b/,bz=/\b[0-9]{1,2}(st|nd|rd|th)(\s+)(of)(\s+)(january|february|march|april|may|june|july|august|september|october|november|december|jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)(\s+)?'[0-9]{2}\b/,bA=/[0-9]{1,2}(st|rd|nd|th)?(\s+)?(january|february|march|april|may|june|july|august|september|october|november|december|jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)(\s+)?(,)?(\s?)\(?(\s+)?(monday|tuesday|wednesday|thursday|friday|saturday|sunday|mon|tue|wed|thu|fri|sat|sun)(\s+)?\)?/,bB=/(january|february|march|april|may|june|july|august|september|october|november|december|jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)(\s+)?[0-9]{1,2}(st|rd|nd|th)(\s+)?(,)?(\s+)?\(?(\s+)?(sunday|monday|tuesday|wednesday|thursday|friday|saturday|sun|mon|tue|wed|thu|fri|sat|sun)(\s+)?\)?/,bC=/\b(january|february|march|april|may|june|july|august|september|october|november|december|jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)(\s+)?[0-9]{1,2}(st|rd|nd|th)(\s+)?(,)?(\s+)?[0-9]{4}(\s+)?(,)?(\s+)?(sunday|monday|tuesday|wednesday|thursday|friday|saturday|sat|sun|mon|tue|wed|thu|fri)\b/,bD=[W,X,Y,Z,$,_,ba,bb,bc,bd,bf,bh,be,bu,bg,bi,bj,bm,bn,bo,bp,bq],bE=/\b(morning|noon|afternoon|evening)\b/,bF=/\b(dinner|breakfast|lunch|supper|brunch|tea)\b/,bG=/\b(0?[0-9]|1[0-9]|2[0-4]){1,2}([:|\.](0[0-9]|[1-4][0-9]|5[0-9]))?\s?(am|pm|hrs)?-(0?[0-9]|1[0-9]|2[0-4]){1,2}([:|\.](0[0-9]|[1-4][0-9]|5[0-9]))?\s?(am|pm|hrs)\b/,bH=/[ \t\n\r]+/ig,bI=/\b(0?[0-9]|1[0-9]|2[0-4]){1,2}([:|.](0[0-9]|[1-4][0-9]|5[0-9]))?\s?(am|pm|hrs)\b/,bJ=/\b(0?[0-9]|1[0-9]|2[0-3])([:](0[0-9]|[1-4][0-9]|5[0-9]))\b/,bK=/\b(now)\b/,bL=/\b(after)\s?[0-9]{1,2}\s?(hours|hrs)\b/,bM=[bI,bJ,bE,bF,bG,bK,bL],j=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],bN=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],bO=["weekend"],bP=new Object;bP.noon="43200000",bP.breakfast="28800000",bP.dinner="75600000",bP.lunch="43200000",bP.afternoon="43200000",bP.supper="61200000",bP.morning="28800000",bP.evening="61200000",bP.tea="61200000";var bQ,bR,bS={one:"1",two:"2",three:"3",four:"4",five:"5",six:"6",seven:"7",eight:"8",nine:"9",ten:"10",eleven:"11",twelve:"12",thirteen:"13",fourteen:"14",fifteen:"15",sixteen:"16",seventeen:"17",eighteen:"18",nineteen:"19",twenty:"20",thirty:"30",forty:"40",fifty:"50",sixty:"60",seventy:"70",eighty:"80",ninty:"90",hundred:"100"},bT=["first","second","third","fourth","last"],bU=new Object,bV=input.trim(),bW=bV.toLowerCase();bW=bW.replace(/\ba.m\b/g,"am"),bW=bW.replace(/\bp.m\b/g,"pm");var bX=bW,bY=new Array,bZ=bW.split(bH),b$,b_,ca=[],cb=[],cc,cd,ce,cf,cg,ch="",ci=new Date,cj=new Date;for(var ck=0;ck<bZ.length;ck++)bS[bZ[ck]]&&bZ[ck+1]&&bS[bZ[ck+1]]&&(bZ[ck+1]=(parseInt(bS[bZ[ck]])+parseInt(bS[bZ[ck+1]])).toString(),bZ[ck]=bZ[ck-1]=="for"?bZ[ck-1]:""),bS[bZ[ck]]&&(bZ[ck]=bS[bZ[ck]]),bZ[ck].match(/^(from|(begin)s?|(start)s?|between|(open)s?|starting|commence)$/)&&ca.push(ck),bZ[ck].match(/^(to|(end)s?|-|and|(close)s?|till|until|over|ending)$/)&&cb.push(ck),bZ[ck].match("once")&&bZ[ck-1]&&bZ[ck-1].match(/(day)s?/)&&bZ[ck-2]&&bZ[ck-2].match(/[0-9]{1,2}/)&&(bQ=bZ[ck-2]),bZ[ck].match("once")&&bZ[ck-1]&&bZ[ck-1].match(/(month)s?/)&&bZ[ck-2]&&bZ[ck-2].match(/[0-9]{1,2}/)&&(bR=bZ[ck-2]),ch=ch+" "+bZ[ck];if(ca.length!=0&&cb.length!=0){if(ca[0]<cb[0]){var cl="";for(var cm=0;cm<ca[0];cm++)cl=cl+" "+bZ[cm];cd=cT(cl),cf=cV(cl);if(b==0)for(var cn in bP)cl.match(cn)&&bP[cn]==cf&&(cf="",bX=ch);cl.match(/\b(every|all)\b/)&&(cd=cl.match(/\b(every|all)\b/)?"":cd,cf=cl.match(/\b(every|all)\b/)?"":cf,cc=1),cg=cf?parseInt(cf)+parseInt(36e5):null}var co;for(var cp=0;cp<ca.length;cp++){var cq,cr,cs,ct,cu,cv,cw=0;if((cp<ca.length?ca[cp]:100)<(cp<cb.length?cb[cp]:-1)){var cw=cp;while(ca[cw]<cb[cp])cw++;var cl="";for(var cx=ca[cp];cx<cb[cp];cx++)cl=cl+" "+bZ[cx];bZ[ca[cp]-1]=="days"&&bZ[ca[cp]-2]&&bZ[ca[cp]-2].match(/[0-9]{1,2}/)&&bZ[ca[cp]-3]&&!bZ[ca[cp]-3].match("every")&&(bZ[ca[cp]-3]=="for"&&(cv=1),cq=864e5*bZ[ca[cp]-2]),bZ[ca[cp]-1]&&bZ[ca[cp]-1].match(/(hour|hours)/)&&bZ[ca[cp]-2]&&bZ[ca[cp]-2].match(/[0-9]{1,2}/)&&bZ[ca[cp]-3]&&!bZ[ca[cp]-3].match(/(after|in)/)?cr=36e5*bZ[ca[cp]-2].match(/[0-9]{1,2}/):bZ[ca[cp]-1]&&bZ[ca[cp]-1].match(/(hour|hours)/)&&bZ[ca[cp]-2]&&bZ[ca[cp]-2].match(/[0-9]{1,2}/)&&bZ[ca[cp]-3]&&bZ[ca[cp]-3].match(/(after|in)/)&&(ct=36e5*bZ[ca[cp]-2].match(/[0-9]{1,2}/)),bZ[ca[cp]-1]&&bZ[ca[cp]-1].match(/(minute|minutes)/)&&bZ[ca[cp]-2]&&bZ[ca[cp]-2].match(/[0-9]{1,2}/)&&bZ[ca[cp]-3]&&!bZ[ca[cp]-3].match(/(after|in)/)?cs=6e4*bZ[ca[cp]-2].match(/[0-9]{1,2}/):bZ[ca[cp]-1]&&bZ[ca[cp]-1].match(/(minute|minutes)/)&&bZ[ca[cp]-2]&&bZ[ca[cp]-2].match(/[0-9]{1,2}/)&&bZ[ca[cp]-3]&&bZ[ca[cp]-3].match(/(after)/)&&(cu=6e4*bZ[ca[cp]-2].match(/[0-9]{1,2}/));var b_=1;cd?!cf&&cT(cl)==undefined&&(cf=cf?cf:cV(cl),cg=cg?"":cr?parseInt(cV(cl))+parseInt(cr):cs?parseInt(cV(cl))+parseInt(cs):"",b_=0):(cd=cd?cd:cq&&!cv?parseInt(cT(cl))+parseInt(cq):cT(cl),cv==1&&(ce=ce?ce:parseInt(cT(cl))+parseInt(cq)),cf=cf?cf:ct?parseInt(cV(cl))+parseInt(ct):cu?parseInt(cV(cl))+parseInt(cu):cV(cl),cg=cg?cg:cr?parseInt(cV(cl))+parseInt(cr):cs?parseInt(cV(cl))+parseInt(cs):"",b_=0);if((cd||cf)&&b_==0&&(bZ[cb[cp]]=="and"&&(bZ[ca[cp]]=="between"||cw-1!=cp&&bW.match("between")||bZ[cb[cp]+1]&&bZ[cb[cp]+1].match(/(end|ends|closes|over|close|ending)/)||(cp+1<cb.length?bZ[cb[cp+1]].match(/(end|ends|closes|close|over|to|ending)/):""))||bZ[cb[cp]]!="and")){var cy="",cz="";for(var cx=cb[cp]+1;cx<ca[cp+1];cx++)cy=cy+" "+bZ[cx];if(bZ[cb[cp]]=="and"&&bZ[ca[cp]]!="between"){var cA=cU(cy)?cU(cy):cW(cy)?cW(cy):"";cA&&(cy="")}if(cy&&cy.match("to")){var cB=cy.split("to");cz=cB[1]}if(!ca[cp+1]&&cb[cp+1]){for(var cC=cb[cp]+1;cC<cb[cp+1];cC++)cy=cy+" "+bZ[cC];if(bZ[cb[cp]]=="and"&&bZ[cb[cp+1]].match(/(end|ends|closes|over|to|close|ending)/)){var cA=cU(cy)?cU(cy):cW(cy)?cW(cy):"";if(!cA)for(var cC=cb[cp+1];cC<bZ.length;cC++)cy=cy+" "+bZ[cC];else bZ[ca[cp]]!="between"&&(cy="")}if(bZ[cC]=="to")for(var cD=cC;cD<bZ.length;cD++)cz=cz+" "+bZ[cD]}if(!ca[cp+1]&&!cb[cp+1]&&!cy)for(var cC=cb[cp]+1;cC<bZ.length;cC++)cy=cy+" "+bZ[cC];if(cw-1!=cp&&ca[cw]&&!cy)for(var cE=cb[cp]+1;cE<ca[cw];cE++)cy=cy+" "+bZ[cE];else if(cw-1!=cp&&!ca[cw]&&!cy){for(var cE=cb[cp]+1;cE<bZ.length;cE++)cy=cy+" "+bZ[cE];if(bZ[cb[cp]]=="and"&&bZ[ca[cp]]!="between"&&cw-1!=cp&&bZ[ca[cw-1]!="between"]){var cA=cU(cy)?cU(cy):cW(cy)?cW(cy):"";cA&&(cy="")}}var cF=0;if(cy.match(/[0-9]{1,2}\s?(day)s?/)){for(var cC=cb[cp]+1;cC<(ca[cp+2]?ca[cp+2]:cb[cp+1]?cb[cp+1]:bZ.length);cC++)cy=cy+" "+bZ[cC];cF=1,ca.shift()}var cG=0;if(cy.match(/[0-9]{1,2}\s?(hours|hour|minute|minutes)/)){for(var cC=cb[cp]+1;cC<(ca[cp+2]?ca[cp+2]:cb[cp+1]?cb[cp+1]:bZ.length);cC++)cy=cy+" "+bZ[cC];cG=1,ca.shift()}ce=ce?ce:cU(cy);if(!cy.match(/[0-9]{1,2}\s?(day)s?\s?(from|after)/)&&cF==1){var cH=cy.match(/[0-9]{1,2}/);ce=ce?ce:parseInt(cd)+cH[0]*864e5}cg=cg?cg:cW(cy),cg&&!cf&&cz&&cW(cz)&&(cf=cg,cg=cW(cz)),cd&&!ce&&(ce=cd),!cd&&ce&&cf&&(cd=Date.parse(n.getMonth()+parseInt(1)+"/"+n.getDate()+"/"+n.getFullYear())),cf&&!cg&&(cg=cf+36e5),!cf&&cg&&(cf=cg-36e5)}}else if(cp<cb.length&&cb[cp]){var cI=cb[cp],cJ,cl="",cK=ce,b_=0;for(var cL=0;cL<cb[cp];cL++)cl=cl+" "+bZ[cL];cd=cd?cd:cT(cl),b_=!cd&&bZ[cb[cp]].match(/(till|end|ends)/)?1:"",cf=cf?cf:cV(cl),b_=!cf&&bZ[cb[cp]].match(/(till|end|ends )/)?b_!=1?1:b_:"";if(cd||cf||b_==1){var cy="";for(var cC=cb[cp];cC<ca[cp];cC++)cy=cy+" "+bZ[cC];ce=ce?ce:cU(cy),cJ=cU(cy),cg=cg?cg:cW(cy),ce&&!cd&&(cd=cd?cd:Date.parse(n.getMonth()+parseInt(1)+"/"+n.getDate()+"/"+n.getFullYear())),cg&&!cf&&(cf=cf?cf:parseInt(n.getHours()*36e5)+parseInt(n.getMonth()*6e4))}cb.shift();if(bZ[cI]=="and"&&cJ!=undefined||cJ&&cJ!=ce){ce=cK?cK:"";break}cp=cb[cp]?cp-1:cp;if(!cb[cp]){if(!cd){var cl="";for(var cM=ca[cp];cM<bZ.length;cM++)cl=cl+" "+bZ[cM];cd=cT(cl)}if(!cf){var cl="";for(var cM=ca[cp];cM<bZ.length;cM++)cl=cl+" "+bZ[cM];cf=cV(cl)}}}else{if(!cd){var cl="";for(var cM=ca[cp];cM<bZ.length;cM++)cl=cl+" "+bZ[cM],cw=0;cd=cT(cl)}if(!cf){var cl="";for(var cM=ca[cp];cM<bZ.length;cM++)cl=cl+" "+bZ[cM],cw=0;cf=cV(cl)}}cp=cw-1==cp||cw==0?cp:cw-1}}if(ca.length==0&&cb.length!=0)for(var cp=0;cp<cb.length;cp++)if(cp==0){var cl="";for(var cx=0;cx<cb[cp];cx++)cl=cl+" "+bZ[cx];var b_=1;if(!cd){cd=cd?cd:cT(cl),q.daily=bZ[cb[cp]].match(/(ends|end|until|till)/)&&!cd?cl.match(/(every|all)\s?(weekday)s?/)?1:"":"",G=bZ[cb[cp]].match(/(ends|end|until|till)/)&&!cd?cl.match(/(every|all)\s?(weekday)s?/)?1:"":"";if(bZ[cb[cp]].match(/(ends|end|until|till)/)&&!cd&&q.daily!=1){var cN=cl.match(/every\s?[0-9]{1,2}\s?(day)s?/);G=cN?1:"",q.daily=cN?1:"";var cO=cN?cN[0].match(/[0-9]{1,2}/):"";F=cO?cO[0]:""}if(bZ[cb[cp]].match(/(ends|end|until|till)/)&&!cd&&q.daily!=1&&cl.match(/[0-9]{1,2}\s?of\s?every\s?([0-9]{1,2})?\s?month/)){var cP=cl.split("every"),cQ=cP[0].match(/[0-9]{1,2}/);if(cP[1].match(/[0-9]{1,2}\s?month/)){var cR=cP[1].match(/[0-9]{1,2}\s?month/),cS=cR[0].match(/[0-9]{1,2}/);q.monthly=1,B=cQ[0],z=cS[0]}else q.monthly=1,B=cQ[0]}cd=bZ[cb[cp]].match(/(ends|end|until|till)/)&&!cd?Date.parse(n.getMonth()+parseInt(1)+"/"+n.getDate()+"/"+n.getFullYear()):cd,cf=cf?cf:cV(cl),cf=bZ[cb[cp]].match(/(end|ends|until|till)/)&&!cf?parseInt(n.getHours()*36e5)+parseInt(n.getMinutes()*6e4):cf,b_=0}else!cf&&cT(cl)==undefined&&(cf=cf?cf:cV(cl),b_=0);if((cd||cf)&&b_==0&&bZ[cb[cp]]!="and"){var cy="";for(var cC=cb[cp]+1;cC<cb[cp+1];cC++)cy=cy+" "+bZ[cC];if(cb[cp+1]&&cy)for(var cD=cC;cD<bZ.length;cD++)cz=cz+" "+bZ[cD];if(!cb[cp+1])for(var cE=cb[cp]+1;cE<bZ.length;cE++)cy=cy+" "+bZ[cE];ce=ce?ce:cU(cy),cg=cg?cg:cW(cy),!cf&&cg&&cz&&cW(cz)&&(cf=cg,cg=cW(cz)),(ce||cg)&&cp++}}else{var cl="";for(var cx=cb[cp-1]+1;cx<cb[cp];cx++)cb[cp-1]!="and"&&cb[cp]!="and"&&(cl=cl+" "+bZ[cx]);var b_=1;cd?!cf&&cT(cl)==undefined&&(cf=cf?cf:cV(cl),b_=0):(cd=cd?cd:cT(cl),cd=bZ[cb[cp]].match(/(end|ends|till)/)&&!cd?Date.parse(n.getMonth()+parseInt(1)+"/"+n.getDate()+"/"+n.getFullYear()):cd,cf=cf?cf:cV(cl),cf=bZ[cb[cp]].match(/(end|ends|till)/)&&!cf?parseInt(n.getHours()*36e5)+parseInt(n.getMinutes()*6e4):cf,b_=0);if((cd||cf)&&b_==0){var cy="";for(var cC=cb[cp]+1;cC<cb[cp+1];cC++)cy=cy+" "+bZ[cC];if(!cb[cp+1])for(var cC=cb[cp]+1;cC<bZ.length;cC++)cy=cy+" "+bZ[cC];if(cb[cp+1]&&cy)for(var cD=cC;cD<bZ.length;cD++)cz=cz+" "+bZ[cD];ce=ce?ce:cU(cy),cg=cg?cg:cW(cy),!cf&&cg&&cz&&cW(cz)&&(cf=cg,cg=cW(cz))}}var cX,dd;if(ch.match(/(remind|reminder|notify|notification)/)){var de=ch.match(/(remind|reminder|notify|notification)/),df=ch.split(de[0]);if(df[1].match(/((in)?\s?[0-9]{1,2}\s?(day|hour|hr|minute|min)s?)/)){var dg=df[1].match(/((in|after|before)?\s?[0-9]{1,2}\s?(day|hour|hr|minute|min)s?\s?(after|before)?)/),cS=dg[0].match(/[0-9]{1,2}/),dh=dg[0].match(/(day)s?/)?864e5:dg[0].match(/(hour|hr)s?/)?36e5:dg[0].match(/(minute|min)s?/)?6e5:"",di=dg[0].match(/after/)?1:dg[0].match(/before/)?0:1,dj=cS*dh,dk=!0;bU.isrem=dk,bU.remt=dj,bU.remty=di}df[0].match(/([0-9]{1,2}\s?(day|hour|hr|minute|min)s?)/)&&(bU.isrem="")}if(cf==undefined&&cd==undefined){cd=cT(ch);if(ch.match(/((this|next)?\s?weekend)/)&&cd){var dl=ch.match(/((this|next)?\s?weekend)/),dm=dl[0].match("this")?c_(new Date,0):dl[0].match("next")?c$(new Date,0):c_(new Date,0);ce=Date.parse(dm.getMonth()+parseInt(1)+"/"+dm.getDate()+"/"+dm.getFullYear())}if(ch.match(/(every|all)\s?(weekend)s?/)&&cd){q.weekly=1;var dn=c_(new Date,6),dp=Date.parse(dn.getMonth()+parseInt(1)+"/"+dn.getDate()+"/"+dn.getFullYear());D="saturday,sunday",ce=cd}if(cd&&!q.daily&&!q.monthly&&!q.weekly&&!q.yearly){if(ch.match(/(every)\s?(first|second|third|fourth|last)\s?(saturday|sunday|monday|tuesday|wednesday|thursday|friday)/)){q.monthly=1;var dq=ch.match(/(every)\s?(first|second|third|fourth|last)\s?(saturday|sunday|monday|tuesday|wednesday|thursday|friday)/),dr=dq[0].split("every"),ds=dr[1].split(" ");y=ds[2],x=ds[1]}if(ch.match(/every/)){var dt=ch.split(/every(.+)?/),du=dt[1].split(bH),dv="";for(var dw=0;dw<du.length;dw++)if(du[dw].match(/(sun|mon|tue|wed|thu|fri|sat|sun|monday|tuesday|wednesday|thursday|friday|saturday|sunday)/)&&!du[dw-1].match(/(first|second|third|fourth|last)/)){var dx=du[dw].match(/^(sun|mon|tue|wed|thu|fri|sat|sun)$/);dx=dx?dx:du[dw].match(/^(monday|tuesday|wednesday|thursday|friday|saturday|sunday)$/),dv+=dx?dx[0]+",":""}dv&&(q.weekly=1,D=dv?dv:D,cc=1)}}if(cd&&q.weekly==1&&p&&p[0].match(/(sun|mon|tue|wed|thu|fri|sat|sun|monday|tuesday|wednesday|thursday|friday|saturday|sunday)/)&&ch.match(/every/)){var dt=ch.split(/every(.+)?/),du=dt[1].split(bH),dv="";for(var dw=0;dw<du.length;dw++)if(du[dw].match(/(sun|mon|tue|wed|thu|fri|sat|sun|monday|tuesday|wednesday|thursday|friday|saturday|sunday)/)){var dx=du[dw].match(/^(sun|mon|tue|wed|thu|fri|sat|sun)$/);dx=dx?dx:du[dw].match(/^(monday|tuesday|wednesday|thursday|friday|saturday|sunday)$/),dv+=dx?dx[0]+",":""}q.weekly=1,D=dv?dv:D,cc=1}dd=cd?cd:"0"}(dd!=undefined||dd==0)&&cf==undefined&&(cf=cV(ch));if(cd==undefined&&ce==undefined){cd=Date.parse(n.getMonth()+parseInt(1)+"/"+n.getDate()+"/"+n.getFullYear()),ce=cd,ch.match(/(every|all)\s?(weekday)s?/)&&(q.daily=1,G=1);if(ch.match(/(every|all)\s?(weekday)s?\s?(of|from|in)\s?(january|jan|february|feb|march|mar|april|apr|may|jun|june|jul|july|august|aug|september|sep|october|oct|november|nov|december|dec)/)){var dy=ch.match(/(every|all)\s?(weekday)s?\s?(of|from|in)\s?(january|jan|february|feb|march|mar|april|apr|may|jun|june|jul|july|august|aug|september|sep|october|oct|november|nov|december|dec)/),dz=dy[0].match(/(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/)?dy[0].match(/(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/):dy[0].match(/(january|february|march|april|may|june|july|august|september|october|november|december)/)?dy[0].match(/(january|february|march|april|may|june|july|august|september|october|november|december)/):"",dA=J.indexOf(dz[0])>-1?J.indexOf(dz[0]):K.indexOf(dz[0])>-1?K.indexOf(dz[0]):"";cd=Date.parse(dA+parseInt(1)+"/"+"01"+"/"+n.getFullYear()),ce=cd;if(dy[0].match(/(of|in)/)){var dB=new Date(cd);dB.setMonth(dB.getMonth()+1),dB.setDate(0),H=Date.parse(dB.getMonth()+parseInt(1)+"/"+dB.getDate()+"/"+dB.getFullYear())}}if(ch.match(/[0-9]{1,2}\s?of\s?every\s?([0-9]{1,2})?\s?month/)){var cP=ch.split("every"),cQ=cP[0].match(/[0-9]{1,2}/);if(cP[1].match(/[0-9]{1,2}\s?month/)){var cR=cP[1].match(/[0-9]{1,2}\s?month/),cS=cR[0].match(/[0-9]{1,2}/);q.monthly=1,B=cQ[0],z=cS[0]}else q.monthly=1,B=cQ[0]}if(ch.match(/every\s?([0-9]{1,2})?\s?(day)s?/)||ch.match("daily")){var dC=ch.match(/every\s?([0-9]{1,2})?\s?(day)s?/)?ch.match(/every\s?([0-9]{1,2})?\s?(day)s?/):ch.match("daily")?ch.match("daily"):"",cS=dC[0].match(/[0-9]{1,2}/)?dC[0].match(/[0-9]{1,2}/):"1";q.daily=1,F=cS[0]}if(ch.match(/((in)\s?[0-9]{1,2}\s?(day)s?)/)&&!bU.isrem){var dD=ch.match(/((in|after)\s?[0-9]{1,2}\s?(day)s?)/),dE=dD[0].match(/[0-9]{1,2}/),dF=new Date(cd);dF.setDate(dF.getDate()+parseInt(dE[0])),cd=dF,ce=cd}if(ch.match(/((for)\s?[0-9]{1,2}\s?(day)s?)/)&&!bU.isrem){var dD=ch.match(/((for)\s?[0-9]{1,2}\s?(day)s?)/),dE=dD[0].match(/[0-9]{1,2}/),dF=new Date(cd);dF.setDate(dF.getDate()+parseInt(dE[0])),ce=dF}}if(cd&&!ce){if(q.weekly==1&&p&&p[0].match(/(sun|mon|tue|wed|thu|fri|sat|sun|monday|tuesday|wednesday|thursday|friday|saturday|sunday)/)&&ch.match(/every/)){var dt=ch.split(/every(.+)?/),du=dt[1].split(bH),dv="";for(var dw=0;dw<du.length;dw++)if(du[dw].match(/(sun|mon|tue|wed|thu|fri|sat|sun|monday|tuesday|wednesday|thursday|friday|saturday|sunday)/)){var dx=du[dw].match(/^(sun|mon|tue|wed|thu|fri|sat|sun)$/);dx=dx?dx:du[dw].match(/^(monday|tuesday|wednesday|thursday|friday|saturday|sunday)$/),dv+=dx?dx[0]+",":""}if(dv){q.weekly=1,D=dv?dv:D,cc=1;if(ch.match(/for\s?[0-9]{1,2}\s?(week|month)s?/)){var dG=ch.match(/for\s?[0-9]{1,2}\s?(week|month)s?/);if(dG[0].match(/(month)s?/)){var cS=dG[0].match(/[0-9]{1,2}/),dH=new Date;dH.setMonth(dH.getMonth()+parseInt(cS[0])),dH.setDate(0),C=dH}else{var cS=dG[0].match(/[0-9]{1,2}/),dI=new Date,dJ=dI.getDay(),dK=dJ==0?7*(cS[0]-1):7*(cS[0]-1)+(7-dJ);dI.setDate(dI.getDate()+parseInt(dK)),C=dI}}}}ce=cd}ce&&cd==undefined&&(cd=Date.parse(n.getMonth()+parseInt(1)+"/"+n.getDate()+"/"+n.getFullYear())),cf&&!cg&&(cg=parseInt(cf)+parseInt(36e5)),!cf&&cg&&(cf=cg-36e5);if(!cf&&!cg){if(ch.match(/(in|after)\s?[0-9]{1,2}\s?(hours|hrs|minute|minutes|hour|min|mins)/)){var dL=ch.match(/(in|after)\s?[0-9]{1,2}\s?(hours|hrs|minute|minutes|hour|min|mins)/),dh=dL[0].match(/(hours|hour|hr|hrs)/)?1:0,dM=dL[0].match(/[0-9]{1,2}/);cf=dh==1?parseInt(n.getHours()*36e5)+parseInt(36e5*dM[0]):(n.getMinutes()+parseInt(dM[0]))*6e4+parseInt(n.getHours()*36e5)}if(ch.match(/(for)\s?(next)?\s?[0-9]{1,2}\s?(hours|hrs|minute|minutes|hour|min|mins)/))if(cf){var dL=ch.match(/(for)\s?(next)?\s?[0-9]{1,2}\s?(hours|hrs|minute|minutes|hour|min|mins)/),dh=dL[0].match(/(hours|hour|hr|hrs)/)?1:0,dM=dL[0].match(/[0-9]{1,2}/);cg=dh==1?cf+parseInt(dM[0]*36e5):cf+parseInt(dM[0]*6e4)}else{cf=n.getHours()*36e5+parseInt(n.getMinutes()*6e4);var dL=ch.match(/(for)\s?(next)?\s?[0-9]{1,2}\s?(hours|hrs|minute|minutes|hour|min|mins)/),dh=dL[0].match(/(hours|hour|hr|hrs)/)?1:0,dM=dL[0].match(/[0-9]{1,2}/);cg=dh==1?cf+parseInt(dM[0]*36e5):cf+parseInt(dM[0]*6e4)}cf=!cf&&!cg?"":cg&&!cf?cf-36e5:cf,cg=!cg&&!cf?"":cf&&!cg?cf+36e5:cg}if(cf&&cg&&cf>cg&&cd==ce&&cg!=-1){var dN=new Date(cd);dN.setDate(dN.getDate()+1);var dO=Date.parse(dN.getMonth()+parseInt(1)+"/"+dN.getDate()+"/"+dN.getFullYear());ce=dO}if(cd&&ce){if(cd!=ce&&!q.daily&&!q.monthly&&!q.weekly&&!q.yearly){if(ch.match(/(every)\s?(first|second|third|fourth|last)\s?(saturday|sunday|monday|tuesday|wednesday|thursday|friday)/)){q.monthly=1;var dq=ch.match(/(every)\s?(first|second|third|fourth|last)\s?(saturday|sunday|monday|tuesday|wednesday|thursday|friday)/),dr=dq[0].split("every"),ds=dr[1].split(" ");y=ds[2],x=ds[1],cc=1}ch.match(/(every|all)\s?(weekend)s?/)&&(q.weekly=1,D="saturday sunday",cc=1),ch.match(/(every\s?day)|(daily)/)&&(q.daily=1,F=1,G=1);if(ch.match(/every\s?[0-9]{1,2}\s?(day)s?/)){var dP=ch.match(/every\s?[0-9]{1,2}\s?(day)s?/),dQ=dP[0].match(/[0-9]{1,2}/);q.daily=1,F=dQ[0],G=1}var dt=ch.match("every")?ch.split(/every(.+)?/):"",du=dt?dt[1].split(bH):"",dv="";for(var dw=0;dw<du.length;dw++)if(du[dw].match(/(sun|mon|tue|wed|thu|fri|sat|sun|monday|tuesday|wednesday|thursday|friday|saturday|sunday)/)&&!du[dw-1].match(/(first|second|third|fourth|last)/)){var dx=du[dw].match(/^(sun|mon|tue|wed|thu|fri|sat|sun)$/);dx=dx?dx:du[dw].match(/^(monday|tuesday|wednesday|thursday|friday|saturday|sunday)$/),dv+=dx?dx[0]+",":""}dv&&(q.weekly=1,D=dv?dv:D,cc=1),ch.match(/every\s?(weekday)s?/)&&(q.daily=1,G=1)}else if(cd!=ce&&q.weekly==1){var dR=0;if(ch.match(/every/)){var dt=ch.split(/every(.+)?/),du=dt[1].split(bH),dv="";for(var dw=0;dw<du.length;dw++)if(du[dw].match(/(sun|mon|tue|wed|thu|fri|sat|sun|monday|tuesday|wednesday|thursday|friday|saturday|sunday)/)){var dx=du[dw].match(/^(sun|mon|tue|wed|thu|fri|sat|sun)$/);dx=dx?dx:du[dw].match(/^(monday|tuesday|wednesday|thursday|friday|saturday|sunday)$/),dv+=dx?dx[0]+",":"";if(du[dw+1]&&du[dw+1].match(/to/)){dR=1;break}}q.weekly=1,D=dv?dv:D,cc=dR==1?"":1}}if(cd>ce){var dN=new Date(ce);dN.setFullYear(dN.getFullYear()+1);var dO=Date.parse(dN.getMonth()+parseInt(1)+"/"+dN.getDate()+"/"+dN.getFullYear());ce=dO}}var dS={};dS.typ,dS.day,dS.idx,dS.month,dS.ct,dS.until,dS.dat,dS.wkday;if(q.yearly==1||q.monthly==1){cd==ce&&(dS.typ=q.yearly==1?3:2,dS.day=dS.typ==3?t?t:"":y?y:"",dS.idx=dS.typ==3?r?r:"":x?x:"",dS.month=dS.typ==3?s:"",dS.ct=dS.typ==2?z?z:"":"",dS.until=dS.typ==3?u?u:"":dS.typ==2?A?A:"":"",dS.dat=dS.typ==3?w?w:"":dS.typ==2?B?B:"":"");if(cd!=ce&&v==1){var dT=new Date(cd);dS.typ=q.yearly==1?3:2,dS.day=dS.typ==2?dT.getDate():"",dS.idx="",dS.month=J[dT.getMonth()],dS.ct="",dS.until=u?u:"",dS.dat=dS.typ==3?dT.getDate():""}cd!=ce&&cc==1&&(dS.typ=2,dS.day=y,dS.idx=x?x:"",dS.ct=dS.typ==2?z?z:"":"",dS.until=ce?ce!=cd?ce:"":"",ce=dS.until?cd:ce)}if(q.weekly==1)if(cc!=1){var dU=new Date(cd);dS.typ=1,dS.day=D?D:l[dU.getDay()],dS.idx="",dS.month="",dS.ct=E?E:"",dS.until=C?C:""}else cc==1&&(dS.typ=1,dS.day=D?D:"",dS.idx="",dS.month="",dS.ct=E?E:"",dS.until=ce?cd!=ce?ce:C?C:"":"",ce=dS.until?cd:ce);q.daily==1&&(cd==ce?(dS.typ=0,dS.ct=F?F:"",dS.idx="",dS.month="",dS.day="",dS.until=H?H:"",dS.wkday=G?G:""):G==1&&(dS.typ=0,dS.ct=F?F:"",dS.idx="",dS.month="",dS.day="",dS.until=ce?ce:"",ce=dS.until?cd:ce,dS.wkday=dS.ct?"":1)),bQ&&!bR&&(dS.typ=0,dS.ct=bQ,dS.idx="",dS.month="",dS.day="",dS.until=cd!=ce?ce:"",ce=dS.until?cd:ce);if(bR&&!bQ&&cd==ce){var dV=new Date(cd),dW=new Date(cd);dW.setDate(dW.getDate()-parseInt(7));var dX=new Date(cd);dX.setDate(dX.getDate()+parseInt(7));if(dV.getMonth()!=dW.getMonth())dS.idx="first";else if(dV.getMonth()!=dX.getMonth())dS.idx="last";else{var ck=1;while(dV.getMonth()==dW.getMonth())dW.setDate(dV.getDate()-ck*7),ck++;dS.idx=ck==3?"second":ck==4?"third":ck==5?"fourth":""}dS.typ=2,dS.month="",dS.day=j[dV.getDay()],dS.ct=bR}bU.isrem=bU.remt?bU.isrem==""?dk:bU.isrem:"";if(bU.isrem=="")var bU={};for(var dY=0;dY<P.length;dY++)if(ch.match(P[dY])){var dZ=ch.match(P[dY]);d$(dY,ch.match(P[dY]))}var d_=bX;if(d_.match(/\[(\s+)?\]/g)||d_.match(/\((\s+)?\)/g)){var ea=d_.match(/\[(\s+)?\]/)?d_.match(/\[(\s+)?\]/):d_.match(/\((\s+)?\)/g);if(ea&&b!=0){var eb=d_.substring(0,d_.indexOf(ea[0])-1);eb=eb.trim();var ec=eb.split(bH);ec.length=ec[ec.length-1]==""||ec[ec.length-1]==","?ec.length-1:ec.length;if(ec[ec.length-1]&&(ec[ec.length-1].match(/\b(from|(begin)s?|(start)s?|between|(open)s?|starting|commence|at|on|tomorrow|today|saturday|sunday|monday|tuesday|wednesday|thursday|friday|sat|sun|mon|tue|wed|thu|fri)\b/)||ec[ec.length-1].match(/@/)))if(!ec[ec.length-1].match(/\b(from|(begin)s?|(start)s?|between|(open)s?|starting|commence|at|on)\b/)&&!ec[ec.length-1].match(/@/)&&ec[ec.length-1].match(/\b(today|tomorrow|saturday|sunday|monday|tuesday|wednesday|thursday|friday|sat|sun|mon|tue|wed|thu|fri)\b/)!=null&&ec[ec.length-2]&&(ec[ec.length-2].match(/\b(from|(begin)s?|(start)s?|between|(open)s?|starting|commence|at|on)\b/)!=null||ec[ec.length-2].match(/@/)!=null)){eb=eb.replace(ec[ec.length-1],"");var ed=d_.substring(eb.lastIndexOf(ec[ec.length-2]),d_.indexOf(ea[0])+ea[0].length);d_=d_.replace(ed,"")}else{var ed=d_.substring(eb.lastIndexOf(ec[ec.length-1]),d_.indexOf(ea[0])+ea[0].length);d_=d_.replace(ed,"")}else d_=d_.replace(ea[0],"")}if(ea&&b==0){var eb=d_.substring(0,d_.indexOf(ea[0])-1);eb=eb.trim();var ec=eb.split(bH);ec.length=ec[ec.length-1]==""||ec[ec.length-1]==","?ec.length-1:ec.length;if(ec[ec.length-1]&&(ec[ec.length-1].match(/\b(from|(begin)s?|(start)s?|between|(open)s?|starting|commence|at|on)\b/)||ec[ec.length-1].match(/@/))){var ed=d_.substring(eb.lastIndexOf(ec[ec.length-1]),d_.indexOf(ea[0])+ea[0].length);d_=d_.replace(ed,"")}else d_=d_.replace(ea[0],"")}}var ee,ef,eg,eh,ei=new Date(cd);ee=ei.getFullYear()+""+(ei.getMonth()+parseInt(1)<10?"0"+(ei.getMonth()+parseInt(1)):ei.getMonth()+parseInt(1))+""+(ei.getDate()<10?"0"+ei.getDate():ei.getDate()),rst=ei.getFullYear()+""+(ei.getMonth()+parseInt(1)<10?"0"+(ei.getMonth()+parseInt(1)):ei.getMonth()+parseInt(1))+""+(ei.getDate()<10?"0"+ei.getDate():ei.getDate());var ej=new Date(ce);ef=ej.getFullYear()+""+(ej.getMonth()+parseInt(1)<10?"0"+(ej.getMonth()+parseInt(1)):ej.getMonth()+parseInt(1))+""+(ej.getDate()<10?"0"+ej.getDate():ej.getDate()),rst=ej.getFullYear()+""+(ej.getMonth()+parseInt(1)<10?"0"+(ej.getMonth()+parseInt(1)):ej.getMonth()+parseInt(1))+""+(ej.getDate()<10?"0"+ej.getDate():ej.getDate());var ek,el,em;ek=cf?parseInt(cf/36e5):"",el=cf?parseInt(cf/6e4)%60:"";var en=ek+":"+(el==0?"00":el);eg=(ek.toString().match(/^[0-9]{1}$/)?"0"+ek:ek)+""+(el.toString().match(/^[0-9]{1}$/)?"0"+el:el),ek=cg?parseInt(cg/36e5):"",el=cg?parseInt(cg/6e4)%60:"",em=cg?parseInt(cg/1e3)%60:"";var eo=ek+":"+(el==0?"00":el);eh=(ek.toString().match(/^[0-9]{1}$/)?"0"+ek:ek)+""+(el.toString().match(/^[0-9]{1}$/)?"0"+el:el);if(dS.typ==0){V.RFRQ=dS.typ,V.ROPT=dS.ct!=""?"0":"1",V.RIVL=dS.ct==""?"1":dS.ct,V.RDAY=[],V.RTOWK="",V.RDATE="",V.RMON="",V.RCNT="";if(dS.until){var ep=new Date(dS.until);ep=ep.getFullYear()+""+(ep.getMonth()+parseInt(1)<10?"0"+(ep.getMonth()+parseInt(1)):ep.getMonth()+parseInt(1))+""+(ep.getDate()<10?"0"+ep.getDate():ep.getDate()),V.RUTL=ep}else V.RUTL="";V.RST=rst}if(dS.typ==1){V.RFRQ=dS.typ,V.ROPT=0,V.RIVL=dS.ct!=""?dS.ct:"1";if(dS.day){V.RDAY=[];var eq=dS.day.replace(/,/g," "),er=eq.split(bH);for(var es=0;es<er.length;es++)(j.indexOf(er[es])>-1||l.indexOf(er[es])>-1)&&V.RDAY.push(j.indexOf(er[es])>-1?j.indexOf(er[es])+parseInt(1):l.indexOf(er[es])+parseInt(1))}else V.RDAY=[];V.RTOWK="",V.RDATE="",V.RMON="",V.RCNT="";if(dS.until){var ep=new Date(dS.until);ep=ep.getFullYear()+""+(ep.getMonth()+parseInt(1)<10?"0"+(ep.getMonth()+parseInt(1)):ep.getMonth()+parseInt(1))+""+(ep.getDate()<10?"0"+ep.getDate():ep.getDate()),V.RUTL=ep}else V.RUTL="";V.RST=rst}if(dS.typ==2){V.RFRQ=dS.typ,V.ROPT=dS.idx?"1":"0",V.RIVL=dS.ct!=""?dS.ct:"1",V.RDATE=dS.dat?dS.dat:"",V.RTOWK=dS.idx?m.indexOf(dS.idx)>-1?m.indexOf(dS.idx):"":"";if(dS.day){V.RDAY=[];var eq=dS.day.replace(/,/g," "),er=eq.split(bH);for(var es=0;es<er.length;es++)(j.indexOf(er[es])>-1||l.indexOf(er[es])>-1)&&V.RDAY.push(j.indexOf(er[es])>-1?j.indexOf(er[es])+parseInt(1):l.indexOf(er[es])+parseInt(1))}else V.RDAY=[];V.RMON="",V.RCNT="";if(dS.until){var ep=new Date(dS.until);ep=ep.getFullYear()+""+(ep.getMonth()+parseInt(1)<10?"0"+(ep.getMonth()+parseInt(1)):ep.getMonth()+parseInt(1))+""+(ep.getDate()<10?"0"+ep.getDate():ep.getDate()),V.RUTL=ep}else V.RUTL="";V.RST=rst}var eu={};bU.isrem==1&&(eu.ACTYPE="1",eu.REMTIME=bU.remt.toString(),eu.REMTYPE=bU.remty.toString());var ev=[];ev.push(eu);var ew=input.split(bH),ex=input.toLowerCase(),ey=ex.split(bH),ez=d_.split(bH),du="";for(var co in ez)for(var cp in ey)if(ey[cp]==ez[co]){du=du!=""?du+" "+ew[cp]:ew[cp];break}return ew.length==1&&du==""&&(du=ew[0]),d_=du?du:bX,U.SD=ee,U.ED=ef,U.ST=eg,U.ET=eh,U.REP=V,U.ALARM=ev[0].REMTYPE?ev:"",U.SUM=d_,U.DESC=input,U};