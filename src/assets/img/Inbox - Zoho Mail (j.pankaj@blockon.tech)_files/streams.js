window.zmStreamsApp=window.zmStreamsApp||{},window.zmStreamsApp.constants=function(){"use strict";var a={};return a.rightClickId="",a.workspaceId="zmStreamsApp",a.popupId="zms_dropdown",a.elements={},a.groupWorkId="zmStreamsGroup",a.setElements=function(){var b=a.workspaceId,c=zmsuite.getCenter(b)[0].getNodes(),d=c[2]&&c[2].$el.find(".SCS_rgt").length?c[2].$el.find(".SCS_rgt"):zmsuite.getCenter(b)[0].getNodes()[2].$el;a.elements={center:zmsuite.getCenter(b)[1],zm_stHdr:c[0].$el[0],streamListWrapper:c[2].$el[0],zm_stMain:c[1].$el[0].parentElement,zm_stPView:zmsuite.getCenter(b)[1].$el[0],preview:zmsuite.getCenter(b)[1],zm_stream:c[0].$el[0].parentElement,centerOuter:zmsuite.getCenterOuter(b).$el[0],leftHolder:c[2].$el.find(".zmGroupLft"),postHolder:d}},a.removeNotificationPreview="/ncenter/closePreview",a.closeDialog="/stream/closeDialog",a.reconnect="zmailReconnect",a.appSwitch="/apps/tabSwitched",a.mailPreviewUnload="mail/preview/unload",a.smartComposeUnload="smartCompose/removeComment",a.taskCloseTab="/zm/task/closetab",a.notificationStopEvent="/ncenter/stopEvents",a.rhsOpenClose="/integ/rhs",a.rhsWidth="",a.maxLimit={MAX_ALLOWED_MEMBERS:200,MAX_ALLOWED_IMAGE_SIZE:300,MAX_GROUP_NAME_LENGTH:100,MAX_GROUP_DESC_LENGTH:200},a.errCode={nopost:"ENTITY_DOES_NOT_EXIST",opPermit:"OPERATION_NOT_PERMITTED"},a.groupEvents={removeMembers:"CONTACT_BOOK_GROUP_MEMBERS_REMOVED",addModerator:"CONTACT_BOOK_GROUP_MODERATORS_ADDED",remModerator:"CONTACT_BOOK_GROUP_MODERATORS_REMOVED",addMembers:"CONTACT_BOOK_GROUP_MEMBERS_ADDED",groupAdded:"CONTACT_BOOK_GROUP_ADDED",groupRemoved:"CONTACT_BOOK_GROUP_REMOVED",groupEdit:"CONTACT_BOOK_GROUP_CHANGED"},a.notifications={mail_type:"4",like:"23",unlike:"24",post_mention:"25",unlike_comment:"26",unshared:"27",invite:"29",add_post:"30",add_comment:"31",delete_post:"32",delete_comment:"34",delete_private_comment:"35",add_private_comment:"36",change_entity:"37",comment_mention:"38",bulk_update:"39",bulk_delete:"40",add_task:"41",reminder_task:"42",add_share_comment:"43",post_group_mention:"44",comment_group_mention:"45",add_event:"46",update_event:"47",delete_event:"48",like_comment:"49",add_group_member:"50",change_moderator:"109",remove_group_member:"51",resource_share:"52",shareperm_change:"53",shareperm_removal:"54",update_event_status_yes:"55",update_event_status_no:"56",update_event_status_maybe:"57",task_assign:"58",mail_reminder:"59",accept_share:"60",mail_share:"61",add_attachment:"62",change_task_due_date:"63",change_task_assignee:"64",change_task_status:"65",change_task_priority:"66",change_task_category:"67",change_task_title:"68",change_task_description:"69",remove_attachment:"70",draft_share:"71",draft_shareupdate:"72",draft_mailmention:"73",share_unsubscribe:"74",stream_group_enable:"75",stream_group_disable:"76",mail_streams_enable:"77",mail_streams_disable:"78",add_link:"79",change_link_category:"80",change_link_title:"81",change_link_description:"82",change_link_url:"83",mark_link_fav:"84",calendar_reminder:"85",calendar_reminder_mailid_change:"86",calendar_sharing:"87",calendar_unsubscribe:"88",biz_sub_online_renew_due_fewday:"89",biz_sub_online_renew_tdy:"90",biz_sub_online_renew_overdue:"91",biz_sub_online_renew_overdue_tdy:"92",biz_sub_offline_renew_due_fewday:"93",biz_sub_offline_renew_tdy:"94",biz_sub_offline_renew_overdue:"95",biz_sub_offline_renew_overdue_tdy:"96",biz_sub_purchase_more:"97",biz_sub_purchase:"98",domain_not_verified:"99",domains_not_verified:"100",mail_hosting_nil:"101",mx_not_pointed_to_zoho:"102",reg_domain_auto_renew:"103",reg_domain_manual_renew:"104",add_subtask:"105",edit_link:"106",lock_invites:"107",unlock_invites:"108",add_tweet:"112"},a}(),zmStreamsApp.i18ntext=function(){"use strict";var a={};return a.streams=zmText.get("streams","streams"),a}(),window.zmStreamsApp=window.zmStreamsApp||{},zmStreamsApp.util=function(){"use strict";var a=zmStreamsApp.constants,b=a.groupEvents,c=zmText.get("streams"),d={hideMenu:function(a){$("#zm_dropDown").remove(),$(".SCS_postHover").removeClass("SCS_postHover"),a&&$(".SC_ddn").removeClass("active"),$(".SC_ddn").removeClass("SC_ddn"),$(".SC_ddnB").removeClass("SC_ddnB"),$("#zm_stream_edit").remove()},getTabElement:function(a){var b,c=zmsuite.getCenter()[0].$el,d=c.find(".SCS_tabWrapper.posFixed").is(":visible"),e=void 0!==a?a:d,f=e?"zm_staticTab":"zm_fixedTab";return b=c.find(".SCS_tabWrapper."+f)},orderComments:function(a,b){var c=_(b).map(function(b,c){var d=a[b];return d.sequence=c+1,d});return c},removeCommentClass:function(a,b,c){b&&b.listObject[a]&&b.removeClassAtStart(a,"msi-lcmnt"),c&&c.length&&c.find(".msi-lcmnt").remove()},removeGroup:function(a){$.publish(b.groupRemoved,{id:a}),zmCont.removeGroup(a)},addGroup:function(a){$.publish(b.groupAdded,{group:a,groupID:a.id})},editGroup:function(a,c){$.publish(b.groupEdit,{props:c,id:a})},groupManagement:function(a){var c=a.members,e=a.groupId;c=_.isArray(c)?c:c.split(","),"addMember"===a.mode?($.publish(b.addMembers,{id:e,members:c}),(c||[]).forEach(function(a){zmCont.GroupAPI.addMember(e,a)})):"removeMember"===a.mode?($.publish(b.removeMembers,{id:e,members:c}),zmCont.GroupAPI.removeMember(e,c)):"addModerator"===a.mode?($.publish(b.addModerator,{id:e,moderators:c}),c.indexOf(zmail.zuid)!==-1&&d.editGroup(e,{isOwner:!0}),zmCont.GroupAPI.addModerator(e,c)):"removeModerator"===a.mode&&($.publish(b.remModerator,{id:e,moderators:c}),c.indexOf(zmail.zuid)!==-1&&d.editGroup(e,{isOwner:!1}),zmCont.GroupAPI.removeModerator(e,c))},showGroupDetails:function(a,b){var c="zmStreamsApp"===zmTab.currentTab?zmsuite.getCenter("zmStreamsApp")[0].$el[0]:a.viewDOM,d=b&&b.type?b.type:"dropdown",e=zmUtil.createFLComp("groups",{data:a.groupInfo,search:"name",display:"name",displayAs:d,onSelect:a.fn,showCheckbox:!1,showCreate:!1,parentDOM:$(a.elm),removehandler:!0,viewDOM:c,showUnread:a.showUnread});"dropdown"===d&&$(a.elm).addClass("SC_ddn"),$.publish("/mail/menuCreated",{menuHandler:function(){$(".SC_ddn").removeClass("SC_ddn")}}),e.show()},getNameOfInvitee:function(a,b,c){var d,e="",f=0;a=a.split(",");var g=zmStreamsApp.util.getContactDetails(a);for(var h in g){d=g[h];var i=d.name||d.fn;if(i)e+=i;else for(var j in b)String(j)===h&&(e+=b[j]);!e&&c&&(e=c),f++,f!==a.length&&(e+=", ")}return e},publishDeletePost:function(a){$.publish("zmstreamsapp/deletePost",a)},getHourAndTime:function(a){var b=new Date(a),c=b.getHours(),d=b.getMinutes(),e=c>=12?"PM":"AM";return c%=12,c=c?c:12,(c<10?"0":"")+c+":"+(d<10?"0":"")+d+" "+e},getFullDateFormat:function(a){var b=new Date(a);return"undefined"==typeof b.getDateBy?b="":(b=b.getDateBy(zmail.userDateFormat.toUpperCase()),b+" "+zmStreamsApp.util.getHourAndTime(a))},updateTime:function(a){var b,d,e=new Date(a),f=new Date;return d=e.toDateString()===f.toDateString(),b=f-e,b=Math.floor(b/6e4),!!(b&&b>0)&&(d?b<60?1===b?b+" "+c.streams.common.minago:b+" "+c.streams.common.minsago:zmStreamsApp.util.getHourAndTime(a):e.toDateString().slice(0,10).toUpperCase())},getMentionList:function(a){var b=[],c=a.myact?a.myact:a.get("myact");b=c.showinvite?[]:c.mention;var d=a.gnrl?a.gnrl:a.get("gnrl"),e=d.group.id;if(c.showinvite)b="org";else if(!c.showinvite&&zmCont.isGroupMember(zmail.zuid,e)){var f=c.inviteeList||[],g=zmCont.getGroup(e).members||[];if(b=g.concat(f),b=b.concat(e),d.shared){var h,i=c.shGroup;for(var j in i)h=i[j].id,h!==zmail.zuid&&zmCont.isGroupMember(zmail.zuid,h)&&(b=b.concat(h))}}return b},getMentionData:function(a){var b,c,d="",e=zmMention.getMentions($(a)),f=[],g=e.length;for(b=0;b<g;b++)c=e[b].zid||e[b].id,f.push(c);d=f.join(",");var h;return d.length&&(h=zmAutoFill.mentionData($(a))),{offset:h,mention:d}},getPostType:function(a){var b=zmStreamsApp.PostApp.constants.streamTypeInfo[a];return c.streams.post.postType[b]},sendRemove:function(a,b,c){b?$(a).removeClass("zs_snd"):void 0!==b&&$(a).addClass("zs_snd"),$(a).text(c)},membersSetPagination:function(a,b,c){var d=a.splice(b,c);return d},membersFilter:function(a,b){var c=zmStreamsApp.util.getGroupDetails(a),d=_zm.copyOf(zmStreamsApp.util.getContactDetails(c.members));d=_.toArray(d);var e=zmAutoFill.filterArray(d,["fn","eid","nn"],b,!0);return""!==b&&(e=e.slice(0,99)),e},showMembersDialog:function(a,b){var c=zmStreamsApp.template.listMembers(a),d={};d.$content=c,d.title=b,Dialog["new"](d)},createDialog:function(a){var b,d=a.items,e=a.shGroup,f=a.users,g={},h=Object.keys(d);g=zmStreamsApp.util.getContactDetails(h);for(var i in g)if(g[i].isDummyObj){for(var j in e)String(e[j].id)===i&&(g[i]=e[j],g[i].isGroupid=!0);g[i].isDummyObj&&(g[i].fn=f[i]||"")}for(var k in d)b=zmStreamsApp.util.getContactDetails([d[k]])[d[k]],b.isDummyObj&&(b.fn=f[d[k]]),g[d[k]]=b;var l=_.pick(a.items,function(a){return a===String(zmail.zuid)}),m=_.pick(a.items,function(a){return a!==String(zmail.zuid)}),n=[],o=[];n.push(m),o.push(l);var p=_.size(n[0])%2;if(p&&0!==_.size(o[0])){var q=Object.keys(o[0])[0],r={};r[q]=o[0][q],n.push(r),delete o[0][q]}var s=zmStreamsApp.template.popup[a.type](o,a.showInvite,g,a.isOwner),t={};t.$content=s,t.dialogDidMount=a.dialogDidMount,a.closeAction&&(t.closeAction=a.closeAction),t.dialogWillMount=function(b){$(b.$els.$content).append(zmStreamsApp.template.popup[a.type](n,a.showInvite,g,a.isOwner));var c=_.size(n[0])+_.size(o[0]);if(a.showInvite){var d=zmStreamsApp.template.invitee_input();$(b.$els.$content).after(d),c>1&&$(d).css("width",500),setTimeout(function(){$(d).find("input").focus()},500)}c>1&&$(b.$els.$contentWrapper).css("width",500),$(b.$els.$content).css("max-height",.8*$(window).height())},a.buttons&&a.buttons.length>0&&(t.buttons=a.buttons),t.title=c.common.labels.invitee,Dialog["new"](t)},createPopup:function(b){var c={};if("invitee_popup"===b.type){var d=b.items,e=b.shGroup;for(var f in d)if(zmCont.isGroup(f))c[f]=zmCont.getGroup(f);else{for(var g in e)String(e[g].id)===f&&(c[f]=e[g]);void 0===c[f]&&(c[f]=zmStreamsApp.util.getContactDetails([f])[f])}}var h=zmStreamsApp.template.popup[b.type](b.items,b.invite,c,b.showInvite),i={par:b.parent,showArrow:!0,liDom:h,ulClass:b.ulclass,spanClass:b.parentClass,id:a.popupId};return b.callback&&(i.clk=b.callback),b.buttons&&b.buttons.length>0&&(i.buttons=b.buttons),b.direction&&(i.direction=b.direction),b.noArrow&&(i.showArrow=!1),void 0!==b.liHover&&(i.liHover=b.liHover),b.align&&(i.align=b.align),b.container&&(i.container=b.container),b.onhide&&(i.onHide=b.onhide),b.avoidScroll&&(i.avoidScroll=b.avoidScroll),zmStreamsApp.util.showDropdown(i,b.hoverElm),b.done&&b.done($("#zm_dropDown")),$("#zm_dropDown")},closePreview:function(){var a=zmsuite.getCenter(),b=$(a[1].$el),c=b.data("view");c||(b=$(a[0].$el),c=b.data("view")),c&&c.remove(),a[1].$el.parent().removeClass("SC_sw"),a[1].close();var d=a[0].$el.find(".streamsList").filter(".zmSLst");if(d.length){d.removeClass("zmSLst");var e=zmStreamsApp.events.getCurrentView();if("unread"===e.view&&(d.remove(),!e.elm.children().length)){var f=$(e.tab).parent().siblings(".postFilter")[1];f&&$(f).hide();var g=zmStreamsApp.PostApp.template.noPost();$(e.elm).empty().append(g)}}},bindEntityElements:function(a){var b=a.entityElem,c=a.entityId,d=zmail.mailObj[c].TH,e=zmsuite.getCenter(),f=$(e[1].$el),g=f.data("view");g||(f=$(e[0].$el),g=f.data("view"),g||(f=a.entityElem.parents(".SCS_postMail"),g=f.data("view"))),d||(f=""),b.hasClass("msi-fav")?g.addLabel(b,"","",f):b.hasClass("zmst_lbl")&&g.applyLabel(b,!0)},getDropdownMenu:function(a,b){var d=$(zmsuite.getCenter()[1].$el).data("view");d||(d=$(zmsuite.getCenter()[0].$el).data("view")),d||"2"!==b||(d=$(zmsuite.getCenter()[0].$el).find(".SCS_post").data("view"));var e,f=zmStreamsApp.PostApp.getModelForEntity(a,b);e="2"===b?c.streams.post.postType.note:c.streams.post.postType.mail;var g=[],h=f.getGnrlInfo();if("2"===b&&g.push({htm:c.common.labels.print,data:{action:"print",fn:function(){zmStreamsApp.util.printEntity({pid:f.get("gnrl").id,etype:b,actionType:zmStreamsApp.events.getActionType(f.getGroupInfo()),gid:f.getGroupInfo().id,allComments:!0})}}}),g.push({htm:c.streams.activitylog.timeline,data:{action:"streamsTimeline",fn:function(){zmStreamsApp.PostActions.getActivityLogs(f,!1,d.$el),setTimeout(function(){var a=d.$el.find(".SCS_postAct"),b=_zm("<","body")[0].getBoundingClientRect(),c=d.$el.find(".SCS_activitiyFeed").offset().top;a&&c>b.height&&a[0].scrollIntoView({behavior:"smooth"})},500)}}}),g.push({htm:f.get("myact").watching?c.common.labels.unwatch+" "+e:c.common.labels.watch+" "+e,data:{action:"watch",fn:function(){d.watchPost.apply(d)}}}),f.get("myact").showdelete&&g.push({htm:c.common.labels.deleteOnly+" "+e,data:{action:"streamsdelete",fn:function(){d.deletePost.apply(d)}}}),h.owner){var i=f.get("cmnt").total>0?c.common.labels.disableFurtherComments:c.common.labels.disableComments,j=h.allowComments?i:c.common.labels.enableComments;g.push({htm:j,data:{action:"streamsdelete",fn:function(){d.enableDisableComment.apply(d)}}})}return g.push({htm:c.common.labels.copylink,data:{action:"copylink",fn:function(){d.showDialogLink.apply(d)}}}),g},hideOptions:function(){var a=zmsuite.getCenter();_zm(".","msi-gototop",a[0].$el[0])[0].parentElement.parentElement.style.visibility="hidden",_zm(".","msi-status",a[0].$el[0])[0].parentElement.parentElement.style.visibility="hidden"},removeViews:function(a,b,c){b=b.element?b.element:b,zmStreamsApp.util.detachAndRemove(b,c)},detachAndRemove:function(a,b){var c=$.Deferred();try{b=b||zmTab.currentTab,a=a||zmsuite.getCenter(b)[0].$el;var d=$(a).find("#s_postview");if(d=d.length?$(d):$(a),d.length){var e=$(d).find("div.SCSpostAct");e.length&&zmStreamsApp.PostActions.removeViews(e);var f=$(d).find("div.sc_cmdv");f.length&&zmStreamsApp.CommentModule.removeViews(f);var g=$(d).find("div.SCS_post");!g.length&&$(d).hasClass("SCS_post")&&(g=$(d)),g.length&&zmStreamsApp.PostApp.removeViews(g);var h=$(d).find("div.zmL");h.length&&zmStreamsApp.PostApp.removeViews(h),c.resolve()}else c.resolve()}catch(i){zmUtil.debugLog(i),c.resolve()}return c},restoreStreams:function(a){var b=zmStreamsApp.RouteHelper,d={appname:c.common.labels.appName,appId:a,data:{CNodes:"3"},appIcon:"msi-streams",searchPlaceHolder:c.common.labels.searchStreams,faqKey:"Streams",router:b,onDelete:function(){return $.publish(zmStreamsApp.constants.removeNotificationPreview,{element:zmsuite.getCenter(a)[0].$el[0]}),!0}};return{streamAppObj:d,tabRouter:b}},printEntity:function(a){a.etype===zmStreamsApp.PostApp.constants.streamTypeName.note?zNote.printNote({id:a.pid,namespaceId:a.gid}):(a.dataRequest=!0,a.callback=function(a){var b=a,d=b.gnrl.type,e=zmStreamsApp.PostApp.template.post({data:a,grid:!0,type:"Status",id:a.id,isPrint:!0}),f=$(e).find(".postMsg");d===zmStreamsApp.PostApp.constants.streamTypeName.task?zmStreamsApp.PostApp.components.addTask(a,f):d===zmStreamsApp.PostApp.constants.streamTypeName.event?zmStreamsApp.PostApp.components.addEvent(a,f):d===zmStreamsApp.PostApp.constants.streamTypeName.link&&zmStreamsApp.PostApp.components.addLink(a,f);var g={elm:$(e).find(".SCS_postWra"),by:b.gnrl.by,id:b.id,etype:d,groupId:b.gnrl.group.id,showinvite:b.myact.showinvite,like:b.myact.like,invitee:parseInt(b.act.invitees),likes:parseInt(b.act.likes),postUuid:b.gnrl.on,inviteeList:b.myact.inviteeList,isOwner:b.gnrl.by===zmail.zuid,lockInvites:b.gnrl.lockInvites,shGroup:b.myact.shGroup,mentionList:b.myact.mention,isDraft:b.gnrl.draft,shared:b.gnrl.shared};zmStreamsApp.PostActions.getPostTemplate(g);var h=zmStreamsApp.util.orderComments(b.cmnt.comments,b.cmnt.order);h.total=b.cmnt.total;var i={elm:$(e).find(".SCS_postWra"),comments:h,id:b.id,isShare:!1,groupId:b.gnrl.group.id,etype:d,owner:b.gnrl.by,isDisableAdd:!0,shGroup:b.myact.shGroup,isPrint:!0};zmStreamsApp.CommentModule.getCommentTemplate(i),zmail.Printer.print({title:c.common.labels.titlePrint,content:e,css:["streams.css"]})},zmStreamsApp.PostApp.singlePost(a))},reconnectActions:function(){zmCont.getGroupOrder().length&&(window.console.log("Updating streams View, in respond to zmailReconnect - "+new Date),"undefined"!=typeof zmStreamsApp.GroupApp&&zmStreamsApp.GroupApp.getAllUnread(),"undefined"!=typeof zmStreamsApp.PostApp&&zmStreamsApp.PostApp.updateCurrentListing(),d.setStreamsAppSelection())},setStreamsAppSelection:function(b,c,d){c=c||zmTab.currentTab;var e=a.workspaceId;c!==e&&d===e&&"m"===zmApp.selectedApp?zmail.mailLeft.getNodes()[0].resetDefaultSelection():c===e&&zmStreamsApp.GroupApp&&zmStreamsApp.GroupApp.GroupId&&zmail.mailLeft.getNodes()[0].setTempSelection("zmStreamTree",zmStreamsApp.GroupApp.GroupId)},getContactDetails:function(a){var b,c,d={};if(a&&a.length)for(var e=0,f=a.length;e<f;e++){if(b=String(a[e]),zmCont.isGroup(b))c=zmCont.getGroup(b);else{var g={isDummyObj:!0,photo:zmail.defaultPhoto,fn:"",zid:"",eid:"",nn:""},h=zmail.ContactBook.get({zuid:b,type:"org",promise:!1});h.length?(c=h[0].attrs,c.avatar=h[0].avatar()[0]):c=g}d[b]=c}return d},getGroupDetails:function(a,b){var c,d,e={includeGroupHome:Boolean(a||b),includeAllGroups:!0};if(c=zmail.ContactBook.getGroups(a,e),a)c.length?(d=c[0].attrs,d.avatar=c[0].avatar()[0]):!c.length&&zmUtil.isNewGroupUser()?zmAppLoader.load("streamsGroupManagement").done(function(){d=zmStreamsApp.GroupManageApp.getGroup(a),d.disabled&&(d.isDisabled=!0)}):d=zmCont.getGroup(a);else{var f;d={};for(var g=0;g<c.length;g++)f=c[g].attrs,d[f.id]=f,d[f.id].avatar=c[g].avatar()[0]}return d},isGroupMember:function(a,b){var c=d.getGroupDetails(String(b)),e=c.members;return!(!e||!e.length)&&e.indexOf(a)!==-1},reOrderMembers:function(a){for(var b=a.members,c=[a.owner],d=a.moderator,e=[],f=[],g=[],h=0;h<b.length;h++)c.indexOf(b[h])!==-1?e.push(b[h]):d.indexOf(b[h])!==-1?f.push(b[h]):g.push(b[h]);return e.concat(f).concat(g)},generateAvatarTemp:function(a,b,c){var d=zmail.ContactBook,e=a,f="";return b||(e=d.Utils.initials(a)),c||(f=d.Utils.colorClasses()),d.Templates.avatar({isValidPhoto:!1,photo:void 0,initials:e,avatarBgColor:f})[0]},getAttachments:function(a,b){var d={},e=$.Deferred();if("undefined"!=typeof a&&""!==a){if(!a.isUploadCompleted()){var f=b?c.streams.common.attUpComm:c.streams.common.attUpPost;zmUtil.succErrMsg("i",f)}a.getStoreAttachments().done(function(a){var b=a.tempLocation,c=a.myAttachment;d.attTmpObj=JSON.stringify(b),d.attEntObj=JSON.stringify(c),e.resolve(d)}).fail(function(){e.reject()})}else"undefined"!=typeof a&&""!==a||e.resolve();return e.promise()},showDropdown:function(a,b){var c=zmsuite.showMenu(a);if(b){var d="SC_ddn";c&&c.dropObj&&("bottom"===c.dropObj.mountPosition?d="SC_ddnB":"top"===c.dropObj.mountPosition&&(d="SC_ddn")),$(b).addClass(d)}return c},adjustWidth:function(a,b){if(zmUtil.isSelectedShareEnabled()){var c=$("div.js-collab-component"),d=b.isOpen;!zmStreamsApp.constants.rhsWidth&&d&&(zmStreamsApp.constants.rhsWidth=$(".zoSidebar_container")[0].getBoundingClientRect().width);for(var e,f,g,h,i,j,k,l=d?zmStreamsApp.constants.rhsWidth:-zmStreamsApp.constants.rhsWidth,m=0;m<c.length;m++)g=$(c[m]).children(".zmCmntFixed"),h=0===g.data("openType"),void 0===g.data("openType")&&(j=g.data("openedTab"),k=g.siblings(".SCS_cmnt").data("id"),k=k.substring(k.indexOf("#")+1,k.length),h=zmPrev.isEntityOpenedInPreview(k,j)),f=parseInt(g.css("right")),h&&(i=62*zmsuite.getCenter()[0].$el[0].getBoundingClientRect().width/100,g.css("left",i+"px")),e=parseInt(f)+l,g.css("right",e+"px")}},errorHandling:function(a){var b=zmStreamsApp.template.errorTemplate(a);return _zm.getDOM(b)},storeUnposted:function(a,b,c,e){b=b||{};var f=function(a){var b,c,d,e;return b=a.text?a.text.trim():"",d=a.mentions?_.size(a.mentions):0,e=a.replyTo?_.size(a.replyTo):0,c=a.attachment?_.size(a.attachment):0,!(b||d||e||c)};if("localStorage"in window&&null!==window.localStorage){var g=zmail.zuid+"_streamsContent",h=localStorage.getItem(g);if(h){var i=JSON.parse(h);if(i[a]){if(b.hasOwnProperty("text")&&(i[a].text=b.text),b.hasOwnProperty("replyTo")&&(i[a].replyTo=b.replyTo),b.hasOwnProperty("mentions")&&(i[a].mentions=b.mentions),b.hasOwnProperty("attachment")&&(i[a].attachment=b.attachment),f(i[a]))return void d.removeUnposted(a,c,e)}else{if(f(b))return;i[a]={text:b.text||"",attachment:b.attachment||"",mentions:b.mentions||"",replyTo:b.replyTo||""}}localStorage[g]=JSON.stringify(i)}else{if(f(b))return;var j={};j[a]={text:b.text||"",attachment:b.attachment||"",mentions:b.mentions||"",replyTo:b.replyTo||""};var k=JSON.stringify(j);localStorage.setItem(g,k)}}else if(c)e&&(b.hasOwnProperty("text")&&e.set("unPost",b.text),b.hasOwnProperty("mentions")&&e.set("mentions",b.mentions),b.hasOwnProperty("attachment")&&e.set("attachment",b.attachment));else{var l=zmStreamsApp.CommentModule.unPost||{};l[a]||(l[a]={}),b.hasOwnProperty("text")&&(l[a].text=b.text),b.hasOwnProperty("replyTo")&&(l[a].replyTo=b.replyTo),b.hasOwnProperty("mentions")&&(l[a].mentions=b.mentions),b.hasOwnProperty("attachment")&&(l[a].attachment=b.attachment),f(l[a])&&delete l[a]}},retrieveUnposted:function(a,b,c){var d={};if("localStorage"in window&&null!==window.localStorage){var e=zmail.zuid+"_streamsContent",f=localStorage.getItem(e);if(f){var g=JSON.parse(f);g[a]&&(d=g[a])}}else if(b)c&&(d={text:c.get("unPost"),mentions:c.get("mentions"),attachment:c.get("attachment")});else{var h=zmStreamsApp.CommentModule.unPost||{};h[a]&&(d=h[a])}return d},removeUnposted:function(a,b,c){if(a=a||"","localStorage"in window&&null!==window.localStorage){var d=zmail.zuid+"_streamsContent",e=localStorage.getItem(d);if(e){var f=JSON.parse(e);if(f[a]){if(delete f[a],!_.size(f))return void localStorage.removeItem(d);localStorage[d]=JSON.stringify(f)}}}else if(b)c&&(c.set("unPost",""),c.set("mentions",""),c.set("attachment",""));else{var g=zmStreamsApp.CommentModule.unPost||{};g[a]&&delete g[a]}},triggerSearch:function(a){a=_zm.copyOf(a);for(var b,c,d,e=zmail.Search,f=e.Models.Filters,g=[],h=e.Utils.CommonUtil.appUtil.filterConstantsNames,i=0;i<a.length;i++)switch(b=a[i],b.name){case f.GroupFilter.name:c=zmail.ContactBook.getGroups(b.value),g.push({name:b.name,value:c[0]});break;case f.HashtagFilter.name:g.push({name:b.name,value:b.value});break;case h.PostedBy:d=zmail.ContactBook.get({zuid:b.value,promise:!1}),g.push({name:b.name,value:d[0]})}g&&(zmail.Search.setContext(e.Models.Contexts.streamSearchContext),zmail.Search.newSearch(g))},listHashTags:function(a){a=a||{};var b=zmail.Search.Models.Filters,c=[{name:b.HashtagFilter.name,value:{name:a.tag}}];a.gid!==zmail.zuid&&zmail.ContactBook.isGroup(a.gid)&&c.push({name:b.GroupFilter.name,value:a.gid}),zmStreamsApp.util.triggerSearch(c)}};return d}(),window.zmStreamsApp=window.zmStreamsApp||{},window.zmStreamsApp=function(a){"use strict";var b=zmText.get("streams"),c=zmStreamsApp.constants;a.constructWorkSpace=function(b,d){var e,f=c.workspaceId,g=zmStreamsApp.util.restoreStreams(f);"restore"===d&&zmsuite.isWorkspaceAvailable(f)?zmsuite.resetWorkspace(f,g.streamAppObj):zmsuite.setWorkSpace(g.streamAppObj),e=a.getCenter($(zmStreamsApp.constants.elements.postHolder)),zmsuite.renderWorkSpace(),zmsuite.showWorkSpace(f),b=void 0===b?"grid"===zmAdHocSettings.getStreamsListType():b,"default"===zmAdHocSettings.getStreamsListType()&&(b=!0);var h="SC_streams";$(e[1].$el[0].parentElement).addClass(h),c.setElements()};var d=function(a){var b=zmStreamsApp.events.getCurrentView(),c=b.elm.parent().children();c.each(function(c,d){$(d).find("div.SC_nmsg").length||"files"===b.view&&"s_files"===$(d).attr("id")||$.when(zmStreamsApp.util.detachAndRemove(d)).done(function(){$(d).data({grid:"grid"===a,request:!1,next:""}).empty()})})},e=function(a){var b,e,f="msi-gridview"===a;if(c.setElements(),b=c.elements.zm_stHdr,e=$(b).find(".SC_sel i").hasClass(a),!e){var g=$(c.elements.zm_stMain).find(".SCS_lft");g.length&&$(c.elements.zm_stMain)[f?"removeClass":"addClass"]("SC_list"),$(b).find(".SC_sel").removeClass("SC_sel"),$(b).find("."+a).parents("b").addClass("SC_sel");var h=zmStreamsApp.events.getCurrentGroupId();d(f?"grid":"list");var i=zmStreamsApp.events.getCurrentView();if(i.elm.parent()[f?"addClass":"removeClass"]("SCS_rgtIn"),"files"===i.view)zmStreamsApp.PostApp.attachScrollRef.toggleView();else{var j={view:i.view,gridview:f,switchView:!0};zmStreamsApp.PostApp.init(i.elm,h,j,!1)}var k=f?"grid":"list";zmAdHocSettings.setStreamsListType(k)}};a.getCenter=function(a,c){var d=zmsuite.getCenter(),f=d[0].getNodes(),g={iconList:["msi-add"],tooltip:b.common.tooltips.groupSubscription,data:"subscribe"};g="",c&&(g={iconList:["msi-add"],tooltip:b.common.labels.addNewMember,data:"addmember"},zmCont.getGroup(c).isOwner||(g.hideIcon=!0));var h={list:{left:[],right:[{actionArr:[{iconList:["msi-status"],tooltip:b.common.tooltips.writeStatus,data:"status"},{iconList:["msi-gototop"],tooltip:b.common.tooltips.toTop,data:"gototop"}]},{actionArr:[{iconList:["msi-gridview"],tooltip:b.common.tooltips.gridView,data:"grid"},{iconList:["msi-listview"],tooltip:b.common.tooltips.listView,data:"list"},{iconList:["msi-close"],tooltip:b.common.tooltips.close}]}]},clk:function(a,b,d){if("msi-add"===b)zmStreamsApp.GroupApp.addMember(c);else if("msi-add"===b||"addnewgroup"===d)zmGroupSubscription.showPage({onPreviewClose:zmStreamsApp.util.closePreview});else if("msi-gototop"===b)$(zmsuite.getCenter()[0].$el.find(".SCS_rgt")).animate({scrollTop:0},500);else if("msi-listview"===b||"msi-gridview"===b)e(b);else if("msi-close"===b)$.publish(zmStreamsApp.constants.removeNotificationPreview,{element:zmsuite.getCenter()[0].$el[0]}),zmsuite.closeWorkspace("zmStreamsApp");else if("msi-status"===b){$(zmsuite.getCenter()[0].$el.find(".SCS_rgt")).animate({scrollTop:0},500);var f=zmsuite.getCenter()[0].$el.find("#s_sbox textArea");f.click(),f.focus()}}};g&&h.list.right[1].actionArr.unshift(g);var i=c&&zmCont.getGroup(c)?zmCont.getGroup(c).name:b.common.labels.appName;if(c&&c!==zmail.zuid){var j=zmCont.getGroup(c),k=j.members.length,l=k+(1===k?" "+b.common.labels.person:" "+b.common.labels.members),m=j.eid?"<span id='geid' class='SC_lnk'>"+j.eid+"</span>":"";i="<div class='SCmb'><ul><li class='SCtxt'><b class='gdrop'><div class='SC_hd'></div><span>"+i+"<i class='msi-barrow'></i></span></b></li></ul></div>"+m+"<span id='viewmembers' class='SC_lnk'>"+l+"</span><span><i class='msi-chat' id='createChat'></i></span>"}else i="<div class='SCmb'><ul><li class='SCtxt'><b class='gdrop'><div class='SC_hd'></div><span>"+b.common.labels.home+"<i class='msi-barrow'></i></span></b></li></ul></div>";var n={list:{left:{leftHTML:i,centerAlign:!0}}};return f[0].push(h.list),f[0].setListener("click",h.clk),f[1].push(n.list),f[1].setListener("click",n.clk),f},a.currentListingView=function(){var a,b,d,e;return c.setElements(),a=c.elements.zm_stHdr,d=$(a).find(".SC_sel i").attr("class"),b={"msi-gridview":"grid","msi-listview":"list"},e=b[d]||"grid"},a.init=function(a,b){a&&(zmCont.isGroup(a)||zmail.zuid===a)||(a=zmail.zuid);var c="grid"===zmAdHocSettings.getStreamsListType();a=a?a:zmail.zuid;var d={view:"all",gridview:c,addTitleHeader:!0};a===zmail.zuid&&_zm.isAllUnreadEnabled()&&(d.view="unread"),zmStreamsApp.PostApp.init("",a,d,!0,!1,b)};var f=function(){$.subscribe(c.removeNotificationPreview,zmStreamsApp.util.removeViews),$.subscribe(c.closeDialog,zmStreamsApp.util.removeViews),$.subscribe(c.reconnect,zmStreamsApp.util.reconnectActions),$.subscribe(c.mailPreviewUnload,function(a,b){zmStreamsApp.util.detachAndRemove(b.prevElem)}),$.subscribe(c.smartComposeUnload,function(a,b){zmStreamsApp.util.detachAndRemove(b.prevElem)}),$.subscribe(c.taskCloseTab,function(a,b){zmStreamsApp.util.detachAndRemove(b.prevElem)}),$.subscribe(c.appSwitch,zmStreamsApp.util.setStreamsAppSelection),$.subscribe(c.rhsOpenClose,zmStreamsApp.util.adjustWidth)};return f(),a}(window.zmStreamsApp||{}),zmStreamsApp.template=function(){"use strict";var a=zmText.get("streams"),b={},c=function(a,b){var c;return c=a.from>b.from?1:a.from===b.from?0:-1,"QUOTE"===b.type&&a.from>b.from&&(c=1),c},d=function(a,b,c,d,e){var f=zmStreamsApp.util.getContactDetails([a.text])[a.text],g={},h="zms_mention",i=f.fn;i=!i&&b&&b.id===a.text?b.name:c.substring(a.from,a.to);var j=[];d&&d.length&&(j=_.pluck(d,"id")),(zmCont.isGroup(a.text)||j.indexOf(a.text)!==-1)&&(h+=" cursorDefault");var k="";return"string"==typeof b&&b.indexOf("#")!==-1?k=b.substring(0,b.indexOf("#")):"object"==typeof b&&(k=b.id),k&&h.indexOf("cursorDefault")===-1&&(zmCont.isGroup(k)||_.size(e)&&e.indexOf(a.text)!==-1)&&!zmCont.isGroupMember(a.text,k)&&(h+=" inviteeColor"),g=f.zid?{"data-zid":a.text}:{},g["class"]=h,["SPAN",{attrs:g,child:[["text",String(i)]]}]},e=function(a,b,c,e,f){var g=[],h=a.type;if("MENTION"===h)g=d(a,c,b,e,f);else if("HASHTAG"===h){var i=b.substring(a.from,a.to),j=i.indexOf("#"),k=i.substring(0,j);g=["SPAN",{attrs:{"class":"zm_HTag"},child:[["text",k+"#"],["SPAN",{child:[["text",String(a.text.substring(1))]]}]]}]}else if("LINK"===h)g=["A",{attrs:{href:a.text,target:"_blank"},child:[["text",a.text]]}];else if("SMILEY"===h){var l=a.text;g=["EM",{attrs:{"class":l,style:"vertical-align:middle;",title:a.title||""}}]}else"BOLD"===h?g=["STRONG",{child:[["text",a.text]]}]:"ITALIC"===h?g=["I",{child:[["text",a.text]]}]:"STRIKE"===h&&(g=["STRIKE",{child:[["text",a.text]]}]);return g},f=function(a){var b=zmUtil.parseURLS(a,{httpOnly:!0}),c=[];if(b.length){var d=0,e=b.length;for(d=0;d<e;d++)c.push({from:b[d].startIndex,to:b[d].endIndex,text:b[d].url,type:"LINK"})}return c},g=function(a,c,d,e,f){var g,h=0,i=c.length,j=[],k="";for(h=0;h<i;h++)g=c[h],"LINK"!==g.type&&"SMILEY"!==g.type&&j.push({from:g.from-d,to:g.to-d,type:g.type,text:g.text});var l,m={text:a,offset:j,group:e};return f?(l=b.richTextOffSet(m),k=["SPAN",{attrs:{"class":"SC_quote"},child:[["text:html",l]]}]):(l=b.setOffsetValues(m),k=["SPAN",{attrs:{"class":"SC_quote"},child:[l]}]),k};return b={errorTemplate:function(b){var c,d,e,f=zmStreamsApp.constants.errCode;b.code===f.opPermit?(c="noAccess",d=a.common.messages.allowHeader,e=a.common.messages.allowCont):(c="doesNotExist",d=a.common.messages.notFoundHeader,e=a.common.messages.notFoundCont);var g=[["DIV",{attrs:{"class":"zmErrorPage "+c},child:[["DIV",{attrs:{"class":"zmEPMsg"},child:[["H4",{child:[["text",d]]}],["P",{child:[["text",e]]}]]}]]}]];return _zm.getDOM(g)},RenderAttachment:function(a,b){b=b||{};var c,d=b.isDraft,e=a.attArr,f=[],g=e.length,h=a.pid;h=h.indexOf("#")!==-1?h.substring(h.indexOf("#")+1,h.length):h;for(var i,j=a.actionType,k=a.groupId,l=0;l<g;l++)i=e[l],i.inline||(c={Id:i.id,e:h,et:a.type,fs:i.size,ft:i.ft,l:i.l,fn:i.name,p:i.part,thn:i.thn,tn:!0,type:j,u:i.u,gId:k},f.push(c));var m={attList:f,entityInfo:{groupId:k,e:h,et:a.type,actionType:j}};d?(m.appName="compose",m.attClass="SC_Pbar zmAch",m.attListClass="zmCAt"):(m.appName="streams",m.attListClass="zmPAtt",m.showTag=!0,m.supportDrag=!0),b.showZipOpt&&(m.zipType="downloadall",m.showMOpt=!0);var n=zmAttach.build(m);return n},setOffsetValues:function(a){var b=a.text,d=a.offset,h=a.span?"DIV":"SPAN",i=0,j=-1,k=[h,{attrs:{"class":"zmsPCcontent"},child:[]}],l=f(b),m=zmSmiley.replaceText(b);if(a.listView?(k[1].attrs["class"]="sum",d=m):(d=l.length?d.concat(l):d,d=m.length?d.concat(m):d),d&&d.length){d.sort(c);var n,o,p,q=0,r=d.length;for(q=0;q<r;q++){if(n=d[q].from,0!==n&&(o=0===q?b.substring(0,n):b.substring(d[q-1].to,n),k[1].child.push(["text"," "+o+" "])),"QUOTE"===d[q].type){j=q,0!==q&&k[1].child.push(["BR"]),i=d[q].from,p=d.slice(q+1,d.length),k[1].child.push(g(d[q].text,p,i,a.group));break}0===i&&j===-1&&k[1].child.push(e(d[q],b,a.group,a.shGroup,a.inviteeList))}0===i&&q>0&&d[q-1].to<b.length&&(o=b.substring(d[q-1].to,b.length),k[1].child.push(["text"," "+o+" "]))}else j===-1&&k[1].child.push(["text",b]);return k},richTextOffSet:function(a){var b=a.text,d=a.text,f=a.offset,h=0,i=-1;if(f&&f.length){f.sort(c);var j,k,l,m,n=0,o=f.length;for(b="",n=0;n<o;n++){if(j=f[n].from,0!==j&&(k=0===n?d.substring(0,j):d.substring(f[n-1].to,j),b=b.concat(k)),"QUOTE"===f[n].type){i=n,0!==n&&(b=b.concat("<br>")),h=f[n].from,l=f.slice(n+1,f.length),m=g(f[n].text,l,h,a.group,!0),b=b.concat(_zm.getDOM(m).outerHTML);break}0===h&&i===-1&&(m=e(f[n],d,a.group,a.shGroup,a.inviteeList),b=b.concat(_zm.getDOM(m).outerHTML))}0===h&&n>0&&f[n-1].to<d.length&&(k=d.substring(f[n-1].to,d.length),
b=b.concat(k))}return b},listMembers:function(a){a=_.isArray(a)?a:a.split(",");var b,c,d,e,f=[];c=zmStreamsApp.util.getContactDetails(a);for(var g in c)e=c[g],d=e.fn||e.name,d&&(b=["LI",{child:[["DIV",{child:[["text",d],["SPAN",{child:[["text",e.eid||""]]}]]}],["IMG",{attrs:{src:e.photo}}]]}],f.push(b));var h=["UL",{attrs:{"class":"SC_P2r",id:"zms_memView"},child:f}];return _zm.getDOM(h)},addAttachment:function(a){return _zm.getDOM(["DIV",{attrs:{"class":"zmCA zms_aAtt"},child:[["DIV",{attrs:{id:a,"class":"zmCAt"}}]]}])},invitee_input:function(){var b=["DIV",{attrs:{"class":"addInv"},child:[["INPUT",{attrs:{type:"text","class":"zm_sgst",placeholder:a.common.labels.addInvitee}}]]}];return _zm.getDOM(b)},popup:{oneLine:function(a){var b,c,d,e=[],f=a.length;for(c=0;c<f;c++)d=a[c].fn||a[c].name,b=d?["LI",{attrs:{"data-id":String(a[c].id)},child:[["DIV",{child:[["text",d]]}],["IMG",{attrs:{src:a[c].photo}}]]}]:["LI",{attrs:{"data-item":a[c].data},child:[["text",a[c].txt]]}],e.push(_zm.getDOM(b));return e},comment:function(a){var b,c=[];return b=["LI",{attrs:{style:"white-space:pre-wrap;max-height:200px;overflow:auto"},child:[["B",{child:[["text",a.name+": "]]}],["text",a.text]]}],c.push(_zm.getDOM(b)),c},invitee_popup:function(a,b,c,d){var e,f,g,h,i,j="",k="",l="",m=_zm.getDOM(["UL",{attrs:{"class":"invList"}}]);if(a&&void 0===a.input)for(var n=0;n<a.length;n++){var o=a[n];for(var p in o)if(e=c[p]){var q=_zm.getDOM(["LI"]);k=e.isGroupid?zmail.defaultGroupPhoto:e.photo||zmail.defaultPhoto,f=e.fn||e.name,_zm.preloadimg(k),h=c[o[p]];var r=h.zid===zmail.zuid;i=e.id||e.zid,g={name:f,attr:{"data-uid":i,"data-iid":h.zid},ph:k,ret:"dom",img:!0},r||d?(g.iclass="msi-close",g.cls="SC_cs myInv"):g.cls="SC_cs othrInv",l=zmConUtil.bubbleUtil(g),q.appendChild(l),r||(j=h.fn||h.name,q.appendChild(_zm.getDOM(["SPAN",{child:[["text",j]]}]))),m.appendChild(q)}}return m},trendingtags:function(b,c){var d,e,f=[];_.each(b,function(a){e=a.id||a.name,d=c?[["FONT",{attrs:{"class":"SClbl",style:"background-color:"+a.color}}],["text",a.dispName]]:[["text",a.name]],f.push(["SPAN",{attrs:{"data-text":e},child:d}])});var g=c?a.streams.tooltip.tag:zmText.applyArgs(a.common.labels.trendingtags,{tag:"#"}),h=["LI",{child:[["DIV",{child:[["STRONG",{child:[["text",g]]}],["DIV",{attrs:{"class":"SCS_tTags"},child:f}]]}]]}];return[_zm.getDOM(h)]}}}}(),window.zmStreamsApp=window.zmStreamsApp||{},zmStreamsApp.events=function(){"use strict";var a=zmText.get("streams"),b={mentionsInput:function(a){var b=a.elm,c=a.resize,d=a.mention||[],e=a.gid,f=a.keyCallback,g="org";if(d.length&&"org"!==d){var h=zmCont.getGroupOrder(),i=[],j=[];_.each(d,function(a){if(a=String(a),h.indexOf(a)!==-1){var b=zmStreamsApp.util.getGroupDetails(a);b.disabled||j.push(a)}else i.push(a)}),d=_.without(i,zmail.zuid),g=zmStreamsApp.util.getContactDetails(d),g=_.toArray(g),a.gid&&zmCont.isGroupMember(zmail.zuid,a.gid)&&h.push(a.gid),j.length&&_.each(j,function(a){var b=zmCont.getGroup(a),c={fn:b.name,nn:"",eid:b.eid,photo:b.photo,zid:a};g.push(c)})}var k={contentArray:g,compare:["fn","ln","nn","eid"],LType:"3",OType:"3"};e&&e!==zmail.zuid&&(k.groupId=e,k.addtolist=!0,$(b).data("gid",e)),a.addGroups&&(k.groupId=!0,k.addtolist=!0),f&&(k.keyCallback=f,k.keyParam=a.keyParam),"undefined"!=typeof zmStreamsApp.GroupApp&&(k.hashTag=!0,k.hashArray=zmStreamsApp.GroupApp.fetchHashTags),k.aliasPlusForAt=!0,k.resize=c||!1,a.isShareFolder&&(k={contentArray:[],LType:"2",OType:"3",compare:[]}),k.heightPadding=22,zmAutoFill.setAutofill(k,$(b))},previewImage:function(a){if(a){for(var b=$(a).find("img"),c=[],d=b.length,e=0;e<d;e++)b[e].src&&c.push({ft:101,fn:"image.png",src:b[e].src});var f={attObjList:c,hideAllOptions:!0,ignoreThumb:!0},g=c.length;b.click(function(a){for(var b=$(this),d=0,e=0;e<g;e++)c[e].src===b[0].src&&(d=e);f.startIndex=d,zmUtil.initAttSlideShow(f)})}},getActionType:function(a){return a.isGroup?"viewGroupEntity":"viewSelfData"},getCurrentGroupId:function(){var a="zmStreamsApp"===zmTab.currentTab?zmStreamsApp.GroupApp.getCurrentGroup():zmail.mailLeft.selId;return a},getCurrentView:function(a){if(!zmsuite.isWorkspaceAvailable("zmStreamsApp")&&"zmStreamTree"!==zmail.mailLeft.selLayerId)return{};zmStreamsApp.constants.setElements(),a=a||zmStreamsApp.constants.elements.postHolder;var b=a.find("#stabHol").children(".stSel"),c=$(b).data("type"),d=a.find("#s_postview #s_"+c);return c="userPost"===c||"hashTag"===c||"label"===c?"other":c,{elm:d,view:c,tab:b}},publishKeyEvent:function(a){$.publish("zmstreamsapp/keyevent",{data:a})},getListHolders:function(a){var b,c,d=[];return zmsuite.isWorkspaceAvailable("zmStreamsApp")&&(a&&zmStreamsApp.GroupApp.getCurrentGroup()===a||!a)&&(c="zmStreamsApp"),c&&(b=zmsuite.getWorkSpace(c)[0].$el.find("#s_postview")),b&&b.length&&d.push(b),d},openPost:function(a){var b=a.ntype;if("43"===b)return a.sharedMail=!0,void zmList.showNotificationPopup(a);if(a.commentuuid){var c=a.commentuuid;c instanceof Array&&(c=c[0]),a.commentId=c}zmStreamsApp.PostApp.singlePost(a)},setMaxHeight:function(a,b,c,d){var e=parseInt($(a).css("maxHeight")),f=$(a).find(".SC_ptit",a)[0],g=0,h=50;f&&(g=f.getBoundingClientRect().height);var i=["transition","-webkit-transition","-moz-transition"];i.forEach(function(a){c.style[a]="height ease 0.1s, max-height ease 0.1s"});var j=b?b.getBoundingClientRect().height:0;j<h&&(h=100);var k=e-(j+h+g);if(c.style.maxHeight=k+"px",$(a).hasClass("zmScCmnt")){var l=$(a).find("SCSpostAct"),m=l[0]?a[0].getBoundingClientRect().height:0,n=k-m+"px";$(a).find(".SCS_draftCmnt").css("maxHeight",n)}if(d){var o=b.getBoundingClientRect().height;setTimeout(function(){var c=$(a).parents(".SC_Twpr");$(c).css("bottom",o+"px");var d=c;if(d.length){var e=d[0].getBoundingClientRect(),f=zmInit.cliWid;f||(f=document.body.getBoundingClientRect().width);var g=zmUtil.isChildWindow()?10:f-(d.offset().left+d.innerWidth()-10),h=$(c)[0].getBoundingClientRect().height/2,i=zmUtil.wmsBarHeight()||0;$(b).css({right:g+"px",left:e.left+20+"px",position:"fixed",bottom:i+10+"px","will-change":"transform"}).show(),$(b).find(".cmntText").css("maxHeight",h)}},200)}},createWorkSpace:function(a){var b=a.msgId||a.pid,c="Streams_"+b;if(zmsuite.isWorkspaceAvailable(c)&&"restore"!==a.src)return zmsuite.showWorkSpace(c),!1;var d=function(){var c=zmsuite.createAppRouter();return c._hashKey="stream",c.initialize({hashKey:"stream",handler:function(){return{updateParams:!1,handled:!1,daultAction:!1}}}),c.setParams(["tab",a.gid,b,a.etype,a.actionType]),c},e=d(),f={appname:"Streams single post",appId:c,appIcon:"msi-post",data:{CNodes:"3"},router:e,onDelete:function(){return $.publish(zmStreamsApp.constants.removeNotificationPreview,{element:zmsuite.getCenter(c)[0].$el[0]}),!0}},g=function(a,d){var e=d.id;b.indexOf("#")===-1&&(e=d.id.split("#")[1]),e===b&&zmsuite.isWorkspaceAvailable(c)&&zmsuite.closeWorkspace(c)};$.subscribe("zmstreamsapp/deletePost",g);var h={list:{left:[],right:[{actionArr:[{iconList:["msi-close"],tooltip:"Close"}]}]},clk:function(a,b){"msi-close"===b&&($.publish(zmStreamsApp.constants.removeNotificationPreview,{element:zmsuite.getCenter(c)[0].$el[0]}),zmsuite.closeWorkspace(c),$.unsubscribe("zmstreamsapp/deletePost",g))}};"restore"===a.src&&zmsuite.isWorkspaceAvailable(c)?zmsuite.resetWorkspace(c,f):zmsuite.setWorkSpace(f);var i=zmsuite.getCenter(),j=i[0].getNodes();j[0].push(h.list),j[0].setListener("click",h.clk),zmsuite.renderWorkSpace(),zmsuite.showWorkSpace(c),a.elm=j[2].$el[0],a.allComments=!0,a.callback=function(b,d){if(!a.opentype){var e={list:{left:{leftText:d,centerAlign:!0}}};j[1].push(e.list),f.appname=d,zmTab.updateTabLst(f),zmsuite.getCenterOuter(c).paint(),$(a.elm).scroll(function(){zmUtil.hideMenu()})}};var k={actionType:a.actionType,etype:a.etype,gid:a.gid,pid:a.pid};return $.publish("zmail/SaveTabState",[{appId:c,app:"stream",appObj:{appId:c,appname:"Streams single post",data:{},appIcon:"msi-post"},category:"stream_post",data:k}]),a},openPostInTab:function(a){var b=zmStreamsApp.PostApp.constants,c=a.pid||a.msgId;if(a.markRead=!0,a.isMail||String(a.etype)===b.streamTypeName.mail){c.indexOf("t")!==-1&&(c=c.substring(1,c.length)),a.opentype=2;var d=zmail.mailObj[c];if(d&&d.groupId){a.gid=d.groupId,a.pid=a.thId||c,a.etype=b.streamTypeName.mail,a.cachedData=!0;var e="zm_tab"+(d.T?"t":"")+c;if(zmsuite.isWorkspaceAvailable(e))return void zmsuite.showWorkSpace(e);zmUtil.publishCloseNotif()}a.allComments=!0,a.isTab=!0,zmStreamsApp.events.openPost(a)}else if("group"===a.gid)zmStreamsApp.init(c);else if(String(a.etype)===b.streamTypeName.task){var f={groupId:a.gid,entityId:c,commentId:a.commentId,opentype:"tab"};zmtCom.openTask(f)}else String(a.etype)===b.streamTypeName.note&&zmail.isInternalOrgUser?zNote.openNoteInTab({id:c,namespaceId:a.gid,commentId:a.commentId}):(a=zmStreamsApp.events.createWorkSpace(a),a&&zmStreamsApp.events.openPost(a))},clearList:function(a){var b=zmStreamsApp.events.getCurrentView();if(b){var c=$(b.elm).data("groupId");if(c===a&&"unread"===b.view){$(b.elm).data("postlist",[]),zmStreamsApp.util.detachAndRemove(b.elm[0]);var d=$(b.tab).parent().siblings(".postFilter")[1];d&&$(d).hide(),$(b.elm).empty().append(zmStreamsApp.PostApp.template.noPost())}}},loadPostsOfUsers:function(a){var b=a.zid,c=a.gid,d=a.dialog;if("zmStreamsApp"===zmTab.currentTab){var e=zmStreamsApp.events.getCurrentView(),f=zmStreamsApp.util.getContactDetails([b])[b];zmStreamsApp.util.closePreview(),zmail.zuid===String(b)&&zmStreamsApp.events.getCurrentGroupId()!==zmail.zuid?e.tab.siblings("li[data-type='byme']").trigger("click"):(zmStreamsApp.PostApp.showOtherTab(f.fn,"userPost",b,c),zmStreamsApp.PostApp.fetchPosts({type:"other",ele:e.elm,previous:e.tab})),d.remove()}},groupAction:function(b){zmUtil.hideMenu();var c=b.action,d=b.gid;if(d&&c)switch(c){case"viewMembers":var e={gid:d,callback:zmStreamsApp.events.loadPostsOfUsers,title:a.groupSubscription.memberActions.loadPost};zmStreamsApp.GroupApp.showMemberDialog(e);break;case"createChat":zmStreamsApp.GroupApp.createGroupChat(d);break;case"email":zmStreamsApp.GroupApp.emailGroup(d);break;case"markRead":zmStreamsApp.GroupApp.markAllRead(d);break;case"hideGroup":zmAppLoader.load("streamsGroupManagement").done(function(){zmStreamsApp.GroupManageApp.hideGroup(d)})}},showContactCard:function(b){b=b||{};var c=zmStreamsApp.PostApp.constants,d=b.zid||"",e=b.elm,f=zmStreamsApp.events.getCurrentView(),g=b.groupId,h=zmStreamsApp.util.getGroupDetails(g),i=b.eType;$(e).data("show","");var j=[],k=zmStreamsApp.util.getContactDetails([d])[d];if(d===zmail.zuid||k.isDummyObj||j.push({htm:a.common.labels.chatcontact,clk:zmConUtil.createChat}),h&&zmCont.isGroupMember(d,h.id))if("zmStreamsApp"===zmTab.currentTab){var l=[{name:zmail.Search.Utils.CommonUtil.appUtil.filterConstantsNames.PostedBy,value:d},{name:zmail.Search.Models.Filters.GroupFilter.name,value:h.id}];j.push({htm:a.common.labels.viewposts,clk:this.listUserPosts,args:[l,!0]})}else"n"===zmApp.currentApp&&"zm_notes"===zmTab.currentTab&&String(i)===c.streamTypeName.note?j.push({htm:a.common.labels.viewnotes,clk:this.listUserNotes,args:[{zuid:d,groupId:g}]}):"t"===zmApp.currentApp&&"zm_task"===zmTab.currentTab&&String(i)===c.streamTypeName.task&&(j.push({htm:a.common.labels.viewtasksby,clk:this.listUserTasks,args:[{zuid:d,type:"addedby",groupId:g}]}),j.push({htm:a.common.labels.viewtasksto,clk:this.listUserTasks,args:[{zuid:d,type:"assignedto",groupId:g}]}));_.size(j)&&setTimeout(function(){var a=$(e).data("show"),b=$("#zm_dropDown"),c="",g=zmStreamsApp.events.getCurrentView().view;b&&(c=b.data("zid")),"false"!==a&&c!==d&&f.view===g&&$(document).find($(e)).length?zmConUtil.showContactCard({dom:e,items:j,event:null,source:"streams"}):$(e).data("show","")},500)},listUserPosts:function(a,b,c){if(zmStreamsApp.util.hideMenu(),c)zmStreamsApp.util.triggerSearch(b);else{b=b||{};var d=b.zid,e=b.grpInfo,f=b.elm,g=zmStreamsApp.events.getCurrentView(),h=zmStreamsApp.util.getContactDetails([d])[d];h=h.isDummyObj?$(f).text():h.fn,zmail.zuid===d&&zmStreamsApp.events.getCurrentGroupId()!==zmail.zuid?zmStreamsApp.events.getCurrentView().tab.siblings("li[data-type='byme']").trigger("click"):"other"===g.view&&h===$("#s_zms_otherT").find("span").text()||(zmStreamsApp.PostApp.showOtherTab(h,"userPost",d,e.id),zmStreamsApp.util.closePreview(),zmStreamsApp.PostApp.fetchPosts({type:"other",ele:g.elm,previous:g.tab}))}},listUserNotes:function(a,b){zmStreamsApp.util.hideMenu(),zNote.invokeNoteSearch(b),$.publish("zm/closeAllOpenDialog")},listUserTasks:function(a,b){zmStreamsApp.util.hideMenu(),zmtCom.listTaskSearchAction(b)}};return b}(),zmStreamsApp.linkPreview=function(a){"use strict";a=a||{};var b=zmText.get("streams"),c=function(a){var b=zmHash.decode(a),c={};return b&&"stream"===b.key&&("tab"===b.params[0]?(c.etype=b.params[3],c.cId=b.params[5]):(c.etype=b.params[2],c.cId=b.params[4])),c},d=function(a){var b={};return a=a||{},b.linktitle=a.title||"",b.linkdesc=a.description||"",b.linkurl=a.url||"",b.videourl=a.videoURL||"",a.thumbnailURL&&(b.imageurls=[a.thumbnailURL]),a.tags&&a.tags.length&&(b.linktags=a.tags),b},e=function(a){var b={};return b.url=a.linkUrl,b.title=a.title,b.description=a.desc,b.tags=a.tags,b.thumbnails=a.imageUrls,b.videoURL=a.videoUrl||"",b.title&&b.title.length>100&&(b.title=b.title.substr(0,97)+"..."),b.description&&b.description.length>200&&(b.description=b.description.substr(0,197)+"..."),b.tags&&b.tags.length>10&&(b.tags=b.tags.slice(0,10)),b.thumbnails&&b.thumbnails.lenth>20&&(b.thumbnails=b.thumbnails.slice(0,20)),b},f=function(a){return function(c){var d=zmStreamsApp.PostApp.models.posts.get(a)||{},e=("function"==typeof d.get?d.get("myact"):{})||{};if(e.showinvite){var f=zmStreamsApp.events.getCurrentView();zmStreamsApp.PostApp.showOtherTab("#"+c,"hashTag",c,d.getGroupInfo().id),zmStreamsApp.PostApp.fetchPosts({type:"other",ele:f.elm,previous:f.tab})}else _zm.succErrMsg("e",b.common.messages.noHashTagSearch)}},g=function(a,b,d){if(a.link&&a.link.linkUrl){var g={},h={},i=a.link;h=e(i),g.editMode=!1,g.data=h,g.playVideoInline=!0;var j=c(h.url);j.etype&&(g.data.entityType=j.etype,j.cId&&(g.data.isComment=!0));var k=zmLinks.createComponent(g);h.tags&&h.tags.length&&k.setConfig("onHashTagClick",f(d,b,!1));var l=(_zm(".","postMsg",b)||[])[0];_zm.after(l,k.getDOM())}},h=function(a,b,d){if(a.link&&a.link.linkUrl){var g={},h={},i=a.link;h=e(i),g.editMode=!1,g.data=h,g.playVideoInline=!0;var j=c(h.url);j.etype&&(g.data.entityType=j.etype,j.cId&&(g.data.isComment=!0));var k=zmLinks.createComponent(g);h.tags&&h.tags.length&&k.setConfig("onHashTagClick",f(d,b,!0)),b.appendChild(k.getDOM())}},i=function(a,b){for(var c in a)b[c]=a[c];b.imageurls&&(b.imageurls=b.imageurls.join("\n")),b.tags&&(b.tags=b.tags.join("\n"))},j=function(a){var b=a.getData();b.title&&b.title.length>100&&(b.title=b.title.substr(0,97)+"..."),b.description&&b.description.length>200&&(b.description=b.description.substr(0,197)+"..."),b.tags&&b.tags.length>10&&(b.tags=b.tags.slice(0,10)),b.thumbnails&&b.thumbnails.lenth>20&&(b.thumbnails=b.thumbnails.slice(0,20)),a.setConfig("data",b)};return a.getLinkInfoFromComponentData=d,a.addLinkPreviewToPost=g,a.addLinkPreviewToComment=h,a.addDataToParams=i,a.getComponentDataFromLinkInfo=e,a.sanitizeComponent=j,a}(),window.zmLinks=function(a){"use strict";a=a||{};var b,c=zmText.get("streams","linkPreview"),d="click",e="mouseup",f="mousedown",g=zmail.streamsLinkPreviewSupportedUrls||["connect","projects","mail","zmail","bugtracker"],h={6:"msi-status",1:"msi-mail",2:"msi-notes",3:"msi-task",4:"msi-calendar",10:"msi-links"},i=function(a,b,c,d,e){b=b||"GET",c=c||{},zmAjq.XHR({u:a,t:b,p:c,fn:d,efn:e})},j=function(a,b,c,d){return i(a,"POST",b,c,d)},k=function(a){this.url=a,this.title="",this.description="",this.images=[],this.tags=[],this.hasData=!1,this.videoURL="",this.isZohoDocsURL=!1},l=function(a){var b,c=function(a){a&&a.st?b(!0,a):b(!1)},d=function(){b(!1)},e=function(){j(zmail.conPath+"/link.do",{link:a,mode:"link",actionType:"getLinkDetails"},c,d)};return{done:function(a){b=a,e()}}};k.prototype={loadData:function(){var a,b=this,c=function(){b.hasData?a(b):l(b.url).done(function(c,d){if(c&&d.st){if(b.hasData=d.st,b.url=d.linkUrl||b.url,b.title=d.title||"",b.description=d.desc||"","string"==typeof d.imageUrls&&(d.imageUrls=[d.imageUrls]),b.images=d.imageUrls||[],b.tags=d.tags||[],b.videoURL=d.videoUrl||"","ZohoMail"===d.serviceName){if(b.entityType=d.entityType,b.isComment=d.isComment,!d.imageUrls&&d.authorZuid){var e=zmStreamsApp.util.getContactDetails([d.authorZuid])[d.authorZuid];b.images=[e.photo]}d.entityTitle&&d.desc?b.description=d.entityTitle+" - "+d.desc:b.description=d.entityTitle||d.desc}else"ZohoConnect"===d.serviceName?b.images=["https://connect.zoho.com/favicon.ico"]:"ZohoProjects"!==d.serviceName&&"ZohoBugTracker"!==d.serviceName||(b.images=["https://projects.zoho.com/favicon.ico"]);$(b).trigger("changed",b),a(b)}else a()})};return{then:function(b){a="function"==typeof b?b:function(){},c()}}},subscribeChanges:function(a){var b=this;$(b).on("changed",a)},unsubscribeChanges:function(a){var b=this;$(b).off("changed",a)}};var m=['<div data-marker="tag" class="SC_cs zmfc">','<span data-marker="tagname" title=""></span>','<i data-marker="removetag" title="'+c.tooltips.removeTag+'" class="msi-close"></i>',"</div>"].join("\n"),n=['<div data-marker="preview" class="SC_linkpreview zmOwnLinkPreview">','<div class="zmL SC_vpv SC_sq" data-marker="previewboxholder">','<div class="zmLst" data-marker="previewbox">','<div class="zmDtl">','<div data-marker="imageholder" class="zmImg">','<img src="" data-marker="thumbnail">','<i data-marker="playvideo" class="msi-play"></i>','<i data-marker="previmage" class="msi-larrow"></i>','<i data-marker="nextimage" class="msi-rarrow"></i>',"</div>",'<div class="zmFrm">','<span data-marker="title"></span>',"</div>",'<div class="zmSub">','<span class="" data-marker="description"></span>','<span class="sum" data-marker="domain"></span>',"</div>",'<div class="SC_icn">','<i data-marker="removepreview" class="msi-close"></i>',"</div>","</div>","</div>","</div>",'<div data-marker="taglist" class="SC_input">',"</div>","</div>"].join("\n"),o=function(a,b){var c,d,e,f=$("[data-marker]",a),g={};for(f=f||[],$(a).attr("data-marker")&&f.push($(a)[0]),c=0,d=f.length;c<d;c++)e=f[c],g[$(e).attr("data-marker")]=$(e),b&&$(e).removeAttr("data-marker");return g},p=function(a,b){return a=a||"",b=b||[],b.indexOf(a)},q=function(a){a=a||{},a.data=a.data||{};var b={},c=a.data,d=$(m),e=o(d,!0),f=function(){$(e.tag).off().on("click",function(c){"function"==typeof a.onTagClick&&a.onTagClick(b),_zm.stopEvents(c)}),"function"==typeof a.onRemoveTag&&$(e.removetag).off().on("click",function(c){a.onRemoveTag(b),_zm.stopEvents(c)})},g=function(){$(e.tagname).text(c.name||""),$(e.tagname).attr("title",c.name||""),a.editMode||$(e.removetag).remove()},h=function(){g(),f()};return b.setData=function(a,b){c[a]=b,h()},b.setConfig=function(b,c){a[b]=c,h()},b.getData=function(a){return a?c[a]:c},b.getDOM=function(){return d},h(),b},r=function(g){g=g||{},g.data=g.data||{},g.data.tags=g.data.tags||[],g.data.thumbnails=g.data.thumbnails||[];var i={},j=g.data,k={},l=0;j.thumbnails.length&&(j.thumbnailURL=j.thumbnails[l]);var m=$(n),r=o(m,!0),s=function(){if(j.videoURL&&!g.playerLoading){var b=a.getVideoIframe(j.videoURL);b&&($(r.previewboxholder).before(b).hide(),g.playerLoading=!0)}},t=function(){var a="",b="SC_sq SC_po SC_ls SC_sls SC_spo";if($(r.title).text(j.title||""),j.entityType){var c=h[j.entityType];j.isComment&&(c="msi-comment"),$(r.title).prepend('<i class="'+c+'"></i>')}if($(r.description).text(j.description||""),$(r.domain).text(zmUtil.getHostName(j.url)),j.thumbnails&&j.thumbnails.length?($(r.imageholder).css("display",""),a=j.thumbnails[l]||"",$(r.thumbnail).attr("src",a),a&&zmUtil.loadImage(a).then(function(c){if(c&&a===$(r.thumbnail).attr("src")){var d=c.width/c.height,e="SC_sq";d<=.8?e="SC_po":d>=2?e="SC_sls":d>=1.3&&(e="SC_ls"),r.previewboxholder.removeClass(b).addClass(e)}}),$(r.previewboxholder).removeClass("noimg")):($(r.imageholder).remove(),$(r.previewboxholder).addClass("noimg")),j.videoURL&&!g.editMode||$(r.playvideo).remove(),g.editMode?$(r.previewboxholder).addClass("SC_edit"):($(r.removepreview).remove(),$(r.previewboxholder).removeClass("SC_edit")),(!g.editMode||!j.thumbnails||j.thumbnails.length<2)&&($(r.previmage).remove(),$(r.nextimage).remove()),$(r.taglist).html(""),j.tags&&j.tags.length){$(r.taglist).show();for(var d in j.tags)k[d]&&$(r.taglist).append(k[d].getDOM())}else $(r.taglist).hide()},u=function(a){var b=q({editMode:g.editMode,data:{name:a},onRemoveTag:function(){i.removeTag(a)},onTagClick:function(a){if("function"==typeof g.onHashTagClick){var b=a.getData();g.onHashTagClick(b.name)}}});return b},v=function(){if(j.tags&&j.tags.length){k={};for(var a in j.tags)k[a]=u(j.tags[a])}},w=function(){v(),t(),b()},x=function(){var a=l;l=-1,w(),l=a},y=function(a){var b=j.thumbnails.length?j.thumbnails.length-1:0;a>=0&&a<=b?(l=a,j.thumbnailURL=j.thumbnails[l]):_zm.succErrMsg("e",c.messages.noMoreThumbnails),x(),w()},z=function(){y(l-1)},A=function(){y(l+1)};b=function(){var a,b;$(r.previewbox).off(f).on(f,function(){window.getSelection&&(a=window.getSelection()||"",a=a.toString())}),$(r.previewbox).off(e).on(e,function(){window.getSelection&&(b=window.getSelection()||"",b=b.toString())}),$(r.previewbox).off(d).on(d,function(c){a===b&&zmUtil.openLink(j.url),_zm.stopEvents(c)}),$(r.previmage).off().on(d,function(a){z(),_zm.stopEvents(a)}),$(r.nextimage).off().on(d,function(a){A(),_zm.stopEvents(a)}),$(r.thumbnail).off().on(d,function(a){j.videoURL&&(g.playVideoInline===!0?s():"function"==typeof g.onPlayVideo&&g.onPlayVideo(),_zm.stopEvents(a))}),$(r.playvideo).off().on(d,function(a){j.videoURL&&(g.playVideoInline===!0?s():"function"==typeof g.onPlayVideo&&g.onPlayVideo(),_zm.stopEvents(a))}),"function"==typeof g.onRemovePreview&&$(r.removepreview).off().on(d,function(a){g.onRemovePreview(a.ctrlKey),_zm.stopEvents(a)})};var B=function(b){b instanceof a.LinkData&&(j.url=b.url||"",j.title=b.title||"",j.description=b.description||"",j.thumbnails=b.images,j.thumbnails&&j.thumbnails.length&&(j.thumbnailURL=j.thumbnails[0]),j.tags=b.tags,j.videoURL=b.videoURL||"",b.entityType&&(j.entityType=b.entityType),j.isComment=b.isComment)};return i.setConfig=function(a,b){g[a]=b,"data"===a&&(j=g.data,l=0,j.thumbnails.length&&(j.thumbnailURL=j.thumbnails[l])),w()},i.setData=function(a,b){j[a]=b,w()},i.setTags=function(a){a=a||[];for(var b in a)i.addTag(b,!0);w()},i.addTag=function(a,b){a=a||"",a&&p(a,j.tags)===-1&&(j.tags.push(a),b||w())},i.removeTag=function(a){a=a||"";var b=p(a,j.tags);a&&b!==-1&&(j.tags.splice(b,1),w())},i.getDOM=function(){return m[0]},i.getData=function(a){return a?j[a]:j},i.initFromLink=function(b){var c=new a.LinkData(b);c.loadData().then(function(){c.hasData&&(B(c),w())})},g.linkData instanceof a.LinkData&&B(g.linkData),w(),i},s=function(b,c){var d,e=function(){var e=new a.LinkData(b);e.loadData().then(function(){if(e.hasData){c.linkData=e;var b=a.createComponent(c);d(b)}else d()})};return{then:function(a){d=a,e()}}},t='<iframe src="" class="SC_ve" style="min-width: 400px; height: 300px; width: 100%;" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>',u={YOUTUBE:{urlPatterns:[/(?:https?:\/\/)?[^.\s]+\.youtube\.[^.\/]+\/[^\s]*watch\?[^\s]*v=([^\s&#\/]+)(?:&t=([^\s&#]+))*[^\s]*/g,/(?:https?:\/\/)?[^.\s]+\.youtube\.[^.\/]+\/v\/([^\s&#\/]+)(?:&t=([^\s&#]+))*[^\s]*/g,/(?:https?:\/\/)?youtu\.be\/([^\s&#\/]+)(?:&t=([^\s&#]+))*[^\s]*/g],iframeURL:"//www.youtube.com/embed/{{videoID}}{{extraParams}}",timeParseRegex:/(?:([0-9]*)h)*(?:([0-9]*)m)*(?:([0-9]*)s)*/gi},VIMEO:{urlPatterns:[/(?:https?:\/\/)?vimeo\.[^.\/]+\/([^\s&#\/]+)[^\s]*/g],iframeURL:"//player.vimeo.com/video/{{videoID}}"},DAILYMOTION:{urlPatterns:[/(?:https?:\/\/)?[^.\s]+\.dailymotion\.[^.\/]+\/video\/([^\s&#\/_]+)[^\s]*/g,/(?:https?:\/\/)?dai.ly\/([^\s&#\/_]+)[^\s]*/g],iframeURL:"//www.dailymotion.com/embed/video/{{videoID}}"},FACEBOOK:{urlPatterns:[/(?:https?:\/\/)?[^.\s]+\.facebook\.[^.\/]+\/[^\s]*videos\/([^\s&#\/]+)*[^\s]*/g],iframeURL:"//www.facebook.com/video/embed?video_id={{videoID}}"}},v=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=Object.keys(u);for(b=0,c=o.length;b<c;b++){for(d=u[o[b]],f=0,g=d.urlPatterns.length;f<g;f++)if(e=d.urlPatterns[f],e.lastIndex=0,j=void 0,null!==(j=e.exec(a))&&(e.lastIndex=0,j[1])){h=j[1],i=j[2]||"";break}if(h)return k=d.iframeURL.replace(/\{\{videoID\}\}/,h),i?(l=d.timeParseRegex,l.lastIndex=0,m=l.exec(i),m[1]=parseInt(m[1])||0,m[2]=parseInt(m[2])||0,m[3]=parseInt(m[3])||0,n=3600*m[1]+60*m[2]+m[3],k=k.replace(/\{\{extraParams\}\}/,"?start="+n)):k=k.replace(/\{\{extraParams\}\}/,""),k}},w=function(a){return Boolean(v(a))},x=function(a,b){var c=v(a);if(c+=(c.indexOf("?")!==-1?"&":"?")+"autoplay=true"){var d=$(t).attr("src",c)[0];return"function"==typeof b&&$(d).on("load",function(){b()}),d}},y="zmlinks_"+Math.round(1e3*Math.random())+"_",z=1,A=function(){return y+Date.now()+"_"+z++},B={},C={},D=function(b){var d,e,f,h={},i=!1,j={},k="",l=function(){},m=function(){},n=function(){},o=function(a,b){j[a]=!0,b&&zmsDialog.confirm(zmText.applyArgs(c.messages.confirmPreviewDisable,{url:a}),{onOk:function(){C[a]=!0}})},p=function(a){var b=Boolean(j[a]||C[a]),c="http";if(b=b||a.indexOf(c)===-1&&a.indexOf("www")===-1)return b;b=b||a.indexOf(".zoho.com")!==-1;for(var d=0,e=g.length;d<e;d++)if(a.indexOf(g[d])!==-1){b=g[d].indexOf("mail")!==-1&&a.indexOf("#stream")===-1;break}if(zmail.isBaihui&&!b){var f;for(var h in u)if("YOUTUBE"===h||"FACEBOOK"===h){f=u[h].urlPatterns;for(var i=0,k=f.length;i<k;i++)if(f[i].lastIndex=0,null!==f[i].exec(a)){b=!0;break}}}return b},q=function(){j={}},r=function(a){l="function"==typeof a?function(){i||a.apply(this,arguments)}:function(){}},s=function(a){m="function"==typeof a?function(){i||a.apply(this,arguments)}:function(){}},t=function(a){n="function"==typeof a?function(){i||a.apply(this,arguments)}:function(){}},v=function(){var a=$("<div>").addClass("SC_lpload");zmComponent.loadingBand({type:"pagination",container:a[0]});var b=function(){e&&e.append(a)},c=function(){e&&a.remove()};return{show:b,hide:c}}(),w=function(){var a=d;d=void 0,a&&$(a.getDOM()).remove(),n(a)},x=function(b){d||p(b)||k===b||(k=b,l(b),a.createComponentFromLink(b,{editMode:!0,onRemovePreview:function(a){o(b,a),w()}}).then(function(a){v.hide(),k&&(k="",a?(w(),d=a,m(a)):o(b))}),v.show())},y=function(){var a,c=b.tagName;a="TEXTAREA"===c||"INPUT"===c?b.value:$(b).text();var d=zmUtil.parseURLS(a);if(d.length)for(var e in d){var f=d[e].url;if(!j[f]&&!C[f])return void x(f)}},z=function(){return d&&d.getData()},A=function(){f&&f.unbind()},D=function(){A(),f=zmUtil.bindInputTextChange({input:b,callback:y})},E=function(){return i=!0,k="",q(),w(),D(),i=!1,h},F=function(){return E()};return h.setLinkFoundCallback=function(a){return r(a),h},h.setComponentReadyCallback=function(a){return s(a),h},h.setPreviewRemovedCallback=function(a){return t(a),h},h.setProgressDisplayDOM=function(a){return e=a?$(a):void 0,h},h.reset=function(){return F()},h.getPreview=function(){return d},h.getPreviewData=function(){return z()},h.destroy=function(){F(),A(),B[b]=void 0,delete B[b]},E(),h};return a.PreviewManager=function(a){var b=$(a).attr("data-zmlinks");return b||(b=A(),$(a).attr("data-zmlinks",b)),B[b]||(B[b]=D(a)),B[b]},a.PreviewManager.destroy=function(){for(var a in B)B[a].destroy()},a.getVideoIframe=x,a.isURLEmbeddable=w,a.createComponentFromLink=s,a.createComponent=function(a){return r(a)},a.requestLinkData=l,a.LinkData=k,a}(),window.zmStreamsApp.twitter=function(a){"use strict";var b,c,d=zmail.Integrations.twitter,e=zmText.get("streams","twitter");a.getGroupConfig=function(a){var b=$.Deferred();return zmAjq.XHR({u:"/integPlatform/integAction.do",t:"GET",fn:function(a){var c;a=a||{},c=a.data||{},b.resolve(c)},p:{action:"GET_CONFIGURED_GRPACCS",groupId:a,appType:"twitter"},onerror:function(){b.resolve({})},onnetfailure:function(){b.resolve({})}}),b};var f=function(a,c,d){a.value="";var f=_zm(".","TW_setSize",d)[0];f.textContent=e.maxChar,b&&c&&(b.clearStoreAttachments(),$(c).find(".TW_attList").html(""))};a.tweetUpdateBox=function(){var c=d.twitterData,g=_zm.getDOM(["DIV",{child:[["DIV",{attrs:{"class":"zm_mention"},child:[["TEXTAREA",{attrs:{autocomplete:"off",autocorrect:"off",autocapitalize:"off",placeholder:e.addTweet}}]]}],["DIV",{attrs:{"class":"zmSpitwitter"},child:[["text","Post in twitter via "],["STRONG",{child:[["text","@"+c.profileName]]}]]}],["DIV",{attrs:{"class":"zmCA TW_attach"},child:[["DIV",{attrs:{"class":"zmCAt TW_attList"}}]]}]]}]),h=_zm.getDOM(["DIV",{attrs:{"class":"SCmb SC_flt TW_attIcon"},child:[["UL",{child:[["LI",{child:[["B",{child:[["I",{attrs:{"class":"msi-image"}}]]}]]}]]}]]}]),i=_zm.getDOM(["LI",{attrs:{"class":"TW_showLen"},child:[["B",{child:[["SPAN",{attrs:{"class":"TW_setSize"},child:[["text","280"]]}]]}]]}]),j=_zm("<","TEXTAREA",g)[0];j.onkeyup=function(){var a=_zm(".","TW_setSize",i)[0],b=parseInt(e.maxChar)-j.value.length;a.textContent=String(b),b<0&&!_zm.hasClass(a,"redInfo")?_zm.addClass(a,"redInfo"):b>=0&&_zm.removeClass(a,"redInfo")};var k={componentId:"twitter",attachFrom:["desktop"],currentAttachedSize:0,maxAttachedSize:3145728,eleId:$(g).find(".TW_attList"),desktop:{allowedType:{type:".png,.jpg,.jpeg,.gif,.webp",error:e.onlyImages}},isNewImp:!0,autoLaunch:!1,actionMode:1,$dropCenter:g,$actionEle:$(h)};return zmUtil.initAttachComponent(k,function(a){b=a}),{$elem:g,$attachelem:h,$lengthelem:i,addStreams:function(c){var d=j.value.trim();if(""===d||d.length>280){var h=""===d?e.emptyContent:e.maxContent;_zm.succErrMsg("e",h),c.onfailure()}else{var k={text:d},l=b.getStoreAttachments(),m=l.tempLocation.length;if(1===m)k.attachment={fP:l.tempLocation[0].fP,sN:l.tempLocation[0].sN};else if(m>1)return _zm.succErrMsg("e",e.oneAttach),void c.onfailure();var n=function(){_zm.succErrMsg("s",e.tweetAdded),f(j,g,i),c.onsuccess()},o=function(){_zm.succErrMsg("e",e.addTweetErr),c.onfailure()};a.addTweet(k,n,o)}}}};var g=function(a,b){var c,d,e=[],f=a.type,g=b.substring(a.from,a.to);if("TWEET_MENTION"===f){c=g.indexOf("#"),d=g.substring(0,c);var h="https://twitter.com/"+String(a.text.substring(1));e=["SPAN",{attrs:{"class":"zm_twitLnk TW_mention"},child:[["text",d+"@"],["A",{attrs:{href:h,target:"_blank","class":"tw_links"},child:[["text",String(a.text.substring(1))]]}]]}]}else if("HASHTAG"===f){c=g.indexOf("#"),d=g.substring(0,c);var i="https://twitter.com/hashtag/"+String(a.text.substring(1));e=["SPAN",{attrs:{"class":"zm_twitLnk TW_hashTag"},child:[["text",d+"#"],["A",{attrs:{href:i,target:"_blank","class":"tw_links"},child:[["text",String(a.text.substring(1))]]}]]}]}else"LINK"===f&&(e=["SPAN",{attrs:{"class":"zm_twitLnk"},child:[["A",{attrs:{href:a.text,target:"_blank"},child:[["text",a.text]]}]]}]);return e},h=function(a){var b=['<div ref="wrapper" class="zm_rtwit zm_retweet"><div class="zm_twitHead"><div class="SC_avtr"><img ref = "image"></div><div class="zm_twitIco SC_frt"><i class="msi-twitter"></i></div><div class="zm_twitUser"><strong class="zm_susr" ref="username"></strong><span class="sum" ref="content"></span></div></div></div>'].join(""),c=_zm.getDOMReferenceMap($(b),!0),d=zmail.ContactBook.getContacts(zmail.zuid)[0];$(c.image).attr({src:d.attrs.photo}),$(c.username).text(e.you),$(c.content).text(" "+e.reTwtAdd);var f=$(a).find(".zm_twitCmnt");f.length?$(f).before(c.wrapper):$(a).append(c.wrapper)};a.setOffsetValues=function(a){var b=a.text,c=a.offset,d=["DIV",{attrs:{"class":"zm_twitMsg"},child:[]}],e=zmUtil.parseURLS(b,{httpOnly:!0});if(e.length)for(var f=0,h=e.length;f<h;f++)c.push({from:e[f].startIndex,to:e[f].endIndex,text:e[f].url,type:"LINK"});var i=function(a,b){var c;return c=a.from>b.from?1:a.from===b.from?0:-1};if(c&&c.length){c.sort(i);var j,k,l=0,m=c.length;for(l=0;l<m;l++)j=c[l].from,0!==j&&(k=0===l?b.substring(0,j):b.substring(c[l-1].to,j),d[1].child.push(["text"," "+k+" "])),d[1].child.push(g(c[l],b));
k=b.substring(c[l-1].to,b.length),d[1].child.push(["text"," "+k+" "])}else d[1].child.push(["text",b]);return d},a.getTweetDom=function(b,c){b=b||{};var d,f=b.tweets,g=f.tweetId,h="",i=f.screenName,j=i.indexOf("@"),k=i.substring(0,j),l=i.substring(j+1,i.length),m=f.profileURL,n={text:b.cntnt.summary,offset:b.tags},o=a.setOffsetValues(n),p=JSON.parse(f.tweetAttachment),q="";if(p.length){q=["DIV",{child:[]}];for(var r=0,s=p.length;r<s;r++)"photo"===p[r].attachmentType&&(d=p[r].url,q[1].child.push(["IMG",{attrs:{src:d,style:"max-width:300px;"}}]))}var t="https://twitter.com/"+l+"/status/"+g,u=["DIV",{attrs:{"class":"zm_mtwitLnk"},child:[["SPAN",{attrs:{"class":"zm_twitLnk TW_link"},child:[["text",t]]}]]}],v=["DIV",{attrs:{"class":"zm_twitHead"},child:[["DIV",{attrs:{"class":"SC_avtr"},child:[["IMG",{attrs:{src:m}}]]}],["DIV",{attrs:{"class":"zm_twitUser"},child:[["STRONG",{attrs:{"class":"zm_susr"},child:[["text",k]]}],["SPAN",{attrs:{"class":"sum"},child:[["text"," @"+l]]}]]}]]}];c&&(h=["DIV",{attrs:{"class":"zm_twitIcons"},child:[["SPAN",{attrs:{"class":"tw_reply"},child:[["I",{attrs:{"class":"msi-comment"}}],["text",e.reply]]}],["SPAN",{attrs:{"class":"retwit tw_retweet"},child:[["I",{attrs:{"class":"msi-watch"}}],["text",e.retweet]]}]]}]);var w=_zm.getDOM(["DIV",{attrs:{"class":"zm_twit"},child:[["DIV",{attrs:{"class":"zm_mtwit tweetMsg","data-tid":g},child:[u,v,o,q,h]}]]}]);return w},a.getSubTweetDom=function(a){a=a||{};var b=a.tweetId,c=a.profileImage,d=a.userName,e=a.screenName,f=a.content,g=_zm.getDOM(["DIV",{attrs:{"class":"zm_rtwit tweetMsg","data-tid":b},child:[["DIV",{attrs:{"class":"zm_twitHead"},child:[["DIV",{attrs:{"class":"SC_avtr"},child:[["IMG",{attrs:{src:c}}]]}],["DIV",{attrs:{"class":"zm_twitIco SC_frt"},child:[["I",{attrs:{"class":"msi-twitter"}}]]}],["DIV",{attrs:{"class":"zm_twitUser"},child:[["STRONG",{attrs:{"class":"zm_susr"},child:[["text",d]]}],["SPAN",{attrs:{"class":"sum"},child:[["text"," @"+e]]}]]}]]}],["DIV",{attrs:{"class":"zm_twitMsg"},child:[["text",f]]}]]}]);return g},a.replyCommentBox=function(a){a=a||{};var b=a.screenName,c=a.photoLink,d=a.tweetId,f=_zm.getDOM(["DIV",{attrs:{"class":"zm_twitCmnt"},child:[["DIV",{attrs:{"class":"zm_twitCmntRp sum"},child:[["text",e.replyTo],["SPAN",{attrs:{"class":"zm_twitLnk TW_repSname"},child:[["text"," @"+b]]}]]}],["DIV",{attrs:{"class":"zm_twitCmntBx expandIp"},child:[["DIV",{attrs:{"class":"SC_avtr"},child:[["IMG",{attrs:{src:c}}]]}],["TEXTAREA",{attrs:{"class":"zm_twitCmntIp",placeholder:e.replyPlaceholder}}]]}],["DIV",{attrs:{"class":"zm_twitBtn"},child:[["SPAN",{attrs:{"class":"SC_flt zm_twitWrdCnt sum"},child:[["text",e.maxChar]]}],["SPAN",{attrs:{"class":"TW_cancelRep lnk cursorPointer"},child:[["text",e.cancel]]}],["SPAN",{attrs:{"class":"TW_sendRep btn cursorPointer","data-id":d},child:[["text",e.reply]]}]]}]]}]);return f},a.retweetDialog=function(a){a=a||{};var b=a.profileImage,c=a.userName,d=a.screenName,f=a.summary,g=_zm.getDOM(["DIV",{child:[["DIV",{attrs:{"class":"zm_retwitCont"},child:[["DIV",{attrs:{"class":"zm_twitHead"},child:[["DIV",{attrs:{"class":"SC_avtr"},child:[["IMG",{attrs:{src:b}}]]}],["DIV",{attrs:{"class":"zm_twitUser"},child:[["STRONG",{attrs:{"class":"zm_susr"},child:[["text",c]]}],["SPAN",{attrs:{"class":"sum"},child:[["text"," @"+d]]}]]}]]}],["DIV",{attrs:{"class":"zm_twitMsg"},child:[["text",f]]}]]}],["DIV",{attrs:{"class":"zm_twitBtn"},child:[["SPAN",{attrs:{"class":"TW_retweetBtn btn cursorPointer"},child:[["text",e.retweet]]}]]}]]}]);return g};var i=function(b,d){var f=_zm(".","TW_sendRep",b)[0],g=d.tweetId,h=_zm("<","TEXTAREA",b)[0],i=d.screenName;if(!_zm.hasClass(f,"tw_snd")){_zm.addClass(f,"tw_snd");var j=h.value.trim();if(""===j)return _zm.succErrMsg("e",e.emptyContent),void _zm.removeClass(f,"tw_snd");if(j.length>280)return _zm.succErrMsg("e",e.maxContent),void _zm.removeClass(f,"tw_snd");f.textContent=e.replying;var k={tweetId:g,screenName:i,text:j,groupId:d.gId,profileId:d.profileId};a.replyTweet(k,function(a){_zm.removeClass(f,"tw_snd"),f.textContent=e.reply,a.errors?a.errors[0].message?_zm.succErrMsg("e",a.errors[0].message):_zm.succErrMsg("e",e.errorMsg):a.msg?_zm.succErrMsg("e",a.msg):(_zm.succErrMsg("s",e.replied),c(a,b))},function(a){_zm.succErrMsg("e",e.errorMsg),_zm.removeClass(f,"tw_snd"),f.textContent=e.reply})}},j=function(b,c){var d=c.tweetId,f=c.gId,g=c.screenName,j=c.profileId,k=_zm(".","TW_link",b)[0];k.onclick=function(){a.viewTweet(g,d)};var l=_zm(".","tw_retweet",b)[0];if(l){var m;l.onclick=function(){var i=a.retweetDialog(c),k=_zm(".","TW_retweetBtn",i)[0];k.onclick=function(c){var i=c.currentTarget;if(!_zm.hasClass(i,"tw_snd")){_zm.addClass(i,"tw_snd"),k.textContent=e.retweeting;var l={id:d,screenName:g,groupId:f,profileId:j},n=_zm("<","TEXTAREA",m.$els.$header[0])[0],o=n.value.trim();o&&(l.text=o),a.reTweet(l,function(a){_zm.succErrMsg("s",e.retweeted),m.remove(),h(b)},function(a){_zm.succErrMsg("e",e.errorMsg),_zm.removeClass(i,"tw_snd"),k.textContent=e.retweet})}},m=Dialog["new"]({$content:i,defaultCloseIcon:!0});var l=_zm.getDOM(["DIV",{child:[["H3",{child:[["text",e.retwtTitle]]}],["DIV",{attrs:{"class":"zm_twitCmntBx zm_retwit"},child:[["TEXTAREA",{attrs:{"class":"zm_twitCmntIp",placeholder:e.addComment}}]]}]]}]),n=_zm("<","TEXTAREA",l)[0];n.onclick=function(){var a=_zm.findParentWithClass(this,"zm_twitCmntBx");_zm.addClass(a,"expandIp")},_zm.append(m.$els.$header[0],l),m.show()}}var n=_zm(".","tw_reply",b)[0];n&&(n.onclick=function(b){var e,f=b.currentTarget,h=zmail.ContactBook.getContacts(zmail.zuid)[0],j="";h&&(j=h.attrs.photo);var k=_zm.findParentWithClass(f,"tweetMsg"),l=$(k).siblings(".zm_twitCmnt")[0];if(l)e=_zm("<","TEXTAREA",l)[0],e.focus();else{l=a.replyCommentBox({screenName:g,photoLink:j,tweetId:d}),e=_zm("<","TEXTAREA",l)[0];var m=_zm(".","zm_twitBtn",l)[0],n=_zm(".","TW_cancelRep",m)[0],o=_zm(".","TW_sendRep",m)[0];e.onkeyup=function(){var a=_zm(".","zm_twitWrdCnt",m)[0],b=280-e.value.length;a.textContent=String(b),b<0&&!_zm.hasClass(a,"redInfo")?_zm.addClass(a,"redInfo"):b>=0&&_zm.removeClass(a,"redInfo")},e.onkeydown=function(a){zmail.mailOpt.isKey&&a.ctrlKey&&13===a.keyCode&&(a.preventDefault(),i(l,c))},n.onclick=function(a){var b=a.currentTarget,c=_zm.findParentWithClass(b,"zm_twitCmnt");_zm.remove(c)},o.onclick=function(){i(l,c)},$(k).parent().append(l),e.focus()}})};return a.showTweet=function(b,c){b=b||{};var e=!1,f=b.gnrl.group.id,g=b.gnrl.id;if(_zm.isTwitterIntegrationEnabled())if(d.twitterData&&b.tweets.profileId===d.twitterData.profileId&&1===d.twitterData.status)e=!0;else if(f!==zmail.zuid){var h=a.getTwitterModel(f);if(h&&h.length)for(var i,k=0,l=h.length;k<l;k++)if(h[k].profileId===b.tweets.profileId){if(2===h[k].privilege){e=!0;break}if(1===h[k].privilege&&(i=zmail.ContactBook.getGroups(String(h[k].nameSpaceId)),i[0].isOwner)){e=!0;break}}}var m=a.getTweetDom(b,e),n=b.tweets.screenName,o=n.indexOf("@"),p=n.substring(0,o),q=n.substring(o+1,n.length);j(m,{summary:b.cntnt.summary,userName:p,screenName:q,profileImage:b.tweets.profileURL,gId:f,tweetId:g,profileId:b.tweets.profileId}),c&&c.length&&_zm.append(c[0],m)},c=function(b,c){var d=b.id_str,e=b.user.name,f=b.user.screen_name,g=b.user.profile_image_url_https,h=b.full_text,i=a.getSubTweetDom({tweetId:d,profileImage:g,userName:e,screenName:f,content:h});$(c).parent().append(i),$(c).remove()},a.addTweet=function(a,b,c){a=a||{};var e=d.twitterData,f=e.nameSpaceId?String(e.nameSpaceId):String(e.zuid),g={action:"TWEET",profileId:e.profileId,status:a.text,nameSpaceId:f,appType:"TWITTER"};a.attachment&&(g.fP=a.attachment.fP,g.sN=a.attachment.sN),zmAjq.XHR({u:"/zm/IntegAction.do",t:"POST",fn:function(a){"success"===a.status?b(a.data):c()},onnetfailure:function(){c()},onerror:function(){c()},p:g})},a.reTweet=function(a,b,c){a=a||{};var d={action:"RETWEET",profileId:a.profileId,tweetId:a.id,screenName:a.screenName,nameSpaceId:a.groupId,rootEntityId:a.id,appType:"TWITTER"};a.text&&(d.status=a.text),zmAjq.XHR({u:"/zm/IntegAction.do",t:"POST",fn:function(a){"success"===a.status?b(a.data):c()},onnetfailure:function(){c()},onerror:function(){c()},p:d})},a.replyTweet=function(a,b,c){a=a||{};var d={action:"REPLY_TO_TWEET",profileId:a.profileId,tweetId:a.tweetId,screenName:a.screenName,tweetStatus:a.text,nameSpaceId:a.groupId,rootEntityId:a.tweetId,appType:"TWITTER"};a.attachment&&(d.fN=a.attachment.fN,d.sN=a.attachment.sN),zmAjq.XHR({u:"/zm/IntegAction.do",t:"POST",fn:function(a){"success"===a.status?b(a.data):c()},onnetfailure:function(){c()},onerror:function(){c()},p:d})},a.viewTweetUser=function(a){a=a||"";var b=a.indexOf("@");a=a.substring(b+1,a.length);var c="https://twitter.com/"+a;zmUtil.openLink(c)},a.viewTweet=function(a,b){a=a||"",b=b||"";var c=a.indexOf("@");a=a.substring(c+1,a.length);var d="https://twitter.com/"+a+"/status/"+b;zmUtil.openLink(d)},a.getTwitterModel=function(a){var b,c=zmStreamsApp.GroupApp.getModel(a);return c&&(b=c.get("configuredTwitterAcnts")),b},a}(zmStreamsApp.twitter||Zmail.App.extend({}));