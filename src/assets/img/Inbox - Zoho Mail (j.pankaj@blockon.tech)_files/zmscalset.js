_defineSettingsModule("Categories",function(a,b){"use strict";var c="calendar",d={title:"Calendar"},e=b("Platform.Components"),f=e.CategoryManager,g=f.create(c,{props:{title:d.title}});a.Calendar=g},"MailSuite"),_defineSettingsModule("Pages",function(a,b){"use strict";var c="calendar-generals",d=b("Platform.Components"),e=b("Platform.Entities"),f={title:"Calendar Preferences"},g=d.SettingPageManager,h=e.SettingPage,i=h.Types,j=g.create(c,{props:{title:f.title},attributes:{card:c,category:"calendar",type:i.Title,pageCSSClass:"calendar-generals-page",appContainer:!0}});a.CalendarGenerals=j},"MailSuite"),_defineSettingsModule("Cards",function(a,b){"use strict";var c="calendar-generals",d="calendar",e="calendar-generals",f={cardTitle:"Calendar Preferences"},g=b("Platform.Components"),h=g.SettingCardManager,i=h.create(c,{props:{openable:!0,addToSearch:!1,title:f.cardTitle},state:{hidden:!1},attributes:{category:d},openAction:h.CardActions.OpenPageAction(e)});a.CalendarGenerals=i},"MailSuite"),_defineSettingsModule("CalendarGeneralView",function(a,b){"use strict";var c=function(a){a=a||{};var b=a.process;b.resolve()},d=function(a){a=a||{};var b=a.process;b.resolve()};a.initialize=c,a.uninitialize=d;var e={};a._getGeneralView=function(){var a=$(document.createDocumentFragment()),b=zcal.cdata.opt;zcal.timezones.length==0&&ZCL_uXHR("/cal/timez.do",function(a){zcal.timezones=ZCL_Evl(1,a.responseText)});var c="",d=$("<li class='SC_setbox zcl_setbox'></li>"),e=$("<ul></ul>");c+="<li><h3>"+zcal.i18n.timezone+"</h3><div class='startup'><p><span class='SC_select zcl_Stz' >"+i()+"</span></p></div></li>",c+="<li><h3>"+zcal.i18n.dateformat+"</h3><div class='section-content startup' ><div class='fontSettings mb' rel='"+b.DF+"' >";for(var g in zcal.DATEFORMAT)c+='<em value="'+b.DF+'" id="zcl_DF" rel="'+g+'" class="'+(b.DF==g?"sel":"")+'">'+zcal.DATEFORMAT[g]+"</em>";c+="</div></div></li>",c+="<li><h3>"+zcal.i18n.timeformat+"</h3><div class='section-content startup'><div class='fontSettings mb' rel='"+b.TF+"'>";for(var g in zcal.TIMEFORMAT)c+='<em id="zcl_TF"  rel="'+g+'" class="'+(b.TF==g?"sel":"")+'">'+zcal.TIMEFORMAT[g]+"</em>";c+="</div></div></li>",c+="<li><h3>"+zcal.i18n.defaultview+"</h3><div class='section-content startup'><div class='fontSettings mb' rel='"+b.DEF+"'>";for(var g in zcal.DEFAULTVIEW)c+='<em id="zcl_DEF" rel="'+g+'" class="'+(b.DEF==g?"sel":"")+'">'+zcal.DEFAULTVIEW[g]+"</em>";c+="</div></div></li>",c+="<li><h3>"+zcal.i18n.firdayofthwk+"</h3><div class='section-content startup'><div class='fontSettings mb' rel='"+b.WK+"'>";for(var g in Date.WEEK_DAYS[0])c+='<em id="zcl_WK"  rel="'+g+'" class="'+(b.WK==g?"sel":"")+'">'+Date.WEEK_DAYS[0][g]+"</em>";c+="</div></div></li>",c+="<li><h3>"+zcal.i18n.workweek+"</h3>",c+="<div class='section-content startup'><div class='fontSettings' rel='"+b.WS+"'><span>"+zcal.i18n.from+"</span>";for(var g in Date.WEEK_DAYS[0])c+='<em id="zcl_WS" rel="'+g+'" class="'+(b.WS==g?"sel":"")+'">'+Date.WEEK_DAYS[0][g]+"</em>";c+="</div></div>",c+="<div class='section-content startup'><div class='fontSettings' rel='"+b.WE+"'><span>"+zcal.i18n.to+"</span>";for(var g in Date.WEEK_DAYS[0])c+='<em id="zcl_WE" rel="'+g+'" class="'+(b.WE==g?"sel":"")+'">'+Date.WEEK_DAYS[0][g]+"</em>";c+="</div></div>",c+="</li>",c+="<li><h3>"+zcal.i18n.workinghours+"</h3><div class='startup'><p><span>"+zcal.i18n.from+"</span><span class='SC_select zcl_Sdf'><input value='"+zcal.HOURS[b.HS]+"' type='text' id='zcl_HS' rel="+b.HS+" readonly=''></span><span>"+zcal.i18n.to+"</span><span class='SC_select zcl_Sdf'><input value='"+zcal.HOURS[b.HE]+"' type='text' id='zcl_HE' rel="+b.HE+" readonly=''></span></p></div></li>";var h=b.SIE,j=b.DDE,l=b.REM,m=b.NWTB;c+="<li><h3>"+zcal.i18n.outsideworkingtime_busy+"<div class='onoffButton' id='zcl_nonWHr' data-marker='nonworkingHour'><div class='"+(m==1?"sdiv":"sdiv sadiv")+"' rel='"+(m==1?"on":"off")+"' data-on='"+zcal.i18n.on+"' data-off='"+zcal.i18n.off+"'></div></div></h3><div class='startup help zcl_mt'><em><img src="+zmail.imgPath+"lightbulb-info.png class='info-message'></em><span>\tShow your non-working time as busy.</span></div></li>",c+="<li><h3>"+zcal.i18n.automatic_addinv+"</h3><div class='section-content startup'><div class='fontSettings mb' rel='"+h+"'>",c+='<em id="zcl_autoInv"  rel="0" class="'+(h=="0"?"sel":"")+'">'+zcal.i18n.allow+"</em>",c+='<em id="zcl_autoInv"  rel="2" class="'+(h=="2"?"sel":"")+'">'+zcal.i18n.allowiffree+"</em>",c+='<em id="zcl_autoInv"  rel="1" class="'+(h=="1"?"sel":"")+'">'+zcal.i18n.dontallow+"</em>",c+="</div></div></li>",c+="<li><h3>"+zcal.i18n.denied_events+"<div class='onoffButton' id='zcl_showDE' data-marker='deniedEvents'><div class='"+(j==1?"sdiv":"sdiv sadiv")+"' rel='"+(j==1?"on":"off")+"' data-on='"+zcal.i18n.on+"' data-off='"+zcal.i18n.off+"'></div></div></h3><div class='startup help zcl_mt'><em><img src="+zmail.imgPath+"lightbulb-info.png class='info-message'></em><span>"+zcal.i18n.disdenied_eventsmsg+"</span></div></li>",c+="<li><h3>"+zcal.i18n.reminder_notification+"<div class='onoffButton' id='zcl_remNotify' data-marker='reminderNotify'><div class='"+(l==1?"sdiv":"sdiv sadiv")+"' rel='"+(l==1?"on":"off")+"' data-on='"+zcal.i18n.on+"' data-off='"+zcal.i18n.off+"'></div></div></h3><div class='startup help zcl_mt'><em><img src="+zmail.imgPath+"lightbulb-info.png class='info-message'></em><span>"+zcal.i18n.rem_notifymsg+"</span></div></li>",e.append($(c)),d.append(e),a.append(d),d.find("#zcl_DF").on("click",function(a){var b=$(this);b.parent().find("em").removeClass("sel").addClass(""),b.removeClass("").addClass("sel"),b.parent()[0].setAttribute("rel",b[0].getAttribute("rel")),k()}),d.find("#zcl_TF").on("click",function(a){var b=$(this);b.parent().find("em").removeClass("sel").addClass(""),b.removeClass("").addClass("sel"),b.parent()[0].setAttribute("rel",b[0].getAttribute("rel")),k()}),d.find("#zcl_DEF").on("click",function(a){var b=$(this);b.parent().find("em").removeClass("sel").addClass(""),b.removeClass("").addClass("sel"),b.parent()[0].setAttribute("rel",b[0].getAttribute("rel")),k()}),d.find("#zcl_WK").on("click",function(a){var b=$(this);b.parent().find("em").removeClass("sel").addClass(""),b.removeClass("").addClass("sel"),b.parent()[0].setAttribute("rel",b[0].getAttribute("rel")),k()}),d.find("#zcl_WS").on("click",function(a){var b=$(this);b.parent().find("em").removeClass("sel").addClass(""),b.removeClass("").addClass("sel"),b.parent()[0].setAttribute("rel",b[0].getAttribute("rel")),k()}),d.find("#zcl_WE").on("click",function(a){var b=$(this);b.parent().find("em").removeClass("sel").addClass(""),b.removeClass("").addClass("sel"),b.parent()[0].setAttribute("rel",b[0].getAttribute("rel")),k()}),d.find("#zcl_autoInv").on("click",function(a){var b=$(this);b.parent().find("em").removeClass("sel").addClass(""),b.removeClass("").addClass("sel"),b.parent()[0].setAttribute("rel",b[0].getAttribute("rel")),k()}),d.on("click",function(a){if(a.target.tagName=="INPUT"&&a.target.id=="zcl_HS"){var b=[];for(var c in zcal.HOURS){var d={};d.value=c,d.text=zcal.HOURS[c],b.push(d)}var e=a.target;p({menuItems:b,par:a.target,parWidth:!0}).then(function(a){e.value=a.text,e.setAttribute("rel",a.value),k(),zmUtil.hideMenu()})}if(a.target.tagName=="INPUT"&&a.target.id=="zcl_HE"){var f=[];for(var c in zcal.HOURS){var d={};d.value=c,d.text=zcal.HOURS[c],f.push(d)}var e=a.target;p({menuItems:f,par:a.target,parWidth:!0}).then(function(a){e.value=a.text,e.setAttribute("rel",a.value),k(),zmUtil.hideMenu()})}}),d.find("#zcl_TZ").on("click",function(a){var b=zcal.timezones,c=[];for(var d in b)for(var e in b[d]){var f={};f.id=e,f.name=b[d][e]+" ("+e+")",f.display_text=b[d][e]+" ("+e+")",c.push(f)}var g={},h=$(this),i;g.parentDOM=h.parent(),g.displayAs="dropdown",g.parWidth=!0,g.onSelect=function(a,b){n(h,a,b),k(),i.hide()},g.dataCallback=function(){return c},i=zmUtil.createFLComp("generic",g),i.show()});var n=function(a,b,c){a.val(c.display_text),a.attr("rel",b)},o=d.find("[data-marker=showallTimezone]").removeAttr("data-marker");o.on("click",function(){f(),$(this).remove()});var q=d.find("[data-marker=showallTimezone1]").removeAttr("data-marker");q.on("click",function(){zcal.timezones.length>0?i():ZCL_uXHR("/cal/timez.do",function(a){zcal.timezones=ZCL_Evl(1,a.responseText)}),$(this).remove()});var r=d.find("[data-marker=nonworkingHour]");r&&r.on("click",function(){var a=$(this);a.find("div")[0].className=="sdiv"?(a.find("div").removeClass("sdiv").addClass("sdiv sadiv"),a.find("div")[0].setAttribute("rel","off")):(a.find("div").removeClass("sdiv sadiv").addClass("sdiv"),a.find("div")[0].setAttribute("rel","on")),k()});var s=d.find("[data-marker=automaticInvitation]");s.on("click",function(){var a=$(this);a.parent().find("i").removeClass("msi-option").addClass("msi-unoption"),a.find("i").removeClass("msi-unoption").addClass("msi-option"),k()});var t=d.find("[data-marker=deniedEvents]");t.on("click",function(){var a=$(this);a.find("div")[0].className=="sdiv"?(a.find("div").removeClass("sdiv").addClass("sdiv sadiv"),a.find("div")[0].setAttribute("rel","off")):(a.find("div").removeClass("sdiv sadiv").addClass("sdiv"),a.find("div")[0].setAttribute("rel","on")),k()});var u=d.find("[data-marker=reminderNotify]");u.on("click",function(){var a=$(this);a.find("div")[0].className=="sdiv"?(a.find("div").removeClass("sdiv").addClass("sdiv sadiv"),a.find("div")[0].setAttribute("rel","off")):(a.find("div").removeClass("sdiv sadiv").addClass("sdiv"),a.find("div")[0].setAttribute("rel","on")),k()});var v=d.find("[data-marker=saveGeneral]");return v.on("click",function(){k()}),a};var f=function(){zcal.timezones.length>0?h():g({mode:"mypref",callback:function(){h()}})},g=function(a){ZCL_XHR("/cal/timez.do",function(b){zcal.timezones=ZCL_Evl(1,b.responseText),a.callback&&a.callback()})},h=function(){var a="<select>";for(var b in zcal.timezones)for(var c in zcal.timezones[b]){var d=zcal.cdata.opt.TIM==c?"selected":"";a+="<option "+d+" value="+c+' id="zc_tzOp">'+unescape(zcal.timezones[b][c])+" ("+c+")"+"</option>"}return a+="</select>",a},i=function(){var a='<input value="'+unescape(zcal.cdata.opt.CTIM)+'" type="text"  rel='+zcal.cdata.opt.TIM+' readonly="" id="zcl_TZ">';return a},j=function(){var a='<select class="select">';return a+="<option selected value="+zcal.cdata.opt.TIM+">"+unescape(zcal.cdata.opt.CTIM)+"</option>",a+="</select>",a},k=function(){l()?n():_zm.succErrMsg("i","No Changes made in My Preferences")},l=function(){var a=zcal.cdata.opt,b,c,d,e,f;if($("#zcl_TZ")){var g=$("#zcl_TZ")[0].getAttribute("rel");if(g&&g!=a.TIM)return!0}var b=["DF","TF","DEF","WK","WS","WE"];for(var h=0;h<b.length;h++)if(a[b[h]]!=parseInt($("#zcl_"+b[h]).parent()[0].getAttribute("rel"),10))return!0;var i=["HS","HE"];for(var h=0;h<i.length;h++)if(a[i[h]]!=parseInt($("#zcl_"+i[h])[0].getAttribute("rel"),10))return!0;f=$("#zcl_nonWHr").find("[rel=on]").length==1?1:0;var j=$("#zcl_autoInv"),k=$("#zcl_showDE"),l=$("#zcl_remNotify"),m;return m=j.parent()[0].getAttribute("rel"),c=m,d=$("#zcl_showDE").find("[rel=on]").length==1?1:0,e=$("#zcl_remNotify").find("[rel=on]").length==1?1:0,a.DDE!=d||a.SIE!=c||a.REM!=e||a.NWTB!=f?!0:!1},m=function(){var a=zcal.cdata.opt;e={};var b,c,d;b=[["DF",3],["TF",1],["DEF",4],["WK",6],["WS",6],["WE",6]],c=parseInt($("#zcl_HS")[0].getAttribute("rel"),10),d=parseInt($("#zcl_HE")[0].getAttribute("rel"),10);if(c>=d)return _zm.succErrMsg("e",zcal.i18n.wkhretgrwkhrst),!1;e.HS=c,e.HE=d;var f=$("#zcl_TZ")?$("#zcl_TZ")[0].getAttribute("rel"):null;f&&f!=zcal.cdata.opt.TIM?(e.TIM=f,e.CTIM=$("#zcl_TZ")[0].value):e.TIM=zcal.cdata.opt.TIM;for(var g=0;g<b.length;g++){var h=b[g][0],i=parseInt($("#zcl_"+h).parent()[0].getAttribute("rel"),10);e[h]=i>=0&&i<=b[g][1]?i:a[h]}var j=$("#zcl_autoInv"),k=$("#zcl_showDE"),l=$("#zcl_remNotify"),m;return m=m=j.parent()[0].getAttribute("rel"),e.SIE=m,e.DDE=$("#zcl_showDE").find("[rel=on]").length==1?1:0,e.REM=$("#zcl_remNotify").find("[rel=on]").length==1?1:0,e.NWTB=$("#zcl_nonWHr").find("[rel=on]").length==1?1:0,!0},n=function(){var a=zcal.cdata.opt;m()&&ZCL_XHR("/cal/set.do?type=gen&obj="+encodeURIComponent('{"DF":'+e.DF+',"TF":'+e.TF+',"DEF":'+e.DEF+',"WK":'+e.WK+',"WS":'+e.WS+',"WE":'+e.WE+',"HS":'+e.HS+',"HE":'+e.HE+',"MTO":'+a.MTO+', "TH":'+a.TH+',"FS":'+a.FS+',"TIM":"'+e.TIM+'", "DDE":'+e.DDE+', "SIE":'+e.SIE+',"REM":'+e.REM+',"NWTB":'+e.NWTB+"}"),o)},o=function(a){var b=ZCL_Evl(1,a.responseText);if(b.status=="success"){var c=zcal.cdata.opt;b.TZLBL&&(c.TZLBL=b.TZLBL);for(var d in e)c[d]=e[d];_zm.succErrMsg("s",zcal.i18n.changessaved)}},p=function(a){var b=[],c=a.menuItems||[];c.forEach(function(a){var c=a.value,d=a.text;b.push({htm:"<div>"+d+"</div>",data:{value:c,text:d}})});var d=$.Deferred();return a.list=b,a.clk=function(a,b,c){d.resolve(a,b.parentNode,c)},a.onHide=function(){d.reject()},b.length?zmsuite.showMenu(a):d.reject(),d.fail(zmUtil.hideMenu),d.promise()}},"MailSuite.Apps.CalendarGenerals"),_defineSettingsModule("CalendarGenerals",function(a,b){"use strict";var c=b("Platform.Components"),d=c.SettingAppManager,e=b("Platform.System.Utils"),f="calendar-generals",g="calendar-generals",h="MailSuite.Apps.CalendarGenerals.AppCore",i="MailSuite.Apps.CalendarGenerals.CalendarGeneralView",j,k=function(){return b(i)},l=function(){var a=$.Deferred();return zmApp.loadCalendar("/calendar/settings",a),a.promise()},m=function(){var a=$.Deferred(),b=e.makeDeferred();return typeof zcal=="undefined"?l().done(function(){k().initialize({process:b})}).fail(b.reject):k().initialize({process:b}),b.promise()},n=function(){var a=e.makeDeferred();return k().uninitialize({process:a}),a.promise()},o=function(){var a=k();return a._getGeneralView()},p=function(){return null},q=function(){j=d.create(f,{attributes:{page:g,isReactApp:!1},initialize:m,uninitialize:n,getView:o,handleContainerEvent:p})},r=function(){q(),a.App=j};r()},"MailSuite.Apps"),function(a){"use strict";var b="calendar-generals",c="calendar-generals",d={TIME_ZONE:"time-zone",DATE_FORMAT:"date-format",TIME_FORMAT:"time-format",DEFAULT_VIEW:"default-view",AUTOMATIC_INVI:"automatic-invi",REMINDER_NOTIFI:"reminder-notifi"},e={timezone:{cardItem:{title:"Time Zone"}},dateformat:{cardItem:{title:"Date Format"}},timeformat:{cardItem:{title:"Time Format"}},defaultview:{cardItem:{title:"Defaut View"}},automaticinvi:{cardItem:{title:"Automatic invitation"}},remindernotifi:{cardItem:{title:"Reminder notification"}}},f=a("Platform.Components"),g=a("Platform.Entities"),h=a("Platform.System.Utils"),i=f.SettingCardItemManager,j=g.SettingCardItem,k=j.Types,l=i.create(d.TIME_ZONE,{props:{title:e.timezone.cardItem.title,value:""},attributes:{type:k.LabelValue,card:b},primaryAction:i.CardItemActions.OpenPageAction(c,{showSection:d.TIME_ZONE})}),m=i.create(d.DATE_FORMAT,{props:{title:e.dateformat.cardItem.title,value:""},attributes:{type:k.LabelValue,card:b},primaryAction:i.CardItemActions.OpenPageAction(c,{showSection:d.DATE_FORMAT})}),n=i.create(d.TIME_FORMAT,{props:{title:e.timeformat.cardItem.title,value:""},attributes:{type:k.LabelValue,card:b},primaryAction:i.CardItemActions.OpenPageAction(c,{showSection:d.TIME_FORMAT})}),o=i.create(d.DEFAULT_VIEW,{props:{title:e.defaultview.cardItem.title,value:""},attributes:{type:k.LabelValue,card:b},primaryAction:i.CardItemActions.OpenPageAction(c,{showSection:d.DEFAULT_VIEW})}),p=i.create(d.AUTOMATIC_INVI,{props:{title:e.automaticinvi.cardItem.title,value:""},attributes:{type:k.LabelValue,card:b},primaryAction:i.CardItemActions.OpenPageAction(c,{showSection:d.AUTOMATIC_INVI})}),q=i.create(d.REMINDER_NOTIFI,{props:{title:e.remindernotifi.cardItem.title,value:""},attributes:{type:k.LabelValue,card:b},primaryAction:i.CardItemActions.OpenPageAction(c,{showSection:d.REMINDER_NOTIFI})}),r=function(){};r()}(zmail.Settings.Modules.import),_defineSettingsModule("Pages",function(a,b){"use strict";var c="email-notify",d=b("Platform.Components"),e=b("Platform.Entities"),f={title:"Email Notification"},g=d.SettingPageManager,h=e.SettingPage,i=h.Types,j=g.create(c,{props:{title:f.title},attributes:{card:c,category:"calendar",type:i.Title,pageCSSClass:"email-notify-page",appContainer:!0}});a.CalendarEmailNotify=j},"MailSuite"),_defineSettingsModule("Cards",function(a,b){"use strict";var c="email-notify",d="calendar",e="email-notify",f={cardTitle:"Email Notification"},g=b("Platform.Components"),h=g.SettingCardManager,i=h.create(c,{props:{openable:!0,addToSearch:!1,title:f.cardTitle},state:{hidden:!1},attributes:{category:d},openAction:h.CardActions.OpenPageAction(e)});a.CalendarEmailNotify=i},"MailSuite"),_defineSettingsModule("EmailNotifyView",function(a,b){"use strict";var c=function(a){a=a||{};var b=a.process;b.resolve()},d=function(a){a=a||{};var b=a.process;b.resolve()},e=b("MailSuite.Apps.CalendarGenerals.CalendarGeneralView"),f=$(document.createDocumentFragment()),g=$('<li class="SC_setbox zcl_setbox"></li>'),h={},i=function(){var a=$("<ul></ul>"),b=zcal.cdata.opt,c="",d=b.MT,e=b.MTO;if(b.CMAIL&&b.CMAIL!="")c+='<li><div class="startup help zcl_mb">',c+="<p>"+v(zcal.i18n.revertmsg1,['<a class="SC_lnk">'+b.CMAIL+"</a>",'<a class=" link SC_lnk" data-marker="resendEmail">',"</a>"])+" </p><p>"+v(zcal.i18n.revertmsg2,['<a class=" link SC_lnk">'+e+"</a>"])+"</p></div></div></li>",c+='<li><div><div class="zm_comp"><span data-marker="reverttoPrevious">'+zcal.i18n.rebutton+"</span></div></li>";else{c+='<li class="SC_cal_prefer">';if(zcal.emlNfy=="1"){var f=b.REMID.split(",");c+="<h3>"+zcal.i18n.emailaddress+'</h3><div class="startup"><p><span  class="SC_select"><input type="text" value='+e+" rel="+e+' readonly="" id="zcl_MTO"></span></p></div><div class="startup help zcl_mb"> <em><img src='+zmail.imgPath+'lightbulb-info.png class="info-message"></em><span>'+zcal.i18n.emailaddress_msg2+"</span></div>"}else c+="<h3>"+zcal.i18n.notify_emailaddress+'</h3><div id="zcl_emailD"><div class="startup zcl_mb"><p><span>'+e,zcal.emlNfy!="0"&&zcal.emlNfy!="1"&&(c+='<a class="link SC_lnk" data-marker="changeEmailNotify">'+zcal.i18n.change+"</a>"),c+='</span></p></div></div><div class="startup help zcl_mb"> <em><img src='+zmail.imgPath+'lightbulb-info.png class="info-message"></em><span>'+zcal.i18n.emailaddress_msg1+"</span></div>";c+="<h3>"+zcal.i18n.email_format+"</h3>",c+='<div class="section-content startup" ><div class="fontSettings" rel='+b.MT+'> <em id="enotifyType" rel=0 class="'+(d==0?"sel":"")+'">'+zcal.i18n.sendhtml+'</em><em id="enotifyType" rel=1 class="'+(d==1?"sel":"")+'">'+zcal.i18n.sendplaintext+"</em></div></div>",c+="</li>";if(d==0){c+="<li><h3>"+zcal.i18n.agenda_notify+"</h3><div class='section-content startup'><div class='fontSettings mb' rel='"+b.AI+"'>";for(var h in zcal.AGENDA_INTERVAL)c+='<em id="zcl_AI" rel="'+h+'" class="'+(b.AI==h?"sel":"")+'">'+zcal.AGENDA_INTERVAL[h]+"</em>";c+="</div></div></li>"}}a.append($(c)),a.find("#enotifyType").on("click",function(){var a=$(this);a.parent().find("em").removeClass("sel").addClass(""),a.removeClass("").addClass("sel"),a.parent()[0].setAttribute("rel",a[0].getAttribute("rel")),q(a.index()),k()}),a.find("#zcl_AI").on("click",function(){var a=$(this);a.parent().find("em").removeClass("sel").addClass(""),a.removeClass("").addClass("sel"),a.parent()[0].setAttribute("rel",a[0].getAttribute("rel")),k()});var i=a.find("[data-marker=agendaNotify]").removeAttr("data-marker");i.length&&i.on("click",function(a){var b=[];for(var c in zcal.AGENDA_INTERVAL){var d={};d.value=c,d.text=zcal.AGENDA_INTERVAL[c],b.push(d)}var e=a.target;w({menuItems:b,par:a.target,parWidth:!0}).then(function(a){e.value=a.text,e.setAttribute("rel",a.value),zmUtil.hideMenu()})});var j=a.find("#zcl_MTO");j.length&&j.on("click",function(a){var c=b.REMID.split(","),d=[];for(var e in c){var f={};f.value=e,f.text=c[e],d.push(f)}var g=a.target;w({menuItems:d,par:a.target,parWidth:!0}).then(function(a){g.value=a.text,g.setAttribute("rel",a.value),zmUtil.hideMenu()})});var l=a.find("[data-marker=notifyType]").removeAttr("data-marker");l.length&&l.on("click",function(a){var b=$(this);b.parent().find("i").removeClass("msi-option").addClass("msi-unoption"),b.find("i").removeClass("msi-unoption").addClass("msi-option"),q(b.index())});var n=a.find("[data-marker=resendEmail]").removeAttr("data-marker");n.length&&n.on("click",function(a){ZCL_XHR("/cal/set.do?type=resendemail",t)});var o=a.find("[data-marker=reverttoPrevious]").removeAttr("data-marker");o.length&&o.on("click",function(a){ZCL_XHR("/cal/set.do?type=revert",u)});var p=a.find("[data-marker=changeEmailNotify]").removeAttr("data-marker");p.length&&p.on("click",function(a){m()});var r=a.find("[data-marker=saveENotify]").removeAttr("data-marker");return r.length&&r.on("click",function(a){k()}),g.empty().append(a),g},j=function(){var a=zcal.cdata.opt,b=$("#enotifyType");if($("#zcl_MTO")[0]){var c=$("#zcl_MTO")[0].value;if(!p(c))return _zm.succErrMsg("e",zcal.i18n.entervalidemailid),$("#zcl_MTO").focus(),!1;if(c!=a.MTO)return!0}if(b.length){var d=parseInt($("#enotifyType").parent()[0].getAttribute("rel"));if(a.MT!=d)return!0;var e=-1;d===0&&(e=$("#zcl_AI").parent()[0].getAttribute("rel"));if(e!=a.AI)return!0}return!1},k=function(){if(j()){var a=zcal.cdata.opt,b=$("#enotifyType");h={},h.MTO=$("#zcl_MTO")[0]?$("#zcl_MTO")[0].value:a.MTO,h.MT=b.length?$("#enotifyType").parent()[0].getAttribute("rel"):a.MT,h.AI=h.MT==0?$("#zcl_AI").parent()[0].getAttribute("rel"):-1,ZCL_XHR("/cal/set.do?type=notify&mailto="+h.MTO.zcalescape()+"&as="+h.MT+"&agenda_notify="+h.AI,l)}},l=function(a){var b=ZCL_Evl(1,a.responseText);b.status=="success"&&(_zm.succErrMsg("s",zcal.i18n.successedit),zcal.cdata.opt.MTO=b.MTO,zcal.cdata.opt.MT=b.MT,zcal.cdata.opt.AI=b.AI)},m=function(){var a=$("<li></li>"),b="";b+='<div class="startup"><p><span class="mtb"><span class="SC_select zcl_Sem fn"><input class="inputShadow" id="zcl_MTO" value="'+zcal.cdata.opt.MTO+'" placeholder="" type="text"></span></span></p></div><div class="zcl_senmr"><div class="zm_comp"><span data-marker="confirmEmail">Confirm</span></div><div class="zm_comp"><span data-marker="cancelEmail">Cancel</span></div>',a.append($(b));var c=a.find("[data-marker=confirmEmail]").removeAttr("data-marker");c&&c.on("click",function(){n()});var d=a.find("[data-marker=cancelEmail]").removeAttr("data-marker");return d&&d.on("click",function(){i()}),g.find("#zcl_emailD").empty().append(a),g},n=function(){var a=zcal.cdata.opt,b=$("#zcl_MTO")[0].value.trim();if(a.CMAIL&&a.CMAIL!=""&&b!=a.CMAIL||a.CMAIL==undefined||a.CMAIL==""&&b!=a.MTO){if(!p(b))return _zm.succErrMsg("e",zcal.i18n.entervalidemailid),$("#zcl_MTO").focus(),!1;a.CMAIL=b,ZCL_XHR("/cal/set.do?type=changeemail&mailto="+b.zcalescape(),o)}else i()},o=function(a){var b=$.Deferred(),c=ZCL_Evl(1,a.responseText);c.MTO!=""&&c.CMAIL==""?(zcal.cdata.opt.MTO=c.MTO,zcal.cdata.opt.CMAIL=c.CMAIL,c.MSG!=undefined?c.MSG=="INVALID_ID"?_zm.succErrMsg("e",zcal.i18n.nonregisteredemailid):c.MSG=="NOPERM"&&_zm.succErrMsg("e",zcal.i18n.nonregisteredemailid):_zm.succErrMsg("s",zcal.i18n.mailconfirmed)):(zcal.cdata.opt.CMAIL=c.CMAIL,_zm.succErrMsg("s",zcal.i18n.verifymailsend)),i()},p=function(a){a=a.trim();var b=/^[\w]([\w\-\.\+\'\/]*)@([\w\-\.]*)(\.[a-zA-Z]{2,22}(\.[a-zA-Z]{2}){0,2})$/i;return b.test(a)},q=function(a){if(a===0){var b=zcal.cdata.opt;if($("#zcl_AI").length==0){var c=$("<li></li>"),d="";d+="<h3>"+zcal.i18n.agendanotification+"</h3><div class='section-content startup'><div class='fontSettings mb' rel='"+b.AI+"'>";for(var e in zcal.AGENDA_INTERVAL)d+='<em id="zcl_AI" rel="'+e+'" class="'+(b.AI==e?"sel":"")+'">'+zcal.AGENDA_INTERVAL[e]+"</em>";d+="</div></div>",c.append($(d)),c.find("#zcl_AI").on("click",function(){var a=$(this);a.parent().find("em").removeClass("sel").addClass(""),a.removeClass("").addClass("sel"),a.parent()[0].setAttribute("rel",a[0].getAttribute("rel")),k()}),$(".SC_cal_prefer").after(c)}}else $("#zcl_AI").length>0&&$("#zcl_AI").parents("LI")[0].remove()},r=function(a,b,c){var d='<select id="'+a+'">';for(var e in c)d+="<option "+(e==b?"selected='selected'":"")+" value="+e+">"+c[e]+"</option>";return d+="</select>",d},s=function(a,b,c){var d='<select class="select" id="'+a+'">';for(var e in c)d+="<option "+(e==b?"selected":"")+' value="'+e+'">'+c[e]+"</option>";return d+="</select>",d},t=function(a){var b=ZCL_Evl(1,a.responseText);zcal.cdata.opt.CMAIL=b.CMAIL,_zm.succErrMsg("s",zcal.i18n.mailsendsuccess)},u=function(a){var b=ZCL_Evl(1,a.responseText);zcal.cdata.opt.CMAIL=b.CMAIL,i()},v=function(a,b){return a.replace(/\{[0-9]\}/g,function(a){return a=a.replace(/[\{\}]/g,""),b[parseInt(a)]})},w=function(a){var b=[],c=a.menuItems||[];c.forEach(function(a){var c=a.value,d=a.text;b.push({htm:"<div>"+d+"</div>",data:{value:c,text:d}})});var d=$.Deferred();return a.list=b,a.clk=function(a,b,c){d.resolve(a,b.parentNode,c)},a.onHide=function(){d.reject()},b.length?zmsuite.showMenu(a):d.reject(),d.fail(zmUtil.hideMenu),d.promise()};a.initialize=c,a.uninitialize=d,a.getEmailNotifyView=i},"MailSuite.Apps.CalendarEmailNotify"),_defineSettingsModule("EmailNotify",function(a,b){"use strict";var c=b("Platform.Components"),d=c.SettingAppManager,e=b("Platform.System.Utils"),f="email-notify",g="email-notify",h="MailSuite.Apps.CalendarEmailNotify.EmailNotifyView",i,j=function(){return b(h)},k=function(){var a=$.Deferred();return zmApp.loadCalendar("/calendar/settings",a),a.promise()},l=function(){var a=$.Deferred(),b=e.makeDeferred();return typeof zcal=="undefined"?k().done(function(){j().initialize({process:b})}).fail(b.reject):j().initialize({process:b}),b.promise()},m=function(){var a=e.makeDeferred();return j.uninitialize({process:a}),a.promise()},n=function(){var a=j();return a.getEmailNotifyView()},o=function(){return null},p=function(){i=d.create(f,{attributes:{page:g,isReactApp:!1},initialize:l,uninitialize:m,getView:n,handleContainerEvent:o})},q=function(){p(),a.App=i};q()},"MailSuite.Apps"),function(a){"use strict";var b="email-notify",c="email-notify",d={EMAIL_ADDRESS:"email-address",AGENDA_NOTIFY:"agenda-notify"},e={emailaddress:{cardItem:{title:"Email Address"}},agendanotify:{cardItem:{title:"Agenda notification"}}},f=a("Platform.Components"),g=a("Platform.Entities"),h=a("MailSuite.Settings.Calendar"),i=a("Platform.System.Utils"),j=f.SettingCardItemManager,k=g.SettingCardItem,l=k.Types,m=j.create(d.EMAIL_ADDRESS,{props:{title:e.emailaddress.cardItem.title,value:""},attributes:{type:l.LabelAction,card:b},primaryAction:j.CardItemActions.OpenPageAction(c,{showSection:d.EMAIL_ADDRESS})}),n=j.create(d.AGENDA_NOTIFY,{props:{title:e.agendanotify.cardItem.title,value:""},attributes:{type:l.LabelAction,card:b},primaryAction:j.CardItemActions.OpenPageAction(c,{showSection:d.AGENDA_NOTIFY})}),o=function(){};o()}(zmail.Settings.Modules.import),_defineSettingsModule("Pages",function(a,b){"use strict";var c="calendar-import",d=b("Platform.Components"),e=b("Platform.Entities"),f={title:"Import"},g=d.SettingPageManager,h=e.SettingPage,i=h.Types,j=g.create(c,{props:{title:f.title},attributes:{card:c,category:"calendar",type:i.Title,pageCSSClass:"calendar-import-page",appContainer:!0}});a.CalendarImport=j},"MailSuite"),_defineSettingsModule("Cards",function(a,b){"use strict";var c="calendar-import",d="calendar",e="calendar-import",f={cardTitle:"Import"},g=b("Platform.Components"),h=g.SettingCardManager,i=h.create(c,{props:{openable:!0,title:f.cardTitle,addToSearch:!1},state:{hidden:!1},attributes:{category:d},openAction:h.CardActions.OpenPageAction(e)});a.CalendarImport=i},"MailSuite"),_defineSettingsModule("ImportView",function(a,b){"use strict";var c=function(a){a=a||{};var b=a.process;b.resolve(),r()},d=function(a){a=a||{};var b=a.process;b.resolve(),s()},e=function(){var a=$(document.createDocumentFragment()),b=zcal.cdata.opt,c=zcal.cdata.calOrdArr,d="",e=$("<li class='SC_setbox zcl_setbox'></li>"),k=$("<ul></ul>");d+="<li>",d+="<h3>"+zcal.i18n.importfromfile+'</h3><div class="zm_impexp pb40">',d+='<iframe name="zcl_imp" id="zcl_imp" style="display:none"></iframe><form action="/mail/cal/import.do" method="post" enctype="multipart/form-data" target="zcl_imp" onSubmit="return false;" id="zcl_impEve" name="zcl_impEve">',d+='<input id="zcl_impCkey" value="0" name="zcl_impCkey" type="hidden"/>',d+='<input id="zcl_owrEvent" value="false" name="zcl_owrEvent" type="hidden"/>',d+='<input id="zcl_incAtt" value="false" name="zcl_incAtt" type="hidden"/>',d+='<input id="zcl_incRem" value="false" name="zcl_incRem" type="hidden"/>',d+='<input id="zcl_mkPvt" value="false" name="zcl_mkPvt" type="hidden"/>',d+='<div id="importDiv" style="display:;"> <div class="zm_impexpDragdiv"><div id="choose1" data-marker="calimport"><span> <b>'+zcal.i18n.selfiletoimport+'</b> or Drag files here to upload</span></div></div></div><input type="file" id="zcl_impFil" name="zcl_impFil" style="display:none"/>',d+="</form>",d+='<div class="SC_select default">'+m()+"</div>",d+='<div class="zcl_mb">',d+='<ul class="zcl_Sckls" id="zcl_impMoreOpt" class="moreOptions">',d+='<li id="zcl_impOvr"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.overrideevent+"</span></div></li>",d+='<li id="zcl_impAtt"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.includeattendees+"</span></div></li>",d+='<li id="zcl_impRem"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.includereminder+"</span></div></li>",d+='<li id="zcl_impPvt"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.markallasprivate+"</span></div></li>",d+="</ul></div>",d+="</div></div>",d+='<div class="zm_comp"><span data-marker="calImportfile">'+zcal.i18n.import+"</span></div>",d+="</li>",d+="<li>",d+="<h3>"+zcal.i18n.importfromurl+'</h3><div class="zm_impexp pb40"><div class="zcl_mb"><div class="startup zcl_mb"><p><span class="mtb">'+zcal.i18n.providecalurl+'<span class="SC_select zcl_Sem fn"><input class="inputShadow" id="zcl_impUrl" placeholder="" type="text"/></span></span></p><div class="SC_select default">'+p()+"</div></div></div>",d+='<div class="zcl_mb">',d+='<ul class="zcl_Sckls"  id="zcl_impMoreOpt1" class="moreOptions">',d+='<li id="zcl_impOvr"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.overrideevent+"</span></div></li>",d+='<li id="zcl_impAtt"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.includeattendees+"</span></div></li>",d+='<li id="zcl_impRem"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.includereminder+"</span></div></li>",d+='<li id="zcl_impPvt"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.markallasprivate+"</span></div></li>",d+="</ul></div></div>",d+='<div class="startup help zcl_mb"><em><img src='+zmail.imgPath+'lightbulb-info.png class="info-message"></em><span>'+zcal.i18n.provide_icalurl+"</span></div>",d+='<div class="zm_comp"><span data-marker="calImporturl">'+zcal.i18n.import+"</span></div>",d+="</li>",k.append($(d)),k.find("#zcl_impOvr").off("click").on("click",function(a){var b=$(this),c;c=b.find("i"),h(c)}),k.find("#zcl_impAtt").off("click").on("click",function(a){var b=$(this),c;c=b.find("i"),h(c)}),k.find("#zcl_impRem").off("click").on("click",function(a){var b=$(this),c;c=b.find("i"),h(c)}),k.find("#zcl_impPvt").off("click").on("click",function(a){var b=$(this),c;c=b.find("i"),h(c)}),e.append(k);var l=e.find("#zcl_impCal"),n=e.find("select");n.length&&n.change(function(){this.setAttribute("datachange","true");var a=this.value;a==0&&ZCL_createCal()});var o=e.find("[data-marker=calImportfile]").removeAttr("data-marker");o.length&&o.on("click",function(a){i()});var q=e.find("[data-marker=calImporturl]").removeAttr("data-marker");q.length&&q.on("click",function(a){j()});var r=e.find("#zcl_impMoreOptTxt");r.off("click").on("click",function(a){f()});var s=e.find("#zcl_impMoreOptTxt1");return s.off("click").on("click",function(a){g()}),e.find("#choose1").on("click",function(a){var b=a.target||a.srcElement;b.className!="SC_icn"&&b.className!="msi-close"&&$("#zcl_impFil").click()}),e.find("#zcl_impFil").on("change",function(a){var b=a.target.files[0].size/1024;b=Math.round(b*100)/100;var c=$("#choose1").find("span"),d=$('<div class="zmCAt"></div>'),e='<div class="zmL SC_Pbar"><div class="zmLst"><div class="zmDtl"><div class="zmSze"><span class="sum">'+b+'KB</span></div><div class="zmFrm"><span>'+a.target.files[0].name+'</span></div><div class="zmImg"><i></i></div><div class="SC_icn"><i class="msi-close"></i></div></div></div></div></div>';d[0].innerHTML=e,c[0].innerHTML="",d.find(".SC_icn").on("click",function(){$("#zcl_impFil")[0].value="",d[0].innerHTML="",c[0].innerHTML="<b>Choose the ICS file to import</b> or Drag files here to upload"}),c.append(d)}),a.append(e),a},f=function(){var a=$("#zcl_impMoreOpt"),b=$("#zcl_impMoreOptTxt"),c,d,e,f;return c=$('<li id="zcl_impOvr"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.overrideevent+"</span></div></li>"),c.off("click").on("click",function(a){var b=$(this),c;c=b.find("i"),h(c)}),a.append(c),d=$('<li id="zcl_impAtt"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.includeattendees+"</span></div></li>"),d.off("click").on("click",function(a){var b=$(this),c;c=b.find("i"),h(c)}),a.append(d),e=$('<li id="zcl_impRem"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.includereminder+"</span></div></li>"),e.off("click").on("click",function(a){var b=$(this),c;c=b.find("i"),h(c)}),a.append(e),f=$('<li id="zcl_impPvt"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.markallasprivate+"</span></div></li>"),f.off("click").on("click",function(a){var b=$(this),c;c=b.find("i"),h(c)}),a},g=function(){var a=$("#zcl_impMoreOpt1"),b=$("#zcl_impMoreOptTxt1");if(!a.is(":visible")){var c,d,e,f;c=$('<li id="zcl_impOvr"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.overrideevent+"</span></div></li>"),c.off("click").on("click",function(a){var b=$(this),c;c=b.find("i"),h(c)}),a.append(c),d=$('<li id="zcl_impAtt"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.includeattendees+"</span></div></li>"),d.off("click").on("click",function(a){var b=$(this),c;c=b.find("i"),h(c)}),a.append(d),e=$('<li id="zcl_impRem"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.includereminder+"</span></div></li>"),e.off("click").on("click",function(a){var b=$(this),c;c=b.find("i"),h(c)}),a.append(e),f=$('<li id="zcl_impPvt"><div><i class="msi-uncheck"></i><span class="pl5">'+zcal.i18n.markallasprivate+"</span></div></li>"),f.off("click").on("click",function(a){var b=$(this),c;c=b.find("i"),h(c)}),a.append(f),b.text(zcal.i18n.hideoptions),a.show()}else a.html(""),b.text(zcal.i18n.moreoptions),a.hide()},h=function(a){a.hasClass("msi-check")?a.removeClass("msi-check").addClass("msi-uncheck"):a.removeClass("msi-uncheck").addClass("msi-check")},i=function(){var a,b,c=!1,d=!1,e=!1,f=!1,g=$("#zcl_impFil").val().trim(),h=$("#zcl_impMoreOpt");b=g.substr(g.lastIndexOf("."));if(b!=".ics")return zmUtil.succErrMsg("e",zcal.i18n.sel_validicsfile),!1;if(h.is(":visible")){var i=$("#zcl_impOvr").find("i"),j=$("#zcl_impAtt").find("i"),k=$("#zcl_impRem").find("i"),l=$("#zcl_impPvt").find("i");c=i.hasClass("msi-check")?!0:!1,d=j.hasClass("msi-check")?!0:!1,e=k.hasClass("msi-check")?!0:!1,f=l.hasClass("msi-check")?!0:!1}a=$("#zcl_impCal").val();if(a==undefined)return zmUtil.succErrMsg("e",zcal.i18n.selvacalnam),!1;$("#zcl_impCkey").val(a);var m=document.cookie,n;m=m.substring(m.indexOf("aprmjrnpkcrkks=")+15,m.length),n=m.indexOf(";")!=-1?m.substring(0,m.indexOf(";")):m,document.zcl_impEve.appendChild(_zm.getDOM(["INPUT",{attrs:{type:"hidden",name:"mstpcrdhkur",value:n}}])),$("#zcl_owrEvent").val(c),$("#zcl_incAtt").val(d),$("#zcl_incRem").val(e),$("#zcl_mkPvt").val(f),document.zcl_impEve.submit()},j=function(){var a,b,c,d=$("#zcl_impUrl")[0].value.trim(),e=!1,f=!1,g=!1,h=!1,i=$("#zcl_impMoreOpt1");c=/^(http|https|webcal|webcals)\:\/\/[-.\w]*(\/?)([a-zA-Z0-9\-\.\?\,\:\'\/\\\+=&amp;%\$#_@]*)?$/i;if(!c.test(d))return zmUtil.succErrMsg("e",zcal.i18n.provide_httpurl),!1;var j=$("#zcl_impMoreOpt1").find("#zcl_impOvr").find("i"),l=$("#zcl_impMoreOpt1").find("#zcl_impAtt").find("i"),m=$("#zcl_impMoreOpt1").find("#zcl_impRem").find("i"),n=$("#zcl_impMoreOpt1").find("#zcl_impPvt").find("i");e=j.hasClass("msi-check")?!0:!1,f=l.hasClass("msi-check")?!0:!1,g=m.hasClass("msi-check")?!0:!1,h=n.hasClass("msi-check")?!0:!1,a=$("#zcl_impCal1").val();if(a==undefined)return zmUtil.succErrMsg("e",zcal.i18n.selvacalnam),!1;b=$("#zcl_impCal option:selected").data("cid");var o="/cal/impurl.do?url="+encodeURIComponent(d)+"&impCkey="+a+"&incAtt="+f+"&owrEvent="+e+"&incRem="+g+"&mkPvt="+h+(b?"&calId="+b:"");ZCL_XHR(o,function(a){var b=ZCL_Evl(1,a.responseText);k(b)})},k=function(a){a==""?zmUtil.succErrMsg("e",zcal.i18n.failimport):a.PCNT==0?zmUtil.succErrMsg("e",zcal.i18n.failimport):(a.TCNT>"10000"?zmUtil.succErrMsg("e",zcal.i18n.importfailure_exceedlimit):(zmUtil.succErrMsg("s",zcal.i18n.cal_successimport+". "+zcal.i18n.numofeve_processed+" : "+(a.PCNT==undefined?0:a.PCNT)+". "+zcal.i18n.imported+" : "+(a.ACNT==undefined?0:a.ACNT)),zcalEvents.loadMonthData()),$("#zcl_impUrl")[0].value="")},l=function(a){var b=[],c=a.menuItems||[];c.forEach(function(a){var c=a.value,d=a.text;b.push({htm:"<div>"+d+"</div>",data:{value:c,text:d}})});var d=$.Deferred();return a.list=b,a.clk=function(a,b,c){d.resolve(a,b.parentNode,c)},a.onHide=function(){d.reject()},b.length?zmsuite.showMenu(a):d.reject(),d.fail(zmUtil.hideMenu),d.promise()},m=function(){var a='<select id="zcl_impCal" datachange = "false">';return a+=n(),a+="</select>",a},n=function(a){var b=zcal.cdata.calOrdArr,c,d="";return b.forEach(function(b){var c=zcal.cdata.calLst;c[b][8]=="1"&&(d+='<option value="'+c[b][9]+'" data-cid="'+b+'" '+(b==a?"selected":"")+">"+ZCL_getHTML(c[b][0])+"</option>")}),b.length<100&&(d+='<option value="0">'+zcal.i18n.newcal+"</option>"),d},o=function(a,b){var c=$("#zcl_impCal")[0].getAttribute("datachange")=="true"?$("#zcl_impCal"):$("#zcl_impCal1");c[0].setAttribute("datachange","false");var d=$("#zcl_impCal"),e;e=b&&b.calid?n(b.calid):n(),e!=""&&(c.empty(),c.html(e))},p=function(a){var b='<select id="zcl_impCal1" datachange = "false">';return b+=q(),b+="</select>",b},q=function(a){var b=zcal.cdata.calOrdArr,c,d="";return b.forEach(function(b){var c=zcal.cdata.calLst;c[b][8]=="1"&&(d+='<option value="'+c[b][9]+'" data-cid="'+b+'" '+(b==a?"selected":"")+">"+ZCL_getHTML(c[b][0])+"</option>")}),b.length<100&&(d+='<option value="0">'+zcal.i18n.newcal+"</option>"),d},r=function(){$.subscribe("/calendar/added",a.updCalSel),$.subscribe("/calendar/updated",a.updCalSel),$.subscribe("/calendar/deleted",a.updCalSel),$.subscribe("/calendar/statusChanged",a.updCalSel)},s=function(){$.unsubscribe("/calendar/added",a.updCalSel),$.unsubscribe("/calendar/updated",a.updCalSel),$.unsubscribe("/calendar/deleted",a.updCalSel),$.unsubscribe("/calendar/statusChanged",a.updCalSel)};a.initialize=c,a.uninitialize=d,a.getImportView=e,a.updCalSel=o},"MailSuite.Apps.CalendarImport"),_defineSettingsModule("Import",function(a,b){"use strict";var c=b("Platform.Components"),d=c.SettingAppManager,e=b("Platform.System.Utils"),f="calendar-import",g="calendar-import",h="MailSuite.Apps.CalendarImport.ImportView",i,j=function(){return b(h)},k=function(){var a=$.Deferred();return zmApp.loadCalendar("/calendar/settings",a),a.promise()},l=function(){var a=$.Deferred(),b=e.makeDeferred();return typeof zcal=="undefined"?k().done(function(){j().initialize({process:b})}).fail(b.reject):j().initialize({process:b}),b.promise()},m=function(){var a=e.makeDeferred();return j().uninitialize({process:a}),a.promise()},n=function(){var a=j();return a.getImportView()},o=function(){return null},p=function(){i=d.create(f,{attributes:{page:g,isReactApp:!1},initialize:l,uninitialize:m,getView:n,handleContainerEvent:o})},q=function(){p(),a.App=i};q()},"MailSuite.Apps"),function(a){"use strict";var b="calendar-import",c="calendar-import",d={BY_FILE:"by-file",BY_URL:"by-url"},e={byfile:{cardItem:{title:"By File"}},byurl:{cardItem:{title:"By URL"}}},f=a("Platform.Components"),g=a("Platform.Entities"),h=a("MailSuite.Settings.Calendar"),i=a("Platform.System.Utils"),j=f.SettingCardItemManager,k=g.SettingCardItem,l=k.Types,m=j.create(d.BY_FILE,{props:{title:e.byfile.cardItem.title},attributes:{type:l.Action,card:b},primaryAction:j.CardItemActions.OpenPageAction(c,{showSection:d.BY_FILE})}),n=j.create(d.BY_URL,{props:{title:e.byurl.cardItem.title},attributes:{type:l.Action,card:b},primaryAction:j.CardItemActions.OpenPageAction(c,{showSection:d.BY_URL})})}(zmail.Settings.Modules.import),_defineSettingsModule("Pages",function(a,b){"use strict";var c="calendar-subscribe",d=b("Platform.Components"),e=b("Platform.Entities"),f={title:"Subscribe"},g=d.SettingPageManager,h=e.SettingPage,i=h.Types,j=g.create(c,{props:{title:f.title},attributes:{card:c,category:"calendar",type:i.Title,pageCSSClass:"calendar-subscribe-page",appContainer:!0}});a.CalendarSubscribe=j},"MailSuite"),_defineSettingsModule("Cards",function(a,b){"use strict";var c="calendar-subscribe",d="calendar",e="calendar-subscribe",f={cardTitle:"Subscribe"},g=b("Platform.Components"),h=g.SettingCardManager,i=h.create(c,{props:{openable:!0,title:f.cardTitle,addToSearch:!1},state:{hidden:!1},attributes:{category:d},openAction:h.CardActions.OpenPageAction(e)});a.CalendarSubscribe=i},"MailSuite"),_defineSettingsModule("SubscribeView",function(a,b){"use strict";var c=function(a){a=a||{};var b=a.process;b.resolve()},d=function(a){a=a||{};var b=a.process;b.resolve()},e=[],f="settings",g,h=[],i,j=function(){var a=$(document.createDocumentFragment()),b=$("<li class='SC_setbox zcl_setbox'></li>"),c=zcal.cdata.opt,d="",e=$("<ul></ul>");d+="<li>",d+="<h3>"+zcal.i18n.subscribe_weburl+'</h3><div class="startup zcl_mb"><p><span class="mtb">Enter URL :<span class="SC_select zcl_Sem fn"><input id="zcl_subLink" class="inputShadow" placeholder="" type="text"></span></span></p></div><div class="startup help zcl_mb"><em><img src='+zmail.imgPath+'lightbulb-info.png class="info-message"></em><span>'+zcal.i18n.provide_httpurl+'</span></div><div class="zm_comp"><span data-marker="subToCal">'+zcal.i18n.subscribe+"</span></div>",d+="</li>",d+="<li>",d+="<h3>"+zcal.i18n.subsribe_contacts+'</h3><div class="startup zcl_mb"><p><span class="mtb">'+zcal.i18n.provide_contemail+'<span class="SC_select zcl_Sem fn"><input class="inputShadow" placeholder="" type="text" id="zcl_fEmailId"></span></span></p></div><div class="startup help zcl_mb"><em><img src='+zmail.imgPath+'lightbulb-info.png class="info-message"></em><span>'+zcal.i18n.friends_email_note+'</span></div><div class="zm_comp"><span data-marker="listFCal">'+zcal.i18n.subscribe+"</span></div>",d+="</li>",d+="<li>",d+="<h3>"+zcal.i18n.subscribe_holiday+'</h3><div class="startup help zcl_mb"><em><img src='+zmail.imgPath+'lightbulb-info.png class="info-message"></em><span>'+zcal.i18n.holiday_note+'</span></div><div class="zm_comp"><span data-marker="holidaylist">'+zcal.i18n.showavaicountry+"</span></div>",d+="</li>",d+="<li>",d+="<h3>"+zcal.i18n.subscribe_group+"</h3>",d+='<div class="startup zcl_mb"><p><span>'+zcal.i18n.selgroupview+'</span><span class="SC_select" style=""><input data-marker="pergrouplist" type="text" value="select a group" id="zcl_gid" readonly=""></span></p></div>',d+='<div class="zm_comp"><span data-marker="listGCal">'+zcal.i18n.ok+"</span></div>",d+="</li>",e.append($(d)),b.append(e),a.append(b);var f=b.find("[data-marker=holidaylist]").removeAttr("data-marker");f.length&&f.on("click",function(){r()});var g=b.find("[data-marker=pergrouplist]").removeAttr("data-marker");g.length&&g.on("click",function(){var a=H(),b={},c=$(this),d;b.parentDOM=c.parent(),b.displayAs="popup",b.onSelect=function(a,b){I(c,a,b),d.hide()},b.onHide=function(){_zm.remove(_zm("#","zm_dropDown"))},b.dataCallback=function(){return a},d=zmUtil.createFLComp("generic",b),d.show()});var h=b.find("[data-marker=listFCal]").removeAttr("data-marker");h.length&&h.on("click",function(a){s()});var i=b.find("[data-marker=listGCal]").removeAttr("data-marker");i.length&&i.on("click",function(a){var b=$("#zcl_gid")[0].getAttribute("data-gid");if(b!=null){var c=zmail.Settings.MailSuite.App.Core.Framework;c.requestPreviewCard({getView:function(){return M(b)}}).done(function(a){a.card.show()})}else _zm.succErrMsg("e","select a group")});var j=b.find("[data-marker=subToCal]").removeAttr("data-marker");return j.length&&j.on("click",function(a){var b=$("#zcl_subLink")[0].value.trim();if(b=="")return _zm.succErrMsg("e",zcal.i18n.entervalidhttpurl),$("#zcl_subLink")[0].focus(),!1;B(b)}),a},k=function(a){var b=ZCL_Evl(1,a.responseText),c=b.mode;if(c=="list"){h=b.obj;var d=zmail.Settings.MailSuite.App.Core.Framework;d.requestPreviewCard({getView:function(){return m()}}).done(function(a){a.card.show()})}},l=$('<div class="SC_Twpr zcl_Twpr zcl_Twpr_list"></div>'),m=function(){var a=h,b=$('<div class="editFilterParent ht100p"></div>'),c=$('<div class="subDiv"></div>'),d=$('<div class="SC_ptit"><div><div class="impExpHeading">'+zcal.i18n.holidays+"</div></div></div>"),e=$('<div class="SC_filt_bottom SC_filt_bottomCustom"><div data-marker="loadingAnimation"></div></div>'),f=$('<div class="editFilterParent"></div>');for(var g=0;g<a.length;g++){var i=$('<div class="zmL"></div>'),j="";j+="<ul><li><span>"+ZCL_getHTML(a[g][0])+"</span></li>",j+='<li><div class="SC_PUbtm">',zcal.cdata.calOUids.indexOf(a[g][1])==-1?j+='<span data-val="Cancel"   data-marker="sub" id="sub">'+zcal.i18n.subscribe+"</span>":j+='<span class="sel" data-marker="unsub">'+zcal.i18n.unsubscribe+"</span>",j+="</div></li>",j+="</ul>",i.html(j);var k=i.find("[data-marker=sub]").removeAttr("data-marker");k.length&&n(k,a[g][1],a[g][0]);var m=i.find("[data-marker=unsub]").removeAttr("data-marker");m.length&&p(m,a[g][1]),b.append(i)}return e.append(b),c.append(d),c.append(e),l.empty().append(c),l},n=function(a,b,c){a.on("click",{uid:b,name:c},function(a){o(a.data.uid,a.data.name)})},o=function(a,b){var c="/cal/subHoli.do?mode=sub&huid="+encodeURIComponent(a)+"&loc="+b;ZCL_XHR(c,function(a){C(a)})},p=function(a,b){a.on("click",{uid:b},function(a){q(a.data.uid)})},q=function(a){ZCL_XHR("/cal/calAct.do?mode=delByUid&caluid="+encodeURIComponent(a),function(a){E(a)})},r=function(){if(h.length==0){var a="/cal/subHoli.do?mode=list";ZCL_XHR(a,function(a){k(a)})}else{var b=zmail.Settings.MailSuite.App.Core.Framework;b.requestPreviewCard({getView:function(){return m()}}).done(function(a){a.card.show()})}},s=function(){var a=$("#zcl_fEmailId").val();if(!ZCL_isEmail(a))return _zm.succErrMsg("e",zcal.i18n.entervalidemailid),ZCL_$("zcl_fEmailId").focus(),!1;ZCL_XHR("/cal/subCal.do?mode=pub-lst&mailId="+a.zcalescape(),function(a){t(a)})},t=function(a){var b=ZCL_Evl(1,a.responseText);if(b.mode=="pub-lst")if(b.result=="du"){var c=b.obj;e=[c.pub,c.pvt,b.mid],u()}else obj.result=="su"?_zm.succErrMsg("i",zcal.i18n.cannotsubtoowncal):obj.result=="nonzoho"?_zm.succErrMsg("i",ZCL_replaceComName(zcal.i18n.theuserdonthavezohoacc)):obj.result=="np"&&_zm.succErrMsg("e",zcal.i18n.cannotsubnonorgmemcal)},u=function(){var a=zmail.Settings.MailSuite.App.Core.Framework;a.requestPreviewCard({getView:function(){return x()}}).done(function(a){a.card.show()})},v=$('<div class="SC_Twpr zcl_Twpr zcl_Twpr_list"></div>'),w,x=function(){var a=e[0],b=e[1],c,d;w=$('<div id="subDiv1"></div>');var f=$('<div class="SC_ptit"><div class="impExpHeading">'+zcal.i18n.publiccal+"</div></div>"),g=$('<div class="SC_filt_bottom SC_filt_bottomCustom"></div>'),h=$('<div class = "editFilterParent ht100p"></div>');if(!F(a))for(var i in a){var j=$('<div class="zmL"></div>'),k="";k+="<ul><li><span>"+ZCL_getHTML(a[i][0])+"</span><em>"+(a[i][1]==1?zcal.i18n.viewonlyfreebusy:zcal.i18n.vieweventdetail)+"</em></li>",k+='<li><div class="SC_PUbtm">',zcal.cdata.calOUids.indexOf(a[i][2])==-1?k+='<span  data-val="Cancel" data-marker="sub">'+zcal.i18n.subscribe+"</span>":k+='<span class="sel" data-marker="unsub">'+zcal.i18n.unsubscribe+"</span>",k+="</div></li>",k+="</ul>",j.html(k);var l=j.find("[data-marker=sub]").removeAttr("data-marker");l.length&&l.on("click",{id:i},function(a){A(a.data.id)});var m=j.find("[data-marker=unsub]").removeAttr("data-marker");m.length&&m.on("click",{uid:a[i][2]},function(a){q(a.data.uid)}),h.append(j)}else{var n='<div class="zmL"><ul><li><em>'+zcal.i18n.calnotfound+"</em></li></ul></div>";h.append(n)}if(!F(b))var o,p;var r=h.find("#zcl_pvtshreqlnk");return r.length||(r=$('<span class="SC_lnk" id="zcl_pvtshreqlnk"/>'),h.append(r)),r.html("&raquo;"+zcal.i18n.sendreqforindividualshare),r.off("click").on("click",{eid:e[2]},function(a){y(a.data.eid)}),g.append(h),w.append(f),w.append(g),v.empty().append(w),v},y=function(a){var b="/cal/sentReq.do?mailId="+a.zcalescape();ZCL_XHR(b,function(a){z(a)})},z=function(a){_zm.succErrMsg("s",zcal.i18n.requestmailsent)},A=function(a){var b="/cal/subCal.do?mode=sub-url&url="+encodeURIComponent(location.protocol+"//"+zcal.ZCAL+"/ical/"+a);ZCL_XHR(b,function(a){C(a)})},B=function(a){var b="/cal/subCal.do?mode=sub-url&url="+encodeURIComponent(a);ZCL_XHR(b,function(a){C(a)})},C=function(a){if(a.status===200){var b=ZCL_Evl(1,a.responseText);if(b.status=="success"){var c=b.obj,d;zcal.cdata.calOLst=c.clst,zcal.cdata.calOUids=c.Uids,zcal.cdata.calGLst=c.gclst,D(c.aclst),_zm.succErrMsg("s",zcal.i18n.calSubSuccess),$.publish("/calendar/subscribed"),w?x():l&&m(),$("#zcl_subLink")[0].value=""}else _zm.succErrMsg("e",zcal.i18n[b.status])}else _zm.succErrMsg("e",zcal.i18n.errmsg)},D=function(a){var b;zcal.cdata.calALst={};for(var c in a)b=a[c],b[14]!="recruit"&&(zcal.cdata.calALst[c]=ZCL_Evl(1,JSON.stringify(b)))},E=function(a){var b=ZCL_Evl(1,a.responseText);if(b.status=="success"){var c=b.id,d;if(zcal.cdata.calLst[c])delete zcal.cdata.calLst[c],ZCL_remCalid(c),_zm.succErrMsg("s",zcal.i18n.caldeleted);else if(zcal.cdata.calOLst[c]||zcal.cdata.calGLst[c]||zcal.cdata.calALst[c])zcal.cdata.calGLst[c]?delete zcal.cdata.calGLst[c]:delete zcal.cdata.calOLst[c],ZCL_remOCalid(b.uid),_zm.succErrMsg("s",zcal.i18n.unsubscribesuc);ZCL_gothro(c),w?x():l&&m()}else _zm.succErrMsg("e",b.status)},F=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},G=function(a,b){for(var c=0;c<b.length;c++){var d=zcalGroup.getGroup(b[c]);d&&a.push({id:b[c],name:d.name,display_text:d.name})}},H=function(){var a=[],b;return b=zcalGroup.getGroupList("personal"),G(a,b),b=zcalGroup.getGroupList("org"),G(a,b),a},I=function(a,b,c){a.val(c.display_text),a.attr("data-gid",b)},J,K={},L,M=function(a){L=$("<div class='SC_Twpr zcl_Twpr zcl_Twpr_list'></div>");var b=$("<div class='SC_setTab'><div class='SC_setTabList' id='zcl_grpcallst_tabs'></div></div><div class='SC_filt_bottom SC_filt_bottomCustom'><div class='editFilterParent'  id='zcl_grpcallst'></div></div>"),c="def",d=[{type:"def",text:zcal.i18n.available},{type:"sh",text:zcal.i18n.shared},{type:"sub",text:zcal.i18n.subscribed}];for(var e=0;e<d.length;e++){var f=$('<span id="zcl_grpcal_'+d[e].type+'">></span>');f.addClass(d[e].type==c?"sel":""),f.text(d[e].text),N(f,d[e].type),b.find(".SC_setTabList").append(f)}return $.when(O(a)).then(function(a){P("def")}),L.append(b),L},N=function(a,b){a.off("click").on("click",{type:b},function(a){var b=$(this);b.parent().find("span").removeClass("sel"),b.addClass("sel"),P(a.data.type)})},O=function(a){var b=$.Deferred();return ZCL_XHR("/cal/grpDtl.do?mode=grp-callst&comid="+a,function(a){K=ZCL_Evl(1,a.responseText),b.resolve(K)}),b},P=function(a){var b,c=$("#zcl_grpcallst");a=="sh"?b=K.shdcLst:a=="sub"?b=K.subcLst:b=K.owncLst,c.empty();if(!F(b))for(var d in b){var e=b[d],f=$('<div class="zmL"></div>'),g="";g+="<ul><li><span>"+e.CNAME+"</span></li>",g+='<li><div class="SC_PUbtm">',e.IS_SUB==0?g+='<span data-val="Cancel"   data-marker="sub" id="sub">'+zcal.i18n.subscribe+"</span>":g+='<span class="sel" data-marker="unsub">'+zcal.i18n.unsubscribe+"</span>",g+="</div></li>",g+="</ul>",f.html(g);var h=f.find("[data-marker=sub]").removeAttr("data-marker");h.length&&h.on("click",{uid:d,gid:K.comid},function(a){Q(a.data.uid,a.data.gid)});var i=f.find("[data-marker=unsub]").removeAttr("data-marker");i.length&&i.on("click",{uid:d},function(a){R(a.data.uid)}),c.append(f)}else if(c.is(":empty")){var f=$('<div class="zmL"><li><em>'+zcal.i18n.no_sharecalendar+"</em></li></div>");c.append(f)}L.find("SC_filt_bottom SC_filt_bottomCustom").append(c)},Q=function(a,b){var c="/cal/subCal.do?mode=grpcal-sub&caluid="+encodeURIComponent(a)+"&grpid="+b;ZCL_XHR(c,S)},R=function(a){ZCL_XHR("/cal/calAct.do?mode=delByUid&caluid="+encodeURIComponent(a),T)},S=function(a){var b=ZCL_Evl(1,a.responseText);if(b.status=="success"){var c=b.obj,d,e,f=b.uid;zcal.cdata.calOLst=c.clst,zcal.cdata.calOUids=c.Uids,zcal.cdata.calGLst=c.gclst,zcal.cdata.calByGrp=c.gclstbygrp,D(c.aclst),_zm.succErrMsg("s",zcal.i18n.calSubSuccess),U(f),d=$("#zcl_grpcallst_tabs"),e=d.find(".sel"),e[0].id=="zcl_grpcal_sh"?P("sh"):e[0].id=="zcl_grpcal_sub"?P("sub"):P("def"),$.publish("/calendar/subscribed")}else b.status=="available"?_zm.succErrMsg("s",zcal.i18n.calSubSuccess):_zm.succErrMsg("e",b.status)},T=function(a){var b=ZCL_Evl(1,a.responseText);if(b.status=="success"){var c=b.id,d,e,f=b.uid;$.publish("/calendar/deleted",{calid:c,caluid:f,mode:"unsubscribe"}),U(f);var d=$("#zcl_grpcallst_tabs"),e=d.find(".sel");e[0].id=="zcl_grpcal_sh"?P("sh"):e[0].id=="zcl_grpcal_sub"?P("sub"):P("def")}else _zm.succErrMsg("e",b.status)},U=function(a){if(!F(K)){if(K.owncLst&&K.owncLst[a]){K.owncLst[a].IS_SUB=K.owncLst[a].IS_SUB==0?1:0;return}if(K.shdcLst&&K.shdcLst[a]){K.shdcLst[a].IS_SUB=K.shdcLst[a].IS_SUB==0?1:0;return}K.subcLst&&K.subcLst[a]&&(K.subcLst[a].IS_SUB=K.subcLst[a].IS_SUB==0?1:0)}};a.initialize=c,a.uninitialize=d,a.getSubscribeView=j},"MailSuite.Apps.CalendarSubscribe"),_defineSettingsModule("Subscribe",function(a,b){"use strict";var c=b("Platform.Components"),d=c.SettingAppManager,e=b("Platform.System.Utils"),f="calendar-subscribe",g="calendar-subscribe",h="MailSuite.Apps.CalendarSubscribe.SubscribeView",i,j=function(){return b(h)},k=function(){var a=$.Deferred();return zmApp.loadCalendar("/calendar/settings",a),a.promise()},l=function(){var a=e.makeDeferred(),b=$.Deferred();return typeof zcal=="undefined"?k().done(function(){j().initialize({process:a})}).fail(a.reject):j().initialize({process:a}),a.promise()},m=function(){var a=e.makeDeferred();return j.uninitialize({process:a}),a.promise()},n=function(){var a=j();return a.getSubscribeView()},o=function(){return null},p=function(){i=d.create(f,{attributes:{page:g,isReactApp:!1},initialize:l,uninitialize:m,getView:n,handleContainerEvent:o})},q=function(){p(),a.App=i};q()},"MailSuite.Apps"),function(a){"use strict";var b="calendar-subscribe",c="calendar-subscribe",d={WEB_URL:"web-url",FRIENDS_CALENDAR:"friends-calendar",HOLI_DAY:"holi-day",GROUPS:"groups"},e={weburl:{cardItem:{title:"Web URL"}},friendscalendar:{cardItem:{title:"Friends Calendar"}},holiday:{cardItem:{title:"HoliDays"}},groups:{cardItem:{title:"Groups"}}},f=a("Platform.Components"),g=a("Platform.Entities"),h=a("MailSuite.Settings.Calendar"),i=a("Platform.System.Utils"),j=f.SettingCardItemManager,k=g.SettingCardItem,l=k.Types,m=j.create(d.WEB_URL,{props:{title:e.weburl.cardItem.title},attributes:{type:l.Action,card:b},primaryAction:j.CardItemActions.OpenPageAction(c,{showSection:d.WEB_URL})}),n=j.create(d.FRIENDS_CALENDAR,{props:{title:e.friendscalendar.cardItem.title},attributes:{type:l.Action,card:b},primaryAction:j.CardItemActions.OpenPageAction(c,{showSection:d.FRIENDS_CALENDAR})}),o=j.create(d.HOLI_DAY,{props:{title:e.holiday.cardItem.title},attributes:{type:l.Action,card:b},primaryAction:j.CardItemActions.OpenPageAction(c,{showSection:d.HOLI_DAY})}),p=j.create(d.GROUPS,{props:{title:e.groups.cardItem.title},attributes:{type:l.Action,card:b},primaryAction:j.CardItemActions.OpenPageAction(c,{showSection:d.GROUPS})})}(zmail.Settings.Modules.import),_defineSettingsModule("Pages",function(a,b){"use strict";var c="calendar-sync",d=b("Platform.Components"),e=b("Platform.Entities"),f={title:"Sync"},g=d.SettingPageManager,h=e.SettingPage,i=h.Types,j=g.create(c,{props:{title:f.title},attributes:{card:c,category:"calendar",type:i.Title,pageCSSClass:"calendar-sync-page",appContainer:!0}});a.CalendarSync=j},"MailSuite"),_defineSettingsModule("Cards",function(a,b){"use strict";var c="calendar-sync",d="calendar",e="calendar-sync",f={cardTitle:"Synchronize"},g=b("Platform.Components"),h=g.SettingCardManager,i=h.create(c,{props:{openable:!0,title:f.cardTitle,addToSearch:!1},state:{hidden:!1},attributes:{category:d},openAction:h.CardActions.OpenPageAction(e)});a.CalendarSync=i},"MailSuite"),_defineSettingsModule("SyncView",function(a,b){"use strict";var c=function(a){a=a||{};var b=a.process;b.resolve()},d=function(a){a=a||{};var b=a.process;b.resolve()},e=[],f=0,g=!1,h=null,i=function(){var a={};return zcal.ZCAL.indexOf("zoho")!=-1&&zcal.ZCAL.indexOf("zoho.com.cn")==-1&&zcal.ZCAL.indexOf("baihui")==-1&&(a.outlook={text:zcal.i18n.outlook,msg:zcal.i18n.ms_subtitle,type:"outlook"}),zcal.ZCAL.indexOf("zoho.com.cn")==-1&&zcal.ZCAL.indexOf("baihui")==-1&&(a.gcal={text:zcal.i18n.gcal,msg:zcal.i18n.gcal_subtitle,type:"gcal"}),a.caldav={text:zcal.i18n.caldav,msg:ZCL_replaceProName(zcal.i18n.cald_subtitle),type:"caldav"},zcal.ZCAL.indexOf("zoho.com.cn")==-1&&zcal.ZCAL.indexOf("baihui")==-1&&zcal.ZCAL.indexOf("zoho")!=-1&&(a.zcalsync={text:ZCL_replaceComName(zcal.i18n.zcalsync),msg:ZCL_replaceProName(zcal.i18n.zcalsync_subnote),type:"zcalsync"}),a},j=function(){var a=zcal.cdata.opt,b="",c=i(),d=$('<li class="SC_setbox zcl_setbox"></li>'),e=$('<div class="SC_Twpr zcl_Twpr zcl_Twpr_list"></div>'),f=$('<div class="SC_filt_bottom SC_filt_bottomCustom"></div>');for(var g in c){var h=c[g],j=$("<div class='zmL'></div>");j.html("<ul><li><span>"+h.text+"</span><em>"+h.msg+"</em></li></ul>"),j.on("click",{type:h.type},function(a){k(a.data.type)}),f.append(j)}return e.append(f),d.append(e),d},k=function(a){if(a==="caldav")v();else if(a==="gcal")m();else if(a==="outlook"){var b=zmail.Settings.MailSuite.App.Core.Framework;b.requestPreviewCard({getView:function(){return l()}}).done(function(a){a.card.show()})}else a==="zcalsync"&&x()},l=function(){var a=$('<div class="SC_Twpr zcl_Twpr zcl_Twpr_list"></div>'),b=$('<div class="SC_ptit"><div><div class="impExpHeading">'+ZCL_replaceProName(zcal.i18n.ms_title)+"</div></div></div>"),c=$('<div id="zmsdialogcont_zcl_olpp" class="SC_PUcen" style="max-height: 337px;"></div>'),d="";return d+='<div id="zcl_olpp">',d+='<div class="SC_PUcen zcl_ovr" style="max-height: 551px;">',d+='<ul class="SC_cal_groups">',d+='<li><div id="zcl_olbtn" class="zm_comp"><a title='+ZCL_replaceComName(zcal.i18n.outlooktitle64)+" href= "+zcal.OUTLOOK64+' class="SC_lnk"><span>Download</span><span><i class="msi-download"></i></span></a></div><span>'+ZCL_replaceComName(zcal.i18n.outlooktitle64)+"<s>Beta</s></span><em>("+ZCL_replaceProName(zcal.i18n.outlooksubtitle64)+")</em></li>",d+='<li><div id="zcl_olbtn" class="zm_comp"><a title='+ZCL_replaceComName(zcal.i18n.outlooktitle32)+" href= "+zcal.OUTLOOK32+' class="SC_lnk"><span>Download</span><span><i class="msi-download"></i></span></a></div><span>'+ZCL_replaceComName(zcal.i18n.outlooktitle32)+"<s>Beta</s></span><em>("+ZCL_replaceProName(zcal.i18n.outlooksubtitle32)+")</em></li>",d+="</ul>",d+="<p>"+zcal.i18n.mssync_help_link+"</p>",d+="</div>",d+="</div>",c.append($(d)),c.find("a").addClass("SC_lnk"),a.append(b),a.append(c),a},m=function(){if(e&&e.length>0){var a=zmail.Settings.MailSuite.App.Core.Framework;a.requestPreviewCard({getView:function(){return n()}}).done(function(a){a.card.show()})}else ZCL_XHR("/cal/getGCal.do?mode=auth",function(a){e=ZCL_Evl(1,a.responseText),t()})},n=function(){var a=$('<div class="SC_Twpr zcl_Twpr zcl_Twpr_list"></div>'),b=$('<div class="SC_PUtt"><div><div class="impExpHeading">'+zcal.i18n.gcal+"</div></div></div>");a.append(b);var c=$('<div class="SC_filt_bottom SC_filt_bottomCustom"><div class="editFilterParent" id="zcl_gcallst"></div></div>');if(e&&e.length>0)for(var d=0;d<e.length;d++){var g=$('<div class="zmL"></div>'),h="";e[d].gcalName=e[d].gcalName.replace("<","&lt;").replace(">","&gt;"),h+="<ul><li>",h+='<span id="zcl_synccal">'+e[d].gcalName+'</span><li><div class="SC_PUbtm">',zcal.cdata.calOUids.indexOf("gCal_"+decodeURIComponent(e[d].gcalId))==-1?h+='<span data-val="Cancel"   data-marker="sub">'+zcal.i18n.synchronize+"</span>":h+='<span class="sel" data-marker="unsub">'+zcal.i18n.unsynchronize+"</span>",h+="</div></li></li></ul>",f===1&&(g.addClass("zcl_disls"),h+='<s id="zcl_syncstatus">'+zcal.i18n.syncmsg+"</s>"),g.html(h);var i=g.find("[data-marker=sub]").removeAttr("data-marker");i.length&&o(i,{gcalId:e[d].gcalId,gcalName:e[d].gcalName,authMail:e[d].authMail});var j=g.find("[data-marker=unsub]").removeAttr("data-marker");j.length&&s(j,{gcalId:e[d].gcalId,gcalName:e[d].gcalName,authMail:e[d].authMail}),c.find("#zcl_gcallst").append(g)}return a.append(c),a},o=function(a,b){a.off("click").on("click",{calid:b.gcalId,calname:b.gcalName,email:b.authMail},function(a){p(),ZCL_XHR("/cal/getGCal.do?mode=sub&calId="+a.data.calid+"&calName="+a.data.calname+"&ownerMailID="+a.data.email,r)})},p=function(){var a=$("#zcl_gcallst");q(1);var b,c=a.find("#zcl_synccal");a.find("#zcl_syncstatus").length==0&&c.after($('<em id="zcl_syncstatus">'+zcal.i18n.syncmsg+"</em>")),b=a.find("#zcl_syncstatus"),b.parent().addClass("zcl_disls"),c.find("span.button").off("click")},q=function(a){f=a},r=function(a){ZCL_clrStck();if(a.status==200){var b=ZCL_Evl(1,a.responseText);if(b.status=="success"){var c=b.obj;zcal.cdata.calOLst=c.clst,zcal.cdata.calOUids=c.Uids,zcal.cdata.calGLst=c.gclst,ZCL_updateAppCalList(c.aclst),$.publish("/calendar/subscribed")}}},s=function(a,b){a.off("click").on("click",{calid:b.gcalId,calname:b.gcalName},function(a){ZCL_XHR("/cal/getGCal.do?mode=unsub&calId="+a.data.calid+"&calName="+a.data.calname,function(a){var b=ZCL_Evl(1,a.responseText);b.status=="success"&&(f=0,e=null,$("#zcl_gcal_pp").length>0&&(zmsDialog.remove(),$("#zcl_gcal_pp").remove()),$.publish("/calendar/deleted",{calid:b.id,caluid:b.uid,mode:"delete"}))})})},t=function(){if(!e){var a=document.location.protocol+"//"+zcal.ZCAL,b=function(c){var d=c.origin||c.originalEvent.origin;d===a&&(u(),c.source.close(),window.addEventListener?window.removeEventListener("message",b,!1):window.detachEvent("onmessage",b))};window.addEventListener?window.addEventListener("message",b,!1):window.attachEvent("onmessage",b);var c=(document.body.offsetHeight-500)/2,d=(document.body.offsetWidth-700)/2,f="GoogleAuthenticationWindow_"+location.hostname.split(".")[0];g=window.open(zcal.GCALSYNC,f,"menubar=no,toolbar=no,location=no,status=no,scrollbars=yes,resizable=no,width=700,height=500,left="+d+",top="+c),h||(h=setTimeout(function(){checkGCalWinStatus()},5e3))}else{var i=zmail.Settings.MailSuite.App.Core.Framework;i.requestPreviewCard({getView:function(){return n()}}).done(function(a){a.card.show()})}},u=function(){h&&clearTimeout(h),ZCL_XHR("/cal/getGCal.do?mode=list",function(a){e=ZCL_Evl(1,a.responseText),t()})},v=function(){ZCL_XHR("/cal/caldavCalLst.do?mode=callist",function(a){var b=ZCL_Evl(1,a.responseText),c=zmail.Settings.MailSuite.App.Core.Framework;c.requestPreviewCard({getView:function(){return w(b)}}).done(function(a){a.card.show()})})},w=function(a){var b=$('<div class="SC_Twpr zcl_Twpr zcl_Twpr_list"></div>'),c=$('<div class="SC_PUtt"><div><div class="impExpHeading">'+zcal.i18n.caldav+'&nbsp;<a class="SC_lnk" href="https://'+zcal.ZOHOSTATIC+'/help/caldav-sync-zoho-calendar.html#CalDAV" target="_blank">(?)</a></div></div></div>'),d=$('<div id="zmsdialogcont_zcl_caldav_pp" class="SC_PUcen" style="max-height: 337px;"></div>'),e=$('<div id="zcl_caldav_pp"><div><div class="SC_filt_bottom zcl_cdavovr" style="display: block;"><div class="SC_cal_groups"><ul></ul></div></div></div></div>'),f=$('<div class="SC_PUbtm"><span data-marker="ok">'+zcal.i18n.ok+"</span></div>");for(var g in a){var h=a[g],i=ZCL_getHTML(h.NAME),j=h.SHOWHIDE==1?!0:!1,k=h.CALID,l=h.ISDEF==1?!0:!1,m=h.SYNC==1?!0:!1,n=$('<li class="'+(j?"":"disable")+'"><i class="'+(l||m?"msi-check":"msi-uncheck")+'"></i><span>'+i+"</span></li>");l||n.off("click").on("click",{calid:k},function(a){var b=a.data.calid,c=$(this),d,e;d=c.find("i"),d[0].className=="msi-uncheck"?d.removeClass("msi-uncheck").addClass("msi-check"):d.removeClass("msi-check").addClass("msi-uncheck"),e=d[0].className=="msi-check"?"enable":"disable",ZCL_XHR("/cal/enablecaldav.do?mode="+e+"&calid="+b,function(a){var b=ZCL_Evl(1,a.responseText)})}),e.find("ul").append(n)}var o=f.find("[data-marker=ok]").removeAttr("data-marker");return o.off("click").on("click",function(){var a=zmail.Settings.MailSuite.App.Core.Framework;a.requestPreviewCard().done(function(a){a.close()})}),d.append(e),b.append(c),b.append(d),b.append(f),b},x=function(){var a="https://"+zcal.ZOHOSTATIC+"/help/user-guide/calsync-android.html";window.open(a,"_blank")};a.initialize=c,a.uninitialize=d,a.getSyncView=j,a.openOutlookCard=l,a.openCalDAVCard=v,a.openGCalCard=m},"MailSuite.Apps.CalendarSync"),_defineSettingsModule("Sync",function(a,b){"use strict";var c=b("Platform.Components"),d=c.SettingAppManager,e=b("Platform.System.Utils"),f="calendar-sync",g="calendar-sync",h="MailSuite.Apps.CalendarSync.SyncView",i,j=function(){return b(h)},k=function(){var a=$.Deferred();return zmApp.loadCalendar("/calendar/settings",a),a.promise()},l=function(){var a=e.makeDeferred(),b=$.Deferred();return typeof zcal=="undefined"?k().done(function(){j().initialize({process:a})}).fail(a.reject):j().initialize({process:a}),a.promise()},m=function(){var a=e.makeDeferred();return j.uninitialize({process:a}),a.promise()},n=function(){var a=j();return a.getSyncView()},o=function(){return null},p=function(){i=d.create(f,{attributes:{page:g,isReactApp:!1},initialize:l,uninitialize:m,getView:n,handleContainerEvent:o})},q=function(){p(),a.App=i};q()},"MailSuite.Apps"),function(a){"use strict";var b="calendar-sync",c="calendar-sync",d={MICROSOFT_OUTLOOK:"microsoft-outlook",GOOGLE_CALENDAR:"google-calendar",CAL_DAV:"cal-dav",ZOHO_CALSYNC:"zoho-calsync"},e={microsoftoutlook:{cardItem:{title:"Microsoft Outlook"}},googlecalendar:{cardItem:{title:"Google Calendar"}},caldav:{cardItem:{title:"CalDAV"}},zohocalsync:{cardItem:{title:"Zoho CalSync - Android"}}},f=a("Platform.Components"),g=a("Platform.Entities"),h=a("MailSuite.Settings.Calendar"),i=a("Platform.System.Utils"),j=f.SettingCardItemManager,k=g.SettingCardItem,l=k.Types,m=function(a){window.open(a,"_blank")},n={openGroupSettingsPage:function(){m("https://"+zcal.ZOHOSTATIC+"/help/user-guide/calsync-android.html")}};if(!zmail.isFuji)var o=j.create(d.MICROSOFT_OUTLOOK,{props:{title:e.microsoftoutlook.cardItem.title},attributes:{type:l.Action,card:b},primaryAction:function(){j.CardItemActions.OpenPageAction(c),zmail.Settings.MailSuite.App.openApp().done(function(){var a=zmail.Settings.MailSuite.App.Core.Framework;a.requestShowPage(c).done(function(){var b=zmail.Settings.MailSuite.Apps.CalendarSync.SyncView;a.requestPreviewCard({getView:function(){return b.openOutlookCard()}}).done(function(a){a.card.show()})}).fail(function(){})})}});var p=j.create(d.GOOGLE_CALENDAR,{props:{title:e.googlecalendar.cardItem.title},attributes:{type:l.Action,card:b},primaryAction:function(){j.CardItemActions.OpenPageAction(c),zmail.Settings.MailSuite.App.openApp().done(function(){var a=zmail.Settings.MailSuite.App.Core.Framework;a.requestShowPage(c).done(function(){var a=zmail.Settings.MailSuite.Apps.CalendarSync.SyncView;a.openGCalCard()}).fail(function(){})})}}),q=j.create(d.CAL_DAV,{props:{title:e.caldav.cardItem.title},attributes:{type:l.Action,card:b},primaryAction:function(){j.CardItemActions.OpenPageAction(c),zmail.Settings.MailSuite.App.openApp().done(function(){var a=zmail.Settings.MailSuite.App.Core.Framework;a.requestShowPage(c).done(function(){var b=zmail.Settings.MailSuite.Apps.CalendarSync.SyncView;a.requestPreviewCard({getView:function(){return b.openCalDAVCard()}}).done(function(a){a.card.show()})}).fail(function(){})})}});if(!zmail.isFuji)var r=j.create(d.ZOHO_CALSYNC,{props:{title:e.zohocalsync.cardItem.title},attributes:{type:l.Action,card:b},primaryAction:function(){n.openGroupSettingsPage()}})}(zmail.Settings.Modules.import),_defineSettingsModule("Pages",function(a,b){"use strict";var c="calendar-zohoapp",d=b("Platform.Components"),e=b("Platform.Entities"),f={title:"Zoho Apps"},g=d.SettingPageManager,h=e.SettingPage,i=h.Types,j=g.create(c,{props:{title:f.title},attributes:{card:c,category:"calendar",type:i.Title,pageCSSClass:"calendar-zohoapp-page",appContainer:!0}});a.CalendarZohoApp=j},"MailSuite"),_defineSettingsModule("Cards",function(a,b){"use strict";var c="calendar-zohoapp",d="calendar",e="calendar-zohoapp",f={cardTitle:"Zoho Apps"},g=b("Platform.Components"),h=g.SettingCardManager,i=h.create(c,{props:{openable:!0,title:f.cardTitle,addToSearch:!1},state:{hidden:!1},attributes:{category:d},openAction:h.CardActions.OpenPageAction(e)});a.CalendarZohoApp=i},"MailSuite"),_defineSettingsModule("ZohoappView",function(a,b){"use strict";var c=function(a){a=a||{};var b=a.process;b.resolve()},d=function(a){a=a||{};var b=a.process;b.resolve()},e,f={},g,h,i,j=function(){return{zcrm:{text:ZCL_replaceComName(zcal.i18n.zohocrmcal),msg:zcal.i18n.sync,type:"crm"},zrecruit:{text:ZCL_replaceComName(zcal.i18n.zohorecruitcal),msg:zcal.i18n.sync,type:"recruit"},ztask:{text:ZCL_replaceComName(zcal.i18n.zohotask),msg:zcal.i18n.sync,type:"task-sync"},zprojects:{text:ZCL_replaceComName(zcal.i18n.zohoprojects),msg:zcal.i18n.subscribe,type:"project"},zcontacts:{text:ZCL_replaceComName(zcal.i18n.zohocontactscal),msg:zcal.i18n.subscribe,type:"contacts"}}},k=function(){var a=zcal.cdata.opt,b="",c=j(),d=$('<li class="SC_setbox zcl_setbox"></li>'),e=$('<div class="SC_Twpr zcl_Twpr zcl_Twpr_list"></div>'),f=$('<div class="SC_filt_bottom SC_filt_bottomCustom"></div>');for(var g in c){var h=c[g];if(h.type=="crm"&&zcal.ZCRM!=""||h.type=="recruit"&&zcal.ZRECRUIT!=""||h.type=="task-sync"&&zcal.ZTSK!=""||h.type=="project"||h.type=="contacts"){var i=$("<div class='zmL'></div>");i.html("<ul><li><span>"+h.text+"</span><em>"+h.msg+"</em></li></ul>"),i.on("click",{type:h.type,txt:h.text},function(a){var b=zmail.Settings.MailSuite.App.Core.Framework;b.requestPreviewCard({getView:function(){return m(a.data.type,a.data.txt)}}).done(function(a){a.card.show()})}),f.append(i)}}return e.append(f),d.append(e),d},l,m=function(a,b){l=$('<div class="SC_Twpr zcl_Twpr zcl_Twpr_list"></div>');var c=$('<div class="SC_ptit"><div><div class="impExpHeading">'+b+"</div></div></div>"),d=$('<div class="SC_filt_bottom SC_filt_bottomCustom" id="btDiv"></div>');return ZCL_uXHR("/cal/getPortal.do?mode="+a,function(b){n(a,b)}),l.append(c),l.append(d),l},n=function(a,b,c){if(a=="crm"){e=ZCL_Evl(1,b.getElementsByTagName("obj")[0].firstChild.nodeValue);if(e.status=="in-process"||e.status=="success")p();else{f.crm="error";var d=e.status=="503"?zcal.i18n.subscribeunavailable:e.status=="sync-noperm"?ZCL_replaceComName(zcal.i18n.crmcal_noperm):ZCL_replaceComName(zcal.i18n.noacc_inzohocrm);u(d)}}else if(a=="task-sync"){g=ZCL_Evl(1,b.getElementsByTagName("obj")[0].firstChild.nodeValue);if(g.status=="in-process"||g.status=="success")r();else{f.task="error";var d=g=="503"?zcal.i18n.subscribeunavailable:ZCL_replaceComName(zcal.i18n.noacc_inzohotask);u(d)}}else if(a=="project"){var j=b.getElementsByTagName("obj")[0].firstChild.nodeValue;if(j!="503"&&j!="Empty result set"&&j!="error")h=ZCL_Evl(1,j),t();else{f.project="error";var d=j=="503"?zcal.i18n.subscribeunavailable:ZCL_replaceComName(zcal.i18n.noacc_inzohopro);u(d)}}else if(a=="contacts"){var k=b.getElementsByTagName("status")[0].firstChild.nodeValue;if(k=="ok")s();else{f.contacts="error";var d=k=="503"?zcal.i18n.subscribeunavailable:ZCL_replaceComName(zcal.i18n.noacc_inzohocont);u(d)}}else if(a=="recruit"){i=ZCL_Evl(1,b.getElementsByTagName("obj")[0].firstChild.nodeValue);var l=i.obj.VERSION;if(i.obj!="503"&&i.obj!="error")q();else{f.recruit="error";var d=i.obj=="503"?zcal.i18n.subscribeunavailable:ZCL_replaceComName(zcal.i18n.noacc_inzohorecruit);u(d)}}},o=function(a){var b,c=a.find("#zcl_synccal");a.find("#zcl_syncstatus").length==0&&c.after($('<em id="zcl_syncstatus">'+zcal.i18n.syncmsg+"</em>")),b=a.find("#zcl_syncstatus"),b.parent().addClass("zcl_disls"),c.find("span.button").off("click")},p=function(){var a=l.find("#btDiv"),b="";a.empty();var c=$('<div class="editFilterParent"></div>');b+='<div class="zmL"><ul><li><span id="zcl_synccal">'+ZCL_replaceComName(zcal.i18n.crmcal)+"<span></li>",zcal.cdata.calOUids.indexOf("zohoCrm_")==-1?b+='<li><div class="SC_PUbtm"><span data-val="Cancel" data-marker="sub">'+zcal.i18n.synchronize+"</span></div></li>":b+='<li><div class="SC_PUbtm"><span data-val="sel" data-marker="unsub">'+zcal.i18n.unsynchronize+"</span></div></li>",b+="</ul></div>",e.status=="in-process"&&(c.addClass("zcl_disls"),b+='<s id="zcl_syncstatus">'+zcal.i18n.syncmsg+"</s>"),c.html(b);var d=c.find("[data-marker=sub]").removeAttr("data-marker");d.length&&d.off("click").on("click",{soid:e.obj.ZSOID},function(b){o(a),ZCL_XHR("/cal/subCal.do?mode=crm-sync&crmid="+b.data.soid,v)});var f=c.find("[data-marker=unsub]").removeAttr("data-marker");if(f.length){var g=zcal.cdata.calOUids.substring(zcal.cdata.calOUids.indexOf("zohoCrm_"));g=g.indexOf(",")!=-1?g.substring(0,g.indexOf(",")):g,f.on("click",{uid:g,mode:"crm"},function(a){x(a.data.uid,a.data.mode)})}a.append(c)},q=function(){var a=l.find("#btDiv"),b=i.obj.VERSION;a.empty();var c=$('<div class="editFilterParent"></div>'),d="";d+='<div class="zmL"><ul><li><span id="zcl_synccal">'+ZCL_replaceComName(zcal.i18n.recruitcal)+"<span></li>",b=="new"?zcal.cdata.calOUids.indexOf("zohoRecruit4_")==-1?d+='<li><div class="SC_PUbtm"><span data-val="Cancel" data-marker="sub">'+zcal.i18n.synchronize+"</span></div></li>":d+='<li><div class="SC_PUbtm"><span data-val="sel" data-marker="unsub">'+zcal.i18n.unsynchronize+"</span></div></li>":zcal.cdata.calOUids.indexOf("zohoRecruit_")==-1?d+='<li><div class="SC_PUbtm"><span data-val="Cancel" data-marker="sub">'+zcal.i18n.subscribe+"</span></div></li>":d+='<li><div class="SC_PUbtm"><span data-val="sel" data-marker="unsub">'+zcal.i18n.unsubscribe+"</span></div></li>",d+="</ul></div>",c.html(d);var e=c.find("[data-marker=sub]").removeAttr("data-marker");e.length&&e.off("click").on("click",{soid:i.obj.ZSOID},function(a){ZCL_XHR("/cal/subCal.do?mode=recruitcal-sub&recid="+a.data.soid,w)});var f=c.find("[data-marker=unsub]").removeAttr("data-marker");if(f.length){var g=zcal.cdata.calOUids.substring(zcal.cdata.calOUids.indexOf("zohoRecruit"));g=g.indexOf(",")!=-1?g.substring(0,g.indexOf(",")):g,f.on("click",{uid:g,mode:"recruit"},function(a){x(a.data.uid,a.data.mode)})}a.append(c)},r=function(){var a=l.find("#btDiv"),b="";a.empty();var c=$('<div class="editFilterParent"></div>');b+='<div class="zmL"><ul><li><span>'+ZCL_replaceComName(zcal.i18n.zohotask)+"<span></li>",zcal.cdata.calOUids.indexOf("zohoTask_")==-1?b+='<li><div class="SC_PUbtm"><span data-val="Cancel" data-marker="sub">'+zcal.i18n.synchronize+"</span></div></li>":b+='<li><div class="SC_PUbtm"><span data-val="sel" data-marker="unsub">'+(g.isOldTaskSubscribed?zcal.i18n.unsubscribe:zcal.i18n.unsynchronize)+"</span></div></li>",b+="</ul></div>",g.status=="in-process"&&(c.addClass("zcl_disls"),b+='<s id="zcl_syncstatus">'+zcal.i18n.syncmsg+"</s>"),c.html(b);var d=c.find("[data-marker=sub]").removeAttr("data-marker");d.length&&d.on("click",function(a){ZCL_XHR("/cal/subCal.do?mode=task-sync",w)});var e=c.find("[data-marker=unsub]").removeAttr("data-marker");if(e.length){var f=zcal.cdata.calOUids.substring(zcal.cdata.calOUids.indexOf("zohoTask_"));f=f.indexOf(",")!=-1?f.substring(0,f.indexOf(",")):f,e.on("click",{uid:f,mode:"task"},function(a){x(a.data.uid,a.data.mode)})}a.append(c)},s=function(){var a=l.find("#btDiv"),b="";a.empty();var c=$('<div class="editFilterParent"></div>');b+='<div class="zmL"><ul><li><span>'+zcal.i18n.contactscal+"<span></li>",zcal.cdata.calOUids.indexOf("zohoContacts_")==-1?b+='<li><div class="SC_PUbtm"><span data-val="Cancel" data-marker="sub">'+zcal.i18n.subscribe+"</span></div></li>":b+='<li><div class="SC_PUbtm"><span data-val="sel" data-marker="unsub">'+zcal.i18n.unsubscribe+"</span></div></li>",b+="</ul></div>",c.append(b);var d=c.find("[data-marker=sub]").removeAttr("data-marker");d.length&&d.on("click",function(a){ZCL_XHR("/cal/subCal.do?mode=contactcal-sub",w)});var e=c.find("[data-marker=unsub]").removeAttr("data-marker");if(e.length){var f=zcal.cdata.calOUids.substring(zcal.cdata.calOUids.indexOf("zohoContacts_"));f=f.indexOf(",")!=-1?f.substring(0,f.indexOf(",")):f,e.on("click",{uid:f,mode:"contacts"},function(a){x(a.data.uid,a.data.mode)})}a.append(c)},t=function(){var a=l.find("#btDiv"),b=h;a.empty();var c=$('<div class="editFilterParent"></div>');for(var d in b){var e=$('<div class="zmL"/>'),f;f="<ul><li><span>"+ZCL_getHTML(b[d].portal)+"<span></li>",zcal.cdata.calOUids.indexOf("zohoProject_"+b[d].portal_zoid)==-1?f+='<li><div class="SC_PUbtm"><span data-val="Cancel" data-marker="sub" >'+zcal.i18n.subscribe+"</span></div></li>":f+='<li><div class="SC_PUbtm"><span data-val="sel" data-marker="unsub">'+zcal.i18n.unsubscribe+"</span></div></li>",f+="</ul>",e.html(f);var g=e.find("[data-marker=sub]").removeAttr("data-marker");g.length&&g.on("click",{portal:b[d].portal,portalid:b[d].portal_zoid},function(a){ZCL_XHR("/cal/subCal.do?mode=project-sub&portal="+a.data.portal+"&portalId="+encodeURIComponent(a.data.portalid),w)});var i=e.find("[data-marker=unsub]").removeAttr("data-marker");i.length&&i.on("click",{uid:"zohoProject_"+b[d].portal_zoid,mode:"project"},function(a){x(a.data.uid,a.data.mode)}),c.append(e)}a.append(c)},u=function(a){l.find("#btDiv").append("<div class='editFilterParent'><div class='zmL'><ul><li><span>"+a+"</span></li></ul></div></div></div></div>")},v=function(a){ZCL_clrStck();if(a.status==200){var b=ZCL_Evl(1,a.responseText);if(b.status=="success"){if(b.sync_mode=="sync-initiated")b.sync_status=="in-process"?e.status=b.sync_status:(e.status="success",setTimeout(function(){_zm.succErrMsg("s",zcal.i18n.synccompmsg)},2e3));else if(b.sync_status=="success"){e.status=b.sync_status;var c=b.obj;zcal.cdata.calOLst=c.clst,zcal.cdata.calOUids=c.Uids,zcal.cdata.calGLst=c.gclst,zcal.cdata.calALst=c.aclst,ZCL_updateAppCalList(c.aclst),setTimeout(function(){_zm.succErrMsg("s",zcal.i18n.synccompmsg)},2e3),zcalCRM.loadCRMUsers()}else b.sync_status=="in-process"?e.status=b.sync_status:setTimeout(function(){_zm.succErrMsg("e",ZCL_replaceComName(zcal.i18n.crmcal_syncfailed))},2e3);p(),$.publish("/calendar/subscribed")}else setTimeout(function(){_zm.succErrMsg("e",ZCL_replaceComName(zcal.i18n.crmcal_syncfailed))},2e3)}},w=function(a){var b=ZCL_Evl(1,a.responseText);if(b.status=="success"){var c=b.obj,d=b.mode,e=b.uid;zcal.cdata.calOLst=c.clst,zcal.cdata.calOUids=c.Uids,zcal.cdata.calGLst=c.gclst,zcal.cdata.calALst=c.aclst,ZCL_updateAppCalList(c.aclst),d==="contactcal-sub"?(_zm.succErrMsg("s",zcal.i18n.calSubSuccess),s()):d==="project-sub"?(_zm.succErrMsg("s",zcal.i18n.calSubSuccess),t()):d==="task-sync"?(b.sync_status=="completed"?(g.status="success",_zm.succErrMsg("s",zcal.i18n.synccompmsg)):b.sync_status=="in-process"&&(g.status="in-process"),r()):d=="recruitcal-sub"&&q(),$.publish("/calendar/subscribed")}},x=function(a,b){ZCL_XHR("/cal/calAct.do?mode=delByUid&caluid="+encodeURIComponent(a),function(a){y(a,b)})},y=function(a,b){var c=ZCL_Evl(1,a.responseText);if(c.status=="success"){var d=c.id,e=c.uid;$.publish("/calendar/deleted",{calid:d,caluid:e,mode:"unsubscribe"}),b==="contacts"?s():b==="project"?t():b==="task"?r():b==="crm"?p():b==="recruit"&&q()}else _zm.succErrMsg("e",c.status)};a.initialize=c,a.uninitialize=d,a.getZohoappView=k,a.openAppCalCard=m},"MailSuite.Apps.CalendarZohoApp"),_defineSettingsModule("ZohoApps",function(a,b){"use strict";var c=b("Platform.Components"),d=c.SettingAppManager,e=b("Platform.System.Utils"),f="calendar-zohoapp",g="calendar-zohoapp",h="MailSuite.Apps.CalendarZohoApp.ZohoappView",i,j=function(){return b(h)},k=function(){var a=$.Deferred();return zmApp.loadCalendar("/calendar/settings",a),a.promise()},l=function(){var a=e.makeDeferred(),b=$.Deferred();return typeof zcal=="undefined"?k().done(function(){j().initialize({process:a})}).fail(a.reject):j().initialize({process:a}),a.promise()},m=function(){var a=e.makeDeferred();return j.uninitialize({process:a}),a.promise()},n=function(){var a=j();return a.getZohoappView()},o=function(){return null},p=function(){i=d.create(f,{attributes:{page:g,isReactApp:!1},initialize:l,uninitialize:m,getView:n,handleContainerEvent:o})},q=function(){p(),a.App=i};q()},"MailSuite.Apps"),function(a){"use strict";var b="calendar-zohoapp",c="calendar-zohoapp",d={ZOHO_CRM:"zoho-crm",ZOHO_RECRUIT:"zoho-recruit",ZOHO_TASK:"zoho-task",ZOHO_PROJECTS:"zoho-projects",ZOHO_CONTACTS:"zoho-contacts"},e={zohocrm:{cardItem:{title:"Zoho CRM"}},zohorecruit:{cardItem:{title:"Zoho Recruit"}},zohotask:{cardItem:{title:"Zoho Task"}},zohoprojects:{cardItem:{title:"Zoho Projects"}},zohocontacts:{cardItem:{title:"Zoho Contacts"}}},f=a("Platform.Components"),g=a("Platform.Entities"),h=a("MailSuite.Settings.Calendar"),i=a("Platform.System.Utils"),j=f.SettingCardItemManager,k=g.SettingCardItem,l=k.Types,m=j.create(d.ZOHO_CRM,{props:{title:e.zohocrm.cardItem.title},attributes:{type:l.Action,card:b},primaryAction:function(){j.CardItemActions.OpenPageAction(c),zmail.Settings.MailSuite.App.openApp().done(function(){var a=zmail.Settings.MailSuite.App.Core.Framework;a.requestShowPage(c).done(function(){var b=zmail.Settings.MailSuite.Apps.CalendarZohoApp.ZohoappView;a.requestPreviewCard({getView:function(){return b.openAppCalCard("crm","Zoho CRM Calendar")}}).done(function(a){a.card.show()})}).fail(function(){})})}});if(!zmail.isFuji)var n=j.create(d.ZOHO_RECRUIT,{props:{title:e.zohorecruit.cardItem.title},attributes:{type:l.Action,card:b},primaryAction:function(){j.CardItemActions.OpenPageAction(c),zmail.Settings.MailSuite.App.openApp().done(function(){var a=zmail.Settings.MailSuite.App.Core.Framework;a.requestShowPage(c).done(function(){var b=zmail.Settings.MailSuite.Apps.CalendarZohoApp.ZohoappView;a.requestPreviewCard({getView:function(){return b.openAppCalCard("recruit","Zoho Recruit Calendar")}}).done(function(a){a.card.show()})}).fail(function(){})})}});var o=j.create(d.ZOHO_TASK,{props:{title:e.zohotask.cardItem.title},attributes:{type:l.Action,card:b},primaryAction:function(){j.CardItemActions.OpenPageAction(c),zmail.Settings.MailSuite.App.openApp().done(function(){var a=zmail.Settings.MailSuite.App.Core.Framework;a.requestShowPage(c).done(function(){var b=zmail.Settings.MailSuite.Apps.CalendarZohoApp.ZohoappView;a.requestPreviewCard({getView:function(){return b.openAppCalCard("task-sync","Zoho Task")}}).done(function(a){a.card.show()})}).fail(function(){})})}}),p=j.create(d.ZOHO_PROJECTS,{props:{title:e.zohoprojects.cardItem.title},attributes:{type:l.Action,card:b},primaryAction:function(){j.CardItemActions.OpenPageAction(c),zmail.Settings.MailSuite.App.openApp().done(function(){var a=zmail.Settings.MailSuite.App.Core.Framework;a.requestShowPage(c).done(function(){var b=zmail.Settings.MailSuite.Apps.CalendarZohoApp.ZohoappView;a.requestPreviewCard({getView:function(){return b.openAppCalCard("project","Zoho Projects")}}).done(function(a){a.card.show()})}).fail(function(){})})}}),q=j.create(d.ZOHO_CONTACTS,{props:{title:e.zohocontacts.cardItem.title},attributes:{type:l.Action,card:b},primaryAction:function(){j.CardItemActions.OpenPageAction(c),zmail.Settings.MailSuite.App.openApp().done(function(){var a=zmail.Settings.MailSuite.App.Core.Framework;a.requestShowPage(c).done(function(){var b=zmail.Settings.MailSuite.Apps.CalendarZohoApp.ZohoappView;a.requestPreviewCard({getView:function(){return b.openAppCalCard("contacts","Zoho Contacts (Birthday Calendar)")}}).done(function(a){a.card.show()})}).fail(function(){})})}})}(zmail.Settings.Modules.import),_defineSettingsModule("Pages",function(a,b){"use strict";var c="calendar-mgaocalendars",d=b("Platform.Components"),e=b("Platform.Entities"),f={title:"Calendars"},g=d.SettingPageManager,h=e.SettingPage,i=h.Types,j,k=g.create(c,{props:{title:f.title},attributes:{card:c,category:"calendar",type:i.Title,pageCSSClass:"calendar-mgaocalendars-page",appContainer:!0}});a.CalendarMGAOCalendars=k}),_defineSettingsModule("Cards",function(a,b){"use strict";var c="calendar-mgaocalendars",d="calendar",e="calendar-mgaocalendars",f={cardTitle:"Calendars"},g=b("Platform.Components"),h=g.SettingCardManager,i=h.create(c,{props:{openable:!0,title:f.cardTitle,addToSearch:!1},state:{hidden:!1},attributes:{category:d},openAction:h.CardActions.OpenPageAction(e)});a.CalendarMGAOCalendars=i},"MailSuite"),_defineSettingsModule("MGAOCalendarsView",function(a,b){"use strict";var c=function(a){a=a||{};var b=a.process;b.resolve(),A()},d=function(a){a=a||{};var b=a.process;b.resolve()},e=function(a,b){var c=b.calid,d=h.find("[data-id="+c+"]");d.length&&d.remove(),j(b.type)},f,g,h=$('<div data-reactroot class="SC_setbox zcl_setbox zcl_setboxgpls"></div>'),i=function(){var a=$('<div class="filterTopMenu"><ul class="SCS_tab"><li class="stSel" id="myCal">'+zcal.i18n.mycalendars+'</li><li id="grpCal">'+zcal.i18n.groupcalendars+'</li><li id="appCal">'+zcal.i18n.appcalendars+'</li><li id="othCal">'+zcal.i18n.othercalendars+"</li></ul></div>"),b=$('<div><div class="zcl_Twpr_Callist"><div class="SC_filt_bottom SC_filt_bottomCustom"  id="topB"><div class="zmL SC_filt_bld"><ul class="bld"><li></li><li>Calendar Name</li><li>Actions</li> <li class="conditions">Status</li></ul></div></div><div class="SC_Twpr zcl_Twpr_Callist zcl_setsrl"> <div class="SC_filt_bottom SC_filt_bottomCustom" id="listCal"></div></div></div></div>');while(h[0].firstChild)h[0].removeChild(h[0].firstChild);return h.append(a),h.append(b),f=zcal.cdata.calOrdArr,g=zcal.cdata.calLst,f.forEach(function(a){g[a]&&m(a,g[a])}),a.find("#grpCal").on("click",function(a){var b=r(a);h.append(b)}),a.find("#myCal").on("click",function(a){var b=$(this);b.parent().find("li").removeClass("stSel"),b.addClass("stSel");var c=i()}),a.find("#appCal").on("click",function(a){var b=t();h.append(b)}),a.find("#othCal").on("click",function(a){var b=v();h.append(b)}),h},j=function(a){if(a=="groups"){if(h.find("#listCal")[0].childNodes.length==0){var b;h.find("#listCal").html('<div class="startup help zcl_mb">No calendars found, <a class="SC_lnk">click here</a> to subscribe.</div>'),b=h.find("#listCal").find("a"),$("#topB").empty(),b.off("click").on("click",function(a){var b=zmail.Settings.MailSuite.App.Core.Framework;b.requestShowPage("calendar-group",{}).done(function(){}).fail(function(){})})}}else if(a=="apps"){if(h.find("#listCal")[0].childNodes.length==0){var b;h.find("#listCal").html('<div class="startup help zcl_mb">'+zcal.i18n.noappcal+"</div>"),$("#topB").empty()}}else if(a=="other"&&h.find("#listCal")[0].childNodes.length==0){var b;h.find("#listCal").html('<div class="startup help zcl_mb">No calendars found, <a class="SC_lnk">click here</a> to subscribe.</div>'),$("#topB").empty(),b=h.find("#listCal").find("a"),b.off("click").on("click",function(a){var b=zmail.Settings.MailSuite.App.Core.Framework;b.requestShowPage("calendar-subscribe",{}).done(function(){}).fail(function(){})})}},k=function(a){var b,c;b=zcal.getCalObj(a),c=b[2]==1?!1:!0,l(a,c,b)},l=function(a,b,c){var d="/cal/calAct.do?mode=en-dis&calid="+a+"&isen="+b;ZCL_XHR(d,function(d){var e=ZCL_Evl(1,d.responseText);e.status=="success"&&(c[2]=b?"1":"0",$.publish("/calendar/statusChanged",{calid:a,sts:c[2]}))})},m=function(a,b){var c="my",d,e,f,g,i,j,l,m=$('<div id="d" class="zmL '+(b[8]==1?"":"disableFilter")+'" data-id="'+a+'"><ul></ul></div>'),p=ZCL_getCalColor(b[1])[1],r=ZCL_getHTML(b[0]),s=$('<li><div style="background-color:'+p+'" class="SClbl"><i class="'+(b[2]==1?"msi-tick":"")+'"></i></div></li>');j=s.find(".SClbl"),j.off("click").on("click",{calid:a},function(a){var b=a.data.calid;k(b)}),m.find("ul").append(s);var t=$('<li><strong class="filterControl">'+r+"</strong></li>");n(t,a,b,c),m.find("ul").append(t);var u=$('<li class="filterControl"><b></b></li>');l=u.find("b"),d=$('<span data-id="det">'+zcal.i18n.details+"</span>"),d.off("click").on("click",{calid:a,cobj:b},function(a){var b=zmail.Settings.MailSuite.App.Core.Framework;b.requestPreviewCard({getView:function(){return o(a.data.calid,a.data.cobj,c)}}).done(function(a){a.card.show()})}),l.append(d);if(zcal.shrCal!="0"||zcal.pvtUrl!="0")e=$('<span data-id="sh">'+zcal.i18n.share+"</span>"),e.off("click").on("click",{calid:a,cobj:b},function(a){var b=zmail.Settings.MailSuite.App.Core.Framework;b.requestPreviewCard({getView:function(){return q(a.data.calid,a.data.cobj)}}).done(function(a){a.card.show()})}),l.append(e);zcal.impExp!="0"&&b[13][2]==1&&(f=$('<span data-id="exp">'+zcal.i18n.exports+"</span>"),f.off("click").on("click",{calid:a,ckey:b[9]},function(a){ZCL_formSubmit({ckey:a.data.ckey,mode:"calexp"},"/cal/export.do","GET")}),l.append(f)),b[13][3]==1&&(g=$('<span data-id="emp">'+zcal.i18n.empty+"</span>"),g.off("click").on("click",{calid:a},function(a){var b=a.data.calid;ZCL_empCal(b)}),l.append(g)),b[13][4]==1&&(i=$('<span data-id="del">'+zcal.i18n.del+"</span>"),i.off("click").on("click",{calid:a,ckey:b[9]},function(a){var b=a.data.calid;ZCL_delCal(b,!1,c)}),l.append(i)),m.find("ul").append(u);var v=$('<li><div class="onoffButton" style="background-color: transparent !important;"></div></li>');if(b[3]=="false"){var w=$("<div data-on="+zcal.i18n.on+" data-off="+zcal.i18n.off+">");b[8]==0?w.addClass("sdiv sadiv"):w.addClass("sdiv"),w.off("click").on("click",{calid:a},function(a){var c=$(this),d=c.parents(".zmL"),e=a.data.calid;ZCL_XHR("/cal/calAct.do?mode=sh-hde&calid="+e+"&isshow="+(c.hasClass("sadiv")?!0:!1),function(a){var f=ZCL_Evl(1,a.responseText);f.status=="success"&&(b[8]=f.isshow?1:0,c.removeAttr("class").addClass(f.isshow?"sdiv inctop":"sdiv sadiv"),d.removeAttr("class").addClass(f.isshow?"zmL":"zmL disableFilter"),$.publish("/calendar/visibilityChanged",{calid:e,visibility:f.isshow}))})}),v.find(".onoffButton").append(w)}m.find("ul").append(v),h.find("#listCal").append(m)},n=function(a,b,c,d){a.on("click",{calid:b,cobj:c,ty:d},function(a){var b=zmail.Settings.MailSuite.App.Core.Framework;b.requestPreviewCard({getView:function(){return o(a.data.calid,a.data.cobj,a.data.ty)}}).done(function(a){a.card.show()})})},o=function(a,b,c){var d,e=$("<div class='SC_Twpr zcl_Twpr zcl_Twpr_list'  id='zcl_callist'></div>"),f=$("<div class='SC_setTab'><div class='SC_setTabList'><span class='sel' id='det'>"+zcal.i18n.details+"</span><span id='em'>"+zcal.i18n.embed+"</span></div></div>"),g="det";if(c=="apps"||c=="groups"){if(b[13][0]!=0||b[13][7]!=0)d="<span id='sh'>"+zcal.i18n.share+"</span>",$(d).insertBefore(f.find(".SC_setTabList")[0].childNodes[1])}else if(c=="my"){if(zcal.shrCal!="0"||zcal.pvtUrl!="0")d="<span id='sh'>"+zcal.i18n.share+"</span>",$(d).insertBefore(f.find(".SC_setTabList")[0].childNodes[1])}else c=="other"&&b[13][0]!=0&&zcal.shrCal!="0"&&(d="<span id='sh'>"+zcal.i18n.share+"</span>",$(d).insertBefore(f.find(".SC_setTabList")[0].childNodes[1]));var h=$(this),i,j,k,l=a,m=b;return i=zcalDetailsView.render(l,m),f.find("#det").on("click",function(a){var b=$(this);b.parent().find("span").removeClass("sel"),b.addClass("sel"),e[0].removeChild(e[0].childNodes[1]),i=zcalDetailsView.render(l,m),e.append(i)}),f.find("#sh").on("click",function(a){var b=$(this);b.parent().find("span").removeClass("sel"),b.addClass("sel"),e[0].removeChild(e[0].childNodes[1]),j=zcalShareView.render(l,m),e.append(j)}),f.find("#em").on("click",function(a){var b=$(this);b.parent().find("span").removeClass("sel"),b.addClass("sel"),e[0].removeChild(e[0].childNodes[1]),k=zcalEmbedView.render(l,m),e.append(k)}),e.append(f),e.append(i),e},p=function(a,b){var c=$("<div class='SC_Twpr zcl_Twpr zcl_Twpr_list'  id='zcl_callist'></div>"),d=$("<div class='SC_setTab'><div class='SC_setTabList'><span id='det'>"+zcal.i18n.details+"</span><span id='sh'>"+zcal.i18n.share+"</span><span class='sel' id='em'>"+zcal.i18n.embed+"</span></div></div>"),e=zcalEmbedView.render(a,b),f,g;return d.find("#det").on("click",function(d){var e=$(this);e.parent().find("span").removeClass("sel"),e.addClass("sel"),c[0].removeChild(c[0].childNodes[1]),f=zcalDetailsView.render(a,b),c.append(f)}),d.find("#sh").on("click",function(d){var e=$(this);e.parent().find("span").removeClass("sel"),e.addClass("sel"),c[0].removeChild(c[0].childNodes[1]),g=zcalShareView.render(a,b),c.append(g)}),d.find("#em").on("click",function(d){var f=$(this);f.parent().find("span").removeClass("sel"),f.addClass("sel"),c[0].removeChild(c[0].childNodes[1]),e=zcalEmbedView.render(a,b),c.append(e)}),c.append(d),c.append(e),c},q=function(a,b){var c=$("<div class='SC_Twpr zcl_Twpr zcl_Twpr_list'  id='zcl_callist'></div>"),d=$("<div class='SC_setTab'><div class='SC_setTabList'><span id='det'>"+zcal.i18n.details+"</span><span class='sel' id='sh'>"+zcal.i18n.share+"</span><span id='em'>"+zcal.i18n.embed+"</span></div></div>"),e=zcalShareView.render(a,b),f,g;return d.find("#det").on("click",function(d){var e=$(this);e.parent().find("span").removeClass("sel"),e.addClass("sel"),c[0].removeChild(c[0].childNodes[1]),f=zcalDetailsView.render(a,b),c.append(f)}),d.find("#sh").on("click",function(d){var f=$(this);f.parent().find("span").removeClass("sel"),f.addClass("sel"),c[0].removeChild(c[0].childNodes[1]),e=zcalShareView.render(a,b),c.append(e)}),d.find("#em").on("click",function(d){var e=$(this);e.parent().find("span").removeClass("sel"),e.addClass("sel"),c[0].removeChild(c[0].childNodes[1]),g=zcalEmbedView.render(a,b),c.append(g)}),c.append(d),c.append(e),c},r=function(){var a="groups",b=zcal.cdata.gcalOdrArr;h[0].removeChild(h[0].childNodes[1]);var c=$('<div><div class="zcl_Twpr_Callist"><div class="SC_filt_bottom SC_filt_bottomCustom"  id="topB"><div class="zmL SC_filt_bld"><ul class="bld"><li></li><li>Calendar Name</li><li>Actions</li> <li class="conditions">Status</li></ul></div></div><div class="SC_Twpr zcl_Twpr_Callist zcl_setsrl"> <div class="SC_filt_bottom SC_filt_bottomCustom" id="listCal"></div></div></div></div>'),d=h.find("#grpCal");d.parent().find("li").removeClass("stSel"),d.addClass("stSel"),h.append(c);for(var e in b){var f=b[e],g=zcal.cdata.calGLst;s(f,g[f])}j(a)},s=function(a,b){var c="groups",d,e,f,g,i,j=$('<div class="zmL '+(b[8]==1?"":"disableFilter")+'" data-id="'+a+'"><ul></ul></div>'),l=ZCL_getCalColor(b[1])[1],m=ZCL_getHTML(b[0]),p=$('<li><div style="background-color:'+l+'" class="SClbl"><i class="'+(b[2]==1?"msi-tick":"")+'"></i></div></li>');g=p.find(".SClbl"),g.off("click").on("click",{calid:a},function(a){var b=a.data.calid;k(b)}),j.find("ul").append(p);var r=$('<li><strong class="filterControl">'+m+"</strong></li>");n(r,a,b,c),j.find("ul").append(r);var s=$('<li class="filterControl"><b></b></li>');i=s.find("b"),d=$('<span data-id="det">'+zcal.i18n.details+"</span>"),d.off("click").on("click",{calid:a,cobj:b},function(a){var b=zmail.Settings.MailSuite.App.Core.Framework;b.requestPreviewCard({getView:function(){return o(a.data.calid,a.data.cobj,c)}}).done(function(a){a.card.show()})}),i.append(d);if(b[13][0]!=0||b[13][7]!=0)e=$('<span data-id="sh">'+zcal.i18n.share+"</span>"),e.off("click").on("click",{calid:a,cobj:b},function(a){var b=zmail.Settings.MailSuite.App.Core.Framework;b.requestPreviewCard({getView:function(){return q(a.data.calid,a.data.cobj)}}).done(function(a){a.card.show()})}),i.append(e);b[13][5]==1&&(f=$('<span data-id="del">'+zcal.i18n.unsubscribe+"</span>"),f.off("click").on("click",{calid:a,ckey:b[9]},function(a){var b=a.data.calid;x(b,!0,c)}),i.append(f)),j.find("ul").append(s);var t=$('<li><div class="onoffButton" style="background-color: transparent !important;"></li>');if(b[3]=="false"){var u=$("<div data-on="+zcal.i18n.on+" data-off="+zcal.i18n.off+"></div>");b[8]==0?u.addClass("sdiv sadiv"):u.addClass("sdiv"),u.off("click").on("click",{calid:a},function(a){var c=$(this),d=c.parents(".zmL"),e=a.data.calid;ZCL_XHR("/cal/calAct.do?mode=sh-hde&calid="+e+"&isshow="+(c.hasClass("sadiv")?!0:!1),function(a){var f=ZCL_Evl(1,a.responseText);f.status=="success"&&(b[8]=f.isshow?1:0,c.removeAttr("class").addClass(f.isshow?"sdiv inctop":"sdiv sadiv"),d.removeAttr("class").addClass(f.isshow?"zmL":"zmL disableFilter"),$.publish("/calendar/visibilityChanged",{calid:e,visibility:f.isshow}))})}),t.find(".onoffButton").append(u)}j.find("ul").append(t),h.find("#listCal").append(j)},t=function(){var a="apps",b=$('<div><div class="zcl_Twpr_Callist"><div class="SC_filt_bottom SC_filt_bottomCustom"  id="topB"><div class="zmL SC_filt_bld"><ul class="bld"><li></li><li>Calendar Name</li><li>Actions</li> <li class="conditions">Status</li></ul></div></div><div class="SC_Twpr zcl_Twpr_Callist zcl_setsrl"> <div class="SC_filt_bottom SC_filt_bottomCustom" id="listCal"></div></div></div></div>');h[0].removeChild(h[0].childNodes[1]),h.append(b);var c=h.find("#appCal");c.parent().find("li").removeClass("stSel"),c.addClass("stSel"),g=zcal.cdata.calALst;for(var d in g)u(d,g[d]);j(a)},u=function(a,b){var c="apps",d,e,f,g,i,j,l=$('<div class="zmL '+(b[8]==1?"":"disableFilter")+'" data-id="'+a+'"><ul></ul></div>'),m=ZCL_getCalColor(b[1])[1],p=ZCL_getHTML(b[0]),r=$('<li><div style="background-color:'+m+'" class="SClbl"><i class="'+(b[2]==1?"msi-tick":"")+'"></i></div></li>');g=r.find(".SClbl"),g.off("click").on("click",{calid:a},function(a){var b=a.data.calid;k(b)}),l.find("ul").append(r);var s=$('<li><strong class="filterControl">'+p+"</strong></li>");n(s,a,b,c),l.find("ul").append(s);var t=$('<li class="filterControl"><b></b></li>');j=t.find("b"),d=$('<span data-id="det">'+zcal.i18n.details+"</span>"),d.off("click").on("click",{calid:a,cobj:b},function(a){var b=zmail.Settings.MailSuite.App.Core.Framework;b.requestPreviewCard({getView:function(){return o(a.data.calid,a.data.cobj,c)}}).done(function(a){a.card.show()})}),j.append(d);if(b[13][0]!=0||b[13][7]!=0)e=$('<span data-id="sh">'+zcal.i18n.share+"</span>"),e.off("click").on("click",{calid:a,cobj:b},function(a){q(a.data.calid,a.data.cobj)}),j.append(e);b[13][5]==1&&(f=$('<span data-id="del">'+zcal.i18n.unsubscribe+"</span>"),f.off("click").on("click",{calid:a,ckey:b[9]},function(a){var b=a.data.calid;x(b,!0,c)}),j.append(f));if(b[5]==2||b[5]==5&&(b[14]=="zcontacts"||b[14]=="zprojects"))i=$('<span data-id="upd">'+zcal.i18n.update+"</span>"),i.off("click").on("click",{calid:a,ckey:b[9]},function(a){var b=a.data.calid;y(b)}),j.append(i);l.find("ul").append(t);var u=$('<li><div class="onoffButton" style="background-color: transparent !important;"></div></li>');if(b[3]=="false"){var v=$("<div data-on="+zcal.i18n.on+" data-off="+zcal.i18n.off+"></div>");b[8]==0?v.addClass("sdiv sadiv"):v.addClass("sdiv"),v.off("click").on("click",{calid:a},function(a){var c=$(this),d=c.parents(".zmL"),e=a.data.calid;ZCL_XHR("/cal/calAct.do?mode=sh-hde&calid="+e+"&isshow="+(c.hasClass("sadiv")?!0:!1),function(a){var f=ZCL_Evl(1,a.responseText);f.status=="success"&&(b[8]=f.isshow?1:0,c.removeAttr("class").addClass(f.isshow?"sdiv inctop":"sdiv sadiv"),d.removeAttr("class").addClass(f.isshow?"zmL":"zmL disableFilter"),$.publish("/calendar/visibilityChanged",{calid:e,visibility:f.isshow}))})}),u.find(".onoffButton").append(v)}l.find("ul").append(u),h.find("#listCal").append(l)},v=function(){var a=$('<div><div class="zcl_Twpr_Callist"><div class="SC_filt_bottom SC_filt_bottomCustom"  id="topB"><div class="zmL SC_filt_bld"><ul class="bld"><li></li><li>Calendar Name</li><li>Actions</li> <li class="conditions">Status</li></ul></div></div><div class="SC_Twpr zcl_Twpr_Callist zcl_setsrl"> <div class="SC_filt_bottom SC_filt_bottomCustom" id="listCal"></div></div></div></div>');h[0].removeChild(h[0].childNodes[1]),h.append(a);var b=h.find("#othCal");b.parent().find("li").removeClass("stSel"),b.addClass("stSel"),g=zcal.cdata.calOLst;for(var c in g)w(c,g[c]);j("other")},w=function(a,b){var c="other",d,e,f,g,i,j,l,m=$('<div class="zmL '+(b[8]==1?"":"disableFilter")+'" data-id="'+a+'"><ul></ul></div>'),p=ZCL_getCalColor(b[1])[1],r=ZCL_getHTML(b[0]),s=$('<li><div style="background-color:'+p+'" class="SClbl"><i class="'+(b[2]==1?"msi-tick":"")+'"></i></div></li>');i=s.find(".SClbl"),i.off("click").on("click",{calid:a},function(a){var b=a.data.calid;k(b)}),m.find("ul").append(s);var t=$('<li><strong class="filterControl">'+r+"</strong></li>");n(t,a,b,c),m.find("ul").append(t);var u=$('<li class="filterControl"><b></b></li>');l=u.find("b"),d=$('<span data-id="det">'+zcal.i18n.details+"</span>"),d.off("click").on("click",{calid:a,cobj:b},function(a){var b=zmail.Settings.MailSuite.App.Core.Framework;b.requestPreviewCard({getView:function(){return o(a.data.calid,a.data.cobj,c)}}).done(function(a){a.card.show()})}),l.append(d),b[13][0]!=0&&zcal.shrCal!="0"&&(e=$('<span data-id="sh">'+zcal.i18n.share+"</span>"),e.off("click").on("click",{calid:a,cobj:b},function(a){var b=zmail.Settings.MailSuite.App.Core.Framework;b.requestPreviewCard({getView:function(){return q(a.data.calid,a.data.cobj)}}).done(function(a){a.card.show()})}),l.append(e)),b[13][5]==1&&(g=$('<span data-id="del">'+zcal.i18n.unsubscribe+"</span>"),g.off("click").on("click",{calid:a,ckey:b[9]},function(a){var b=a.data.calid;x(b,!0,c)}),l.append(g)),b[5]==2&&(j=$('<span data-id="upd">'+zcal.i18n.update+"</span>"),j.off("click").on("click",{calid:a,ckey:b[9]},function(a){var b=a.data.calid;y(b)}),l.append(j)),m.find("ul").append(u);var v=$('<li><div class="onoffButton" style="background-color: transparent !important;"></div></li>');if(b[3]=="false"){var w=$("<div data-on="+zcal.i18n.on+" data-off="+zcal.i18n.off+">");b[8]==0?w.addClass("sdiv sadiv"):w.addClass("sdiv"),w.off("click").on("click",{calid:a},function(a){var c=$(this),d=c.parents(".zmL"),e=a.data.calid;ZCL_XHR("/cal/calAct.do?mode=sh-hde&calid="+e+"&isshow="+(c.hasClass("sadiv")?!0:!1),function(a){var f=ZCL_Evl(1,a.responseText);f.status=="success"&&(b[8]=f.isshow?1:0,c.removeAttr("class").addClass(f.isshow?"sdiv inctop":"sdiv sadiv"),d.removeAttr("class").addClass(f.isshow?"zmL":"zmL disableFilter"),$.publish("/calendar/visibilityChanged",{calid:e,visibility:f.isshow}))})}),v.find(".onoffButton").append(w)}m.find("ul").append(v),h.find("#listCal").append(m)},x=function(a,b,c){var d,e=b?zcal.i18n.areyousureunsub:zcal.i18n.deletecalendar;zmsDialog.confirm(e,{onOk:function(){d=zcal.getCalObj(a),ZCL_XHR("/cal/calAct.do?mode=del&calid="+a+"&calencpt="+d[9],function(b){var d=ZCL_Evl(1,b.responseText);d.status=="success"&&$.publish("/calendar/deleted",{calid:a,caluid:d.uid,mode:"delete",type:c})})}})},y=function(a){var b=zcal.CALMODE==1?"/cal/gsubCal.do?&grpid="+ZCL_ZGID+"&mode=userUpd&calid="+a:"/cal/subCal.do?mode=userUpd&calid="+a;ZCL_XHR(b,function(){ZCL_setCalendars(),zcalEvents.loadMonthData(),zmUtil.succErrMsg("s",zcal.i18n.updatedsuccessfully)})},z=function(a,b){var c=b.calid,d=b.sts,e;e=h.find("[data-id="+c+"]"),e.find("i").length>0&&e.find("i").removeAttr("class").addClass(b.sts==1?"msi-tick":"")},A=function(){$.subscribe("/calendar/added",i),$.subscribe("/calendar/updated",i),$.subscribe("/calendar/deleted",a.delCal),$.subscribe("/calendar/statusChanged",a.updCalSts)};a.initialize=c,a.uninitialize=d,a.delCal=e,a.updCalSts=z,a.getMGAOCalendarsView=i,a.openShare=q,a.openEmbed=p,a.groupCalendarView=r,a.appCalendarView=t,a.otherCalendarView=v,a.ZCL_delCal=x},"MailSuite.Apps.CalendarMGAOCalendars");var zcalDetailsView=function(a){a=a||{};var b,c,d,e,f,g,h,i,j=function(){var a=zmail.Settings.MailSuite.App.Core.Framework;a.requestPreviewCard().done(function(a){a.close()})},k=function(){var a,b,h=g&&g.find(".msi-check").length>0?"1":"0",i=$("#zcl_calname")[0].value,k=$("#zcl_caldesc")[0].getElementsByTagName("TEXTAREA")[0].value.trim().replace(zcal.REG,"").zcalescape(),l=ZCL_$("zcl_calcol").getElementsByTagName("li"),m=0;for(var n in l){var o=l[n].getElementsByTagName("i");if(o.length>0&&o[0].className=="msi-tick"){m=l[n].getAttribute("rel");break}}var p=$("#zcl_txtcol")[0].getElementsByTagName("i"),q=1;p[0].className=="msi-option"&&(q=0),a=ZCL_getAlarmObj(f[0].childNodes)[0];if(!!a.ACTYPE||a.ACTYPE==d[6].ACTYPE&&a.ACTYPE!=undefined){if(a.ACTYPE!=d[6].ACTYPE||a.REMTIME!=d[6].REMTIME||a.REMTYPE!=d[6].REMTYPE||h!=d[16])b="&remt="+a.REMTIME+"&remty="+a.REMTYPE+"&actty="+a.ACTYPE+"&busy="+h}else b="&remt=&remty=&actty=&busy="+h;b&&ZCL_XHR("/cal/calAct.do?mode=edit-adv&caluid="+e+"&calid="+c+b+"&calcol="+m+"&txtcol="+q+"&caldesc="+k+"&calname="+i,function(a){var b=ZCL_Evl(1,a.responseText);if(b.status==="success"){d[6]=b.obj.REM,d[16]=b.obj.BUSY,zmUtil.succErrMsg("s",zcal.i18n.updatedsuccessfully);var c=zcal.getCalObj(b.id);c[0]=b.calobj[0],c[1]=b.calobj[1],c[4]=b.calobj[4],$.publish("/calendar/updated"),j()}})},l=function(a){a=a?a:"0";var b="<ul >",c=!1;for(var d=0;d<zcal.calcolor.length;d++)c=a==d||zcal.calcolor[d][1].toLowerCase()==a.toLowerCase()?!0:c,b+='<li id="selCo" style="background-color:'+zcal.calcolor[d][1]+';" rel="'+d+'">',b+=a==d||zcal.calcolor[d][1].toLowerCase()==a.toLowerCase()?'<i class="msi-tick"></i>':"",b+=d==9?"</ul><ul>":"";return b+="</ul>",c||(b+='<ul><li id="selCo" style="background-color:'+a+'" rel="'+a+'"><i class="msi-tick"></i></li>',b+="<li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>"),b},m=function(a){var b=zcal.$("zcl_calcol").getElementsByTagName("li");for(var c in b)b[c].innerHTML="";a.innerHTML='<i class="msi-tick"></i>'};return a.render=function(a,m){c=a,d=m,e=d[9];var n=ZCL_getHTML(m[0]),o=d[1].split(":")[0],p=d[1].split(":")[1];b=$('<div id="caldetails" class="SC_Twpr zcl_Twpr" style="top:46px"><div class="SC_filt_bottom SC_filt_bottomCustom" id="SC_detail"></div></div>');var q='<div class="editFilterParent zcl_stfrm">';q+='<div class="zmL noPad">',q+='<div class="SC_srch shw">',q+='<table class="condition">',q+="<tbody>",q+='<tr><td class="gbld">'+zcal.i18n.calname+"</td></tr>",q+='<tr><td><table><tbody><tr><td><div class="SC_select SC_selectnoneArw newFltr"><input id="zcl_calname" placeholder="" value="'+n+'" type="text"></div></td></tr></tbody></table></td></tr>',q+="</tbody>",q+="</table>",q+=m[4]&&m[4]!=""?'<div class="zmL"  id="zcl_caldesc"><div class="SC_srch shw"><table class="condition"><tbody><tr><td class="gbld">Description</td></tr><tr><td><textarea class="SC_tiput" >'+m[4]+"</textarea></td></tr></tbody></table></div></div>":'<span class="zcl_grey zcl_cp" id="zcl_opencaldesc">+'+zcal.i18n.addnote+'</span><div class="zmL" style="display:none"  id="zcl_caldesc"><div class="SC_srch shw"><table class="condition"><tbody><tr><td class="gbld">'+zcal.i18n.description+'</td></tr><tr><td><textarea class="SC_tiput"  ></textarea></td></tr></tbody></table></div></div>',q+="</div>",q+="</div>",q+='<div class="zcl_sczml"><div class="SC_srch shw"><div class="gbld">Calendar Color</div></div>',q+='<div class="zcl_calcol" id="zcl_calcol">'+l(o)+"</div>",q+='<div class="zcl_addcaltx zcl_sczml">',q+='<div class="SC_srch shw">',q+='<div class="gbld">Text color</div>',q+="</div>",q+='<u data-marker ="textColor" id="zcl_txtcol"><i class="'+(p==0?"msi-option":"msi-unoption")+'"></i><u class="">White</u></u><u data-marker ="textColor"><i class="'+(p==1?"msi-option":"msi-unoption")+'"></i><u class="">Black</u></u>',q+="</div>",q+='<div class="zmL">',q+='<div class="SC_srch shw">',q+='<table class="condition">',q+="<tbody>",q+='<tr><td class="gbld">'+zcal.i18n.calendarid+"</td></tr>",q+='<tr><td><p class="zcl_Calid">'+e+"</p></td></tr>",q+="</tbody>",q+="</table>",q+="</div>",q+="</div>",q+='<div class="zmL">',q+='<div class="SC_srch shw">',q+='<table class="condition">',q+="<tbody>",q+='<tr><td class="gbld">'+zcal.i18n.reminder+"</td></tr>",q+="</tbody>",q+="</table>",q+="</div>",q+='<ul id="zcl_addrem" class="zcl_rem">',q+='<li data-marker="calReminder">',q+='<span><i class="msi-add"></i>Add Reminder</span>',q+="</li>",q+="</ul>",q+="</div>",q+='<div class="zmL">',q+='<div class="SC_srch shw">',q+='<p class="match" data-marker="markAsBusy">',q+='<em><i class="msi-check"></i>',q+='<span class="fn ml5">'+zcal.i18n.markasbusy_cal+"</span>",q+="</em>",q+="</p>",q+="</div>",q+="</div>",q+='<div class="SC_PUbtm">',q+='<span class="sel" data-marker="detailSave">'+zcal.i18n.save+"</span>",q+='<span data-val="Cancel">'+zcal.i18n.cancel+"</span>",q+="</div>",q+="</div>",b.find("#SC_detail").append($(q)),f=b.find("[data-marker=calReminder]").removeAttr("data-marker"),f.html(ZCL_putCalAlarm(d[6])),f.find(".msi-close").off("click").on("click",function(){$(this).closest("ul").remove(),f.find("#zcl_addrem").length||ZCL_AppendRemAddLnk(f[0])}),g=b.find("[data-marker=markAsBusy]").removeAttr("data-marker");if(d[16]!=undefined&&d[16]!=""){var r=g.find("i");r.length>0&&(r.removeAttr("class").addClass(d[16]=="1"?"msi-check":"msi-uncheck"),r.off("click").on("click",function(){this.className=this.className=="msi-check"?"msi-uncheck":"msi-check"}))}else g.remove();b.find("#zcl_opencaldesc").off("click").on("click",function(){ZCL_$("zcl_caldesc").style.display="",this.style.display="none"});var s=b.find("[data-marker=textColor]").removeAttr("data-marker");s.on("click",function(a){var b=$(this);b.parent().find("i").removeClass("msi-option").addClass("msi-unoption"),b.find("i").removeClass("msi-unoption").addClass("msi-option")});var t=b.find("#selCo");return t.on("click",function(a){var b=zcal.$("zcl_calcol").getElementsByTagName("li");for(var c in b)b[c].innerHTML="";a.target.innerHTML='<i class="msi-tick"></i>'}),h=b.find("[data-marker=detailSave]").removeAttr("data-marker"),h.off("click").on("click",k),i=b.find("[data-val=Cancel]"),i.off("click").on("click",j),b},a.close=j,a}(zcalDetailsView||{}),zcalShareView=function(a){a=a||{};var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r={};a.render=function(a,g){c=a,d=g,e=d[9],p=ZCL_Evl(1,JSON.stringify(zcal.cdata.grpLst)),b=$('<div id="zcl_calshare" class="SC_Twpr zcl_Twpr" style="top:46px"><div class="SC_filt_bottom SC_filt_bottomCustom" id="SC_detail"></div></div>');var k='<div class="editFilterParent zcl_stfrm">';k+='<div data-marker="publicShare" class="zmL"></div>',k+='<div data-marker="privateAddress" class="zmL"></div>',k+='<div data-marker="indShare" class="zmL"></div>',k+='<div class="zcl_Sshlst" data-marker="sharedList"></div>',k+='<div class="SC_PUbtm"><span data-val="Cancel">'+zcal.i18n.cancel+"</span></div>",k+="</div>";var l=$(k);if(d[13][0]!=0||d[13][7]==1)return h=l.find("[data-marker=publicShare]").removeAttr("data-marker"),i=l.find("[data-marker=privateAddress]").removeAttr("data-marker"),j=l.find("[data-marker=indShare]").removeAttr("data-marker"),o=l.find("[data-marker=sharedList]").removeAttr("data-marker"),d[13][0]==0&&d[13][7]==1?zcal.pvtUrl!=0&&(d[5]==3?s():Q()):d[13][0]==1&&d[13][7]==0?zcal.shCal!=0&&zcal.shCal!=1&&(d[5]==3?s():F()):d[13][0]==1&&d[13][7]==1?zcal.shCal==0&&zcal.pvtUrl!=0?d[5]==3?s():Q():zcal.shCal!=0&&zcal.shCal!=1&&zcal.pvtUrl==0?d[5]==3?s():F():zcal.shCal!=0&&zcal.shCal!=1&&zcal.pvtUrl!=0&&(d[5]==3?s():(F(),Q())):zcal.shCal==0&&zcal.pvtUrl!=0?(h&&(h.remove(),h=undefined),j&&(j.remove(),j=undefined),o&&(o.remove(),o=undefined),Q()):zcal.shCal==1&&zcal.pvtUrl==0?(h&&(h.remove(),h=undefined),i&&(i.remove(),i=undefined),zcal.cdata.calLst[c]?u():t()):zcal.shCal==1&&zcal.pvtUrl!=0?(h&&(h.remove(),h=undefined),zcal.cdata.calLst[c]?(Q(),u()):t()):zcal.shCal==2&&zcal.pvtUrl==0?(i&&(i.remove(),i=undefined),zcal.cdata.calLst[c]?(F(),u()):t()):zcal.cdata.calLst[c]?(F(),Q(),u()):t(),f=l.find("[data-val=Cancel]"),f.off("click").on("click",T),b.find("#SC_detail").html(l),b;b=undefined,b.remove()};var s=function(){var a="/cal/shareCal.do?mode=cal-pubpvtinfo&caluid="+d[9]+"&calid="+c+"&calmode=0";ZCL_XHR(a,function(a){var b=ZCL_Evl(1,a.responseText);b.obj&&(d[10]=b.obj),F()})},t=function(){var a="/cal/shareCal.do?mode=sh-calinfo&caluid="+d[9]+"&calid="+c+"&calmode=0";ZCL_XHR(a,function(a){var b=ZCL_Evl(1,a.responseText);b.calinfo&&(d[10]=b.calInfo[10],d[11]=b.calInfo[11],d[12]=b.calInfo[12]),b.pvtLst&&(q=b.pvtLst,w()),b.grpInfo&&(p.grp=b.grpInfo),F()})},u=function(){var a="/cal/shareCal.do?mode=priv-shlst&calid="+c+"&calmode=0";ZCL_XHR(a,function(a){var b=ZCL_Evl(1,a.responseText);b.obj&&(q=b.obj,w())})},v=function(a){var b=[],c=a.menuItems||[];c.forEach(function(a){var c=a.value,d=a.text;b.push({htm:"<div>"+d+"</div>",data:{value:c,text:d}})});var d=$.Deferred();return a.list=b,a.clk=function(a,b,c){d.resolve(a,b,c)},a.onHide=function(){d.reject()},b.length?zmsuite.showMenu(a):d.reject(),d.fail(zmUtil.hideMenu),d.promise()},w=function(){var a='<div class="SC_srch shw">';a+='<table class="condition">',a+="<tbody>",a+='<tr><td class="gbld">Share with individuals or groups</td></tr>',a+="</tbody>",a+="</table>",a+="</div>",a+='<div class="SC_srch shw">',a+='<table class="condition">',a+="<tbody>",a+="<tr><td><table><tbody><tr>",a+='<td width="60px"><div class="SC_select first zcl_w60" data-marker="shareType"><i class="msi-invitee"></i></div></td>',a+='<td width="43%" class="zcl_Calshemail"><div class="SC_select SC_selectnoneArw" ><input placeholder="'+zcal.i18n.typeaemailid+'" value="" class="zm_sgst" type="text" data-marker="shareTo"></div></td>',a+='<td width="29%"><div class="SC_select"><input class="disabled" readonly="" value="'+zcal.i18n.private_shperm_viewevent+'" type="text"   data-marker="sharePerm"></div></td>',a+='<td class="tRht"><span><i class="msi-plus"></i></span></td>',a+="</tr></tbody></table></td></tr>",a+="</tbody>",a+="</table>",a+="</div>",j.html(a),k=j.find("[data-marker=shareType]").removeAttr("data-marker"),l=j.find("[data-marker=shareTo]").removeAttr("data-marker"),m=j.find("[data-marker=sharePerm]").removeAttr("data-marker");var b=j.find(".msi-plus");b.off("click").on("click",function(a){if(r.type==1){var b=l.attr("data-gid");if(b==null)return!1;r.grpid=b}else{var c=l[0].value;if(!ZCL_isEmail(c))return zmUtil.succErrMsg("e",zcal.i18n.entervalidemail),l[0].focus(),!1;r.email=c}z(r)}),A({value:0}),x()},x=function(){var a=$("<table></table>");for(var b in q[0]){var c,d,e=E(0),f,g=e[q[0][b]].text;c=$('<tr><td><i class="msi-invitee"></i></td><td width="43%"><span>'+ZCL_getHTML(b)+'</span></td><td width="29%"><div class="SC_select"><input type="text" class="disabled" readonly value="'+g+'"></div></td><td><i class="msi-close"></i></td></tr>'),d=c.find("input"),d.off("click").on("click",{menuItems:e,email:b},function(a){v({menuItems:a.data.menuItems,par:this,parWidth:!0}).then(function(b){z({type:0,email:a.data.email,perm:b.value}),zmUtil.hideMenu()})}),f=c.find(".msi-close"),f.off("click").on("click",{email:b},function(a){y({email:a.data.email,mode:0})}),a.append(c)}for(var h in q[1]){var i=p.pgrp[h]||p.ogrp[h];if(i){var c,d,e=E(1),f,g=e[q[1][h]].text;c=$('<tr><td width="5%"><i class="msi-group"></i></td><td width="43%"><span>'+ZCL_getHTML(i.GNAME)+'</span></td><td width="29%"><div class="SC_select"><input type="text" class="disabled" readonly value="'+g+'"></div></td><td><i class="msi-close"></i></td></tr>'),d=c.find("input"),d.off("click").on("click",{menuItems:e,grpid:h},function(a){v({menuItems:a.data.menuItems,par:this,parWidth:!0}).then(function(b){z({type:1,grpid:a.data.grpid,perm:b.value}),zmUtil.hideMenu()})}),f=c.find(".msi-close"),f.off("click").on("click",{grpid:h},function(a){y({grpid:a.data.grpid,mode:1})}),a.append(c)}}o.html(a)},y=function(a){var b=a.mode,e="/cal/shareCal.do?&calid="+c+"&caluid="+d[9]+"&calmode=0";e+=b==0?"&mode=priv-sh-del&shuser="+a.email.zcalescape():"&mode=grp-sh-del&grpid="+a.grpid,ZCL_XHR(e,function(a){var b=ZCL_Evl(1,a.responseText),c,d;c=b.mode,d=b.obj,c=="grp-sh-del"?delete q[1][d[0]]:delete q[0][d[0]],zmUtil.succErrMsg("s","Calendar sharing removed successfully"),x()})},z=function(a){var b="/cal/shareCal.do?calid="+c+"&perm="+a.perm+"&caluid="+e+"&calmode=0";a.type==1?b+="&mode=grp-sh&grpid="+a.grpid:b+="&mode=priv-sh&shuser="+a.email.zcalescape(),ZCL_XHR(b,function(a){var b=ZCL_Evl(1,a.responseText),c;if(b.status!="success"){b.status=="maxLmtReached"?zmUtil.succErrMsg("e",ZCL_replaceString(zcal.i18n.maxLmtReached,[60])):b.status=="noPermission"?zmUtil.succErrMsg("e",zcal.i18n.NoPermission):b.status=="WaitForApprvl"&&zmUtil.succErrMsg("e",zcal.i18n.waitingforapproval);return}zmUtil.succErrMsg("s",zcal.i18n.sharedsuccessfully),c=b.obj,b.mode==="grp-sh"?q[1][c[0]]=c[1]:q[0][c[0]]=c[1],w()})},A=function(a){var b=ZCL_isEmpty(p.pgrp)&&ZCL_isEmpty(p.ogrp)?!1:!0,c=a.value,d=E(c);r.type=c,r.perm=d[1].value,k&&(k.html('<i class="'+(c==1?"msi-group":"msi-invitee")+'"></i>'),k.off("click").on("click",{isgrp:b},function(a){var b=[{value:0,text:zcal.i18n.individuals}];a.data.isgrp&&b.push({value:1,text:zcal.i18n.groups}),v({menuItems:b,par:this,parWidth:!1}).then(function(a){A(a),zmUtil.hideMenu()})})),n&&zmAutoFill.removeAutoFill(n);if(l){l.off("click"),l.val("");if(c==1){l.attr("placeholder",zcal.i18n.selectagroup);var e=D();l.off("click").on("click",function(a){var b={},c=$(this),d;b.parentDOM=c.parent(),b.displayAs="dropdown",b.onSelect=function(a,b){B(c,a,b),d.hide()},b.dataCallback=function(){return e},d=zmUtil.createFLComp("generic",b),d.show()})}else{l.attr("placeholder",zcal.i18n.typeaemailid);var f=zmSearch.getAFObj(0,function(a,b){l[0].value=a.eid,r.email=a.eid});n=zmAutoFill.setAutofill(f,l)}}m&&m.off("click").on("click",function(a){var b=this;v({menuItems:d,par:this,parWidth:!0}).then(function(a){b.value=a.text,r.perm=a.value,zmUtil.hideMenu()})})},B=function(a,b,c){a.val(c.display_text),a.attr("data-gid",b)},C=function(a,b){for(var c=0;c<b.length;c++){var d=zcalGroup.getGroup(b[c]);d&&a.push({id:b[c],name:d.name,display_text:d.name})}},D=function(){var a=[],b;return b=zcalGroup.getGroupList("personal"),C(a,b),b=zcalGroup.getGroupList("org"),C(a,b),a},E=function(a){var b=[{value:0,text:zcal.i18n.private_shperm_freebusy},{value:1,text:zcal.i18n.private_shperm_viewevent}];return a==0&&(b.push({value:2,text:zcal.i18n.private_shperm_editevent}),b.push({value:3,text:zcal.i18n.private_shperm_delegate})),b},F=function(){var a,b,c,e,f,g,i='<div class="SC_srch shw">';i+='<table class="condition">',i+="<tbody>",i+='<tr><td class="gbld">'+zcal.i18n.public_share+"</td></tr>",i+="</tbody>",i+="</table>",i+="</div>",i+="<div>",i+='<table class="condition">',i+="<tbody>",i+="<tr><td>",i+='<div><span data-marker="makePublic">',i+='<i class="'+(d[10][1]!=0?"msi-check":"msi-uncheck")+'"></i><span class="pl5">'+zcal.i18n.makethiscalpub+"</span>",i+="</span></div>",d[10][1]!=0&&(i+='<div class="zcl_Sshp zcl_Sshpu">',i+="<div>",i+='<span data-marker="chgPubPerm" rel="fb">',i+='<i class="'+(d[10][1]==1||d[10][1]==4?"msi-option":"msi-unoption")+'"></i><span class="pl5">'+zcal.i18n.public_shperm_freebusy+"</span>",i+="</span>",i+='<span data-marker="chgPubPerm" rel="vd">',i+='<i class="'+(d[10][1]==2||d[10][1]==3?"msi-option":"msi-unoption")+'"></i><span class="pl5">'+zcal.i18n.public_shperm_viewevent+"</span>",i+="</span>",d[13][1]==1&&(i+="<div>",i+='<span data-marker="allowER"><i class="'+(d[10][1]==3||d[10][1]==4?"msi-check":"msi-uncheck")+'"></i><span class="pl5">'+zcal.i18n.allow_requisition+"</span></span>",i+=d[10][1]==3||d[10][1]==4?'<ul><li><span class="zcl_lk" data-marker="webAPI">'+zcal.i18n.webapiforevent+'</span></li><li><span class="zcl_lk" data-marker="eventReq">'+zcal.i18n.calpubevtreq+"</span></li></ul>":"",i+="</div>"),i+="</div>",i+="<div>",i+='<span class="zcl_lk" data-marker="pubICAL">'+zcal.i18n.ical+"</span>",i+='<span class="zcl_sp"></span><span class="zcl_lk" data-marker="pubHTML">'+zcal.i18n.html+"</span>",i+="</div>",i+="</div>"),i+="</td></tr>",i+="</tbody>",i+="</table>",i+="</div>",h.html(i),a=h.find("[data-marker=makePublic]").removeAttr("data-marker"),a.off("click").on("click",function(a){var b=$(this).find("i"),c;b.hasClass("msi-check")?(b.removeClass("msi-check").addClass("msi-uncheck"),c=0):(b.removeClass("msi-uncheck").addClass("msi-check"),c=1),G({perm:c,mode:"enable/disable"})}),b=h.find("[data-marker=chgPubPerm]").removeAttr("data-marker"),b.off("click").on("click",function(a){var b=$(this),c=b.parent(),e;e=$(this).attr("rel")==="vd"?2:1,e=d[10][1]>=3?e==1?4:3:e,c.find(".msi-option").removeClass().addClass("msi-unoption"),b.find("i").addClass("msi-option"),G({perm:e,mode:"change"})}),g=h.find("[data-marker=allowER]").removeAttr("data-marker"),g.off("click").on("click",function(a){var b=$(this).find("i"),c;b.hasClass("msi-check")?(b.removeClass("msi-check").addClass("msi-uncheck"),c=0):(b.removeClass("msi-uncheck").addClass("msi-check"),c=1),H(c)}),c=h.find("[data-marker=pubICAL]").removeAttr("data-marker"),c.off("click").on("click",function(a){I("ical")}),e=h.find("[data-marker=pubHTML]").removeAttr("data-marker"),e.off("click").on("click",function(a){I("embed")}),f=h.find("[data-marker=webAPI]").removeAttr("data-marker"),f.off("click").on("click",function(a){J()}),g=h.find("[data-marker=eventReq]").removeAttr("data-marker"),g.off("click").on("click",function(a){P()})},G=function(a){var b=a.perm,e="/cal/shareCal.do?pubshare="+b+"&mode=pub-sh&calid="+c+"&caluid="+d[9]+"&calmode=0";ZCL_XHR(e,function(c){var e=ZCL_Evl(1,c.responseText),f;e.status==="success"&&(d[10][1]=e.pub,f=a.mode==="change"?zcal.i18n.publicsharechanged:b==0?zcal.i18n.publicshare_disabled:zcal.i18n.publicshare_enabled,zmUtil.succErrMsg("s",f)),F()})},H=function(a){var b=d[10][1],e;a==1?b=b==2?3:4:b=b==4?1:2,e="/cal/shareCal.do?pubshare="+b+"&mode=pub-sh&calid="+c+"&caluid="+d[9]+"&calmode=0",ZCL_XHR(e,function(b){var c=ZCL_Evl(1,b.responseText),e;c.status==="success"&&(d[10][1]=c.pub,e=a==0?zcal.i18n.allow_requisition_disabled:zcal.i18n.allow_requisition_enabled,zmUtil.succErrMsg("s",e)),F()})},I=function(a){$("#zcl_calpubaddress").length||$("body").append("<div id='zcl_calpubaddress' class='zcl_ovr'/>");var b,c=$("#zcl_calpubaddress");b='<div class="SC_set SC_filt_bottom">',b+='<textarea type="text" class="zcl_Stxt">'+location.protocol+"//"+zcal.ZCAL+"/"+(d[14]==""||d[14]=="gcal"?"":d[14]+"/")+a+"/"+d[9]+"</textarea>",b+='<span class="zcl_grey">'+zcal.i18n.calurlmsg+"</span>",b+="</div>",c.html(b);var e={title:zcal.i18n.publicaddress,mask:!0,pos:"center",closeaction:function(){c.remove(),zmsDialog.remove()},customClass:"SC_SetPop"};zmsDialog.create("zcl_calpubaddress",e)},J=function(){$("#zcl_calwebapi").length||$("body").append("<div id='zcl_calwebapi' class='zcl_ovr'/>");var a,b=$("#zcl_calwebapi");a='<div class="SC_set SC_filt_bottom">',a+='<div class="zmL">',a+='<div class="SC_srch shw"><table class="condition">',a+='<tr><td class="gbld">'+zcal.i18n.calwebapimsg+"</td></tr>",a+='<tr><td><textarea type="text" class="zcl_Stxt">'+location.protocol+"//"+zcal.ZCAL+"/eventreq/"+d[9]+"?name=[name]&mailId=[EmailId]&date=[MM/dd/yyyy]&time=[13:00]&reason=[Reason for Appointment]</textarea></td></tr>",a+="</table></div>",a+="</div>",a+="</div>",b.html(a);var c={title:zcal.i18n.apiforeventreq,mask:!0,pos:"center",closeaction:function(){b.remove(),zmsDialog.remove()},customClass:"SC_SetPop"};zmsDialog.create("zcl_calwebapi",c)},K=function(){var a=zcalEmbed.languages(),b='<select class="select">';for(var c in a)b+='<option value="'+c+'">'+a[c]+"</option>";return b+="</select>",b},L,M,N=function(a){this.theme=a&&a.theme||0,this.language=a&&a.lang||"en",this.calKey=a&&a.ckey};N.prototype={setTheme:function(a){this.theme=a},setLanguage:function(a){this.language=a},getURL:function(){var a='<iframe src="'+location.protocol+"//"+zcal.ZCAL+"/eventreqForm/"+this.calKey+"?theme="+this.theme+"&l="+this.language+'" frameborder="0" scrolling="no" marginWidth="0" border="0px" marginHeight="0" height="300px" width="432px" allowTransparency="true" align="center"></iframe>';return a}};var O=function(){M&&M.html('<textarea class="zcl_Stxt">'+L.getURL()+"</textarea>")},P=function(){$("#zcl_calereq").length||$("body").append("<div id='zcl_calereq' class='zcl_ovr'/>");var a,b=$("#zcl_calereq"),c;L=new N({lang:"en",theme:0,ckey:d[9]}),c=["#D5E4F7","#899AFF","#6FC252","#D4D4D4","#FF8F8F","#FF8FC1","#C9CE46","#FFAE00","#6F0DC2","#C81515"],a='<div class="SC_set SC_filt_bottom">',a+='<div class="conditionDiv">',a+="<table><tr><td>",a+='<div><div class="zmL">',a+='<div class="SC_srch shw">',a+='<table class="condition">',a+='<tr><td class="gbld">'+zcal.i18n.chooseyourclolor+"</td></tr>",a+='<tr><td><ul class="zcl_cecolr" id="zcl_ereqTheme">';for(var e=0;e<c.length;e++)a+='<li style="background-color:'+c[e]+'" class='+(e===L.theme?"zcl_sl":"")+'><i class="msi-tick"></i></li>';a+="</ul></td></tr>",a+="</table>",a+="</div>",a+="</div></div>",a+="</td>",a+="<td>",a+='<div><div class="zmL">',a+='<div class="SC_srch shw">',a+='<table class="condition">',a+='<tr><td class="gbld">'+zcal.i18n.language+"</td></tr>",a+='<tr><td><table><tr><td><div class="SC_select" data-marker="languageSel"></div></td></tr></table></td></tr>',a+="</table>",a+="</div>",a+="</div></div>",a+="</td></tr></table>",a+="</div>",a+='<div class="zmL">',a+='<div class="SC_srch shw"><table class="condition">',a+='<tr><td class="gbld">'+zcal.i18n.calwebapimsg+"</td></tr>",a+='<tr><td data-marker="ereqCode"><textarea class="zcl_Stxt">'+L.getURL()+"</textarea></td></tr>",a+="</table></div>",a+="</div>",a+="</div>",b.html(a),M=b.find("[data-marker=ereqCode]").removeAttr("data-marker");var f=b.find("#zcl_ereqTheme");f.find("li").off("click").on("click",function(a){var b=$(this);b.parent().find("li").removeClass("zcl_sl"),b.addClass("zcl_sl"),L.setTheme(b.index()),O()});var g=b.find("[data-marker=languageSel]").removeAttr("data-marker"),h=K();g.html(h),g.find("select").off("change").on("change",function(a){L.setLanguage(this.value),O()});var i={title:zcal.i18n.calpubevtreq,mask:!0,pos:"center",closeaction:function(){b.remove(),zmsDialog.remove()},customClass:"SC_SetPop",buttons:[{txt:zcal.i18n.preview,callback:function(){var a=window.open(),b;a.document.open(),b=L.getURL().replace(/&lt;/gi,"<").replace(/&gt;/gi,">"),a.document.write("<html><body>"+b+"</body></html>"),a.document.close()}}]};zmsDialog.create("zcl_calereq",i)},Q=function(){var a,b,c,e,f='<div class="SC_srch shw">';f+='<table class="condition">',f+="<tbody>",f+='<tr><td class="gbld">'+zcal.i18n.privateaddress+"</td></tr>",f+="</tbody>",f+="</table>",f+="</div>",f+="<div>",f+='<table class="condition">',f+="<tbody>",f+="<tr><td>",f+='<span data-marker="enablePvtURL"><i class="'+(d[10][0]?"msi-check":"msi-uncheck")+'"></i><span class="pl5">'+zcal.i18n.endableprivateadd+"</span></span>",d[10][0]&&(f+='<div class="zcl_Sshp"><div><span class="zcl_lk" data-marker="pvtICAL">'+zcal.i18n.ical+'</span><span class="zcl_sp"></span><span class="zcl_lk" data-marker="pvtHTML">'+zcal.i18n.html+"</span>",f+='<span class="SC_button zcl_ovr" data-marker="pvtReset">'+zcal.i18n.reseturl+"</span></div></div>"),f+="</td></tr>",f+="</tbody>",f+="</table>",f+="</div>",i.html(f),a=i.find("[data-marker=enablePvtURL]").removeAttr("data-marker"),a.off("click").on("click",function(a){var b=$(this).find("i"),c;b.hasClass("msi-check")?(b.removeClass("msi-check").addClass("msi-uncheck"),c="priv-dis"):(c="priv-reset",b.removeClass("msi-uncheck").addClass("msi-check")),R({mode:c,msg:"enable/disable"})}),b=i.find("[data-marker=pvtICAL]").removeAttr("data-marker"),b.off("click").on("click",function(a){S("ical")}),c=i.find("[data-marker=pvtHTML]").removeAttr("data-marker"),c.off("click").on("click",function(a){S("embed")}),$pvtReset=i.find("[data-marker=pvtReset]").removeAttr("data-marker"),$pvtReset.off("click").on("click",function(a){R({mode:"priv-reset",msg:"reset"})})},R=function(a){var b=d[9],e,f=a.mode;e="/cal/shareCal.do?calid="+c+"&caluid="+b+"&mode="+f+"&calmode=0",ZCL_XHR(e,function(b){var c=ZCL_Evl(1,b.responseText);f==="priv-reset"?(d[10][0]=c.pvtId,zmUtil.succErrMsg("s",a.msg=="reset"?zcal.i18n.privateurlchanged:zcal.i18n.privateshare_enabled)):(d[10][0]=null,zmUtil.succErrMsg("s",zcal.i18n.privateshare_disabled)),Q()})},S=function(a){var b;$("#zcl_calpvtaddress").length||$("body").append("<div id='zcl_calpvtaddress' class='zcl_ovr'/>"),b=$("#zcl_calpvtaddress");var c='<div class="SC_set SC_filt_bottom">';c+='<textarea type="text" class="zcl_Stxt">'+location.protocol+"//"+zcal.ZCAL+"/"+(d[14]==""?"":d[14]+"/")+a+"/"+d[9]+"/pvt_"+d[10][0]+"</textarea>",c+='<span class="zcl_grey">'+zcal.i18n.calurlmsg+"</span>",c+="</div>",b.html(c);var e={title:zcal.i18n.privateaddress,mask:!0,pos:"center",closeaction:function(){b.remove(),zmsDialog.remove()},customClass:"SC_SetPop"};zmsDialog.create("zcl_calpvtaddress",e)},T=function(){var a=zmail.Settings.MailSuite.App.Core.Framework;a.requestPreviewCard().done(function(a){a.close()})};return a.close=T,a}(zcalShareView||{}),zcalEmbedView=function(a){a=a||{};var b,c,d,e,f,g,h,i,j=[{w:"600",h:"500",c:-1,v:0},{w:"300",h:"500",c:0,v:-1},{w:"350",h:"500",c:10,v:-1},{w:"300",h:"500",c:0,v:-1},{w:"400",h:"400",c:-1,v:-1},{w:"700",h:"270",c:0,v:-1},{w:"300",h:"400",c:-1,v:-1},{w:"350",h:"500",c:1,v:-1},{w:"300",h:"500",c:7,v:-1},{w:"300",h:"500",c:0,v:-1}],k=function(){return[zcal.i18n.blue,zcal.i18n.green,zcal.i18n.red,zcal.i18n.pink,zcal.i18n.violet,zcal.i18n.rosybrown,zcal.i18n.purple,zcal.i18n.grey,zcal.i18n.orange,zcal.i18n.brown,zcal.i18n.yellow]},l=function(){return zcal.ZCAL.indexOf(".baihui.com")!=-1?{zh:zcal.i18n.chines,en:zcal.i18n.english}:{en:zcal.i18n.english,da:zcal.i18n.danish,de:zcal.i18n.german,es:zcal.i18n.spanish,fr:zcal.i18n.french,hu:zcal.i18n.hungarian,it:zcal.i18n.italian,ja:zcal.i18n.japanes,nl:zcal.i18n.dutch,pl:zcal.i18n.polish,pt:zcal.i18n.portuguese,ru:zcal.i18n.russian,sv:zcal.i18n.swedish,tr:zcal.i18n.turkish,zh:zcal.i18n.chines}},m=function(a){this.template=a&&a.type||0,this.title=a&&a.title,this.defaultCal=a&&a.dcal,this.selectedCal=[],this.view=j[this.template].v,this.color=j[this.template].c,this.language=a&&a.lang||"en",this.width=j[this.template].w,this.height=j[this.template].h,this.timezone=a&&a.tz,this.showTitle=!0,this.showTimezone=!0,this.detailview=!1};m.prototype={setTemplate:function(a){this.template=parseInt(a),this.view=j[this.template].v,this.color=j[this.template].c,this.width=j[this.template].w,this.height=j[this.template].h},setTitle:function(a){this.title=a},setCalendars:function(a){this.selectedCal=a!=""?a.split(","):[]},setView:function(a){this.view=parseInt(a)},setColor:function(a){this.color=parseInt(a)},setLanguage:function(a){this.language=a},setWidth:function(a){this.width=parseInt(a)},setHeight:function(a){this.height=parseInt(a)},setTimezone:function(a){this.timezone=a},setShowTitle:function(a){this.showTitle=a},setShowTimezone:function(a){this.showTimezone=a},setDetailview:function(a){this.detailview=a},getURL:function(){var a='<iframe src="'+location.protocol+"//"+zcal.ZCAL+(d[14]===""||d[14]==="gcal"?"":"/"+d[14])+"/embed/"+this.defaultCal+"?";if(zcal.cdata.calLst[c]){var b=this.selectedCal.length,e="";if(b!=0)for(var f=0;f<b;f++)e+=(f==0?"":",")+this.selectedCal[f];a+=e!=""?"cal="+e+"&":""}return a+="title="+ZCL_getHTML(this.title).replace("&#39;",""),a+="&type="+(this.template+1),a+="&l="+this.language,a+="&tz="+this.timezone,a+="&sh=["+(this.showTitle?1:0)+","+(this.showTimezone?1:0)+","+(this.detailview?1:0)+"]",a+=this.color!=-1?"&c="+this.color:"",a+=this.view!=-1?"&v="+this.view:"",a+='" width="'+this.width+'" height="'+this.height+'" frameborder="0" scrolling="no"></iframe>',a}};var n=function(){zcal.timezones.length==0&&ZCL_uXHR("/cal/timez.do",function(a){zcal.timezones=ZCL_Evl(1,a.responseText)}),o(),p(),q(),z()},o=function(){f&&f.html('<div><div class="zcl_emb'+(e.template+1)+'"></div></div>')},p=function(){var a,b,c,d;if(g){d='<div class="zmL">',d+='<div class="SC_srch shw">',d+='<table class="condition">',d+="<tbody><tr>",d+='<td class="gbld">'+zcal.i18n.title+"</td>",d+="</tr><tr>",d+='<td><div class="SC_select SC_selectnoneArw first"><input placeholder="Untitled"  class="SC_tiput"  value="'+ZCL_getHTML(e.title)+'" type="text"></div></td>',d+="</tr></tbody>",d+="</table>",d+="</div>",d+="</div>",d+='<div class="zmL">',d+='<div class="SC_srch shw">',d+='<table class="condition">',d+="<tbody><tr>",d+='<td class="gbld">'+zcal.i18n.select_calendar+'</td></tr><tr><td><select style="width:100%" size="4" multiple="multiple"/></td>',d+="</tr></tbody>",d+="</table>",d+="</div>",d+="</div>";if(e.color!=-1||e.view!=-1)d+='<div class="zmL">',d+='<div class="SC_srch shw">',d+='<table class="condition">',d+="<tbody>",d+='<tr><td class="gbld">'+(e.view!=-1?zcal.i18n.chooseyourview:zcal.i18n.chooseacolor)+"</td></tr>",d+='<tr><td><table><tbody><tr><td><div class="SC_select first" data-marker="viewColorSel"><input type="text" id="color" class="disabled"  readonly value='+zcal.i18n.vday+"></div></td></tr></tbody></table></td></tr>",d+="</tbody>",d+="</table>",d+="</div>",d+="</div>";g.html(d),a=g.find("input.SC_tiput"),a.off("change").on("change",function(a){e.setTitle(this.value),z()}),b=g.find("select");var f=u();b.html(f),b.off("click").on("click",function(a){var b=$(this),c=[];$.each(b.find("option:selected"),function(){var a=$(this).val();a!=e.defaultCal&&c.push(a)}),e.setCalendars(c.join(",")),z()}),c=g.find("[data-marker=viewColorSel]").removeAttr("data-marker");if(c){var h,i;if(e.color!=-1){var j=k(),l=[];for(var m=0;m<j.length;m++){$("#color")[0].value=j[e.color];var n={text:j[m],value:m};l.push(n)}c.on("click",function(a){var b=a.target;y({menuItems:l,par:this,parWidth:!0}).then(function(a){b.value=a.text,e.setColor(a.value),z(),zmUtil.hideMenu()})})}else if(e.view!=-1){var o=[{text:zcal.i18n.vday,value:0},{text:zcal.i18n.week,value:1},{text:zcal.i18n.month,value:2}];c.on("click",function(a){var b=a.target;y({menuItems:o,par:this,parWidth:!0}).then(function(a){b.value=a.text,e.setView(a.value),z(),zmUtil.hideMenu()})})}}}},q=function(){var a,b,c,d,f,g;if(h){g='<div class="zmL">',g+='<div class="SC_srch shw">',g+='<table class="condition">',g+="<tbody>",g+='<tr><td class="gbld">'+zcal.i18n.language+"</td></tr>",g+='<tr><td><table><tbody><tr><td><div class="SC_select first" data-marker="languageSel"><input type="text" id="lan" class="disabled"  readonly value="English"></div></td></tr></tbody></table></td></tr>',g+="</tbody>",g+="</table>",g+="</div>",g+="</div>",g+='<div class="zmL">',g+='<div class="SC_srch shw">',g+="<table>",g+="<tbody><tr>",g+='<td><table class="condition"><tbody><tr><td class="gbld">'+zcal.i18n.width+'</td></tr><tr><td><table><tbody><tr><td><div class="SC_select SC_selectnoneArw first"><input id="zcl_embedWdt" value="'+e.width+'px" type="text"></div></td></tr></tbody></table></td></tr></tbody></table></td>',g+='<td><table class="condition"><tbody><tr><td class="gbld">'+zcal.i18n.height+'</td></tr><tr><td><table><tbody><tr><td><div class="SC_select SC_selectnoneArw"><input id="zcl_embedHgt" value="'+e.height+'px" type="text"></div></td></tr></tbody></table></td></tr></tbody></table></td>',g+="</tr></tbody>",g+="</table>",g+="</div>",g+="</div>",g+='<div class="zmL">',g+='<div class="SC_srch shw">',g+='<table class="condition">',g+="<tbody>",g+="<tr><td><table><tbody><tr>",g+='<td><span class="mLnone mr20" id="zcl_embedShowTitle"><i  class="'+(e.showTitle?"msi-check":"msi-uncheck")+'"></i><span class="pl5">'+zcal.i18n.title+"</span></span></td>",g+='<td><span class="mLnone" id="zcl_embedShowTz"><i  class="'+(e.showTimezone?"msi-check":"msi-uncheck")+'"></i><span class="pl5">'+zcal.i18n.timezone+"</span></span></td>",g+="</tr></tbody></table></td></tr>",e.template==0&&(g+='<tr><td><span class="mLnone" id="zcl_embedDview"><i class="'+(e.detailview?"msi-check":"msi-uncheck")+'"></i><span class="pl5">'+zcal.i18n.detailsview+"</span></span></td></tr>"),g+="</tbody>",g+="</table>",g+="</div>",g+="</div>",h.html(g),a=h.find("[data-marker=languageSel]").removeAttr("data-marker");var i=l(),j=[];for(var k in i){var m={text:i[k],value:k};j.push(m)}a.on("click",function(a){var b=a.target;y({menuItems:j,par:this,parWidth:!0}).then(function(a){b.value=a.text,e.setLanguage(a.value),z(),zmUtil.hideMenu()})}),$wdtDOM=h.find("#zcl_embedWdt"),$wdtDOM.off("change").on("change",function(a){var b=this.value;b!=""&&(b=b.replace(/\D/g,""),e.setWidth(b),z())}),c=h.find("#zcl_embedHgt"),c.off("change").on("change",function(a){var b=this.value;b!=""&&(b=b.replace(/\D/g,""),e.setHeight(b),z())});var n=h.find("#zcl_embedShowTitle");n.off("click").on("click",function(a){var b=$(this),c,d,f;d=b.find("i"),c=d.hasClass("msi-check")?"msi-uncheck":"msi-check",f=c==="msi-check"?!0:!1,d.attr("class",c),e.setShowTitle(f),z()});var o=h.find("#zcl_embedShowTz");o.off("click").on("click",function(a){var b=$(this),c,d,f;d=b.find("i"),c=d.hasClass("msi-check")?"msi-uncheck":"msi-check",f=c==="msi-check"?!0:!1,d.attr("class",c),e.setShowTimezone(f),z()});var p=h.find("#zcl_embedDview");p.off("click").on("click",function(a){var b=$(this),c,d,f;d=b.find("i"),c=d.hasClass("msi-check")?"msi-uncheck":"msi-check",f=c==="msi-check"?!0:!1,d.attr("class",c),e.setDetailview(f),z()})}},r=function(){var a="<select>";for(var b in zcal.timezones)for(var c in zcal.timezones[b]){var d=zcal.cdata.opt.TIM==c?"selected":"";a+="<option "+d+" value="+c+">"+unescape(zcal.timezones[b][c])+" ("+c+")"+"</option>"}a+="</select>",$("#zcl_embedTZ").html(a);var f=h.find("#zcl_embedTZ select");f.off("change").on("change",function(a){e.setTimezone(this.value),z()})},s=function(){zcal.timezones.length>0?t():ZCL_getTZ({mode:"embed",callback:function(){t()}})},t=function(){var a='<input value="'+unescape(zcal.cdata.opt.CTIM)+'" type="text"  rel='+zcal.cdata.opt.TIM+' readonly="" id="zcl_emTZ">';return a},u=function(){var a=zcal.cdata.calOrdArr,b,c="";return a.forEach(function(a){var b=zcal.cdata.calLst,d=b[a][9]==e.defaultCal||e.selectedCal.indexOf(b[a][9])!=-1?"selected":"";c+='<option value="'+b[a][9]+'" '+d+">"+ZCL_getHTML(b[a][0])+"</option>"}),c},v=function(){var a=k(),b=[];for(var c=0;c<a.length;c++){var d={text:a[c],value:c};b.push(d)}return b},w=function(){var a=[zcal.i18n.vday,zcal.i18n.week,zcal.i18n.month],b='<select class="select">';for(var c=0;c<a.length;c++)b+='<option value="'+c+'" '+(e.view==c?"selected":"")+">"+a[c]+"</option>";return b+="</select>",b},x=function(a,j){c=a,d=j,e=new m({title:d[0],dcal:d[9],tz:zcal.cdata.opt.TIM,lang:zcal.cdata.opt.LANG});var k,l="";b=$('<div id="calembed" class="SC_Twpr zcl_Twpr" style="top:46px"><div class="SC_filt_bottom SC_filt_bottomCustom" id="SC_embed"></div>');var o='<div class="editFilterParent zcl_stfrm">';o+='<div class="zcl_Semdtmp" data-marker="embedTpl">',o+="</div>",o+='<div class="conditionDiv">',o+='<table class="zcl_Semdsp">',o+="<tbody>",o+="<tr>",o+='<td data-marker="embedTplImg"></td>',o+='<td><div data-marker="embedTitleSec"></div></td>',o+='<td><div data-marker="embedTZSec"></div></td>',o+="</tr>",o+="</tbody>",o+="</table>",o+="</div>",o+='<div class="zmL">',o+='<div class="SC_srch shw">',o+='<table class="condition">',o+='<tbody><tr><td class="gbld">'+zcal.i18n.timezone+'</td></tr><tr><td><table><tbody><tr><td><div style="width: 380px!important" class="SC_select first" id="zcl_embedTZ">'+t()+"</div></td></tr></tbody></table></td></tr></tbody>",o+="</table>",o+="</div>",o+="</div>",o+='<div class="zmL">',o+='<div class="SC_srch shw">',o+='<table class="condition">',o+="<tbody>",o+='<tr><td class="gbld">'+zcal.i18n.embed_instruction+"</td></tr>",o+='<tr><td><table class="zcl_w100pc">',o+='<tbody><tr><td data-marker="embedCode"></td></tr></tbody>',o+="</table></td></tr>",o+="</tbody>",o+="</table>",o+="</div>",o+="</div>",o+='<div class="SC_PUbtm">',o+='<span class="sel" id="pre">'+zcal.i18n.preview+"</span>",o+='<span data-val="Cancel" id="ref">'+zcal.i18n.refresh+"</span>",o+="</div>",o+="</div>",b.find("#SC_embed").append(o),k=b.find("[data-marker=embedTpl]").removeAttr("data-marker");for(var p=0;p<10;p++)l+="<span "+(p==e.template?'class="zcl_sl"':"")+">"+(p+1)+"</span>";k.html(l),k.find("span").off("click").on("click",function(a){var b=$(this);b.parent().find("span").removeClass("zcl_sl"),b.addClass("zcl_sl"),e.setTemplate(b.index()),n()}),b.find("#zcl_emTZ").on("click",function(){var a=zcal.timezones,b=[];for(var c in a)for(var d in a[c]){var e={};e.id=d,e.name=a[c][d]+" ("+d+")",e.display_text=a[c][d]+" ("+d+")",b.push(e)}var f={},g=$(this),h;f.parentDOM=g.parent(),f.displayAs="dropdown",f.parWidth=!0,f.onSelect=function(a,b){q(g,a,b),h.hide()},f.dataCallback=function(){return b},h=zmUtil.createFLComp("generic",f),h.show()});var q=function(a,b,c){a.val(c.display_text),a.attr("rel",b),e.setTimezone(b),z()},r=b.find("#zcl_embedShowTz");return r.off("click").on("click",function(a){var b=$(this),c,d,f;d=b.find("i"),c=d.hasClass("msi-check")?"msi-uncheck":"msi-check",f=c==="msi-check"?!0:!1,d.attr("class",c),e.setShowTimezone(f),z()}),b.find("#pre").on("click",function(){var a=window.open(),b;a.document.open(),b=e.getURL().replace(/&lt;/gi,"<").replace(/&gt;/gi,">"),a.document.write("<html><body>"+b+"</body></html>"),a.document.close()}),b.find("#ref").on("click",function(){e=new m({title:d[0],dcal:d[9],tz:zcal.cdata.opt.TIM,lang:zcal.cdata.opt.LANG,type:e.template}),n()}),f=b.find("[data-marker=embedTplImg]").removeAttr("data-marker"),g=b.find("[data-marker=embedTitleSec]").removeAttr("data-marker"),h=b.find("[data-marker=embedTZSec]").removeAttr("data-marker"),i=b.find("[data-marker=embedCode]").removeAttr("data-marker"),n(),b},y=function(a){var b=[],c=a.menuItems||[];c.forEach(function(a){var c=a.value,d=a.text;b.push({htm:"<div>"+d+"</div>",data:{value:c,text:d}})});var d=$.Deferred();return a.list=b,a.clk=function(a,b,c){d.resolve(a,b,c)},a.onHide=function(){d.reject()},b.length?zmsuite.showMenu(a):d.reject(),d.fail(zmUtil.hideMenu),d.promise()},z=function(){i&&i.html('<textarea class="zcl_Stxt">'+e.getURL()+"</textarea>")};return a.render=x,a.showAllTimezone=r,a}(zcalEmbedView||{});_defineSettingsModule("MGAOCalendars",function(a,b){"use strict";var c=b("Platform.Components"),d=c.SettingAppManager,e=b("Platform.System.Utils"),f="calendar-mgaocalendars",g="calendar-mgaocalendars",h="MailSuite.Apps.CalendarMGAOCalendars.MGAOCalendarsView",i,j=function(){return b(h)},k=function(){var a=$.Deferred();return zmApp.loadCalendar("/calendar/settings",a),a.promise()},l=function(){var a=e.makeDeferred(),b=$.Deferred();return typeof zcal=="undefined"?k().done(function(){j().initialize({process:a})}).fail(a.reject):j().initialize({process:a}),a.promise()},m=function(){var a=e.makeDeferred();return j.uninitialize({process:a}),a.promise()},n=function(){var a=j();return a.getMGAOCalendarsView()},o=function(){return null},p=function(){i=d.create(f,{attributes:{page:g,isReactApp:!1},initialize:l,uninitialize:m,getView:n,handleContainerEvent:o})},q=function(){p(),a.App=i};q()},"MailSuite.Apps"),function(a){"use strict";var b="calendar-mgaocalendars",c="calendar-mgaocalendars",d={MY_CALENDARS:"my-calendars",GROUP_CALENDARS:"group-calendars",APP_CALENDARS:"app-calendars",OTHER_CALENDARS:"other-calendars"},e={mycalendars:{cardItem:{title:"My Calendars"}},groupcalendars:{cardItem:{title:"Group Calendars"}},appcalendars:{cardItem:{title:"App. Calendars"}},othercalendars:{cardItem:{title:"Other Calendars"}}},f=a("Platform.Components"),g=a("Platform.Entities"),h=a("MailSuite.Settings.Calendar"),i=a("Platform.System.Utils"),j=f.SettingCardItemManager,k=g.SettingCardItem,l=k.Types,m=j.create(d.MY_CALENDARS,{props:{title:e.mycalendars.cardItem.title},attributes:{type:l.Action,card:b},primaryAction:function(){zmail.Settings.MailSuite.App.openApp().done(function(){var a=zmail.Settings.MailSuite.App.Core.Framework;a.requestShowPage(c).done(function(){var a=zmail.Settings.MailSuite.Apps.CalendarMGAOCalendars.MGAOCalendarsView;a.getMGAOCalendarsView()}).fail(function(){})})}}),n=j.create(d.GROUP_CALENDARS,{props:{title:e.groupcalendars.cardItem.title},attributes:{type:l.Action,card:b},primaryAction:function(){zmail.Settings.MailSuite.App.openApp().done(function(){var a=zmail.Settings.MailSuite.App.Core.Framework;a.requestShowPage(c).done(function(){var a=zmail.Settings.MailSuite.Apps.CalendarMGAOCalendars.MGAOCalendarsView;a.groupCalendarView()}).fail(function(){})})}}),o=j.create(d.APP_CALENDARS,{props:{title:e.appcalendars.cardItem.title},attributes:{type:l.Action,card:b},primaryAction:function(){zmail.Settings.MailSuite.App.openApp().done(function(){var a=zmail.Settings.MailSuite.App.Core.Framework;a.requestShowPage(c).done(function(){var a=zmail.Settings.MailSuite.Apps.CalendarMGAOCalendars.MGAOCalendarsView;a.appCalendarView()}).fail(function(){})})}}),p=j.create(d.OTHER_CALENDARS,{props:{title:e.othercalendars.cardItem.title},attributes:{type:l.Action,card:b},primaryAction:function(){zmail.Settings.MailSuite.App.openApp().done(function(){var a=zmail.Settings.MailSuite.App.Core.Framework;a.requestShowPage(c).done(function(){var a=zmail.Settings.MailSuite.Apps.CalendarMGAOCalendars.MGAOCalendarsView;a.otherCalendarView()}).fail(function(){})})}})}(zmail.Settings.Modules.import),_defineSettingsModule("ZCAL_Setinit",function(a,b){"use strict";var c=function(){var a=$.Deferred();return zmApp.loadCalendar("/calendar/settings",a),a.promise()},d=function(){var a=$.Deferred();return $.subscribe("/zm-settings/mailsuite-app/opened",function(){c().done(function(){var b=[zcal.i18n.allow,zcal.i18n.dontallow,zcal.i18n.allowiffree],c=[zcal.i18n.off,zcal.i18n.on],d=zmail.Settings.Platform.Components.SettingCardItemManager,e=zmail.Settings.Platform.Components.SettingCardManager,f=zmail.Settings.Platform.Components.CategoryManager,g=f.get("calendar").setProp("title",zcal.i18n.calendar),h=e.get("calendar-generals").setProp("title",zcal.i18n.calendarpreferences),i=e.get("email-notify").setProp("title",zcal.i18n.emailnotification),j=e.get("calendar-import").setProp("title",zcal.i18n.import),k=e.get("calendar-subscribe").setProp("title",zcal.i18n.subscribe),l=e.get("calendar-sync").setProp("title",zcal.i18n.synchronize),m=e.get("calendar-zohoapp").setProp("title",ZCL_replaceComName(zcal.i18n.zohoapps)),n=e.get("calendar-mgaocalendars").setProp("title",zcal.i18n.calendars),o=d.get("time-zone").setProp("title",zcal.i18n.timezone),p=d.get("date-format").setProp("title",zcal.i18n.dateformat),q=d.get("time-format").setProp("title",zcal.i18n.timeformat),r=d.get("default-view").setProp("title",zcal.i18n.defaultview),s=d.get("automatic-invi").setProp("title",zcal.i18n.automatic_inv),t=d.get("reminder-notifi").setProp("title",zcal.i18n.reminder_notification),u=d.get("email-address").setProp("title",zcal.i18n.emailaddress),v=d.get("agenda-notify").setProp("title",zcal.i18n.agendanotification),w=d.get("by-file").setProp("title",zcal.i18n.file),x=d.get("by-url").setProp("title",zcal.i18n.url),y=d.get("web-url").setProp("title",zcal.i18n.weburl),z=d.get("friends-calendar").setProp("title",zcal.i18n.friendscalendar),A=d.get("holi-day").setProp("title",zcal.i18n.holiday),B=d.get("groups").setProp("title",zcal.i18n.groups),C=d.get("microsoft-outlook").setProp("title",zcal.i18n.outlook),D=d.get("google-calendar").setProp("title",zcal.i18n.gcal),E=d.get("cal-dav").setProp("title",zcal.i18n.caldav),F=d.get("zoho-calsync").setProp("title",ZCL_replaceComName(zcal.i18n.zcalsync)),G=d.get("zoho-crm").setProp("title",ZCL_replaceComName(zcal.i18n.zohocrm)),H=d.get("zoho-recruit").setProp("title",ZCL_replaceComName(zcal.i18n.zohorecruit)),I=d.get("zoho-task").setProp("title",ZCL_replaceComName(zcal.i18n.zohotask)),J=d.get("zoho-projects").setProp("title",ZCL_replaceComName(zcal.i18n.zohoprojects)),G=d.get("zoho-contacts").setProp("title",ZCL_replaceComName(zcal.i18n.zohocontacts)),K=d.get("my-calendars").setProp("title",zcal.i18n.mycalendars),D=d.get("group-calendars").setProp("title",zcal.i18n.groupcalendars),L=d.get("app-calendars").setProp("title",zcal.i18n.appcalendars),M=d.get("other-calendars").setProp("title",zcal.i18n.othercalendars),N=d.get("time-zone").setProp("value",zcal.cdata.opt.TIM),O=d.get("date-format").setProp("value",zcal.DATEFORMAT[zcal.cdata.opt.DF]),P=d.get("time-format").setProp("value",zcal.TIMEFORMAT[zcal.cdata.opt.TF]),Q=d.get("default-view").setProp("value",zcal.DEFAULTVIEW[zcal.cdata.opt.DEF]),R=d.get("automatic-invi").setProp("value",b[zcal.cdata.opt.SIE]),S=d.get("reminder-notifi").setProp("value",c[zcal.cdata.opt.REM]);if(typeof zcal.cdata.opt.CMAIL=="undefined")var T=d.get("email-address").setProp("value",zcal.cdata.opt.MTO);else var T=d.get("email-address").setProp("value",zcal.cdata.opt.CMAIL);var U=d.get("agenda-notify").setProp("value",zcal.AGENDA_INTERVAL[zcal.cdata.opt.AI]);a.resolve()}).fail(function(){SystemUtils.debugLog("Module load failed !!!"),a.reject()})}),a.promise()};d()},"MailSuite.Apps.ZCAL_Setinit");